[
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/19001463",
    "html_url": "https://github.com/ipython/ipython/issues/3404#issuecomment-19001463",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/3404",
    "id": 19001463,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MDAxNDYz",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-06-05T19:12:47Z",
    "updated_at": "2013-06-05T19:12:47Z",
    "author_association": "MEMBER",
    "body": "That regex looks like you'll end up matching names that start with the exact string `ab{2}`. If you're trying to escape the braces, try doubling them: `{{a}}`.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/19002746",
    "html_url": "https://github.com/ipython/ipython/issues/3404#issuecomment-19002746",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/3404",
    "id": 19002746,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MDAyNzQ2",
    "user": {
      "login": "amjacobs",
      "id": 4623400,
      "node_id": "MDQ6VXNlcjQ2MjM0MDA=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/4623400?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amjacobs",
      "html_url": "https://github.com/amjacobs",
      "followers_url": "https://api.github.com/users/amjacobs/followers",
      "following_url": "https://api.github.com/users/amjacobs/following{/other_user}",
      "gists_url": "https://api.github.com/users/amjacobs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amjacobs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amjacobs/subscriptions",
      "organizations_url": "https://api.github.com/users/amjacobs/orgs",
      "repos_url": "https://api.github.com/users/amjacobs/repos",
      "events_url": "https://api.github.com/users/amjacobs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amjacobs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-06-05T19:32:20Z",
    "updated_at": "2013-06-05T19:32:20Z",
    "author_association": "NONE",
    "body": "I'm not trying to escape the braces.  I'm trying to match all names with a given prefix.  This was the use case in which I stumbled across the apparent error mentioned.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/19002999",
    "html_url": "https://github.com/ipython/ipython/issues/3404#issuecomment-19002999",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/3404",
    "id": 19002999,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MDAyOTk5",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-06-05T19:36:39Z",
    "updated_at": "2013-06-05T19:36:39Z",
    "author_association": "MEMBER",
    "body": "To put it another way: if you're trying to pass grep the regex `ab{2}`, try doubling the braces rather than sticking slashes in front of them.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/19003437",
    "html_url": "https://github.com/ipython/ipython/issues/3404#issuecomment-19003437",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/3404",
    "id": 19003437,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MDAzNDM3",
    "user": {
      "login": "minrk",
      "id": 151929,
      "node_id": "MDQ6VXNlcjE1MTkyOQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/151929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/minrk",
      "html_url": "https://github.com/minrk",
      "followers_url": "https://api.github.com/users/minrk/followers",
      "following_url": "https://api.github.com/users/minrk/following{/other_user}",
      "gists_url": "https://api.github.com/users/minrk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/minrk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/minrk/subscriptions",
      "organizations_url": "https://api.github.com/users/minrk/orgs",
      "repos_url": "https://api.github.com/users/minrk/repos",
      "events_url": "https://api.github.com/users/minrk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/minrk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-06-05T19:44:19Z",
    "updated_at": "2013-06-05T19:44:19Z",
    "author_association": "MEMBER",
    "body": "IPython applies Python string formatting to your subcommands, so `{expr}` is replaced with the result of `eval(expr)`.  Now, you might expect that the backslash functions as an escape, but it doesn't (for whatever reason).  If you want to escape the braces so they arrive at the subcommand, you will want to double up (`{{2}}`).  You can see the string that IPython passes to the shell by testing `ip.var_expand(\"command\")`.  The one additional piece of relevant information is that if variable expansion fails, none of it is done.  For example:\n\n``` python\nIn [2]: ip = get_ipython()\n\nIn [3]: ip.var_expand('!ls $dir')\nOut[3]: u'!ls /Users/minrk/temp/somedir'\n\nIn [4]: ip.var_expand('!ls $dir | grep \"^ab{2}\"')\nOut[5]: u'!ls /Users/minrk/temp/somedir | grep \"^ab2\"'\n\nIn [5]: ip.var_expand('!ls $dir | grep \"^ab\\{2\\}\"')\nOut[5]: '!ls $dir | grep \"^ab\\\\{2\\\\}\"'\n\nIn [6]: ip.var_expand('!ls $dir | grep \"^ab\\{{2\\}}\"')\nOut[6]: u'!ls /Users/minrk/temp/somedir | grep \"^ab\\\\{2\\\\}\"'\n\nIn [7]: !ls $dir | grep \"^ab\\{{2\\}}\"\nabb-1\nabb-2\nabb-3\n```\n- Case 3: works fine\n- Case 4: `{2}` is replaced with `eval('2')`, which is just `2`\n- Case 5: `{2\\}` tries to replace with `eval('2\\')` which fails, resulting in untransformed input (note that even `$dir` isn't replaced)\n- Case 6: `{{2\\}}` is the regular Python formatting way to escape braces that should not do anything, and is the actual command that you want, as confirmed in input 7.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/19006092",
    "html_url": "https://github.com/ipython/ipython/issues/3404#issuecomment-19006092",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/3404",
    "id": 19006092,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MDA2MDky",
    "user": {
      "login": "amjacobs",
      "id": 4623400,
      "node_id": "MDQ6VXNlcjQ2MjM0MDA=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/4623400?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amjacobs",
      "html_url": "https://github.com/amjacobs",
      "followers_url": "https://api.github.com/users/amjacobs/followers",
      "following_url": "https://api.github.com/users/amjacobs/following{/other_user}",
      "gists_url": "https://api.github.com/users/amjacobs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amjacobs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amjacobs/subscriptions",
      "organizations_url": "https://api.github.com/users/amjacobs/orgs",
      "repos_url": "https://api.github.com/users/amjacobs/repos",
      "events_url": "https://api.github.com/users/amjacobs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amjacobs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-06-05T20:26:47Z",
    "updated_at": "2013-06-05T20:31:11Z",
    "author_association": "NONE",
    "body": "Ah, I think I get it now.\n\n``` python\nIn[1]: !\\ls \"/path/to/some/dir/\" | grep \"^ab\\{2\\}\"\n```\n\nworks fine because variable expansion isn't triggered as there's no `$var` to interpret, but\n\n``` python\nIn[2]: adir = \"/path/to/some/dir/\" \n  ...: !\\ls $adir | grep \"^ab\\{2\\}\"\n```\n\nbreaks because the `$adir` triggers expansion which breaks due to the `{2\\}` and thus I don't get my expected results.\n\nI can fix my notebook now.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/19006640",
    "html_url": "https://github.com/ipython/ipython/issues/3404#issuecomment-19006640",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/3404",
    "id": 19006640,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MDA2NjQw",
    "user": {
      "login": "minrk",
      "id": 151929,
      "node_id": "MDQ6VXNlcjE1MTkyOQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/151929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/minrk",
      "html_url": "https://github.com/minrk",
      "followers_url": "https://api.github.com/users/minrk/followers",
      "following_url": "https://api.github.com/users/minrk/following{/other_user}",
      "gists_url": "https://api.github.com/users/minrk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/minrk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/minrk/subscriptions",
      "organizations_url": "https://api.github.com/users/minrk/orgs",
      "repos_url": "https://api.github.com/users/minrk/repos",
      "events_url": "https://api.github.com/users/minrk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/minrk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-06-05T20:35:23Z",
    "updated_at": "2013-06-05T20:35:23Z",
    "author_association": "MEMBER",
    "body": "That's close, but a little bit backwards - it's the attempted expansion of `{2\\}` that fails, which failure _prevents_ the substitution of `$adir`:\n\n``` python\nIn [1]: a = 5\n\nIn [2]: !echo a=$a {2}\na=5 2\n\nIn [3]: !echo a=$a {2\\\\}\na= {2\\}\n\nIn [4]: !echo a=$a {{2}}\na=5 {2}\n\nIn [5]: !echo a=$a {{2\\\\}}\na=5 {2\\}\n```\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/19007481",
    "html_url": "https://github.com/ipython/ipython/issues/3404#issuecomment-19007481",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/3404",
    "id": 19007481,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MDA3NDgx",
    "user": {
      "login": "amjacobs",
      "id": 4623400,
      "node_id": "MDQ6VXNlcjQ2MjM0MDA=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/4623400?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amjacobs",
      "html_url": "https://github.com/amjacobs",
      "followers_url": "https://api.github.com/users/amjacobs/followers",
      "following_url": "https://api.github.com/users/amjacobs/following{/other_user}",
      "gists_url": "https://api.github.com/users/amjacobs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amjacobs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amjacobs/subscriptions",
      "organizations_url": "https://api.github.com/users/amjacobs/orgs",
      "repos_url": "https://api.github.com/users/amjacobs/repos",
      "events_url": "https://api.github.com/users/amjacobs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amjacobs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-06-05T20:49:41Z",
    "updated_at": "2013-06-05T20:49:41Z",
    "author_association": "NONE",
    "body": "Ah, yes.  So expansion/interpretation is always happening and it fails on the `{2\\}` in both cases.  It's only noticeable in case 2 due to the `$adir` needing to be expanded.  Thanks for the insight.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/19007546",
    "html_url": "https://github.com/ipython/ipython/issues/3404#issuecomment-19007546",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/3404",
    "id": 19007546,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MDA3NTQ2",
    "user": {
      "login": "minrk",
      "id": 151929,
      "node_id": "MDQ6VXNlcjE1MTkyOQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/151929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/minrk",
      "html_url": "https://github.com/minrk",
      "followers_url": "https://api.github.com/users/minrk/followers",
      "following_url": "https://api.github.com/users/minrk/following{/other_user}",
      "gists_url": "https://api.github.com/users/minrk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/minrk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/minrk/subscriptions",
      "organizations_url": "https://api.github.com/users/minrk/orgs",
      "repos_url": "https://api.github.com/users/minrk/repos",
      "events_url": "https://api.github.com/users/minrk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/minrk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-06-05T20:50:43Z",
    "updated_at": "2013-06-05T20:50:43Z",
    "author_association": "MEMBER",
    "body": "> So expansion/interpretation is always happening\n\nYes, this is a key point, I should have mentioned that.\n"
  }
]
