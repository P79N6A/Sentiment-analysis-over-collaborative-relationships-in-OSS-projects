[
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/75423072",
    "html_url": "https://github.com/ipython/ipython/issues/7830#issuecomment-75423072",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/7830",
    "id": 75423072,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NDIzMDcy",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-02-22T07:00:01Z",
    "updated_at": "2015-02-22T07:00:01Z",
    "author_association": "MEMBER",
    "body": "Can you stick a `print(modname)` in there (just before line 524) to see what module it's choking on?\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/75437513",
    "html_url": "https://github.com/ipython/ipython/issues/7830#issuecomment-75437513",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/7830",
    "id": 75437513,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NDM3NTEz",
    "user": {
      "login": "sjlnk",
      "id": 3604830,
      "node_id": "MDQ6VXNlcjM2MDQ4MzA=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/3604830?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sjlnk",
      "html_url": "https://github.com/sjlnk",
      "followers_url": "https://api.github.com/users/sjlnk/followers",
      "following_url": "https://api.github.com/users/sjlnk/following{/other_user}",
      "gists_url": "https://api.github.com/users/sjlnk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sjlnk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sjlnk/subscriptions",
      "organizations_url": "https://api.github.com/users/sjlnk/orgs",
      "repos_url": "https://api.github.com/users/sjlnk/repos",
      "events_url": "https://api.github.com/users/sjlnk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sjlnk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-02-22T14:20:36Z",
    "updated_at": "2015-02-22T14:21:05Z",
    "author_association": "NONE",
    "body": "takluyver: I tried that.\n\n`__mp_main__` is the modname giving problems.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/75443832",
    "html_url": "https://github.com/ipython/ipython/issues/7830#issuecomment-75443832",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/7830",
    "id": 75443832,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NDQzODMy",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-02-22T16:36:05Z",
    "updated_at": "2015-02-22T16:36:05Z",
    "author_association": "MEMBER",
    "body": "Does your script use multiprocessing? I guess that's what mp stands for.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/75667339",
    "html_url": "https://github.com/ipython/ipython/issues/7830#issuecomment-75667339",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/7830",
    "id": 75667339,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NjY3MzM5",
    "user": {
      "login": "sjlnk",
      "id": 3604830,
      "node_id": "MDQ6VXNlcjM2MDQ4MzA=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/3604830?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sjlnk",
      "html_url": "https://github.com/sjlnk",
      "followers_url": "https://api.github.com/users/sjlnk/followers",
      "following_url": "https://api.github.com/users/sjlnk/following{/other_user}",
      "gists_url": "https://api.github.com/users/sjlnk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sjlnk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sjlnk/subscriptions",
      "organizations_url": "https://api.github.com/users/sjlnk/orgs",
      "repos_url": "https://api.github.com/users/sjlnk/repos",
      "events_url": "https://api.github.com/users/sjlnk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sjlnk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-02-24T00:01:20Z",
    "updated_at": "2015-02-24T00:03:00Z",
    "author_association": "NONE",
    "body": "takluyver: Indeed that seems to be the problem. I get that error when I `%run` a program like this:\n\n``` python\nimport multiprocessing\n\nif __name__ == \"__main__\":\n\n    print(\"hello\")\n```\n\nI cannot `import concurrent.futures` either... Same error. I suppose that library is using `multiprocessing` under the hood.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/75669097",
    "html_url": "https://github.com/ipython/ipython/issues/7830#issuecomment-75669097",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/7830",
    "id": 75669097,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NjY5MDk3",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-02-24T00:11:41Z",
    "updated_at": "2015-02-24T00:11:41Z",
    "author_association": "MEMBER",
    "body": "OK, I've retitled the issue to reflect that.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/83625900",
    "html_url": "https://github.com/ipython/ipython/issues/7830#issuecomment-83625900",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/7830",
    "id": 83625900,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzNjI1OTAw",
    "user": {
      "login": "memeplex",
      "id": 2845433,
      "node_id": "MDQ6VXNlcjI4NDU0MzM=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/2845433?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/memeplex",
      "html_url": "https://github.com/memeplex",
      "followers_url": "https://api.github.com/users/memeplex/followers",
      "following_url": "https://api.github.com/users/memeplex/following{/other_user}",
      "gists_url": "https://api.github.com/users/memeplex/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/memeplex/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/memeplex/subscriptions",
      "organizations_url": "https://api.github.com/users/memeplex/orgs",
      "repos_url": "https://api.github.com/users/memeplex/repos",
      "events_url": "https://api.github.com/users/memeplex/events{/privacy}",
      "received_events_url": "https://api.github.com/users/memeplex/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-03-19T15:20:11Z",
    "updated_at": "2015-03-19T15:21:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "One relevant offender from the point of view of ipython is sklearn. Just importing, say, `linear_model`, drags in the joblib external, which sets the main module to `__mp_main__`. A minimal example is:\n\n```\nimport sklearn.externals.joblib\n```\n\nor\n\n```\nimport sklearn.linear_model\n```\n\nTake a look at this ipython session:\n\n```\nIn [1]: import sys\n\nIn [2]: print(id(sys.modules['__main__']))\n140213167095144\n\nIn [3]: print(id(sys.modules['__mp_main__']))\nKeyError: '__mp_main__'\n\nIn [4]: %run /tmp/test.py\n__main__\n140213114820472\n140213114820472\n__main__\n__main__\n\nIn [5]: print(id(sys.modules['__main__']))\n140213167095144\n\nIn [6]: print(id(sys.modules['__mp_main__']))\n140213114820472\n\nIn [7]: print(sys.modules['__mp_main__'].__name__)\nAttributeError: 'module' object has no attribute '__name__'\n```\n\nwhere `/tmp/test.py` is defined as:\n\n```\nimport sklearn.linear_model\n\nprint(__name__)\n\nimport sys\n\nprint(id(sys.modules['__main__']))\nprint(id(sys.modules['__mp_main__']))\n\nprint(sys.modules['__main__'].__name__)\nprint(sys.modules['__mp_main__'].__name__)\n```\n\nThe `__main__` module for the `/tmp/test.py` script is aliased as `__mp_main__` in `multiprocessing.__init__` (see the `__init__.py` file for multiprocessing). But this `__main__` module is not the same than the ipython's one (note the different ids in the output above). Still the `__mp_main__` alias remains in `sys.modules` after the `%run`. But this module now has no `__name__` (nota bene: it had one inside the script, namely `__main__`). So:\n1. It seems desirable that ipython cleaned the `__mp_main__` module up after `%run` (and not just replace the `__main__` module for the script with the ipython's one).\n2. It's not clear why the `__name__` attribute is disappearing. Maybe this has to do with some post-`%run` cleanup ipython is already doing.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/85616426",
    "html_url": "https://github.com/ipython/ipython/issues/7830#issuecomment-85616426",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/7830",
    "id": 85616426,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1NjE2NDI2",
    "user": {
      "login": "memeplex",
      "id": 2845433,
      "node_id": "MDQ6VXNlcjI4NDU0MzM=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/2845433?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/memeplex",
      "html_url": "https://github.com/memeplex",
      "followers_url": "https://api.github.com/users/memeplex/followers",
      "following_url": "https://api.github.com/users/memeplex/following{/other_user}",
      "gists_url": "https://api.github.com/users/memeplex/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/memeplex/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/memeplex/subscriptions",
      "organizations_url": "https://api.github.com/users/memeplex/orgs",
      "repos_url": "https://api.github.com/users/memeplex/repos",
      "events_url": "https://api.github.com/users/memeplex/events{/privacy}",
      "received_events_url": "https://api.github.com/users/memeplex/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-03-24T17:45:38Z",
    "updated_at": "2015-03-24T17:45:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "@takluyver what do you think of the above solution (clean up `__mp_main__` after `%run`)? It's basically what I'm doing manually now. Seriously, using ipython with sklearn has become a bit of a PITA because of this issue.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/86232750",
    "html_url": "https://github.com/ipython/ipython/issues/7830#issuecomment-86232750",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/7830",
    "id": 86232750,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjMyNzUw",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-03-25T22:07:25Z",
    "updated_at": "2015-03-25T22:07:25Z",
    "author_association": "MEMBER",
    "body": "I'd be inclined to just make autoreload skip over modules called `__mp_main__`. This is only an issue when using autoreload, right? It's not a problem with IPython in general?\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/120922939",
    "html_url": "https://github.com/ipython/ipython/issues/7830#issuecomment-120922939",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/7830",
    "id": 120922939,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMDkyMjkzOQ==",
    "user": {
      "login": "memeplex",
      "id": 2845433,
      "node_id": "MDQ6VXNlcjI4NDU0MzM=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/2845433?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/memeplex",
      "html_url": "https://github.com/memeplex",
      "followers_url": "https://api.github.com/users/memeplex/followers",
      "following_url": "https://api.github.com/users/memeplex/following{/other_user}",
      "gists_url": "https://api.github.com/users/memeplex/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/memeplex/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/memeplex/subscriptions",
      "organizations_url": "https://api.github.com/users/memeplex/orgs",
      "repos_url": "https://api.github.com/users/memeplex/repos",
      "events_url": "https://api.github.com/users/memeplex/events{/privacy}",
      "received_events_url": "https://api.github.com/users/memeplex/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-07-13T13:10:21Z",
    "updated_at": "2015-07-13T13:10:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm unable to reproduce this anymore. I don't see any explicit reference to `__mp_main__` in `autoreload.py`, so who knows what has changed meanwhile... maybe you?\n\nCould you check whether this is somehow fixed or somehow not?\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/150899217",
    "html_url": "https://github.com/ipython/ipython/issues/7830#issuecomment-150899217",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/7830",
    "id": 150899217,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MDg5OTIxNw==",
    "user": {
      "login": "sjlnk",
      "id": 3604830,
      "node_id": "MDQ6VXNlcjM2MDQ4MzA=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/3604830?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sjlnk",
      "html_url": "https://github.com/sjlnk",
      "followers_url": "https://api.github.com/users/sjlnk/followers",
      "following_url": "https://api.github.com/users/sjlnk/following{/other_user}",
      "gists_url": "https://api.github.com/users/sjlnk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sjlnk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sjlnk/subscriptions",
      "organizations_url": "https://api.github.com/users/sjlnk/orgs",
      "repos_url": "https://api.github.com/users/sjlnk/repos",
      "events_url": "https://api.github.com/users/sjlnk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sjlnk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-10-25T07:49:45Z",
    "updated_at": "2015-10-25T07:50:41Z",
    "author_association": "NONE",
    "body": "IPython 4.0.0 still has the same bug. \n\nTo reproduce follow these steps:\n\nWrite script mp_bug.py:\n\n``` python\nimport multiprocessing\n\nif __name__ == \"__main__\":\n\n    print(\"hello\")\n```\n\nAnd execute:\n\n```\nipython3\n> %load_ext autoreload\n> %autoreload 2\n> run mp_bug.py\n```\n\nI just noticed IPython 1.2.1 doesn't have this bug.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/175139916",
    "html_url": "https://github.com/ipython/ipython/issues/7830#issuecomment-175139916",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/7830",
    "id": 175139916,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3NTEzOTkxNg==",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-01-26T17:50:38Z",
    "updated_at": "2016-01-26T17:50:38Z",
    "author_association": "MEMBER",
    "body": "I think this is fixed for 4.1 by #8568 \n"
  }
]
