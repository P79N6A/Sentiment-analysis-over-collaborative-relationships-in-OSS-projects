[
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/243735993",
    "html_url": "https://github.com/ipython/ipython/issues/9923#issuecomment-243735993",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/9923",
    "id": 243735993,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0MzczNTk5Mw==",
    "user": {
      "login": "minrk",
      "id": 151929,
      "node_id": "MDQ6VXNlcjE1MTkyOQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/151929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/minrk",
      "html_url": "https://github.com/minrk",
      "followers_url": "https://api.github.com/users/minrk/followers",
      "following_url": "https://api.github.com/users/minrk/following{/other_user}",
      "gists_url": "https://api.github.com/users/minrk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/minrk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/minrk/subscriptions",
      "organizations_url": "https://api.github.com/users/minrk/orgs",
      "repos_url": "https://api.github.com/users/minrk/repos",
      "events_url": "https://api.github.com/users/minrk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/minrk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-08-31T11:27:52Z",
    "updated_at": "2016-08-31T11:27:52Z",
    "author_association": "MEMBER",
    "body": "No, that's not intentional, it's probably just something not handled correctly due to the threads involved.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/243754036",
    "html_url": "https://github.com/ipython/ipython/issues/9923#issuecomment-243754036",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/9923",
    "id": 243754036,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0Mzc1NDAzNg==",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-08-31T12:52:49Z",
    "updated_at": "2016-08-31T12:52:49Z",
    "author_association": "MEMBER",
    "body": "The protocol used for terminals is stateful, so stuff printed from background threads without care is liable to get messed up. prompt_toolkit has a [patch_stdout_context](http://python-prompt-toolkit.readthedocs.io/en/latest/pages/reference.html#prompt_toolkit.interface.CommandLineInterface.patch_stdout_context) method which will make printed text from Python code appear above the prompt, but I doubt it's thread safe.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/243781395",
    "html_url": "https://github.com/ipython/ipython/issues/9923#issuecomment-243781395",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/9923",
    "id": 243781395,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0Mzc4MTM5NQ==",
    "user": {
      "login": "eudoxos",
      "id": 1029876,
      "node_id": "MDQ6VXNlcjEwMjk4NzY=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1029876?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eudoxos",
      "html_url": "https://github.com/eudoxos",
      "followers_url": "https://api.github.com/users/eudoxos/followers",
      "following_url": "https://api.github.com/users/eudoxos/following{/other_user}",
      "gists_url": "https://api.github.com/users/eudoxos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eudoxos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eudoxos/subscriptions",
      "organizations_url": "https://api.github.com/users/eudoxos/orgs",
      "repos_url": "https://api.github.com/users/eudoxos/repos",
      "events_url": "https://api.github.com/users/eudoxos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eudoxos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-08-31T14:26:56Z",
    "updated_at": "2016-08-31T14:26:56Z",
    "author_association": "NONE",
    "body": "My particular case is a background `std::thread` (on Linux, that means pthread; it is spawned from a c++ extension module); not sure whether `sys.stdout` and `sys.stderr` will be effective (maybe it will).\n\nA sufficient approach would be to set the terminal state to neutral color after the prompt it displayed and user input is awaited. Mixing user typing into prompt and bg thread outputting at the same time is not something that worries me, that will be always messy.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/243795423",
    "html_url": "https://github.com/ipython/ipython/issues/9923#issuecomment-243795423",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/9923",
    "id": 243795423,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0Mzc5NTQyMw==",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-08-31T15:09:28Z",
    "updated_at": "2016-08-31T15:09:28Z",
    "author_association": "MEMBER",
    "body": "sys.stdout/stderr will only affect it if it uses Python machinery to produce output; if it's doing output the normal way in C++, it won't.\n\nI don't think there's anything we can do about that in IPython; you could try petitioning @jonathanslenders, but I'd consider the formatting of output from background threads to be out of scope, so that the foreground thread can assume it has exclusive use of the terminal.\n\nYou could send the data over to the foreground thread by some means, and then use an inputhook to display it from the main event loop.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/243905739",
    "html_url": "https://github.com/ipython/ipython/issues/9923#issuecomment-243905739",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/9923",
    "id": 243905739,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0MzkwNTczOQ==",
    "user": {
      "login": "jonathanslenders",
      "id": 216638,
      "node_id": "MDQ6VXNlcjIxNjYzOA==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/216638?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonathanslenders",
      "html_url": "https://github.com/jonathanslenders",
      "followers_url": "https://api.github.com/users/jonathanslenders/followers",
      "following_url": "https://api.github.com/users/jonathanslenders/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonathanslenders/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonathanslenders/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonathanslenders/subscriptions",
      "organizations_url": "https://api.github.com/users/jonathanslenders/orgs",
      "repos_url": "https://api.github.com/users/jonathanslenders/repos",
      "events_url": "https://api.github.com/users/jonathanslenders/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonathanslenders/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-08-31T21:20:11Z",
    "updated_at": "2016-08-31T21:20:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi all,\n\nI fixed the color issue in prompt_toolkit: https://github.com/jonathanslenders/python-prompt-toolkit/commit/47a6adf16ffb5c2306be0c833fb2784d406b8932\nHowever, of course everything is printed where the cursor is at that point. (Unless `patch_stdout=True` has been set.)\n\nIt's not perfect, because the terminal is indeed stateful, and background threads are not supposed to print to stdout, but it's the best that we can do.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/244034327",
    "html_url": "https://github.com/ipython/ipython/issues/9923#issuecomment-244034327",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/9923",
    "id": 244034327,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDAzNDMyNw==",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-01T10:04:01Z",
    "updated_at": "2016-09-01T10:04:01Z",
    "author_association": "MEMBER",
    "body": "Thanks Jonathan. Closing the issue as there's nothing more for us to do.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/244529000",
    "html_url": "https://github.com/ipython/ipython/issues/9923#issuecomment-244529000",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/9923",
    "id": 244529000,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDUyOTAwMA==",
    "user": {
      "login": "eudoxos",
      "id": 1029876,
      "node_id": "MDQ6VXNlcjEwMjk4NzY=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1029876?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eudoxos",
      "html_url": "https://github.com/eudoxos",
      "followers_url": "https://api.github.com/users/eudoxos/followers",
      "following_url": "https://api.github.com/users/eudoxos/following{/other_user}",
      "gists_url": "https://api.github.com/users/eudoxos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eudoxos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eudoxos/subscriptions",
      "organizations_url": "https://api.github.com/users/eudoxos/orgs",
      "repos_url": "https://api.github.com/users/eudoxos/repos",
      "events_url": "https://api.github.com/users/eudoxos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eudoxos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-03T05:57:59Z",
    "updated_at": "2016-09-03T05:57:59Z",
    "author_association": "NONE",
    "body": "Thanks, @jonathanslenders, works perfectly now. Cheers!\n"
  }
]
