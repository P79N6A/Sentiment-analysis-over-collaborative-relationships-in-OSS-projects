[
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/42255028",
    "html_url": "https://github.com/ipython/ipython/pull/5781#issuecomment-42255028",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/5781",
    "id": 42255028,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMjU1MDI4",
    "user": {
      "login": "minrk",
      "id": 151929,
      "node_id": "MDQ6VXNlcjE1MTkyOQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/151929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/minrk",
      "html_url": "https://github.com/minrk",
      "followers_url": "https://api.github.com/users/minrk/followers",
      "following_url": "https://api.github.com/users/minrk/following{/other_user}",
      "gists_url": "https://api.github.com/users/minrk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/minrk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/minrk/subscriptions",
      "organizations_url": "https://api.github.com/users/minrk/orgs",
      "repos_url": "https://api.github.com/users/minrk/repos",
      "events_url": "https://api.github.com/users/minrk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/minrk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-05-06T00:01:14Z",
    "updated_at": "2014-05-06T00:01:14Z",
    "author_association": "MEMBER",
    "body": "I fixed a variety of issues in the dict key completion, especially when greedy=True in #5790. One of the effects of that PR is removing auto-close of quotes and brackets when they were opened outside the text passed to the dict key completer (i.e. greedy=False), which I think were not appropriate to do, given the current hierarchy of completion.\n\nCompletion should get a major refactor in the future, which would allow us to be more sensible about that sort of thing, but I don't think it makes sense with how it works today.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/42255696",
    "html_url": "https://github.com/ipython/ipython/pull/5781#issuecomment-42255696",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/5781",
    "id": 42255696,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMjU1Njk2",
    "user": {
      "login": "jnothman",
      "id": 78827,
      "node_id": "MDQ6VXNlcjc4ODI3",
      "avatar_url": "https://avatars2.githubusercontent.com/u/78827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnothman",
      "html_url": "https://github.com/jnothman",
      "followers_url": "https://api.github.com/users/jnothman/followers",
      "following_url": "https://api.github.com/users/jnothman/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnothman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnothman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnothman/subscriptions",
      "organizations_url": "https://api.github.com/users/jnothman/orgs",
      "repos_url": "https://api.github.com/users/jnothman/repos",
      "events_url": "https://api.github.com/users/jnothman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnothman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-05-06T00:12:06Z",
    "updated_at": "2014-05-06T00:12:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "I haven't really understood that change yet, but will try to grok it later. I perhaps didn't completely understand some of the semantics of `greedy`. In what case is the opening outside of the text passed to the dict key completer (given that `IPCompleter.dict_key_matches` rolls its own prefix extraction, albeit only to the start of the line, but if it doesn't find the opening bracket then dict key completion shouldn't fire at all)? Rather, could you please give me an example that fails at master?\n\nPS: I don't understand the Travis failure here... is it a heisenbug?\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/42267625",
    "html_url": "https://github.com/ipython/ipython/pull/5781#issuecomment-42267625",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/5781",
    "id": 42267625,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMjY3NjI1",
    "user": {
      "login": "minrk",
      "id": 151929,
      "node_id": "MDQ6VXNlcjE1MTkyOQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/151929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/minrk",
      "html_url": "https://github.com/minrk",
      "followers_url": "https://api.github.com/users/minrk/followers",
      "following_url": "https://api.github.com/users/minrk/following{/other_user}",
      "gists_url": "https://api.github.com/users/minrk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/minrk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/minrk/subscriptions",
      "organizations_url": "https://api.github.com/users/minrk/orgs",
      "repos_url": "https://api.github.com/users/minrk/repos",
      "events_url": "https://api.github.com/users/minrk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/minrk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-05-06T04:43:51Z",
    "updated_at": "2014-05-06T06:37:51Z",
    "author_association": "MEMBER",
    "body": "> Rather, could you please give me an example that fails at master?\n\n```\nIn [1]: %config IPCompleter.greedy=True\nIn [2]: d = dict(a=5)\nIn [3]: d[<TAB>\nIn [3]: d['<TAB>\nIn [3]: d['a<TAB>\n```\n\nall fail.  In fact, there is a test added, asserting that greedy completion does the wrong thing.  The completions returned by `dict_key_completions` must all always start with the `text` that is passed to the method. Otherwise, the replacement will be incorrect. In the case of greedy completion, this is typically `d['a`, and the completions start with `'a`, so the `d[` will be removed when the replacement is inserted.\n\nThe logic in the fix is that there shouldn't be multiple contexts in the completion result. When the completer is given `app`, it should complete to `apple`, not `apple'` or `apple']`. In the greedy case, the completer is given `d['a`, which is safe to complete to `d['apple']`. This is what's causing the problem with double-closing strings - the completion result is expected to stay within the context it is given, and it isn't in master.\n\n> PS: I don't understand the Travis failure here... is it a heisenbug?\n\nYes, the travis failure is in a race condition in test cleanup. I think it's fixed in master.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/42269282",
    "html_url": "https://github.com/ipython/ipython/pull/5781#issuecomment-42269282",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/5781",
    "id": 42269282,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMjY5Mjgy",
    "user": {
      "login": "jnothman",
      "id": 78827,
      "node_id": "MDQ6VXNlcjc4ODI3",
      "avatar_url": "https://avatars2.githubusercontent.com/u/78827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnothman",
      "html_url": "https://github.com/jnothman",
      "followers_url": "https://api.github.com/users/jnothman/followers",
      "following_url": "https://api.github.com/users/jnothman/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnothman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnothman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnothman/subscriptions",
      "organizations_url": "https://api.github.com/users/jnothman/orgs",
      "repos_url": "https://api.github.com/users/jnothman/repos",
      "events_url": "https://api.github.com/users/jnothman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnothman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-05-06T05:35:16Z",
    "updated_at": "2014-05-06T05:35:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "Okay. Handling greedy=True was a latecomer to the feature. It's probably\nnot tested properly. I've still not looked at your changes completely.\n\nOn 6 May 2014 14:44, Min RK notifications@github.com wrote:\n\n>  Rather, could you please give me an example that fails at master?\n> \n> In [1]: %config IPCompleter.greedy=True\n> In [2]: d = dict(a=5)\n> In [3]: d[<TAB>\n> In [3]: d['<TAB>\n> In [3]: d['a<TAB>\n> \n>  all fail. In fact, there is a test added, asserting that greedy\n> completion does the wrong thing. The completions returned by\n> dict_key_completions must all always start with the text that is passed\n> to the method. Otherwise, the replacement will be incorrect. In the case of\n> greedy completion, this is typically d['a, and the completions start with\n> 'a, so the d[ will be removed when the replacement is inserted.\n> \n> The logic in the fix is that there shouldn't be multiple contexts in the\n> completion result. When the completer is given app, it should complete to\n> apple, not apple' or apple']. In the greedy case, the completer is given\n> d['a, which is safe to complete to d['apple']. This is what's causing the\n> problem with double-closing strings - the completion result is expected to\n> stay within the context it is given, and it isn't in master.\n> \n> PS: I don't understand the Travis failure here... is it a heisenbug?\n> \n> Yes, the travis failure is in a race condition in test cleanup. I think\n> it's fixed in master.\n> \n> —\n> Reply to this email directly or view it on GitHubhttps://github.com/ipython/ipython/pull/5781#issuecomment-42267625\n> .\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/42271870",
    "html_url": "https://github.com/ipython/ipython/pull/5781#issuecomment-42271870",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/5781",
    "id": 42271870,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMjcxODcw",
    "user": {
      "login": "minrk",
      "id": 151929,
      "node_id": "MDQ6VXNlcjE1MTkyOQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/151929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/minrk",
      "html_url": "https://github.com/minrk",
      "followers_url": "https://api.github.com/users/minrk/followers",
      "following_url": "https://api.github.com/users/minrk/following{/other_user}",
      "gists_url": "https://api.github.com/users/minrk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/minrk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/minrk/subscriptions",
      "organizations_url": "https://api.github.com/users/minrk/orgs",
      "repos_url": "https://api.github.com/users/minrk/repos",
      "events_url": "https://api.github.com/users/minrk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/minrk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-05-06T06:40:48Z",
    "updated_at": "2014-05-06T06:40:48Z",
    "author_association": "MEMBER",
    "body": "To be clear, the completion machinery does need to be reorganized substantially. Once that is done, it should be possible to make the auto-close replacements work without issue, I just don't think it makes sense with the current hierarchy. One step at a time.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/42271965",
    "html_url": "https://github.com/ipython/ipython/pull/5781#issuecomment-42271965",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/5781",
    "id": 42271965,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMjcxOTY1",
    "user": {
      "login": "jnothman",
      "id": 78827,
      "node_id": "MDQ6VXNlcjc4ODI3",
      "avatar_url": "https://avatars2.githubusercontent.com/u/78827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnothman",
      "html_url": "https://github.com/jnothman",
      "followers_url": "https://api.github.com/users/jnothman/followers",
      "following_url": "https://api.github.com/users/jnothman/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnothman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnothman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnothman/subscriptions",
      "organizations_url": "https://api.github.com/users/jnothman/orgs",
      "repos_url": "https://api.github.com/users/jnothman/repos",
      "events_url": "https://api.github.com/users/jnothman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnothman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-05-06T06:43:14Z",
    "updated_at": "2014-05-06T06:43:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "> the completion machinery does need to be reorganized substantially\n\nI can tell :P\n\nOn 6 May 2014 16:40, Min RK notifications@github.com wrote:\n\n>  To be clear, the completion machinery does need to be reorganized\n> substantially. Once that is done, it should be possible to make the\n> auto-close replacements work without issue, I just don't think it makes\n> sense with the current hierarchy. One step at a time.\n> \n> —\n> Reply to this email directly or view it on GitHubhttps://github.com/ipython/ipython/pull/5781#issuecomment-42271870\n> .\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/42618720",
    "html_url": "https://github.com/ipython/ipython/pull/5781#issuecomment-42618720",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/5781",
    "id": 42618720,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNjE4NzIw",
    "user": {
      "login": "minrk",
      "id": 151929,
      "node_id": "MDQ6VXNlcjE1MTkyOQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/151929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/minrk",
      "html_url": "https://github.com/minrk",
      "followers_url": "https://api.github.com/users/minrk/followers",
      "following_url": "https://api.github.com/users/minrk/following{/other_user}",
      "gists_url": "https://api.github.com/users/minrk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/minrk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/minrk/subscriptions",
      "organizations_url": "https://api.github.com/users/minrk/orgs",
      "repos_url": "https://api.github.com/users/minrk/repos",
      "events_url": "https://api.github.com/users/minrk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/minrk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-05-08T23:28:49Z",
    "updated_at": "2014-05-08T23:28:49Z",
    "author_association": "MEMBER",
    "body": "Thanks @jnothman! Hopefully we can get to the completion refactor before too long, then it should be easier to get closing quotes and brackets without fighting with readline.\n"
  }
]
