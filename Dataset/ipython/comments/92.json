[
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/236221",
    "html_url": "https://github.com/ipython/ipython/issues/92#issuecomment-236221",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/92",
    "id": 236221,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjIyMQ==",
    "user": {
      "login": "ipython",
      "id": 230453,
      "node_id": "MDEyOk9yZ2FuaXphdGlvbjIzMDQ1Mw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/230453?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ipython",
      "html_url": "https://github.com/ipython",
      "followers_url": "https://api.github.com/users/ipython/followers",
      "following_url": "https://api.github.com/users/ipython/following{/other_user}",
      "gists_url": "https://api.github.com/users/ipython/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ipython/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ipython/subscriptions",
      "organizations_url": "https://api.github.com/users/ipython/orgs",
      "repos_url": "https://api.github.com/users/ipython/repos",
      "events_url": "https://api.github.com/users/ipython/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ipython/received_events",
      "type": "Organization",
      "site_admin": false
    },
    "created_at": "2010-05-10T09:40:06Z",
    "updated_at": "2010-05-10T09:40:06Z",
    "author_association": "COLLABORATOR",
    "body": "[ LP comment 1 by: Justin MacCallum, on 2010-02-05 01:15:35.441384+00:00 ]\n\nAfter some research, I believe that this is an issue that arises because of Twisted, which doesn't play nice with mulitprocessing or popen.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/236223",
    "html_url": "https://github.com/ipython/ipython/issues/92#issuecomment-236223",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/92",
    "id": 236223,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjIyMw==",
    "user": {
      "login": "ipython",
      "id": 230453,
      "node_id": "MDEyOk9yZ2FuaXphdGlvbjIzMDQ1Mw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/230453?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ipython",
      "html_url": "https://github.com/ipython",
      "followers_url": "https://api.github.com/users/ipython/followers",
      "following_url": "https://api.github.com/users/ipython/following{/other_user}",
      "gists_url": "https://api.github.com/users/ipython/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ipython/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ipython/subscriptions",
      "organizations_url": "https://api.github.com/users/ipython/orgs",
      "repos_url": "https://api.github.com/users/ipython/repos",
      "events_url": "https://api.github.com/users/ipython/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ipython/received_events",
      "type": "Organization",
      "site_admin": false
    },
    "created_at": "2010-05-10T09:40:07Z",
    "updated_at": "2010-05-10T09:40:07Z",
    "author_association": "COLLABORATOR",
    "body": "[ LP comment 2 by: Brian Granger, on 2010-02-05 02:17:19+00:00 ]\n\nAre you using multiprocessing or just subprocess?\n\nBrian\n\nOn Thu, Feb 4, 2010 at 5:14 PM, Justin MacCallum\njustin.maccallum@me.com wrote:\n\n> Public bug reported:\n> \n> I have a parallel scientific code that runs on clusters. It currently\n> uses my own (badly designed) parallel communication engine and I'm\n> trying to transition to iPython's TaskClient interface. One part of my\n> code uses the subprocess module to wrap a call to a different piece of\n> software. Unfortunately, this seems to be causing problems for me. I'm\n> running on OS X 10.6.2, with python 2.6.4 and ipython 0.10 as supplied\n> by MacPorts. The following code snippet will reproduce the problem I'm\n> having.\n> \n> ---\n> \n> #!/usr/bin/env python\n> \n> from IPython.kernel import client\n> \n> tc = client.TaskClient()\n> \n> @tc.parallel()\n> def remote_test(input):\n>   import subprocess\n>   # I'm obviously not wrapping ls, but I have the same problem with the real binary I'm trying to call\n>   subprocess.check_call('ls')\n>   return input\n> \n> work = range(100)\n> \n> ## results = remote_test(work)\n> \n> The output of this program is:\n> \n> ---\n> \n> /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/python/filepath.py:12: DeprecationWarning: the sha module is deprecated; use the hashlib module instead\n>  import sha\n> /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/clientconnector.py:43: DeprecationWarning: Importing class Tub directly from 'foolscap' is deprecated since Foolscap 0.4.3. Please import foolscap.api.Tub instead\n>  self.tub = Tub()\n> /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/taskfc.py:79: DeprecationWarning: Importing class Referenceable1 directly from 'foolscap' is deprecated since Foolscap 0.4.3. Please import foolscap.api.Referenceable instead\n>  class FCTaskControllerFromTaskController(Referenceable):\n> Traceback (most recent call last):\n>  File \"./test.py\", line 15, in <module>\n>   results = remote_test(work)\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/parallelfunction.py\", line 104, in call_function\n>   return self.mapper.map(self.func, _sequences)\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/mapper.py\", line 230, in map\n>   task_results = [self.task_controller.get_task_result(tid) for tid in task_ids]\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/taskclient.py\", line 93, in get_task_result\n>   taskid, block)\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/twistedutil.py\", line 72, in blockingCallFromThread\n>   return twisted.internet.threads.blockingCallFromThread(reactor, f, *a, *_kw)\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/internet/threads.py\", line 114, in blockingCallFromThread\n>   result.raiseException()\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/python/failure.py\", line 326, in raiseException\n>   raise self.type, self.value, self.tb\n> \n> ## OSError: [Errno 4] Interrupted system call\n> \n> The ipcontroller log file looks like:\n> \n> ---\n> \n> 2010-02-04 12:42:36-0800 [-] Running task 82 on worker 1\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Task completed: 82\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] distributing Tasks\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Running task 83 on worker 1\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Task 83 failed on worker 1\n> 2010-02-04 12:42:36-0800 [-] distributing Tasks\n> 2010-02-04 12:42:36-0800 [-] Running task 84 on worker 0\n> 2010-02-04 12:42:36-0800 [Negotiation,0,192.168.0.194] Task 84 failed on worker 0\n> 2010-02-04 12:42:37-0800 [-] distributing Tasks\n> 2010-02-04 12:42:37-0800 [-] Running task 85 on worker 1\n> 2010-02-04 12:42:37-0800 [Negotiation,2,192.168.0.194] Task 85 failed on worker 1\n> 2010-02-04 12:42:37-0800 [-] distributing Tasks\n> 2010-02-04 12:42:37-0800 [-] Running task 86 on worker 0\n> 2010-02-04 12:42:37-0800 [Negotiation,0,192.168.0.194] Task 86 failed on worker 0\n> 2010-02-04 12:42:38-0800 [-] distributing Tasks\n> \n> ## 2010-02-04 12:42:38-0800 [-] Running task 87 on worker 1\n> \n> Notice that a few of the tasks actually complete, while the majority\n> fail with the strange interrupted system call error.\n> \n> *\\* Affects: ipython\n>     Importance: Undecided\n>         Status: New\n> \n> ## \n> \n> Using multiprocessing module crashes parallel iPython\n> https://bugs.launchpad.net/bugs/517358\n> You received this bug notification because you are a member of IPython\n> Developers, which is subscribed to IPython.\n> \n> Status in IPython - Enhanced Interactive Python: New\n> \n> Bug description:\n> I have a parallel scientific code that runs on clusters. It currently uses my own (badly designed) parallel communication engine and I'm trying to transition to iPython's TaskClient interface. One part of my code uses the subprocess module to wrap a call to a different piece of software. Unfortunately, this seems to be causing problems for me. I'm running on OS X 10.6.2, with python 2.6.4 and ipython 0.10 as supplied by MacPorts. The following code snippet will reproduce the problem I'm having.\n> \n> ---\n> \n> #!/usr/bin/env python\n> \n> from IPython.kernel import client\n> \n> tc = client.TaskClient()\n> \n> @tc.parallel()\n> def remote_test(input):\n>   import subprocess\n>   # I'm obviously not wrapping ls, but I have the same problem with the real binary I'm trying to call\n>   subprocess.check_call('ls')\n>   return input\n> \n> work = range(100)\n> \n> ## results = remote_test(work)\n> \n> The output of this program is:\n> \n> ---\n> \n> /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/python/filepath.py:12: DeprecationWarning: the sha module is deprecated; use the hashlib module instead\n>  import sha\n> /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/clientconnector.py:43: DeprecationWarning: Importing class Tub directly from 'foolscap' is deprecated since Foolscap 0.4.3. Please import foolscap.api.Tub instead\n>  self.tub = Tub()\n> /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/taskfc.py:79: DeprecationWarning: Importing class Referenceable1 directly from 'foolscap' is deprecated since Foolscap 0.4.3. Please import foolscap.api.Referenceable instead\n>  class FCTaskControllerFromTaskController(Referenceable):\n> Traceback (most recent call last):\n>  File \"./test.py\", line 15, in <module>\n>   results = remote_test(work)\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/parallelfunction.py\", line 104, in call_function\n>   return self.mapper.map(self.func, _sequences)\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/mapper.py\", line 230, in map\n>   task_results = [self.task_controller.get_task_result(tid) for tid in task_ids]\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/taskclient.py\", line 93, in get_task_result\n>   taskid, block)\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/twistedutil.py\", line 72, in blockingCallFromThread\n>   return twisted.internet.threads.blockingCallFromThread(reactor, f, *a, *_kw)\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/internet/threads.py\", line 114, in blockingCallFromThread\n>   result.raiseException()\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/python/failure.py\", line 326, in raiseException\n>   raise self.type, self.value, self.tb\n> \n> ## OSError: [Errno 4] Interrupted system call\n> \n> The ipcontroller log file looks like:\n> \n> ---\n> \n> 2010-02-04 12:42:36-0800 [-] Running task 82 on worker 1\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Task completed: 82\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] distributing Tasks\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Running task 83 on worker 1\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Task 83 failed on worker 1\n> 2010-02-04 12:42:36-0800 [-] distributing Tasks\n> 2010-02-04 12:42:36-0800 [-] Running task 84 on worker 0\n> 2010-02-04 12:42:36-0800 [Negotiation,0,192.168.0.194] Task 84 failed on worker 0\n> 2010-02-04 12:42:37-0800 [-] distributing Tasks\n> 2010-02-04 12:42:37-0800 [-] Running task 85 on worker 1\n> 2010-02-04 12:42:37-0800 [Negotiation,2,192.168.0.194] Task 85 failed on worker 1\n> 2010-02-04 12:42:37-0800 [-] distributing Tasks\n> 2010-02-04 12:42:37-0800 [-] Running task 86 on worker 0\n> 2010-02-04 12:42:37-0800 [Negotiation,0,192.168.0.194] Task 86 failed on worker 0\n> 2010-02-04 12:42:38-0800 [-] distributing Tasks\n> \n> ## 2010-02-04 12:42:38-0800 [-] Running task 87 on worker 1\n> \n> Notice that a few of the tasks actually complete, while the majority fail with the strange interrupted system call error.\n\n## \n\nBrian E. Granger, Ph.D.\nAssistant Professor of Physics\nCal Poly State University, San Luis Obispo\nbgranger@calpoly.edu\nellisonbg@gmail.com\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/236224",
    "html_url": "https://github.com/ipython/ipython/issues/92#issuecomment-236224",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/92",
    "id": 236224,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjIyNA==",
    "user": {
      "login": "ipython",
      "id": 230453,
      "node_id": "MDEyOk9yZ2FuaXphdGlvbjIzMDQ1Mw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/230453?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ipython",
      "html_url": "https://github.com/ipython",
      "followers_url": "https://api.github.com/users/ipython/followers",
      "following_url": "https://api.github.com/users/ipython/following{/other_user}",
      "gists_url": "https://api.github.com/users/ipython/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ipython/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ipython/subscriptions",
      "organizations_url": "https://api.github.com/users/ipython/orgs",
      "repos_url": "https://api.github.com/users/ipython/repos",
      "events_url": "https://api.github.com/users/ipython/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ipython/received_events",
      "type": "Organization",
      "site_admin": false
    },
    "created_at": "2010-05-10T09:40:08Z",
    "updated_at": "2010-05-10T09:40:08Z",
    "author_association": "COLLABORATOR",
    "body": "[ LP comment 3 by: Justin MacCallum, on 2010-02-05 02:28:03.882376+00:00 ]\n\nSigh... sorry. It was a typo, I'm just using subprocess.\n\nI still believe my comment is valid though; I think this is a long standing problem with Twisted.\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/236225",
    "html_url": "https://github.com/ipython/ipython/issues/92#issuecomment-236225",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/92",
    "id": 236225,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjIyNQ==",
    "user": {
      "login": "ipython",
      "id": 230453,
      "node_id": "MDEyOk9yZ2FuaXphdGlvbjIzMDQ1Mw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/230453?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ipython",
      "html_url": "https://github.com/ipython",
      "followers_url": "https://api.github.com/users/ipython/followers",
      "following_url": "https://api.github.com/users/ipython/following{/other_user}",
      "gists_url": "https://api.github.com/users/ipython/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ipython/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ipython/subscriptions",
      "organizations_url": "https://api.github.com/users/ipython/orgs",
      "repos_url": "https://api.github.com/users/ipython/repos",
      "events_url": "https://api.github.com/users/ipython/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ipython/received_events",
      "type": "Organization",
      "site_admin": false
    },
    "created_at": "2010-05-10T09:40:09Z",
    "updated_at": "2010-05-10T09:40:09Z",
    "author_association": "COLLABORATOR",
    "body": "[ LP comment 4 by: Brian Granger, on 2010-02-05 02:37:28+00:00 ]\n\nYes, my feeling is that subprocess won't work reliably in any twisted\nusing process as it installs its own signal handlers.  I will look\ninto this though.\n\nCheers,\n\nBrian\n\nOn Thu, Feb 4, 2010 at 6:28 PM, Justin MacCallum\njustin.maccallum@me.com wrote:\n\n> Sigh... sorry. It was a typo, I'm just using subprocess.\n> \n> I still believe my comment is valid though; I think this is a long\n> standing problem with Twisted.\n> \n> ## \n> \n> Using multiprocessing module crashes parallel iPython\n> https://bugs.launchpad.net/bugs/517358\n> You received this bug notification because you are a member of IPython\n> Developers, which is subscribed to IPython.\n> \n> Status in IPython - Enhanced Interactive Python: New\n> \n> Bug description:\n> I have a parallel scientific code that runs on clusters. It currently uses my own (badly designed) parallel communication engine and I'm trying to transition to iPython's TaskClient interface. One part of my code uses the subprocess module to wrap a call to a different piece of software. Unfortunately, this seems to be causing problems for me. I'm running on OS X 10.6.2, with python 2.6.4 and ipython 0.10 as supplied by MacPorts. The following code snippet will reproduce the problem I'm having.\n> \n> ---\n> \n> #!/usr/bin/env python\n> \n> from IPython.kernel import client\n> \n> tc = client.TaskClient()\n> \n> @tc.parallel()\n> def remote_test(input):\n>   import subprocess\n>   # I'm obviously not wrapping ls, but I have the same problem with the real binary I'm trying to call\n>   subprocess.check_call('ls')\n>   return input\n> \n> work = range(100)\n> \n> ## results = remote_test(work)\n> \n> The output of this program is:\n> \n> ---\n> \n> /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/python/filepath.py:12: DeprecationWarning: the sha module is deprecated; use the hashlib module instead\n>  import sha\n> /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/clientconnector.py:43: DeprecationWarning: Importing class Tub directly from 'foolscap' is deprecated since Foolscap 0.4.3. Please import foolscap.api.Tub instead\n>  self.tub = Tub()\n> /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/taskfc.py:79: DeprecationWarning: Importing class Referenceable1 directly from 'foolscap' is deprecated since Foolscap 0.4.3. Please import foolscap.api.Referenceable instead\n>  class FCTaskControllerFromTaskController(Referenceable):\n> Traceback (most recent call last):\n>  File \"./test.py\", line 15, in <module>\n>   results = remote_test(work)\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/parallelfunction.py\", line 104, in call_function\n>   return self.mapper.map(self.func, _sequences)\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/mapper.py\", line 230, in map\n>   task_results = [self.task_controller.get_task_result(tid) for tid in task_ids]\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/taskclient.py\", line 93, in get_task_result\n>   taskid, block)\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/twistedutil.py\", line 72, in blockingCallFromThread\n>   return twisted.internet.threads.blockingCallFromThread(reactor, f, *a, *_kw)\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/internet/threads.py\", line 114, in blockingCallFromThread\n>   result.raiseException()\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/python/failure.py\", line 326, in raiseException\n>   raise self.type, self.value, self.tb\n> \n> ## OSError: [Errno 4] Interrupted system call\n> \n> The ipcontroller log file looks like:\n> \n> ---\n> \n> 2010-02-04 12:42:36-0800 [-] Running task 82 on worker 1\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Task completed: 82\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] distributing Tasks\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Running task 83 on worker 1\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Task 83 failed on worker 1\n> 2010-02-04 12:42:36-0800 [-] distributing Tasks\n> 2010-02-04 12:42:36-0800 [-] Running task 84 on worker 0\n> 2010-02-04 12:42:36-0800 [Negotiation,0,192.168.0.194] Task 84 failed on worker 0\n> 2010-02-04 12:42:37-0800 [-] distributing Tasks\n> 2010-02-04 12:42:37-0800 [-] Running task 85 on worker 1\n> 2010-02-04 12:42:37-0800 [Negotiation,2,192.168.0.194] Task 85 failed on worker 1\n> 2010-02-04 12:42:37-0800 [-] distributing Tasks\n> 2010-02-04 12:42:37-0800 [-] Running task 86 on worker 0\n> 2010-02-04 12:42:37-0800 [Negotiation,0,192.168.0.194] Task 86 failed on worker 0\n> 2010-02-04 12:42:38-0800 [-] distributing Tasks\n> \n> ## 2010-02-04 12:42:38-0800 [-] Running task 87 on worker 1\n> \n> Notice that a few of the tasks actually complete, while the majority fail with the strange interrupted system call error.\n\n## \n\nBrian E. Granger, Ph.D.\nAssistant Professor of Physics\nCal Poly State University, San Luis Obispo\nbgranger@calpoly.edu\nellisonbg@gmail.com\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/236226",
    "html_url": "https://github.com/ipython/ipython/issues/92#issuecomment-236226",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/92",
    "id": 236226,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjIyNg==",
    "user": {
      "login": "ipython",
      "id": 230453,
      "node_id": "MDEyOk9yZ2FuaXphdGlvbjIzMDQ1Mw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/230453?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ipython",
      "html_url": "https://github.com/ipython",
      "followers_url": "https://api.github.com/users/ipython/followers",
      "following_url": "https://api.github.com/users/ipython/following{/other_user}",
      "gists_url": "https://api.github.com/users/ipython/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ipython/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ipython/subscriptions",
      "organizations_url": "https://api.github.com/users/ipython/orgs",
      "repos_url": "https://api.github.com/users/ipython/repos",
      "events_url": "https://api.github.com/users/ipython/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ipython/received_events",
      "type": "Organization",
      "site_admin": false
    },
    "created_at": "2010-05-10T09:40:10Z",
    "updated_at": "2010-05-10T09:40:10Z",
    "author_association": "COLLABORATOR",
    "body": "[ LP comment 5 by: Justin MacCallum, on 2010-02-12 19:27:40+00:00 ]\n\nHi Brian,\n\nI agree that the problem lies in how Twisted deals with signal handling. However, this has been a known problem with Twisted for a very long time. Unfortunately, it doe not look like fixing it is much of a priority. The usual response is that you should do things the Twisted way and use their API to spawn a process. The problem comes for projects like iPython that, ideally, shouldn't be exposing any of Twisted at all. Perhaps you might have more traction with the Twisted folks, given that you have a well known project that would benefit from fixing this bug. As I understand it, the solution is to write a simple C extension module that fixes signal handling - just no one has done it yet.\n\nI should also point out, that these problems don't exist if the calls to subprocess occur in a separate thread spawned by deferToThread. I haven't had time to look at the source, but how hard would it be to setup the engines so that remote calls are run using deferToThread?\n\nRegards,\nJustin\n\nOn Feb 4, 2010, at 6:37 PM, Brian Granger wrote:\n\n> Yes, my feeling is that subprocess won't work reliably in any twisted\n> using process as it installs its own signal handlers.  I will look\n> into this though.\n> \n> Cheers,\n> \n> Brian\n> \n> On Thu, Feb 4, 2010 at 6:28 PM, Justin MacCallum\n> justin.maccallum@me.com wrote:\n> \n> > Sigh... sorry. It was a typo, I'm just using subprocess.\n> > \n> > I still believe my comment is valid though; I think this is a long\n> > standing problem with Twisted.\n> > \n> > ## \n> > \n> > Using multiprocessing module crashes parallel iPython\n> > https://bugs.launchpad.net/bugs/517358\n> > You received this bug notification because you are a member of IPython\n> > Developers, which is subscribed to IPython.\n> > \n> > Status in IPython - Enhanced Interactive Python: New\n> > \n> > Bug description:\n> > I have a parallel scientific code that runs on clusters. It currently uses my own (badly designed) parallel communication engine and I'm trying to transition to iPython's TaskClient interface. One part of my code uses the subprocess module to wrap a call to a different piece of software. Unfortunately, this seems to be causing problems for me. I'm running on OS X 10.6.2, with python 2.6.4 and ipython 0.10 as supplied by MacPorts. The following code snippet will reproduce the problem I'm having.\n> > \n> > ---\n> > \n> > #!/usr/bin/env python\n> > \n> > from IPython.kernel import client\n> > \n> > tc = client.TaskClient()\n> > \n> > @tc.parallel()\n> > def remote_test(input):\n> >   import subprocess\n> >   # I'm obviously not wrapping ls, but I have the same problem with the real binary I'm trying to call\n> >   subprocess.check_call('ls')\n> >   return input\n> > \n> > work = range(100)\n> > \n> > ## results = remote_test(work)\n> > \n> > The output of this program is:\n> > \n> > ---\n> > \n> > /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/python/filepath.py:12: DeprecationWarning: the sha module is deprecated; use the hashlib module instead\n> >  import sha\n> > /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/clientconnector.py:43: DeprecationWarning: Importing class Tub directly from 'foolscap' is deprecated since Foolscap 0.4.3. Please import foolscap.api.Tub instead\n> >  self.tub = Tub()\n> > /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/taskfc.py:79: DeprecationWarning: Importing class Referenceable1 directly from 'foolscap' is deprecated since Foolscap 0.4.3. Please import foolscap.api.Referenceable instead\n> >  class FCTaskControllerFromTaskController(Referenceable):\n> > Traceback (most recent call last):\n> >  File \"./test.py\", line 15, in <module>\n> >   results = remote_test(work)\n> >  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/parallelfunction.py\", line 104, in call_function\n> >   return self.mapper.map(self.func, _sequences)\n> >  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/mapper.py\", line 230, in map\n> >   task_results = [self.task_controller.get_task_result(tid) for tid in task_ids]\n> >  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/taskclient.py\", line 93, in get_task_result\n> >   taskid, block)\n> >  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/twistedutil.py\", line 72, in blockingCallFromThread\n> >   return twisted.internet.threads.blockingCallFromThread(reactor, f, *a, *_kw)\n> >  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/internet/threads.py\", line 114, in blockingCallFromThread\n> >   result.raiseException()\n> >  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/python/failure.py\", line 326, in raiseException\n> >   raise self.type, self.value, self.tb\n> > \n> > ## OSError: [Errno 4] Interrupted system call\n> > \n> > The ipcontroller log file looks like:\n> > \n> > ---\n> > \n> > 2010-02-04 12:42:36-0800 [-] Running task 82 on worker 1\n> > 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Task completed: 82\n> > 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] distributing Tasks\n> > 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Running task 83 on worker 1\n> > 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Task 83 failed on worker 1\n> > 2010-02-04 12:42:36-0800 [-] distributing Tasks\n> > 2010-02-04 12:42:36-0800 [-] Running task 84 on worker 0\n> > 2010-02-04 12:42:36-0800 [Negotiation,0,192.168.0.194] Task 84 failed on worker 0\n> > 2010-02-04 12:42:37-0800 [-] distributing Tasks\n> > 2010-02-04 12:42:37-0800 [-] Running task 85 on worker 1\n> > 2010-02-04 12:42:37-0800 [Negotiation,2,192.168.0.194] Task 85 failed on worker 1\n> > 2010-02-04 12:42:37-0800 [-] distributing Tasks\n> > 2010-02-04 12:42:37-0800 [-] Running task 86 on worker 0\n> > 2010-02-04 12:42:37-0800 [Negotiation,0,192.168.0.194] Task 86 failed on worker 0\n> > 2010-02-04 12:42:38-0800 [-] distributing Tasks\n> > \n> > ## 2010-02-04 12:42:38-0800 [-] Running task 87 on worker 1\n> > \n> > Notice that a few of the tasks actually complete, while the majority fail with the strange interrupted system call error.\n> \n> ## \n> \n> Brian E. Granger, Ph.D.\n> Assistant Professor of Physics\n> Cal Poly State University, San Luis Obispo\n> bgranger@calpoly.edu\n> ellisonbg@gmail.com\n> \n> ## \n> \n> Using multiprocessing module crashes parallel iPython\n> https://bugs.launchpad.net/bugs/517358\n> You received this bug notification because you are a direct subscriber\n> of the bug.\n> \n> Status in IPython - Enhanced Interactive Python: New\n> \n> Bug description:\n> I have a parallel scientific code that runs on clusters. It currently uses my own (badly designed) parallel communication engine and I'm trying to transition to iPython's TaskClient interface. One part of my code uses the subprocess module to wrap a call to a different piece of software. Unfortunately, this seems to be causing problems for me. I'm running on OS X 10.6.2, with python 2.6.4 and ipython 0.10 as supplied by MacPorts. The following code snippet will reproduce the problem I'm having.\n> \n> ---\n> \n> #!/usr/bin/env python\n> \n> from IPython.kernel import client\n> \n> tc = client.TaskClient()\n> \n> @tc.parallel()\n> def remote_test(input):\n>   import subprocess\n>   # I'm obviously not wrapping ls, but I have the same problem with the real binary I'm trying to call\n>   subprocess.check_call('ls')\n>   return input\n> \n> work = range(100)\n> \n> ## results = remote_test(work)\n> \n> The output of this program is:\n> \n> ---\n> \n> /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/python/filepath.py:12: DeprecationWarning: the sha module is deprecated; use the hashlib module instead\n> import sha\n> /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/clientconnector.py:43: DeprecationWarning: Importing class Tub directly from 'foolscap' is deprecated since Foolscap 0.4.3. Please import foolscap.api.Tub instead\n> self.tub = Tub()\n> /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/taskfc.py:79: DeprecationWarning: Importing class Referenceable1 directly from 'foolscap' is deprecated since Foolscap 0.4.3. Please import foolscap.api.Referenceable instead\n> class FCTaskControllerFromTaskController(Referenceable):\n> Traceback (most recent call last):\n> File \"./test.py\", line 15, in <module>\n>   results = remote_test(work)\n> File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/parallelfunction.py\", line 104, in call_function\n>   return self.mapper.map(self.func, _sequences)\n> File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/mapper.py\", line 230, in map\n>   task_results = [self.task_controller.get_task_result(tid) for tid in task_ids]\n> File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/taskclient.py\", line 93, in get_task_result\n>   taskid, block)\n> File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/twistedutil.py\", line 72, in blockingCallFromThread\n>   return twisted.internet.threads.blockingCallFromThread(reactor, f, *a, *_kw)\n> File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/internet/threads.py\", line 114, in blockingCallFromThread\n>   result.raiseException()\n> File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/python/failure.py\", line 326, in raiseException\n>   raise self.type, self.value, self.tb\n> \n> ## OSError: [Errno 4] Interrupted system call\n> \n> The ipcontroller log file looks like:\n> \n> ---\n> \n> 2010-02-04 12:42:36-0800 [-] Running task 82 on worker 1\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Task completed: 82\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] distributing Tasks\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Running task 83 on worker 1\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Task 83 failed on worker 1\n> 2010-02-04 12:42:36-0800 [-] distributing Tasks\n> 2010-02-04 12:42:36-0800 [-] Running task 84 on worker 0\n> 2010-02-04 12:42:36-0800 [Negotiation,0,192.168.0.194] Task 84 failed on worker 0\n> 2010-02-04 12:42:37-0800 [-] distributing Tasks\n> 2010-02-04 12:42:37-0800 [-] Running task 85 on worker 1\n> 2010-02-04 12:42:37-0800 [Negotiation,2,192.168.0.194] Task 85 failed on worker 1\n> 2010-02-04 12:42:37-0800 [-] distributing Tasks\n> 2010-02-04 12:42:37-0800 [-] Running task 86 on worker 0\n> 2010-02-04 12:42:37-0800 [Negotiation,0,192.168.0.194] Task 86 failed on worker 0\n> 2010-02-04 12:42:38-0800 [-] distributing Tasks\n> \n> ## 2010-02-04 12:42:38-0800 [-] Running task 87 on worker 1\n> \n> Notice that a few of the tasks actually complete, while the majority fail with the strange interrupted system call error.\n> \n> To unsubscribe from this bug, go to:\n> https://bugs.launchpad.net/ipython/+bug/517358/+subscribe\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/236227",
    "html_url": "https://github.com/ipython/ipython/issues/92#issuecomment-236227",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/92",
    "id": 236227,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjIyNw==",
    "user": {
      "login": "ipython",
      "id": 230453,
      "node_id": "MDEyOk9yZ2FuaXphdGlvbjIzMDQ1Mw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/230453?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ipython",
      "html_url": "https://github.com/ipython",
      "followers_url": "https://api.github.com/users/ipython/followers",
      "following_url": "https://api.github.com/users/ipython/following{/other_user}",
      "gists_url": "https://api.github.com/users/ipython/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ipython/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ipython/subscriptions",
      "organizations_url": "https://api.github.com/users/ipython/orgs",
      "repos_url": "https://api.github.com/users/ipython/repos",
      "events_url": "https://api.github.com/users/ipython/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ipython/received_events",
      "type": "Organization",
      "site_admin": false
    },
    "created_at": "2010-05-10T09:40:11Z",
    "updated_at": "2010-05-10T09:40:11Z",
    "author_association": "COLLABORATOR",
    "body": "[ LP comment 6 by: Brian Granger, on 2010-02-15 17:38:01+00:00 ]\n\n> I agree that the problem lies in how Twisted deals with signal handling.\n> However, this has been a known problem with Twisted for a very long\n> time. Unfortunately, it doe not look like fixing it is much of a\n> priority. The usual response is that you should do things the Twisted\n> way and use their API to spawn a process. The problem comes for projects\n> like iPython that, ideally, shouldn't be exposing any of Twisted at all.\n> Perhaps you might have more traction with the Twisted folks, given that\n> you have a well known project that would benefit from fixing this bug.\n> As I understand it, the solution is to write a simple C extension module\n> that fixes signal handling - just no one has done it yet.\n\nI think your assessment is correct.  When you use Twisted you have to\nbuy into the\nentire universe.  That is problematic and we may end up moving away\nfrom twisted.\n\n> I should also point out, that these problems don't exist if the calls to\n> subprocess occur in a separate thread spawned by deferToThread. I\n> haven't had time to look at the source, but how hard would it be to\n> setup the engines so that remote calls are run using deferToThread?\n\nI don't see how deferToThread helps as the signal handlers are process wide.\nAlso, I don't think we can use deferToThread in our case for other reasons.\n\nCheers,\n\nBrian\n\n> Regards,\n> Justin\n> \n> On Feb 4, 2010, at 6:37 PM, Brian Granger wrote:\n> \n> > Yes, my feeling is that subprocess won't work reliably in any twisted\n> > using process as it installs its own signal handlers.  I will look\n> > into this though.\n> > \n> > Cheers,\n> > \n> > Brian\n> > \n> > On Thu, Feb 4, 2010 at 6:28 PM, Justin MacCallum\n> > justin.maccallum@me.com wrote:\n> > \n> > > Sigh... sorry. It was a typo, I'm just using subprocess.\n> > > \n> > > I still believe my comment is valid though; I think this is a long\n> > > standing problem with Twisted.\n> > > \n> > > ## \n> > > \n> > > Using multiprocessing module crashes parallel iPython\n> > > https://bugs.launchpad.net/bugs/517358\n> > > You received this bug notification because you are a member of IPython\n> > > Developers, which is subscribed to IPython.\n> > > \n> > > Status in IPython - Enhanced Interactive Python: New\n> > > \n> > > Bug description:\n> > > I have a parallel scientific code that runs on clusters. It currently uses my own (badly designed) parallel communication engine and I'm trying to transition to iPython's TaskClient interface. One part of my code uses the subprocess module to wrap a call to a different piece of software. Unfortunately, this seems to be causing problems for me. I'm running on OS X 10.6.2, with python 2.6.4 and ipython 0.10 as supplied by MacPorts. The following code snippet will reproduce the problem I'm having.\n> > > \n> > > ---\n> > > \n> > > #!/usr/bin/env python\n> > > \n> > > from IPython.kernel import client\n> > > \n> > > tc = client.TaskClient()\n> > > \n> > > @tc.parallel()\n> > > def remote_test(input):\n> > >   import subprocess\n> > >   # I'm obviously not wrapping ls, but I have the same problem with the real binary I'm trying to call\n> > >   subprocess.check_call('ls')\n> > >   return input\n> > > \n> > > work = range(100)\n> > > \n> > > ## results = remote_test(work)\n> > > \n> > > The output of this program is:\n> > > \n> > > ---\n> > > \n> > > /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/python/filepath.py:12: DeprecationWarning: the sha module is deprecated; use the hashlib module instead\n> > >  import sha\n> > > /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/clientconnector.py:43: DeprecationWarning: Importing class Tub directly from 'foolscap' is deprecated since Foolscap 0.4.3. Please import foolscap.api.Tub instead\n> > >  self.tub = Tub()\n> > > /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/taskfc.py:79: DeprecationWarning: Importing class Referenceable1 directly from 'foolscap' is deprecated since Foolscap 0.4.3. Please import foolscap.api.Referenceable instead\n> > >  class FCTaskControllerFromTaskController(Referenceable):\n> > > Traceback (most recent call last):\n> > >  File \"./test.py\", line 15, in <module>\n> > >   results = remote_test(work)\n> > >  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/parallelfunction.py\", line 104, in call_function\n> > >   return self.mapper.map(self.func, _sequences)\n> > >  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/mapper.py\", line 230, in map\n> > >   task_results = [self.task_controller.get_task_result(tid) for tid in task_ids]\n> > >  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/taskclient.py\", line 93, in get_task_result\n> > >   taskid, block)\n> > >  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/twistedutil.py\", line 72, in blockingCallFromThread\n> > >   return twisted.internet.threads.blockingCallFromThread(reactor, f, *a, *_kw)\n> > >  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/internet/threads.py\", line 114, in blockingCallFromThread\n> > >   result.raiseException()\n> > >  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/python/failure.py\", line 326, in raiseException\n> > >   raise self.type, self.value, self.tb\n> > > \n> > > ## OSError: [Errno 4] Interrupted system call\n> > > \n> > > The ipcontroller log file looks like:\n> > > \n> > > ---\n> > > \n> > > 2010-02-04 12:42:36-0800 [-] Running task 82 on worker 1\n> > > 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Task completed: 82\n> > > 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] distributing Tasks\n> > > 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Running task 83 on worker 1\n> > > 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Task 83 failed on worker 1\n> > > 2010-02-04 12:42:36-0800 [-] distributing Tasks\n> > > 2010-02-04 12:42:36-0800 [-] Running task 84 on worker 0\n> > > 2010-02-04 12:42:36-0800 [Negotiation,0,192.168.0.194] Task 84 failed on worker 0\n> > > 2010-02-04 12:42:37-0800 [-] distributing Tasks\n> > > 2010-02-04 12:42:37-0800 [-] Running task 85 on worker 1\n> > > 2010-02-04 12:42:37-0800 [Negotiation,2,192.168.0.194] Task 85 failed on worker 1\n> > > 2010-02-04 12:42:37-0800 [-] distributing Tasks\n> > > 2010-02-04 12:42:37-0800 [-] Running task 86 on worker 0\n> > > 2010-02-04 12:42:37-0800 [Negotiation,0,192.168.0.194] Task 86 failed on worker 0\n> > > 2010-02-04 12:42:38-0800 [-] distributing Tasks\n> > > \n> > > ## 2010-02-04 12:42:38-0800 [-] Running task 87 on worker 1\n> > > \n> > > Notice that a few of the tasks actually complete, while the majority fail with the strange interrupted system call error.\n> > \n> > ## \n> > \n> > Brian E. Granger, Ph.D.\n> > Assistant Professor of Physics\n> > Cal Poly State University, San Luis Obispo\n> > bgranger@calpoly.edu\n> > ellisonbg@gmail.com\n> > \n> > ## \n> > \n> > Using multiprocessing module crashes parallel iPython\n> > https://bugs.launchpad.net/bugs/517358\n> > You received this bug notification because you are a direct subscriber\n> > of the bug.\n> > \n> > Status in IPython - Enhanced Interactive Python: New\n> > \n> > Bug description:\n> > I have a parallel scientific code that runs on clusters. It currently uses my own (badly designed) parallel communication engine and I'm trying to transition to iPython's TaskClient interface. One part of my code uses the subprocess module to wrap a call to a different piece of software. Unfortunately, this seems to be causing problems for me. I'm running on OS X 10.6.2, with python 2.6.4 and ipython 0.10 as supplied by MacPorts. The following code snippet will reproduce the problem I'm having.\n> > \n> > ---\n> > \n> > #!/usr/bin/env python\n> > \n> > from IPython.kernel import client\n> > \n> > tc = client.TaskClient()\n> > \n> > @tc.parallel()\n> > def remote_test(input):\n> >   import subprocess\n> >   # I'm obviously not wrapping ls, but I have the same problem with the real binary I'm trying to call\n> >   subprocess.check_call('ls')\n> >   return input\n> > \n> > work = range(100)\n> > \n> > ## results = remote_test(work)\n> > \n> > The output of this program is:\n> > \n> > ---\n> > \n> > /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/python/filepath.py:12: DeprecationWarning: the sha module is deprecated; use the hashlib module instead\n> > import sha\n> > /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/clientconnector.py:43: DeprecationWarning: Importing class Tub directly from 'foolscap' is deprecated since Foolscap 0.4.3. Please import foolscap.api.Tub instead\n> > self.tub = Tub()\n> > /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/taskfc.py:79: DeprecationWarning: Importing class Referenceable1 directly from 'foolscap' is deprecated since Foolscap 0.4.3. Please import foolscap.api.Referenceable instead\n> > class FCTaskControllerFromTaskController(Referenceable):\n> > Traceback (most recent call last):\n> > File \"./test.py\", line 15, in <module>\n> >   results = remote_test(work)\n> > File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/parallelfunction.py\", line 104, in call_function\n> >   return self.mapper.map(self.func, _sequences)\n> > File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/mapper.py\", line 230, in map\n> >   task_results = [self.task_controller.get_task_result(tid) for tid in task_ids]\n> > File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/taskclient.py\", line 93, in get_task_result\n> >   taskid, block)\n> > File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/twistedutil.py\", line 72, in blockingCallFromThread\n> >   return twisted.internet.threads.blockingCallFromThread(reactor, f, *a, *_kw)\n> > File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/internet/threads.py\", line 114, in blockingCallFromThread\n> >   result.raiseException()\n> > File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/python/failure.py\", line 326, in raiseException\n> >   raise self.type, self.value, self.tb\n> > \n> > ## OSError: [Errno 4] Interrupted system call\n> > \n> > The ipcontroller log file looks like:\n> > \n> > ---\n> > \n> > 2010-02-04 12:42:36-0800 [-] Running task 82 on worker 1\n> > 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Task completed: 82\n> > 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] distributing Tasks\n> > 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Running task 83 on worker 1\n> > 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Task 83 failed on worker 1\n> > 2010-02-04 12:42:36-0800 [-] distributing Tasks\n> > 2010-02-04 12:42:36-0800 [-] Running task 84 on worker 0\n> > 2010-02-04 12:42:36-0800 [Negotiation,0,192.168.0.194] Task 84 failed on worker 0\n> > 2010-02-04 12:42:37-0800 [-] distributing Tasks\n> > 2010-02-04 12:42:37-0800 [-] Running task 85 on worker 1\n> > 2010-02-04 12:42:37-0800 [Negotiation,2,192.168.0.194] Task 85 failed on worker 1\n> > 2010-02-04 12:42:37-0800 [-] distributing Tasks\n> > 2010-02-04 12:42:37-0800 [-] Running task 86 on worker 0\n> > 2010-02-04 12:42:37-0800 [Negotiation,0,192.168.0.194] Task 86 failed on worker 0\n> > 2010-02-04 12:42:38-0800 [-] distributing Tasks\n> > \n> > ## 2010-02-04 12:42:38-0800 [-] Running task 87 on worker 1\n> > \n> > Notice that a few of the tasks actually complete, while the majority fail with the strange interrupted system call error.\n> > \n> > To unsubscribe from this bug, go to:\n> > https://bugs.launchpad.net/ipython/+bug/517358/+subscribe\n> \n> ## \n> \n> Using multiprocessing module crashes parallel iPython\n> https://bugs.launchpad.net/bugs/517358\n> You received this bug notification because you are a member of IPython\n> Developers, which is subscribed to IPython.\n> \n> Status in IPython - Enhanced Interactive Python: New\n> \n> Bug description:\n> I have a parallel scientific code that runs on clusters. It currently uses my own (badly designed) parallel communication engine and I'm trying to transition to iPython's TaskClient interface. One part of my code uses the subprocess module to wrap a call to a different piece of software. Unfortunately, this seems to be causing problems for me. I'm running on OS X 10.6.2, with python 2.6.4 and ipython 0.10 as supplied by MacPorts. The following code snippet will reproduce the problem I'm having.\n> \n> ---\n> \n> #!/usr/bin/env python\n> \n> from IPython.kernel import client\n> \n> tc = client.TaskClient()\n> \n> @tc.parallel()\n> def remote_test(input):\n>   import subprocess\n>   # I'm obviously not wrapping ls, but I have the same problem with the real binary I'm trying to call\n>   subprocess.check_call('ls')\n>   return input\n> \n> work = range(100)\n> \n> ## results = remote_test(work)\n> \n> The output of this program is:\n> \n> ---\n> \n> /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/python/filepath.py:12: DeprecationWarning: the sha module is deprecated; use the hashlib module instead\n>  import sha\n> /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/clientconnector.py:43: DeprecationWarning: Importing class Tub directly from 'foolscap' is deprecated since Foolscap 0.4.3. Please import foolscap.api.Tub instead\n>  self.tub = Tub()\n> /opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/taskfc.py:79: DeprecationWarning: Importing class Referenceable1 directly from 'foolscap' is deprecated since Foolscap 0.4.3. Please import foolscap.api.Referenceable instead\n>  class FCTaskControllerFromTaskController(Referenceable):\n> Traceback (most recent call last):\n>  File \"./test.py\", line 15, in <module>\n>   results = remote_test(work)\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/parallelfunction.py\", line 104, in call_function\n>   return self.mapper.map(self.func, _sequences)\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/mapper.py\", line 230, in map\n>   task_results = [self.task_controller.get_task_result(tid) for tid in task_ids]\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/taskclient.py\", line 93, in get_task_result\n>   taskid, block)\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/IPython/kernel/twistedutil.py\", line 72, in blockingCallFromThread\n>   return twisted.internet.threads.blockingCallFromThread(reactor, f, *a, *_kw)\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/internet/threads.py\", line 114, in blockingCallFromThread\n>   result.raiseException()\n>  File \"/opt/local/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/Twisted-8.2.0-py2.6-macosx-10.6-i386.egg/twisted/python/failure.py\", line 326, in raiseException\n>   raise self.type, self.value, self.tb\n> \n> ## OSError: [Errno 4] Interrupted system call\n> \n> The ipcontroller log file looks like:\n> \n> ---\n> \n> 2010-02-04 12:42:36-0800 [-] Running task 82 on worker 1\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Task completed: 82\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] distributing Tasks\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Running task 83 on worker 1\n> 2010-02-04 12:42:36-0800 [Negotiation,2,192.168.0.194] Task 83 failed on worker 1\n> 2010-02-04 12:42:36-0800 [-] distributing Tasks\n> 2010-02-04 12:42:36-0800 [-] Running task 84 on worker 0\n> 2010-02-04 12:42:36-0800 [Negotiation,0,192.168.0.194] Task 84 failed on worker 0\n> 2010-02-04 12:42:37-0800 [-] distributing Tasks\n> 2010-02-04 12:42:37-0800 [-] Running task 85 on worker 1\n> 2010-02-04 12:42:37-0800 [Negotiation,2,192.168.0.194] Task 85 failed on worker 1\n> 2010-02-04 12:42:37-0800 [-] distributing Tasks\n> 2010-02-04 12:42:37-0800 [-] Running task 86 on worker 0\n> 2010-02-04 12:42:37-0800 [Negotiation,0,192.168.0.194] Task 86 failed on worker 0\n> 2010-02-04 12:42:38-0800 [-] distributing Tasks\n> \n> ## 2010-02-04 12:42:38-0800 [-] Running task 87 on worker 1\n> \n> Notice that a few of the tasks actually complete, while the majority fail with the strange interrupted system call error.\n\n## \n\nBrian E. Granger, Ph.D.\nAssistant Professor of Physics\nCal Poly State University, San Luis Obispo\nbgranger@calpoly.edu\nellisonbg@gmail.com\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/909274",
    "html_url": "https://github.com/ipython/ipython/issues/92#issuecomment-909274",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/92",
    "id": 909274,
    "node_id": "MDEyOklzc3VlQ29tbWVudDkwOTI3NA==",
    "user": {
      "login": "takluyver",
      "id": 327925,
      "node_id": "MDQ6VXNlcjMyNzkyNQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/327925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takluyver",
      "html_url": "https://github.com/takluyver",
      "followers_url": "https://api.github.com/users/takluyver/followers",
      "following_url": "https://api.github.com/users/takluyver/following{/other_user}",
      "gists_url": "https://api.github.com/users/takluyver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takluyver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takluyver/subscriptions",
      "organizations_url": "https://api.github.com/users/takluyver/orgs",
      "repos_url": "https://api.github.com/users/takluyver/repos",
      "events_url": "https://api.github.com/users/takluyver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takluyver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2011-03-23T19:35:03Z",
    "updated_at": "2011-03-23T19:35:03Z",
    "author_association": "MEMBER",
    "body": "Does this issue go away with our move to ZMQ rather than twisted?\n"
  },
  {
    "url": "https://api.github.com/repos/ipython/ipython/issues/comments/927125",
    "html_url": "https://github.com/ipython/ipython/issues/92#issuecomment-927125",
    "issue_url": "https://api.github.com/repos/ipython/ipython/issues/92",
    "id": 927125,
    "node_id": "MDEyOklzc3VlQ29tbWVudDkyNzEyNQ==",
    "user": {
      "login": "minrk",
      "id": 151929,
      "node_id": "MDQ6VXNlcjE1MTkyOQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/151929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/minrk",
      "html_url": "https://github.com/minrk",
      "followers_url": "https://api.github.com/users/minrk/followers",
      "following_url": "https://api.github.com/users/minrk/following{/other_user}",
      "gists_url": "https://api.github.com/users/minrk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/minrk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/minrk/subscriptions",
      "organizations_url": "https://api.github.com/users/minrk/orgs",
      "repos_url": "https://api.github.com/users/minrk/repos",
      "events_url": "https://api.github.com/users/minrk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/minrk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2011-03-28T17:42:12Z",
    "updated_at": "2011-03-28T17:42:12Z",
    "author_association": "MEMBER",
    "body": "Yes, this issue no longer applies to the new 0MQ+tornado parallel code.  Closing as wontfix.\n"
  }
]
