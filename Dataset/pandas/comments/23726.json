[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/439206883",
    "html_url": "https://github.com/pandas-dev/pandas/issues/23726#issuecomment-439206883",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/23726",
    "id": 439206883,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzOTIwNjg4Mw==",
    "user": {
      "login": "jbrockmendel",
      "id": 8078968,
      "node_id": "MDQ6VXNlcjgwNzg5Njg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/8078968?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jbrockmendel",
      "html_url": "https://github.com/jbrockmendel",
      "followers_url": "https://api.github.com/users/jbrockmendel/followers",
      "following_url": "https://api.github.com/users/jbrockmendel/following{/other_user}",
      "gists_url": "https://api.github.com/users/jbrockmendel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jbrockmendel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jbrockmendel/subscriptions",
      "organizations_url": "https://api.github.com/users/jbrockmendel/orgs",
      "repos_url": "https://api.github.com/users/jbrockmendel/repos",
      "events_url": "https://api.github.com/users/jbrockmendel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jbrockmendel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-15T22:04:17Z",
    "updated_at": "2018-11-15T22:04:17Z",
    "author_association": "MEMBER",
    "body": "I’ve noticed this too.  I’m guessing related to #23688.  @jschendel any ideas?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/439226374",
    "html_url": "https://github.com/pandas-dev/pandas/issues/23726#issuecomment-439226374",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/23726",
    "id": 439226374,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzOTIyNjM3NA==",
    "user": {
      "login": "h-vetinari",
      "id": 33685575,
      "node_id": "MDQ6VXNlcjMzNjg1NTc1",
      "avatar_url": "https://avatars1.githubusercontent.com/u/33685575?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/h-vetinari",
      "html_url": "https://github.com/h-vetinari",
      "followers_url": "https://api.github.com/users/h-vetinari/followers",
      "following_url": "https://api.github.com/users/h-vetinari/following{/other_user}",
      "gists_url": "https://api.github.com/users/h-vetinari/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/h-vetinari/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/h-vetinari/subscriptions",
      "organizations_url": "https://api.github.com/users/h-vetinari/orgs",
      "repos_url": "https://api.github.com/users/h-vetinari/repos",
      "events_url": "https://api.github.com/users/h-vetinari/events{/privacy}",
      "received_events_url": "https://api.github.com/users/h-vetinari/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-15T23:22:24Z",
    "updated_at": "2018-11-15T23:22:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jbrockmendel \r\nDefinitely something weird going on.\r\n```\r\n>>> import numpy as np\r\n>>> import pandas as pd\r\n>>> s = pd.Series(np.arange(2**24 + 1))\r\n>>>\r\n>>> s.astype(int).rank(pct=True).max()\r\n1.0\r\n>>> s.astype(np.int32).rank(pct=True).max()\r\n1.0\r\n>>> s.astype(np.int64).rank(pct=True).max()\r\n1.0\r\n>>> s.astype(np.uint32).rank(pct=True).max()\r\n1.0\r\n>>> s.astype(np.uint64).rank(pct=True).max()\r\n1.0\r\n>>> s.astype(float).rank(pct=True).max()\r\n1.0\r\n>>> s.astype(np.float64).rank(pct=True).max()\r\n1.0\r\n>>> s.astype(np.float32).rank(pct=True).max()\r\nMemoryError\r\n>>> # all following calls to s.astype(<whatever>).rank(pct=True), e.g.\r\n>>> s.astype(int).rank(pct=True).max()\r\nMemoryError\r\n>>> # Interestingly, even after the MemoryError, pct=False works\r\n>>> s.astype(int).rank().max()\r\n16777217.0\r\n```\r\n\r\nI can't really see how anything in that test should cast to `float32`, but maybe there's a resource leak somewhere?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/439429129",
    "html_url": "https://github.com/pandas-dev/pandas/issues/23726#issuecomment-439429129",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/23726",
    "id": 439429129,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzOTQyOTEyOQ==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-16T15:29:34Z",
    "updated_at": "2018-11-16T15:29:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "Is this crash 2.7 only, or have we seen it on python 3 builds?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/439453284",
    "html_url": "https://github.com/pandas-dev/pandas/issues/23726#issuecomment-439453284",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/23726",
    "id": 439453284,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzOTQ1MzI4NA==",
    "user": {
      "login": "h-vetinari",
      "id": 33685575,
      "node_id": "MDQ6VXNlcjMzNjg1NTc1",
      "avatar_url": "https://avatars1.githubusercontent.com/u/33685575?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/h-vetinari",
      "html_url": "https://github.com/h-vetinari",
      "followers_url": "https://api.github.com/users/h-vetinari/followers",
      "following_url": "https://api.github.com/users/h-vetinari/following{/other_user}",
      "gists_url": "https://api.github.com/users/h-vetinari/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/h-vetinari/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/h-vetinari/subscriptions",
      "organizations_url": "https://api.github.com/users/h-vetinari/orgs",
      "repos_url": "https://api.github.com/users/h-vetinari/repos",
      "events_url": "https://api.github.com/users/h-vetinari/events{/privacy}",
      "received_events_url": "https://api.github.com/users/h-vetinari/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-16T16:44:12Z",
    "updated_at": "2018-11-16T16:44:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "I've only ever seen it in the travis-27 build."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/439465630",
    "html_url": "https://github.com/pandas-dev/pandas/issues/23726#issuecomment-439465630",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/23726",
    "id": 439465630,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzOTQ2NTYzMA==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-16T17:24:43Z",
    "updated_at": "2018-11-16T17:24:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "Unfortunately I haven't been able to reproduce the segfault locally on my Mac."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/440066487",
    "html_url": "https://github.com/pandas-dev/pandas/issues/23726#issuecomment-440066487",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/23726",
    "id": 440066487,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MDA2NjQ4Nw==",
    "user": {
      "login": "h-vetinari",
      "id": 33685575,
      "node_id": "MDQ6VXNlcjMzNjg1NTc1",
      "avatar_url": "https://avatars1.githubusercontent.com/u/33685575?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/h-vetinari",
      "html_url": "https://github.com/h-vetinari",
      "followers_url": "https://api.github.com/users/h-vetinari/followers",
      "following_url": "https://api.github.com/users/h-vetinari/following{/other_user}",
      "gists_url": "https://api.github.com/users/h-vetinari/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/h-vetinari/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/h-vetinari/subscriptions",
      "organizations_url": "https://api.github.com/users/h-vetinari/orgs",
      "repos_url": "https://api.github.com/users/h-vetinari/repos",
      "events_url": "https://api.github.com/users/h-vetinari/events{/privacy}",
      "received_events_url": "https://api.github.com/users/h-vetinari/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-19T22:33:59Z",
    "updated_at": "2018-11-19T22:33:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "I can reproduce the failure locally (on windows), but I only get a `MemoryError`, not a segfault. If it *were* a MemoryError, it could be an explanation why it only fails sometimes - depending on how busy the worker is with other code at that moment."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/440076164",
    "html_url": "https://github.com/pandas-dev/pandas/issues/23726#issuecomment-440076164",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/23726",
    "id": 440076164,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MDA3NjE2NA==",
    "user": {
      "login": "jschendel",
      "id": 5332445,
      "node_id": "MDQ6VXNlcjUzMzI0NDU=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/5332445?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jschendel",
      "html_url": "https://github.com/jschendel",
      "followers_url": "https://api.github.com/users/jschendel/followers",
      "following_url": "https://api.github.com/users/jschendel/following{/other_user}",
      "gists_url": "https://api.github.com/users/jschendel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jschendel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jschendel/subscriptions",
      "organizations_url": "https://api.github.com/users/jschendel/orgs",
      "repos_url": "https://api.github.com/users/jschendel/repos",
      "events_url": "https://api.github.com/users/jschendel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jschendel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-19T23:12:26Z",
    "updated_at": "2018-11-19T23:13:27Z",
    "author_association": "MEMBER",
    "body": "Yeah, my suspicion is that this is happening due to high memory usage combined with `pytest-xdist` running things in parallel, which could cause different tests to be run simultaneously on different runs.  At least my google searches seem to indicate that this type of error primarily occurs with `pytest-xdist` specifically.\r\n\r\nI'd be somewhat surprised if this was due to a segfault, as different components of the failing test always appear to be passing in other tests.  For example, the 1d version in `test_algos` does the exact same thing as the failing test, with the data just not being wrapped in a `Series`:\r\n\r\nhttps://github.com/pandas-dev/pandas/blob/deb7b4d5003b939f47e525bcdaceeea48622a73a/pandas/tests/test_algos.py#L1465-L1472\r\n\r\nAdditionally, the `DataFrame` version of this test is essentially testing the same thing on two columns of similar data, and calls the same code in `generic.py` that the `Series` version does:\r\n\r\nhttps://github.com/pandas-dev/pandas/blob/deb7b4d5003b939f47e525bcdaceeea48622a73a/pandas/tests/frame/test_rank.py#L313-L318\r\n\r\nSo if there is a segfault, it seems like it has to be something tied to the `Series` constructor, otherwise we'd see failures in the other tests?  And on the Azure 2.7 builds too, presumably?\r\n\r\nTo test this theory, I've made a commit where I marked these tests with `pytest.mark.single`, which I believe marks a subset of tests to be run in non-distributed mode (correct me if I'm wrong).  I have travis hooked up to my local repo, and it looks to be passing with these changes: https://travis-ci.org/jschendel/pandas/builds/457135619\r\n\r\nWill open a PR with the changes above soon."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/440077154",
    "html_url": "https://github.com/pandas-dev/pandas/issues/23726#issuecomment-440077154",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/23726",
    "id": 440077154,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MDA3NzE1NA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-19T23:16:23Z",
    "updated_at": "2018-11-19T23:16:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "yeah marking for single is the best"
  }
]
