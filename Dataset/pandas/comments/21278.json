[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/393719900",
    "html_url": "https://github.com/pandas-dev/pandas/issues/21278#issuecomment-393719900",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/21278",
    "id": 393719900,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MzcxOTkwMA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-01T00:06:41Z",
    "updated_at": "2018-06-01T00:10:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "your results seem odd\r\n\r\nfor ``n = 10000000``\r\n\r\nin 0.23\r\n\r\n```In [8]:     n = 10000000\r\n   ...:     domain = np.arange(0, n)\r\n   ...:     range = domain+10\r\n   ...:     maptable = pd.Series(range, index=domain).sort_index()\r\n   ...: \r\n   ...:     query_vals = pd.Series([1,2,3])\r\n   ...:     def f():\r\n   ...:         query_vals.map(maptable)\r\n   ...: \r\n   ...: \r\n\r\nIn [9]: %timeit query_vals.map(maptable)\r\n145 us +- 15.9 us per loop (mean +- std. dev. of 7 runs, 1 loop each)\r\n```\r\n\r\nand in 0.22\r\n```In [1]:     n = 10000000\r\n   ...:     domain = np.arange(0, n)\r\n   ...:     range = domain+10\r\n   ...:     maptable = pd.Series(range, index=domain).sort_index()\r\n   ...: \r\n   ...:     query_vals = pd.Series([1,2,3])\r\n   ...:     def f():\r\n   ...:         query_vals.map(maptable)\r\n   ...:     \r\n   ...:     \r\n\r\nIn [2]: %timeit query_vals.map(maptable)\r\n351 us +- 71.2 us per loop (mean +- std. dev. of 7 runs, 1 loop each)\r\n```\r\n\r\nnote that we build a hashtable for indexing. once its built, these things are very cheap to do.\r\n\r\nsure you *could* take advantage of monotonic indexes, but there is a cost (in code complexity) and is only sometimes worth it.\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/393729134",
    "html_url": "https://github.com/pandas-dev/pandas/issues/21278#issuecomment-393729134",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/21278",
    "id": 393729134,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MzcyOTEzNA==",
    "user": {
      "login": "stuz5000",
      "id": 7799980,
      "node_id": "MDQ6VXNlcjc3OTk5ODA=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7799980?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stuz5000",
      "html_url": "https://github.com/stuz5000",
      "followers_url": "https://api.github.com/users/stuz5000/followers",
      "following_url": "https://api.github.com/users/stuz5000/following{/other_user}",
      "gists_url": "https://api.github.com/users/stuz5000/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stuz5000/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stuz5000/subscriptions",
      "organizations_url": "https://api.github.com/users/stuz5000/orgs",
      "repos_url": "https://api.github.com/users/stuz5000/repos",
      "events_url": "https://api.github.com/users/stuz5000/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stuz5000/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-01T01:13:27Z",
    "updated_at": "2018-06-01T01:13:27Z",
    "author_association": "NONE",
    "body": "Nice! Warmup was the issue.\r\n\r\nActually, performance looks very reasonably with this in mind - there's basically no difference between n=10 and n=100000000, and the cost to build the index is not bad.\r\n\r\nIt also seems there's no benefit in calling sort_index.\r\nThanks!"
  }
]
