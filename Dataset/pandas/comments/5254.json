[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26557164",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-26557164",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 26557164,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTU3MTY0",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-17T22:05:38Z",
    "updated_at": "2013-10-17T22:05:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "I can sketch something out about how to handle it or even just write it as a preliminary PR. \n\nTo get started could you give me a couple of small DataFrame examples with MultiIndexes that the Excel writers would be required to handle. \n\nMaybe something a little simpler that the [examples in the docs](http://pandas.pydata.org/pandas-docs/stable/indexing.html#hierarchical-indexing-multiindex) to start begin.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26558196",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-26558196",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 26558196,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTU4MTk2",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-17T22:22:02Z",
    "updated_at": "2013-10-17T22:22:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "``` python\nIn [3]: df = pd.DataFrame(zip([0] * 6, [1] * 6, [2] * 6, [3] * 6, [4] * 6), columns=pd.MultiIndex.from_arrays([['Foo', 'Foo', 'Bar', 'Bar', 'Baz'], ['A', 'B', 'C', 'D', 'E']])\n)\n\nIn [4]: df\nOut[4]:\n   Foo     Bar     Baz\n     A  B    C  D    E\n0    0  1    2  3    4\n1    0  1    2  3    4\n2    0  1    2  3    4\n3    0  1    2  3    4\n4    0  1    2  3    4\n5    0  1    2  3    4\n```\n\nHere's what the Excel File should look like:\n\n![screen shot 2013-10-17 at 6 20 12 pm](https://f.cloud.github.com/assets/1598379/1356568/68a4dae0-377a-11e3-853f-deec69bde1b9.png)\n\nThere's something in core/format that I believe handles this (or maybe it's on MI), so I think it should be trivial to convert an MI into a set of spans. (which I think is what the excel writer needs anyways).\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26558240",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-26558240",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 26558240,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTU4MjQw",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-17T22:22:52Z",
    "updated_at": "2013-10-17T22:22:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm less clear on MI index (as opposed to columns) and I'm inclined to not mess with that for now.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26558309",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-26558309",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 26558309,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTU4MzA5",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-17T22:24:07Z",
    "updated_at": "2013-10-17T22:24:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "Here's what it does currently (dots indicate level of nesting).\n![screen shot 2013-10-17 at 6 23 29 pm](https://f.cloud.github.com/assets/1598379/1356591/d5bc1d28-377a-11e3-9803-5e07677490e3.png)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26558696",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-26558696",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 26558696,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTU4Njk2",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-17T22:30:52Z",
    "updated_at": "2013-10-17T22:30:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think it's as simple as passing sparsify=True to it's formatter and looking for empty cols.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26558830",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-26558830",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 26558830,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTU4ODMw",
    "user": {
      "login": "cancan101",
      "id": 51059,
      "node_id": "MDQ6VXNlcjUxMDU5",
      "avatar_url": "https://avatars1.githubusercontent.com/u/51059?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cancan101",
      "html_url": "https://github.com/cancan101",
      "followers_url": "https://api.github.com/users/cancan101/followers",
      "following_url": "https://api.github.com/users/cancan101/following{/other_user}",
      "gists_url": "https://api.github.com/users/cancan101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cancan101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cancan101/subscriptions",
      "organizations_url": "https://api.github.com/users/cancan101/orgs",
      "repos_url": "https://api.github.com/users/cancan101/repos",
      "events_url": "https://api.github.com/users/cancan101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cancan101/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-17T22:33:19Z",
    "updated_at": "2013-10-17T22:33:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jtratner Yes: #4679 and #4468\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26558880",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-26558880",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 26558880,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTU4ODgw",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-17T22:34:36Z",
    "updated_at": "2013-10-17T22:35:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "Example 2:\n\n``` python\nIn [7]: df = pd.DataFrame([list('abcde'), list('fghij'), list('klmno')])\n\nIn [8]: df\nOut[8]:\n   0  1  2  3  4\n0  a  b  c  d  e\n1  f  g  h  i  j\n2  k  l  m  n  o\n\nIn [11]: df.columns = pd.MultiIndex.from_arrays([['A', 'A', 'A', 'C', 'C'], ['D', 'E', 'E', 'H', 'I'],  ['J', 'L', 'M', 'N', 'N']])\n\nIn [12]: df\nOut[12]:\n   A        C\n   D  E     H  I\n   J  L  M  N  N\n0  a  b  c  d  e\n1  f  g  h  i  j\n2  k  l  m  n  o\n```\n\n![screen shot 2013-10-17 at 6 34 20 pm](https://f.cloud.github.com/assets/1598379/1356640/4bb8392a-377c-11e3-80c1-a55c28e7d4be.png)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26558902",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-26558902",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 26558902,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTU4OTAy",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-17T22:34:58Z",
    "updated_at": "2013-10-17T22:34:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "oops, need to make that last 3 level\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26558993",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-26558993",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 26558993,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTU4OTkz",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-17T22:36:37Z",
    "updated_at": "2013-10-17T22:36:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "@cancan101 yeah, that's the reverse of this, still useful tho!\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26559238",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-26559238",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 26559238,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTU5MjM4",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-17T22:41:41Z",
    "updated_at": "2013-10-17T22:41:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "I can have a look at that. Probably not before Sunday though.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26762706",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-26762706",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 26762706,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NzYyNzA2",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-21T22:30:13Z",
    "updated_at": "2013-10-21T22:30:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "you guys going to try to throw this in? (no problem with it, esp if its experimental...so can even do after rc1)...\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26762769",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-26762769",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 26762769,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NzYyNzY5",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-21T22:31:32Z",
    "updated_at": "2013-10-21T22:31:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "I _really_ want this, even if it means stepping through code for hours.  Especially if we can get it on the reading side.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26764649",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-26764649",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 26764649,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NzY0NjQ5",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-21T23:04:21Z",
    "updated_at": "2013-10-21T23:04:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "haha!\n\nnp\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26766378",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-26766378",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 26766378,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NzY2Mzc4",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-21T23:38:08Z",
    "updated_at": "2013-10-27T23:11:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "I had a preliminary look at the Excel writer merge code. \n\nThe merge mechanisms in the Excel writers will probably work without modification if the cells ranges for the merges are identified correctly. However, that part is completely missing (you probably already knew that, I'm just catching up).\n\nOf the existing writers the `to_html()` writer seems to get it's output right in a comprehensive way so I'm trying to steal some ideas from that.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26769275",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-26769275",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 26769275,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NzY5Mjc1",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-22T00:40:38Z",
    "updated_at": "2013-10-22T00:40:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "Feels like the easiest way would be to modify the sparsify function on\nMultiIndex to return tuples of ((start, end), value) so that individual\nformatters can do what they want. (be useful in multiple places)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27137959",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-27137959",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 27137959,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTM3OTU5",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-26T02:59:35Z",
    "updated_at": "2013-10-26T02:59:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "pushing to 0.14\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27158880",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-27158880",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 27158880,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTU4ODgw",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-27T00:05:14Z",
    "updated_at": "2013-10-27T23:11:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "I pushed some initial code for this to the branch above. It is WIP and the `test_excel_010_hemstring` tests fail but I'm debugging that.\n\nAll I've done so far is to uncomment and fix some of the existing code but it appears to be working.\n\nUsing the above dataframes as an example:\n\n``` python\nimport pandas as pd\n\ndf = pd.DataFrame(zip([0] * 6, [1] * 6, [2] * 6, [3] * 6, [4] * 6),\n                  columns=pd.MultiIndex.from_arrays([\n            ['Foo', 'Foo', 'Bar', 'Bar', 'Baz'],\n            ['A', 'B', 'C', 'D', 'E']]))\n\ndf.to_excel('merge1.xls')\ndf.to_excel('merge2.xlsx')\ndf.to_excel('merge3.xlsx', engine='xlsxwriter')\n```\n\nThe output from the `xlsxwriter` example looks like this:\n\n![screenshot](https://f.cloud.github.com/assets/94267/1414662/95bf58e4-3e9a-11e3-98ce-93c7a506f7eb.png)\n\nThe merged ranges aren't centred but that is easily fixable. The output is the same for `openpyxl` and `xlwt` (except that the ranges are centred).\n\nFor the second example:\n\n``` python\nimport pandas as pd\n\ndf = pd.DataFrame([list('abcde'), list('fghij'), list('klmno')])\ndf.columns = pd.MultiIndex.from_arrays([\n        ['A', 'A', 'A', 'C', 'C'], \n        ['D', 'E', 'E', 'H', 'I'],  \n        ['J', 'L', 'M', 'N', 'N']])\n\ndf.to_excel('merge4.xls')\ndf.to_excel('merge5.xlsx')\ndf.to_excel('merge6.xlsx', engine='xlsxwriter')\n```\n\nOutput:\n\n![screenshot](https://f.cloud.github.com/assets/94267/1414668/e1532a10-3e9a-11e3-95ab-ae0e34989be9.png)\n\nThe `openpyxl` output in this case is incorrect but that is most likely an issue with that module. The output is fine with `xlwt`.\n\nOpenpyxl output:\n\n![screenshot](https://f.cloud.github.com/assets/94267/1414671/1c6d2934-3e9b-11e3-86f7-3f6e3c42d337.png)\n\nAnyway, some progress.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27159201",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-27159201",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 27159201,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTU5MjAx",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-27T00:31:02Z",
    "updated_at": "2013-10-27T00:31:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "That looks really great! The hemstring test has to do with round-tripping MI. Would you be able to put your changes under a keyword argument and then we could work on reading back files like that separately?\n\nAlso, if it's not working with openpyxl, I guess we could make it engine dependent and warn if you try to do it with openpyxl.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27181973",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-27181973",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 27181973,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTgxOTcz",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-27T23:01:43Z",
    "updated_at": "2013-10-27T23:01:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "I fixed two of the issues mentioned above:\n1. The centered merge for xlsxwriter.\n2. The border around the merged range for openpyxl.\n\nI'll have a look at the hemstring test failure next.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27183755",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-27183755",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 27183755,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTgzNzU1",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-28T00:35:36Z",
    "updated_at": "2013-10-28T00:37:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jtratner @jreback \n\nI could use your input on the failing `test_excel_010_hemstring` test.\n\nCurrently in the test on the `master` branch you get a DF to be written like this:\n\n```\nC0      C_l0_g0 C_l0_g1 C_l0_g2\nC1      C_l1_g0 C_l1_g1 C_l1_g2\nR0\nR_l0_g0    R0C0    R0C1    R0C2\nR_l0_g1    R1C0    R1C1    R1C2\nR_l0_g2    R2C0    R2C1    R2C2\nR_l0_g3    R3C0    R3C1    R3C2\nR_l0_g4    R4C0    R4C1    R4C2\n```\n\nThis is read back as follow and asserted to be true in the comparisons:\n\n```\n        R0 C_l0_g0.C_l1_g0 C_l0_g1.C_l1_g1 C_l0_g2.C_l1_g2\n0  R_l0_g0            R0C0            R0C1            R0C2\n1  R_l0_g1            R1C0            R1C1            R1C2\n2  R_l0_g2            R2C0            R2C1            R2C2\n3  R_l0_g3            R3C0            R3C1            R3C2\n4  R_l0_g4            R4C0            R4C1            R4C2\n```\n\nHowever, after my changes the following is read back (it is what is actually in the Excel file as well):\n\n```\n         C_l0_g0  C_l0_g1  C_l0_g2\nR0       C_l1_g0  C_l1_g1  C_l1_g2\nR_l0_g0     R0C0     R0C1     R0C2\nR_l0_g1     R1C0     R1C1     R1C2\nR_l0_g2     R2C0     R2C1     R2C2\nR_l0_g3     R3C0     R3C1     R3C2\nR_l0_g4     R4C0     R4C1     R4C2\n```\n\nWhich fails as follow:\n\n```\n$ py.test pandas/io/tests/test_excel.py -v -k hemstring\n================================================== test session starts \nplatform darwin -- Python 2.7.2 -- pytest-2.3.5\ncollected 76 items\n\npandas/io/tests/test_excel.py:826: OpenpyxlTests.test_excel_010_hemstring FAILED\npandas/io/tests/test_excel.py:826: XlwtTests.test_excel_010_hemstring FAILED\npandas/io/tests/test_excel.py:826: XlsxWriterTests.test_excel_010_hemstring FAILED\n\n======================================================== FAILURES \n_________________________________________ OpenpyxlTests.test_excel_010_hemstring \n\nself = <pandas.io.tests.test_excel.OpenpyxlTests testMethod=test_excel_010_hemstring>\n\n    def test_excel_010_hemstring(self):\n        _skip_if_no_xlrd()\n        from pandas.util.testing import makeCustomDataframe as mkdf\n        # ensure limited functionality in 0.10\n        # override of #2370 until sorted out in 0.11\n\n        def roundtrip(df, header=True, parser_hdr=0):\n            path = '__tmp__test_xl_010_%s__.%s' % (np.random.randint(1, 10000), self.ext)\n            df.to_excel(path, header=header)\n\n            with ensure_clean(path) as path:\n                xf = pd.ExcelFile(path)\n                res = xf.parse(xf.sheet_names[0], header=parser_hdr)\n                return res\n\n        nrows = 5\n        ncols = 3\n\n        for i in range(1, 4):  # row multindex upto nlevel=3\n            for j in range(1, 4):  # col \"\"\n                df = mkdf(nrows, ncols, r_idx_nlevels=i, c_idx_nlevels=j)\n                res = roundtrip(df)\n                # shape\n>               self.assertEqual(res.shape, (nrows, ncols + i))\nE               AssertionError: Tuples differ: (6, 3) != (5, 4)\nE\nE               First differing element 0:\nE               6\nE               5\nE\nE               - (6, 3)\nE               + (5, 4)\n\n...\n```\n\nI'm not sure if this is a genuine failure or if the test is based around the existing handling of MI indices and isn't going to work with the new MI handling.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27184001",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-27184001",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 27184001,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTg0MDAx",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-28T00:47:56Z",
    "updated_at": "2013-10-28T00:47:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "What you have is the behavior that it ought to be, I'm :+1: on changing the test (esp b/c we already said we were defaulting tupleize_columns to produce MIs in 0.13. But you should add it as a note to the doc/source/v0.13.0.txt section as well as release.rst that you've improved MI handling and MI round-tripping.\n\n@jreback and others - are you okay with this positive change (that's backwards incompatible only in that the existing behavior was poor)?\n\nBtw - does this handle hierarchical rows correctly too?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27184219",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-27184219",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 27184219,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTg0MjE5",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-28T00:57:26Z",
    "updated_at": "2013-10-28T00:57:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "yep I agree the new behavior is really the correct behavior\nok to break past (but make a mention/example in v0.13 so users not suprised)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27184325",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-27184325",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 27184325,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTg0MzI1",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-28T01:01:24Z",
    "updated_at": "2013-10-28T01:01:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "Also @jmcnamara - thanks so much for tackling this! Looks like you've resolved a _bunch_ of issues with Excel IO with hierarchical data.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27185027",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-27185027",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 27185027,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTg1MDI3",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-28T01:31:48Z",
    "updated_at": "2013-10-28T01:34:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Btw - does this handle hierarchical rows correctly too?\n\nNot currently. Is this a suitable example to test with?:\n\n``` python\nimport pandas as pd\nimport numpy as np\n\narrays = [np.array(['bar', 'bar', 'baz', 'baz', 'foo', 'foo']),\n          np.array(['one', 'two', 'one', 'two', 'one', 'two'])]\n\n\ndf = pd.DataFrame(np.random.randn(6, 4), index=arrays)\n\n\n>>> df\n                0         1         2         3\nbar one  0.405417 -0.045123  0.539755  0.102764\n    two -1.431279 -0.903300 -1.018812 -0.064565\nbaz one  0.084649 -0.497144  0.463838 -0.814132\n    two  0.790201 -2.513413  2.278565 -1.208934\nfoo one  0.246844  0.257885  0.919118 -1.678567\n    two  1.238596  0.889024 -1.078195  0.427454\n```\n\nIf you have other examples to test with could you add them to the thread. The starting examples above were very useful.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27185135",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-27185135",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 27185135,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTg1MTM1",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-28T01:36:08Z",
    "updated_at": "2013-10-28T01:36:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yeah, that's fine.  I'd just tweak slightly so you have different size chunks and different dtypes, i.e.:\n\n``` python\narrays = [np.array(['bar', 'bar', 'bar', 'baz', 'baz', 'foo']),\n          np.array([1, 2, 1, 2, 1, 2])]\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27185505",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-27185505",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 27185505,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTg1NTA1",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-28T01:50:50Z",
    "updated_at": "2013-10-28T01:50:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "The other thing we need to handle (eventually) are index names and `common_format` sorts of things - like examples here #5298 can be useful for input data.\n\nAnd here are some roundtrip examples that could be useful to explicitly handle, just to make sure you cover what you can in terms of naming.\n\n``` python\n>>> df = DataFrame(list(zip(range(3), range(3), range(3), range(3))))\n>>> cols = MultiIndex.from_arrays([['a', 'a', 'b', 'b'], [1, 1, 1, 2]], names=['cat1', 'cat2'])\n>>> df1 = df.copy()\n>>> df1.columns = cols\n>>> df1 # roundtrip this\n\ncat1  a     b\ncat2  1  1  1  2\n0     0  0  0  0\n1     1  1  1  1\n2     2  2  2  2\n```\n\nThen same thing with rows\n\n```\n>>> df2 = df.copy()\n>>> ind = MultiIndex.from_arrays([['x', 'y', 'z'], [4, 4, 5]], names=['ind1', 'ind2'])\n>>> df2.index = ind\n>>> df2 # roundtrip this\n           0  1  2  3\nind1 ind2\nx    4     0  0  0  0\ny    4     1  1  1  1\nz    5     2  2  2  2\n```\n\nAnd finally both\n\n```\n>>> df3 = df2.copy()\n>>> df3.columns = cols\n>> df3 # possibly ambiguous as *input*\ncat1       a     b\ncat2       1  1  1  2\nind1 ind2\nx    4     0  0  0  0\ny    4     1  1  1  1\nz    5     2  2  2  2\n```\n\nPandas will output a blank line, so it's not ambiguous to roundtrip, but some `common_format` input can be ambiguous and it's fine to specify what it's doing now and then use a second example where you explicitly pass headers/index arguments.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27269952",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-27269952",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 27269952,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjY5OTUy",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-29T00:34:09Z",
    "updated_at": "2013-10-29T00:34:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "I made some progress with the handling of hierarchical rows. For this example:\n\n``` python\nimport pandas as pd\nimport numpy as np\n\narrays = [np.array(['bar', 'bar', 'bar',   'baz', 'baz', 'foo']),\n          np.array(['one', 'two', 'three', 'one', 'two', 'one'])]\n\ndf = pd.DataFrame(np.random.randn(6, 4), index=arrays)\n\ndf.to_excel('merge7.xls')\ndf.to_excel('merge8.xlsx')\ndf.to_excel('merge9.xlsx', engine='xlsxwriter')\n```\n\nThe output looks like this for all three Excel writers:\n\n![screenshot](https://f.cloud.github.com/assets/94267/1425180/967948fc-4030-11e3-9800-d697d247b871.png)\n\nI'll start writing some tests next and then look at the index name handling.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27545365",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-27545365",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 27545365,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTQ1MzY1",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-01T03:14:02Z",
    "updated_at": "2013-11-01T03:14:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jtratner @jreback A question.\n\nWith the Excel MultiIndex prototype I have some failing test cases like this:\n\n```\nimport pandas as pd\n\ndf1 = pd.DataFrame([[7] *3, [8] *3, [9] *3])\ndf1.index.name = 'Foo'\n\ndf1.to_excel('merge20.xlsx', engine='xlsxwriter')\n\nxf = pd.ExcelFile('merge20.xlsx')\ndf2 = xf.parse(xf.sheet_names[0], index_col=0)\n\n```\n\nWhich gives:\n\n```\n>>> df1\n     0  1  2\nFoo\n0    7  7  7\n1    8  8  8\n2    9  9  9\n\n>>> df2\n      0   1   2\nFoo NaN NaN NaN\n0.0   7   7   7\n1.0   8   8   8\n2.0   9   9   9\n```\n\nThe equivalent Excel file is:\n\n![screenshot](https://f.cloud.github.com/assets/94267/1451626/976766ac-42a3-11e3-944c-9553ed63db51.png)\n\nI'm not sure how to handle this through the current interface but I'm working around it like this:\n\n```\n>>> df2 = xf.parse(xf.sheet_names[0], index_col=0, skiprows=1)\n>>> df2.columns = [0, 1, 2]\n>>> df2\n     0  1  2\nFoo\n0    7  7  7\n1    8  8  8\n2    9  9  9\n```\n\nDoes this seem okay? Am I missing something more obvious.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27545502",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-27545502",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 27545502,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTQ1NTAy",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-01T03:18:33Z",
    "updated_at": "2013-11-01T03:18:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jreback will know - we handle the same thing in csv. If not I can look it up tomorrow.\n\nWhere are you in terms of this right now?  Could you put the writer functionality under a keyword argument so we could put it in 0.13? [i.e., doesn't do it by default but with kwarg will output nicely] Or do you want to wait for 0.14?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27545540",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5254#issuecomment-27545540",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5254",
    "id": 27545540,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NTQ1NTQw",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-01T03:20:03Z",
    "updated_at": "2013-11-01T03:20:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "you have to specify header=[0,1] in that case\n"
  }
]
