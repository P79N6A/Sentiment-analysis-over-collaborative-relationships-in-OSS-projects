[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/420438906",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22669#issuecomment-420438906",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22669",
    "id": 420438906,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDQzODkwNg==",
    "user": {
      "login": "gfyoung",
      "id": 9273653,
      "node_id": "MDQ6VXNlcjkyNzM2NTM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/9273653?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gfyoung",
      "html_url": "https://github.com/gfyoung",
      "followers_url": "https://api.github.com/users/gfyoung/followers",
      "following_url": "https://api.github.com/users/gfyoung/following{/other_user}",
      "gists_url": "https://api.github.com/users/gfyoung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gfyoung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gfyoung/subscriptions",
      "organizations_url": "https://api.github.com/users/gfyoung/orgs",
      "repos_url": "https://api.github.com/users/gfyoung/repos",
      "events_url": "https://api.github.com/users/gfyoung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gfyoung/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-11T21:54:38Z",
    "updated_at": "2018-09-11T22:48:32Z",
    "author_association": "MEMBER",
    "body": "@olveirap : Thanks for reporting this?  Could you update your issue to show what output you're getting currently and what output you would expect?  That would be very helpful.\r\n\r\ncc @jreback "
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/420447481",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22669#issuecomment-420447481",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22669",
    "id": 420447481,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDQ0NzQ4MQ==",
    "user": {
      "login": "olveirap",
      "id": 10198835,
      "node_id": "MDQ6VXNlcjEwMTk4ODM1",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10198835?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/olveirap",
      "html_url": "https://github.com/olveirap",
      "followers_url": "https://api.github.com/users/olveirap/followers",
      "following_url": "https://api.github.com/users/olveirap/following{/other_user}",
      "gists_url": "https://api.github.com/users/olveirap/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/olveirap/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/olveirap/subscriptions",
      "organizations_url": "https://api.github.com/users/olveirap/orgs",
      "repos_url": "https://api.github.com/users/olveirap/repos",
      "events_url": "https://api.github.com/users/olveirap/events{/privacy}",
      "received_events_url": "https://api.github.com/users/olveirap/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-11T22:27:42Z",
    "updated_at": "2018-09-11T22:27:42Z",
    "author_association": "NONE",
    "body": "Sorry for not being clear enough, I've edited the issue with more clear expected output and current behavior"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/420454821",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22669#issuecomment-420454821",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22669",
    "id": 420454821,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDQ1NDgyMQ==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-11T23:01:53Z",
    "updated_at": "2018-09-11T23:01:53Z",
    "author_association": "MEMBER",
    "body": "Can you make your sample a minimally reproducible one? There are a lot of extraneous elements that make it more difficult to decipher.\r\n\r\nhttp://matthewrocklin.com/blog/work/2018/02/28/minimal-bug-reports"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/420459351",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22669#issuecomment-420459351",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22669",
    "id": 420459351,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDQ1OTM1MQ==",
    "user": {
      "login": "olveirap",
      "id": 10198835,
      "node_id": "MDQ6VXNlcjEwMTk4ODM1",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10198835?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/olveirap",
      "html_url": "https://github.com/olveirap",
      "followers_url": "https://api.github.com/users/olveirap/followers",
      "following_url": "https://api.github.com/users/olveirap/following{/other_user}",
      "gists_url": "https://api.github.com/users/olveirap/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/olveirap/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/olveirap/subscriptions",
      "organizations_url": "https://api.github.com/users/olveirap/orgs",
      "repos_url": "https://api.github.com/users/olveirap/repos",
      "events_url": "https://api.github.com/users/olveirap/events{/privacy}",
      "received_events_url": "https://api.github.com/users/olveirap/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-11T23:24:35Z",
    "updated_at": "2018-09-11T23:24:35Z",
    "author_association": "NONE",
    "body": "Sorry again, I provide here a more simple use of pd.qcut which represent the issue I'm talking about:\r\n\r\n```python\r\nimport pandas as pd\r\nimport numpy as np\r\nzs = np.zeros(3)\r\nrs = np.random.randint(1, 100, size=3)\r\narr=np.concatenate((zs, rs))\r\nser = pd.Series(arr)\r\ndf = pd.DataFrame({'numbers':ser})\r\ndf\r\n```\r\n<div>\r\n\r\n<table border=\"1\" class=\"dataframe\">\r\n  <thead>\r\n    <tr style=\"text-align: right;\">\r\n      <th></th>\r\n      <th>numbers</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <th>0</th>\r\n      <td>0.0</td>\r\n    </tr>\r\n    <tr>\r\n      <th>1</th>\r\n      <td>0.0</td>\r\n    </tr>\r\n    <tr>\r\n      <th>2</th>\r\n      <td>0.0</td>\r\n    </tr>\r\n    <tr>\r\n      <th>3</th>\r\n      <td>84.0</td>\r\n    </tr>\r\n    <tr>\r\n      <th>4</th>\r\n      <td>95.0</td>\r\n    </tr>\r\n    <tr>\r\n      <th>5</th>\r\n      <td>77.0</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n</div>\r\n\r\n\r\n```python\r\nlabels = ['numbers_25q', 'numbers_50q', 'numbers_75q', 'numbers_100q']\r\npd.qcut(x=df['numbers'],\r\nq=4,\r\nlabels=labels, duplicates='drop')\r\n```\r\n\r\n    ---------------------------------------------------------------------------\r\n\r\n    ValueError                                Traceback (most recent call last)\r\n\r\n    <ipython-input-14-1afe71bbc979> in <module>()\r\n          1 pd.qcut(x=df['numbers'],\r\n          2 q=4,\r\n    ----> 3 labels=labels, duplicates='drop')\r\n    \r\n\r\n    ~/anaconda3/lib/python3.6/site-packages/pandas/core/reshape/tile.py in qcut(x, q, labels, retbins, precision, duplicates)\r\n        204     fac, bins = _bins_to_cuts(x, bins, labels=labels,\r\n        205                               precision=precision, include_lowest=True,\r\n    --> 206                               dtype=dtype, duplicates=duplicates)\r\n        207 \r\n        208     return _postprocess_for_cut(fac, bins, retbins, x_is_series,\r\n\r\n\r\n    ~/anaconda3/lib/python3.6/site-packages/pandas/core/reshape/tile.py in _bins_to_cuts(x, bins, right, labels, precision, include_lowest, dtype, duplicates)\r\n        250         else:\r\n        251             if len(labels) != len(bins) - 1:\r\n    --> 252                 raise ValueError('Bin labels must be one fewer than '\r\n        253                                  'the number of bin edges')\r\n        254         if not is_categorical_dtype(labels):\r\n\r\n\r\n    ValueError: Bin labels must be one fewer than the number of bin edges\r\n\r\n\r\n\r\n```python\r\nlabels = ['numbers_50q', 'numbers_75q', 'numbers_100q']\r\npd.qcut(x=df['numbers'],\r\nq=4,\r\nlabels=labels, duplicates='drop')\r\n```\r\n\r\n\r\n    0     numbers_50q\r\n    1     numbers_50q\r\n    2     numbers_50q\r\n    3    numbers_100q\r\n    4    numbers_100q\r\n    5     numbers_75q\r\n    Name: numbers, dtype: category\r\n    Categories (3, object): [numbers_50q < numbers_75q < numbers_100q]\r\n\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/420460439",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22669#issuecomment-420460439",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22669",
    "id": 420460439,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDQ2MDQzOQ==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-11T23:30:21Z",
    "updated_at": "2018-09-11T23:30:21Z",
    "author_association": "MEMBER",
    "body": "Not sure that your desired output is plausible here as it's rather ambiguous what the bins should be when you are asking for 4 of them but only 3 ranges are really possible. \r\n\r\nSo in that case the `ValueError` makes sense, though perhaps a better error message can be thrown"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/420461274",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22669#issuecomment-420461274",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22669",
    "id": 420461274,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDQ2MTI3NA==",
    "user": {
      "login": "olveirap",
      "id": 10198835,
      "node_id": "MDQ6VXNlcjEwMTk4ODM1",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10198835?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/olveirap",
      "html_url": "https://github.com/olveirap",
      "followers_url": "https://api.github.com/users/olveirap/followers",
      "following_url": "https://api.github.com/users/olveirap/following{/other_user}",
      "gists_url": "https://api.github.com/users/olveirap/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/olveirap/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/olveirap/subscriptions",
      "organizations_url": "https://api.github.com/users/olveirap/orgs",
      "repos_url": "https://api.github.com/users/olveirap/repos",
      "events_url": "https://api.github.com/users/olveirap/events{/privacy}",
      "received_events_url": "https://api.github.com/users/olveirap/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-11T23:34:34Z",
    "updated_at": "2018-09-11T23:34:34Z",
    "author_association": "NONE",
    "body": "Do you think dropping the label on the same index of duplicate bin is a bad solution? \r\n\r\nI guess a warning while doing so would be the best of both worlds, informing the user of the possible ambiguity while returning something useful for some cases (such as mine)"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/420462258",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22669#issuecomment-420462258",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22669",
    "id": 420462258,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDQ2MjI1OA==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-11T23:39:44Z",
    "updated_at": "2018-09-11T23:39:56Z",
    "author_association": "MEMBER",
    "body": "> Do you think dropping the label on the same index of duplicate bin is a bad solution?\r\n\r\nOnly because I don't think it's generalizable. With your example what is the differentiator that makes you want to drop \"_25\" but keep \"_100\" instead of the other way around? What would happen if you ended up with say only 1 bin but 4 labels? \r\n\r\nI don't think there is a clear cut answer to situations like the above so I'd be -1 here. Of course let's see what others think"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/420465551",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22669#issuecomment-420465551",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22669",
    "id": 420465551,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDQ2NTU1MQ==",
    "user": {
      "login": "olveirap",
      "id": 10198835,
      "node_id": "MDQ6VXNlcjEwMTk4ODM1",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10198835?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/olveirap",
      "html_url": "https://github.com/olveirap",
      "followers_url": "https://api.github.com/users/olveirap/followers",
      "following_url": "https://api.github.com/users/olveirap/following{/other_user}",
      "gists_url": "https://api.github.com/users/olveirap/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/olveirap/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/olveirap/subscriptions",
      "organizations_url": "https://api.github.com/users/olveirap/orgs",
      "repos_url": "https://api.github.com/users/olveirap/repos",
      "events_url": "https://api.github.com/users/olveirap/events{/privacy}",
      "received_events_url": "https://api.github.com/users/olveirap/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-11T23:57:37Z",
    "updated_at": "2018-09-11T23:59:41Z",
    "author_association": "NONE",
    "body": "Because that would alter the order of the labels in a way that they are no longer assigned to the intended quantile. In the order of the labels it's implicitly passed the assignment to the bin, if you drop the second or the first and you drop the last label then you are arbitrarly changing the assigned labels.\r\n\r\nFirst label was to the first quantile, since first and second quantile are repeated upon calculating the bins, the correct label for the unique bins calculated is to be the one of the second quantile, since it's equivalent to using the following code:\r\n\r\n```python\r\nlabels = ['numbers_50q', 'numbers_75q', 'numbers_100q']\r\nquantiles = [.0,.5,.75,1.]\r\npd.qcut(x=df['numbers'],\r\nq=quantiles,\r\nlabels=labels)\r\n```\r\n\r\n    0     numbers_50q\r\n    1     numbers_50q\r\n    2     numbers_50q\r\n    3    numbers_100q\r\n    4    numbers_100q\r\n    5     numbers_75q\r\n    Name: numbers, dtype: category\r\n    Categories (3, object): [numbers_50q < numbers_75q < numbers_100q]"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/427073203",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22669#issuecomment-427073203",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22669",
    "id": 427073203,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzA3MzIwMw==",
    "user": {
      "login": "qris",
      "id": 754175,
      "node_id": "MDQ6VXNlcjc1NDE3NQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/754175?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/qris",
      "html_url": "https://github.com/qris",
      "followers_url": "https://api.github.com/users/qris/followers",
      "following_url": "https://api.github.com/users/qris/following{/other_user}",
      "gists_url": "https://api.github.com/users/qris/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/qris/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/qris/subscriptions",
      "organizations_url": "https://api.github.com/users/qris/orgs",
      "repos_url": "https://api.github.com/users/qris/repos",
      "events_url": "https://api.github.com/users/qris/events{/privacy}",
      "received_events_url": "https://api.github.com/users/qris/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-04T15:57:27Z",
    "updated_at": "2018-10-04T15:57:27Z",
    "author_association": "NONE",
    "body": "Here is an even simpler example. It works with duplicates='drop' alone:\r\n\r\n    >>> pandas.qcut([ord(x) for x in list('aaaaaabc')], q=3, retbins=True)\r\n    ValueError: Bin edges must be unique: array([ 97.,  97.,  97.,  99.]).\r\n    You can drop duplicate edges by setting the 'duplicates' kwarg\r\n\r\n    >>> pandas.qcut([ord(x) for x in list('aaaaaabc')], q=3, retbins=True, duplicates='drop')\r\n    ([(96.999, 99.0], (96.999, 99.0], (96.999, 99.0], (96.999, 99.0], (96.999, 99.0], (96.999, 99.0], (96.999, 99.0], (96.999, 99.0]]\r\n    Categories (1, interval[float64]): [(96.999, 99.0]], array([ 97.,  99.]))\r\n\r\nBut if you try to apply labels, then it fails:\r\n\r\n    >>> pandas.qcut([ord(x) for x in list('aaaaaabc')], q=3, retbins=True, duplicates='drop', labels=[1, 2, 3])\r\n    ValueError: Bin labels must be one fewer than the number of bin edges\r\n\r\nThere is no way to know in advance how many bin edges Pandas is going to drop, or even which ones it has dropped after the fact, so it's pretty much impossible to use `duplicates='drop'` and `labels` together reliably."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/427103436",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22669#issuecomment-427103436",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22669",
    "id": 427103436,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzEwMzQzNg==",
    "user": {
      "login": "olveirap",
      "id": 10198835,
      "node_id": "MDQ6VXNlcjEwMTk4ODM1",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10198835?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/olveirap",
      "html_url": "https://github.com/olveirap",
      "followers_url": "https://api.github.com/users/olveirap/followers",
      "following_url": "https://api.github.com/users/olveirap/following{/other_user}",
      "gists_url": "https://api.github.com/users/olveirap/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/olveirap/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/olveirap/subscriptions",
      "organizations_url": "https://api.github.com/users/olveirap/orgs",
      "repos_url": "https://api.github.com/users/olveirap/repos",
      "events_url": "https://api.github.com/users/olveirap/events{/privacy}",
      "received_events_url": "https://api.github.com/users/olveirap/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-04T17:28:21Z",
    "updated_at": "2018-10-04T17:28:21Z",
    "author_association": "NONE",
    "body": "Sorry, I found your example a bit convoluted, so this: \r\n`[ord(x) for x in list('aaaaaabc')`\r\nReturns this: \r\n`[97, 97, 97, 97, 97, 97, 98, 99]`\r\nWhat the code should try to do with q=3 is separate the numbers between the 0-percentile and 33-percentile in a bin, the same for 33-percentile and 66-percentile and lastly 66-percentile and 100-percenile. In the array above the value 97 is inside every bin, so what you get is a bin that goes from the 0-percentile to 100-percentile.\r\n\r\n> There is no way to know in advance how many bin edges Pandas is going to drop, or even which ones it has dropped after the fact, so it's pretty much impossible to use duplicates='drop' and labels together reliably.\r\n\r\nWhy? as far as I'm understanding the code, from this line: https://github.com/pandas-dev/pandas/blob/0409521665bd436a10aea7e06336066bf07ff057/pandas/core/reshape/tile.py#L327\r\nI think calculating the difference between bins and unique_bins is pretty straightforward. I'm aware that what labels to keep when dropping bins isn't as evident and it depends of the use of labels. \r\n\r\nIn my example, my labels referred to the upper limit of the bin and that's why I was pushing for dropping the ones before the first nonduplicate, but this could be configured with an optional parameter to behave in the opposite way, keeping the label from first duplicate bin and absorving the ones that come after.\r\n\r\nI'm aware that at this point I'm probably nitpicking about a functionality probably noone uses like me, I will try to do a fork with this functionality for myself if you don't find it would be proper to have it here"
  }
]
