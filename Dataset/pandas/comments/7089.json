[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/42702770",
    "html_url": "https://github.com/pandas-dev/pandas/pull/7089#issuecomment-42702770",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7089",
    "id": 42702770,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzAyNzcw",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-05-09T19:11:25Z",
    "updated_at": "2014-05-09T19:11:25Z",
    "author_association": "MEMBER",
    "body": "@jreback if u want to check this out... not exactly sure where the upcast issue is ... i construct `results` from the itemsize of the dtype, so any `float32` should be fine. can u check with other gruopby float32 methods?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/42713984",
    "html_url": "https://github.com/pandas-dev/pandas/pull/7089#issuecomment-42713984",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7089",
    "id": 42713984,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzEzOTg0",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-05-09T21:06:19Z",
    "updated_at": "2014-05-09T21:06:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "```\nC:\\Users\\Jeff Reback\\Documents\\GitHub\\pandas>c:\\python26-32\\Scripts\\nosetests.exe build\\lib.win32-2.6\\pandas\\tests\\test_groupby.py --pdb --pdb-failure\n\n.......................................> c:\\users\\jeff reback\\documents\\github\\pandas\\testing.pyx(136)pandas._testing.assert_almost_equal (pandas\\src\\\ntesting.c:2299)()\n(Pdb) u\n> c:\\users\\jeff reback\\documents\\github\\pandas\\testing.pyx(93)pandas._testing.assert_almost_equal (pandas\\src\\testing.c:1793)()\n(Pdb) u\n> c:\\users\\jeff reback\\documents\\github\\pandas\\testing.pyx(58)pandas._testing.assert_almost_equal (pandas\\src\\testing.c:2465)()\n(Pdb) u\n> c:\\users\\jeff reback\\documents\\github\\pandas\\build\\lib.win32-2.6\\pandas\\util\\testing.py(520)assert_series_equal()\n-> assert_almost_equal(left.values, right.values, check_less_precise)\n(Pdb) u\n> c:\\users\\jeff reback\\documents\\github\\pandas\\build\\lib.win32-2.6\\pandas\\util\\testing.py(573)assert_frame_equal()\n-> check_exact=check_exact)\n(Pdb) u\n> c:\\users\\jeff reback\\documents\\github\\pandas\\build\\lib.win32-2.6\\pandas\\tests\\test_groupby.py(2017)test_count()\n-> assert_frame_equal(count_not_as, expected.reset_index())\n(Pdb) l\n2012            count_as = df.groupby('A').count()\n2013            count_not_as = df.groupby('A', as_index=False).count()\n2014\n2015            expected = DataFrame([[1, 2], [0, 0]], columns=['B', 'C'], index=[1,3])\n2016            expected.index.name='A'\n2017 ->         assert_frame_equal(count_not_as, expected.reset_index())\n2018            assert_frame_equal(count_as, expected)\n2019\n2020            count_B = df.groupby('A')['B'].count()\n2021            assert_series_equal(count_B, expected['B'])\n2022\n(Pdb) p df\n   A   B    C\n0  1   2  foo\n1  1 NaN  bar\n2  3 NaN  NaN\n\n[3 rows x 3 columns]\n(Pdb) p count_not_as\n   A  B  C\n0  1  2  2\n1  3  1  1\n\n[2 rows x 3 columns]\n(Pdb) p expected.reset_index()\n   A  B  C\n0  1  1  2\n1  3  0  0\n\n[2 rows x 3 columns]\n(Pdb) p expected.reset_index().dtypes\nA    int64\nB    int64\nC    int64\ndtype: object\n(Pdb) p count_not_as.dtypes\nA    int64\nB    int64\nC    int64\ndtype: object\n(Pdb) c\nF> c:\\users\\jeff reback\\documents\\github\\pandas\\testing.pyx(136)pandas._testing.assert_almost_equal (pandas\\src\\testing.c:2299)()\n(Pdb) u\n> c:\\users\\jeff reback\\documents\\github\\pandas\\testing.pyx(93)pandas._testing.assert_almost_equal (pandas\\src\\testing.c:1793)()\n(Pdb) u\n> c:\\users\\jeff reback\\documents\\github\\pandas\\testing.pyx(58)pandas._testing.assert_almost_equal (pandas\\src\\testing.c:2465)()\n(Pdb) u\n> c:\\users\\jeff reback\\documents\\github\\pandas\\build\\lib.win32-2.6\\pandas\\util\\testing.py(520)assert_series_equal()\n-> assert_almost_equal(left.values, right.values, check_less_precise)\n(Pdb) u\n> c:\\users\\jeff reback\\documents\\github\\pandas\\build\\lib.win32-2.6\\pandas\\tests\\test_groupby.py(2034)test_count_object()\n-> tm.assert_series_equal(result, expected)\n(Pdb) l\n2029\n2030            df = pd.DataFrame({'a': ['a', np.nan, np.nan] + ['b'] * 3,\n2031                               'c': [2] * 3 + [3] * 3})\n2032            result = df.groupby('c').a.count()\n2033            expected = pd.Series([1, 3], index=[2, 3], name='a')\n2034 ->         tm.assert_series_equal(result, expected)\n2035\n2036        def test_non_cython_api(self):\n2037\n2038            # GH5610\n2039            # non-cython calls should not include the grouper\n(Pdb) p result\nc\n2    3\n3    3\nName: a, dtype: int64\n(Pdb) p expected\n2    1\n3    3\nName: a, dtype: int64\n(Pdb)\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/42721700",
    "html_url": "https://github.com/pandas-dev/pandas/pull/7089#issuecomment-42721700",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7089",
    "id": 42721700,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzIxNzAw",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-05-09T22:49:52Z",
    "updated_at": "2014-05-09T22:49:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "The problem is here: https://github.com/pydata/pandas/blob/master/pandas/core/groupby.py#L1398\n\nwhen evaluting the object type, a float result to hold the data is created (and not object type).\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/42722360",
    "html_url": "https://github.com/pandas-dev/pandas/pull/7089#issuecomment-42722360",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7089",
    "id": 42722360,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzIyMzYw",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-05-09T23:00:55Z",
    "updated_at": "2014-05-09T23:00:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "This patch fixes. Note that I still don't think we are testing what happens if the cython aggregation fails (but I am not sure what triggers it to fail anyhow, or if their are ANY tests for a cython function failling back).\n\n```\ndiff --git a/pandas/core/groupby.py b/pandas/core/groupby.py\nindex 094324d..b13b212 100644\n--- a/pandas/core/groupby.py\n+++ b/pandas/core/groupby.py\n@@ -1390,16 +1390,19 @@ class BaseGrouper(object):\n         if is_numeric_dtype(values.dtype):\n             values = com.ensure_float(values)\n             is_numeric = True\n+            out_dtype = 'f%d' % values.dtype.itemsize\n         else:\n             is_numeric = issubclass(values.dtype.type, (np.datetime64,\n                                                         np.timedelta64))\n+            out_dtype = 'float64'\n             if is_numeric:\n                 values = values.view('int64')\n             else:\n                 values = values.astype(object)\n\n         # will be filled in Cython function\n-        result = np.empty(out_shape, dtype='f%d' % values.dtype.itemsize)\n+        result = np.empty(out_shape, dtype=out_dtype)\n+\n         result.fill(np.nan)\n         counts = np.zeros(self.ngroups, dtype=np.int64)\n\ndiff --git a/pandas/tests/test_groupby.py b/pandas/tests/test_groupby.py\nindex 8b95748..c46ae4b 100644\n--- a/pandas/tests/test_groupby.py\n+++ b/pandas/tests/test_groupby.py\n@@ -2009,11 +2009,12 @@ class TestGroupBy(tm.TestCase):\n         df = pd.DataFrame([[1, 2, 'foo'], [1, nan, 'bar'], [3, nan, nan]],\n                           columns=['A', 'B', 'C'])\n\n+        expected = DataFrame([[1, 2], [0, 0]], columns=['B', 'C'], index=[1,3])\n+        expected.index.name='A'\n+\n         count_as = df.groupby('A').count()\n         count_not_as = df.groupby('A', as_index=False).count()\n\n-        expected = DataFrame([[1, 2], [0, 0]], columns=['B', 'C'], index=[1,3])\n-        expected.index.name='A'\n         assert_frame_equal(count_not_as, expected.reset_index())\n         assert_frame_equal(count_as, expected)\n\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/42744601",
    "html_url": "https://github.com/pandas-dev/pandas/pull/7089#issuecomment-42744601",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7089",
    "id": 42744601,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzQ0NjAx",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-05-10T15:18:41Z",
    "updated_at": "2014-05-10T15:18:41Z",
    "author_association": "MEMBER",
    "body": "@jreback i applied the patch. so this works on windows?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/42744714",
    "html_url": "https://github.com/pandas-dev/pandas/pull/7089#issuecomment-42744714",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7089",
    "id": 42744714,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzQ0NzE0",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-05-10T15:23:05Z",
    "updated_at": "2014-05-10T15:23:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "yep; I think the problem is that `dtype.itemsize` for object is 8 on linux and 4 on windows (for 32-bit)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/42744735",
    "html_url": "https://github.com/pandas-dev/pandas/pull/7089#issuecomment-42744735",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7089",
    "id": 42744735,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzQ0NzM1",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-05-10T15:23:43Z",
    "updated_at": "2014-05-10T15:23:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "thanks!\n\nwill let you know of any other windows issues\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/42744802",
    "html_url": "https://github.com/pandas-dev/pandas/pull/7089#issuecomment-42744802",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7089",
    "id": 42744802,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzQ0ODAy",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-05-10T15:26:01Z",
    "updated_at": "2014-05-10T15:26:01Z",
    "author_association": "MEMBER",
    "body": "ok i'll keep that in mind when doing other stuff with `object` dtype\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/42745845",
    "html_url": "https://github.com/pandas-dev/pandas/pull/7089#issuecomment-42745845",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7089",
    "id": 42745845,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzQ1ODQ1",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-05-10T16:01:29Z",
    "updated_at": "2014-05-10T16:01:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "ok...passes now on windows\n\nthanks!\n"
  }
]
