[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/40531385",
    "html_url": "https://github.com/pandas-dev/pandas/issues/6885#issuecomment-40531385",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/6885",
    "id": 40531385,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTMxMzg1",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-04-15T20:40:34Z",
    "updated_at": "2014-04-15T20:40:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "Could you try:\n\n``` python\nimport pandas as pd\nfrom StringIO import StringIO\n\ns = \"\"\"å,b\nœ,c\n\"\"\"\ndf = pd.read_csv(StringIO(s), header=None)\npd.get_dummies(df)\n```\n\nThis works fine on my machine. Or share a link to the file that generated your data and the code so we can try to reproduce the problem.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/40536004",
    "html_url": "https://github.com/pandas-dev/pandas/issues/6885#issuecomment-40536004",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/6885",
    "id": 40536004,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTM2MDA0",
    "user": {
      "login": "maxgrenderjones",
      "id": 6059365,
      "node_id": "MDQ6VXNlcjYwNTkzNjU=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/6059365?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maxgrenderjones",
      "html_url": "https://github.com/maxgrenderjones",
      "followers_url": "https://api.github.com/users/maxgrenderjones/followers",
      "following_url": "https://api.github.com/users/maxgrenderjones/following{/other_user}",
      "gists_url": "https://api.github.com/users/maxgrenderjones/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maxgrenderjones/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maxgrenderjones/subscriptions",
      "organizations_url": "https://api.github.com/users/maxgrenderjones/orgs",
      "repos_url": "https://api.github.com/users/maxgrenderjones/repos",
      "events_url": "https://api.github.com/users/maxgrenderjones/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maxgrenderjones/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-04-15T21:20:30Z",
    "updated_at": "2014-04-15T21:23:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for the assist!\n\n``` python\nimport pandas as pd\nfrom StringIO import StringIO\n\ns = \"\"\"letter,cat\nå,b\nœ,c\n\"\"\"\ndf = pd.read_csv(StringIO(s))\npd.get_dummies(df['letter'], prefix=u'foo')\n```\n\nreproduces the bug \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/40536835",
    "html_url": "https://github.com/pandas-dev/pandas/issues/6885#issuecomment-40536835",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/6885",
    "id": 40536835,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTM2ODM1",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-04-15T21:28:39Z",
    "updated_at": "2014-04-15T21:28:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think @hayd mentioned this\ntheir is a str somewhere inside which should encode if it fails\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/40538756",
    "html_url": "https://github.com/pandas-dev/pandas/issues/6885#issuecomment-40538756",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/6885",
    "id": 40538756,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTM4NzU2",
    "user": {
      "login": "hayd",
      "id": 1931852,
      "node_id": "MDQ6VXNlcjE5MzE4NTI=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1931852?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hayd",
      "html_url": "https://github.com/hayd",
      "followers_url": "https://api.github.com/users/hayd/followers",
      "following_url": "https://api.github.com/users/hayd/following{/other_user}",
      "gists_url": "https://api.github.com/users/hayd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hayd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hayd/subscriptions",
      "organizations_url": "https://api.github.com/users/hayd/orgs",
      "repos_url": "https://api.github.com/users/hayd/repos",
      "events_url": "https://api.github.com/users/hayd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hayd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-04-15T21:48:47Z",
    "updated_at": "2014-04-15T21:48:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "That one was in relation to `str.get_dummies`. This is slightly different, is it iterating through these incorrectly (as strings rather than unicode)?\n\n```\nipdb> levels\nIndex([u'å', u'œ'], dtype='object')\nipdb> levels[0]\n'\\xc3\\xa5'\nipdb> type(levels[0])\n<type 'str'>\nipdb> [v for v in levels]\n['\\xc3\\xa5', '\\xc5\\x93']\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/40539562",
    "html_url": "https://github.com/pandas-dev/pandas/issues/6885#issuecomment-40539562",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/6885",
    "id": 40539562,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTM5NTYy",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-04-15T21:56:34Z",
    "updated_at": "2014-04-15T21:56:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "that should be fine\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/40541786",
    "html_url": "https://github.com/pandas-dev/pandas/issues/6885#issuecomment-40541786",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/6885",
    "id": 40541786,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTQxNzg2",
    "user": {
      "login": "maxgrenderjones",
      "id": 6059365,
      "node_id": "MDQ6VXNlcjYwNTkzNjU=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/6059365?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maxgrenderjones",
      "html_url": "https://github.com/maxgrenderjones",
      "followers_url": "https://api.github.com/users/maxgrenderjones/followers",
      "following_url": "https://api.github.com/users/maxgrenderjones/following{/other_user}",
      "gists_url": "https://api.github.com/users/maxgrenderjones/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maxgrenderjones/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maxgrenderjones/subscriptions",
      "organizations_url": "https://api.github.com/users/maxgrenderjones/orgs",
      "repos_url": "https://api.github.com/users/maxgrenderjones/repos",
      "events_url": "https://api.github.com/users/maxgrenderjones/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maxgrenderjones/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-04-15T22:21:37Z",
    "updated_at": "2014-04-15T22:25:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "No. Issue is that it tries to create a column name for each of the different values in the columns. When it creates a column name for the dummy (and there's a prefix) it calls:\n\n``` python\ndummy_cols = ['%s%s%s' % (prefix, prefix_sep, str(v)) for v in levels]\n```\n\n(as per the stacktrace I pasted earlier)\n\nsince v (the value of the element in the category) is non-ascii-able unicode, calling `str(v)` explodes.\n\nInstead of calling `str(v)` you want to do something like `v if isintance(v, six.string_types) else safely_get_str(v)`\n\nIt may be sufficient to use `str` as `safely_get_str` as any object that implements a `__str__` method ought to return something rather than a unicode explosion (I think)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/40542489",
    "html_url": "https://github.com/pandas-dev/pandas/issues/6885#issuecomment-40542489",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/6885",
    "id": 40542489,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTQyNDg5",
    "user": {
      "login": "hayd",
      "id": 1931852,
      "node_id": "MDQ6VXNlcjE5MzE4NTI=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1931852?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hayd",
      "html_url": "https://github.com/hayd",
      "followers_url": "https://api.github.com/users/hayd/followers",
      "following_url": "https://api.github.com/users/hayd/following{/other_user}",
      "gists_url": "https://api.github.com/users/hayd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hayd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hayd/subscriptions",
      "organizations_url": "https://api.github.com/users/hayd/orgs",
      "repos_url": "https://api.github.com/users/hayd/repos",
      "events_url": "https://api.github.com/users/hayd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hayd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-04-15T22:29:42Z",
    "updated_at": "2014-04-15T22:29:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "It actually breaks in the format stage:\n\n```\nipdb> prefix\nu'foo'\nipdb> prefix_sep\n'_'\nipdb> str(v)  # weirdly this is the same as v\n'\\xc5\\x93'\nipdb> '%s%s%s' % (prefix, prefix_sep, str(v))\n*** UnicodeDecodeError: 'ascii' codec can't decode byte 0xc5 in position 0: ordinal not in range(128)\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/40544816",
    "html_url": "https://github.com/pandas-dev/pandas/issues/6885#issuecomment-40544816",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/6885",
    "id": 40544816,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTQ0ODE2",
    "user": {
      "login": "maxgrenderjones",
      "id": 6059365,
      "node_id": "MDQ6VXNlcjYwNTkzNjU=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/6059365?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maxgrenderjones",
      "html_url": "https://github.com/maxgrenderjones",
      "followers_url": "https://api.github.com/users/maxgrenderjones/followers",
      "following_url": "https://api.github.com/users/maxgrenderjones/following{/other_user}",
      "gists_url": "https://api.github.com/users/maxgrenderjones/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maxgrenderjones/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maxgrenderjones/subscriptions",
      "organizations_url": "https://api.github.com/users/maxgrenderjones/orgs",
      "repos_url": "https://api.github.com/users/maxgrenderjones/repos",
      "events_url": "https://api.github.com/users/maxgrenderjones/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maxgrenderjones/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-04-15T22:59:03Z",
    "updated_at": "2014-04-15T23:11:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "I assume changing it to u('%s%s%s') % (prefix, prefix_sep, str(v)) would be cheating? :)\n\nAlternative would be \n\n``` python\ntry:\n    dummy_cols = ['%s%s%s' % (prefix, prefix_sep, str(v)) for v in levels]\ncatch UnicodeDecodeError:\n    dummy_cols = [u('%s%s%s') % (prefix, prefix_sep, str(v)) for v in levels]\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/40551752",
    "html_url": "https://github.com/pandas-dev/pandas/issues/6885#issuecomment-40551752",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/6885",
    "id": 40551752,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTUxNzUy",
    "user": {
      "login": "hayd",
      "id": 1931852,
      "node_id": "MDQ6VXNlcjE5MzE4NTI=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1931852?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hayd",
      "html_url": "https://github.com/hayd",
      "followers_url": "https://api.github.com/users/hayd/followers",
      "following_url": "https://api.github.com/users/hayd/following{/other_user}",
      "gists_url": "https://api.github.com/users/hayd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hayd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hayd/subscriptions",
      "organizations_url": "https://api.github.com/users/hayd/orgs",
      "repos_url": "https://api.github.com/users/hayd/repos",
      "events_url": "https://api.github.com/users/hayd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hayd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-04-16T00:46:04Z",
    "updated_at": "2014-04-16T00:46:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "@maxgrenderjones I don't think that's cheating, in fact always returning unicode is IMO correct (i.e. just your second line). fancy putting together a PR ? :)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/40883881",
    "html_url": "https://github.com/pandas-dev/pandas/issues/6885#issuecomment-40883881",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/6885",
    "id": 40883881,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwODgzODgx",
    "user": {
      "login": "maxgrenderjones",
      "id": 6059365,
      "node_id": "MDQ6VXNlcjYwNTkzNjU=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/6059365?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maxgrenderjones",
      "html_url": "https://github.com/maxgrenderjones",
      "followers_url": "https://api.github.com/users/maxgrenderjones/followers",
      "following_url": "https://api.github.com/users/maxgrenderjones/following{/other_user}",
      "gists_url": "https://api.github.com/users/maxgrenderjones/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maxgrenderjones/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maxgrenderjones/subscriptions",
      "organizations_url": "https://api.github.com/users/maxgrenderjones/orgs",
      "repos_url": "https://api.github.com/users/maxgrenderjones/repos",
      "events_url": "https://api.github.com/users/maxgrenderjones/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maxgrenderjones/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-04-19T23:52:30Z",
    "updated_at": "2014-04-19T23:52:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think there's a bug in our test case. Changing the test to:\n\n``` python\nimport pandas as pd\nreload(pd.core)\nreload(pd.core)\nfrom StringIO import StringIO\n\ns = u\"\"\"letter,cat\nå,b\nœ,c\n\"\"\".encode('utf-8')\ndf = pd.read_csv(StringIO(s), encoding='utf-8')\nprint(df)\npd.get_dummies(df['letter'], prefix='foo')\n```\n\n(i.e. make sure that pandas knows it's reading unicode) and all that is needed to get correct output is to remove the call to `str`. You can't go wantonly surrounding things with `u()` as `u()` raises an Exception if its input is already unicode. Relevant line now reads:\n\n``` python\n    if prefix is not None:\n        dummy_cols = ['%s%s%s' % (prefix, prefix_sep, v)\n                      for v in levels]\n```\n\nTrivial change - if it's enough for a pull request, happy to create one. \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/40889131",
    "html_url": "https://github.com/pandas-dev/pandas/issues/6885#issuecomment-40889131",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/6885",
    "id": 40889131,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwODg5MTMx",
    "user": {
      "login": "hayd",
      "id": 1931852,
      "node_id": "MDQ6VXNlcjE5MzE4NTI=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1931852?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hayd",
      "html_url": "https://github.com/hayd",
      "followers_url": "https://api.github.com/users/hayd/followers",
      "following_url": "https://api.github.com/users/hayd/following{/other_user}",
      "gists_url": "https://api.github.com/users/hayd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hayd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hayd/subscriptions",
      "organizations_url": "https://api.github.com/users/hayd/orgs",
      "repos_url": "https://api.github.com/users/hayd/repos",
      "events_url": "https://api.github.com/users/hayd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hayd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-04-20T06:40:44Z",
    "updated_at": "2014-04-20T06:40:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "Definitely sounds like enough / would be a good PR, with the tests :)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/41791442",
    "html_url": "https://github.com/pandas-dev/pandas/issues/6885#issuecomment-41791442",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/6885",
    "id": 41791442,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzkxNDQy",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-04-30T12:40:32Z",
    "updated_at": "2014-04-30T12:40:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "closed by #6975\n"
  }
]
