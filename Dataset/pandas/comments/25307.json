[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/463508165",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25307#issuecomment-463508165",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25307",
    "id": 463508165,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2MzUwODE2NQ==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-14T06:30:56Z",
    "updated_at": "2019-02-14T06:30:56Z",
    "author_association": "MEMBER",
    "body": "What are you suggesting pandas to do here exactly? Your example shows a Series matches numpy behavior and the \"problem\" is documented limitation of the third party tool you are using, so I'm unclear on what pandas should be doing (though admittedly not terribly familiar with bottleneck)"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/463578834",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25307#issuecomment-463578834",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25307",
    "id": 463578834,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2MzU3ODgzNA==",
    "user": {
      "login": "lumbric",
      "id": 691772,
      "node_id": "MDQ6VXNlcjY5MTc3Mg==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/691772?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lumbric",
      "html_url": "https://github.com/lumbric",
      "followers_url": "https://api.github.com/users/lumbric/followers",
      "following_url": "https://api.github.com/users/lumbric/following{/other_user}",
      "gists_url": "https://api.github.com/users/lumbric/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lumbric/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lumbric/subscriptions",
      "organizations_url": "https://api.github.com/users/lumbric/orgs",
      "repos_url": "https://api.github.com/users/lumbric/repos",
      "events_url": "https://api.github.com/users/lumbric/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lumbric/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-14T10:37:37Z",
    "updated_at": "2019-02-16T11:55:48Z",
    "author_association": "NONE",
    "body": "I'm not sure what you mean by \"Series matches numpy behavior\". In the example above,  `np.mean()` returns the correct result `1.0`, but `pd.Series.mean()` returns `0.5`.\r\n\r\n<s>[Bottleneck's documentation](https://kwgoodman.github.io/bottleneck-doc/reference.html?highlight=overflow#bottleneck.nanmean) warns about overflows, but a naive user (like me) reading only the [pandas documentation](https://pandas.pydata.org/pandas-docs/version/0.24/reference/api/pandas.Series.mean.html) would not think about the dangers involved. When stumbling upon this behavior, I didn't even know that bottleneck is used behind the scenes (nor that it exists or that it is installed on my machine). To be honest, even after [reading Bottleneck's code](https://github.com/kwgoodman/bottleneck/blob/master/bottleneck/src/reduce_template.c#L162), I still don't understand the wrong result. How can a float32 overflow?</s>\r\n\r\n**Update:** it's not an overflow, it is a numerical error caused by naive summation in bottleneck.\r\n\r\nI think the best option in this case is, if pandas avoids using bottleneck for `dtype=float32`. At least this is what was [discussed in the xarray issue](https://github.com/pydata/xarray/issues/1346#issuecomment-456173428). Disclaimer: I'm not sure if I understand all details to suggest the best solution."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/464342481",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25307#issuecomment-464342481",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25307",
    "id": 464342481,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NDM0MjQ4MQ==",
    "user": {
      "login": "lumbric",
      "id": 691772,
      "node_id": "MDQ6VXNlcjY5MTc3Mg==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/691772?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lumbric",
      "html_url": "https://github.com/lumbric",
      "followers_url": "https://api.github.com/users/lumbric/followers",
      "following_url": "https://api.github.com/users/lumbric/following{/other_user}",
      "gists_url": "https://api.github.com/users/lumbric/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lumbric/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lumbric/subscriptions",
      "organizations_url": "https://api.github.com/users/lumbric/orgs",
      "repos_url": "https://api.github.com/users/lumbric/repos",
      "events_url": "https://api.github.com/users/lumbric/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lumbric/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-16T12:20:14Z",
    "updated_at": "2019-02-16T12:20:14Z",
    "author_association": "NONE",
    "body": "Oh, I think I misinterpreted the situation slightly. The wrong result is actually caused by numerical instability in bottleneck's implementation. That's still not good, but maybe different than an overflow. The hint in de documentation to overflow is not related.\r\n\r\nStill, I think it might make sense not to use bottleneck for 32bit."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/467037705",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25307#issuecomment-467037705",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25307",
    "id": 467037705,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NzAzNzcwNQ==",
    "user": {
      "login": "lumbric",
      "id": 691772,
      "node_id": "MDQ6VXNlcjY5MTc3Mg==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/691772?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lumbric",
      "html_url": "https://github.com/lumbric",
      "followers_url": "https://api.github.com/users/lumbric/followers",
      "following_url": "https://api.github.com/users/lumbric/following{/other_user}",
      "gists_url": "https://api.github.com/users/lumbric/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lumbric/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lumbric/subscriptions",
      "organizations_url": "https://api.github.com/users/lumbric/orgs",
      "repos_url": "https://api.github.com/users/lumbric/repos",
      "events_url": "https://api.github.com/users/lumbric/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lumbric/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-25T14:46:13Z",
    "updated_at": "2019-02-25T14:46:13Z",
    "author_association": "NONE",
    "body": "Is there still information missing here? Feel free to close the ticket if you are sure that this is not a pandas bug. I simply think it buts pandas users in danger of wrong results, so something should be done. Let me know, if I can help somehow."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/467041686",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25307#issuecomment-467041686",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25307",
    "id": 467041686,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NzA0MTY4Ng==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-25T14:56:37Z",
    "updated_at": "2019-02-25T14:56:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "Has xarray decided what to do for 32-bit?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/467049406",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25307#issuecomment-467049406",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25307",
    "id": 467049406,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NzA0OTQwNg==",
    "user": {
      "login": "lumbric",
      "id": 691772,
      "node_id": "MDQ6VXNlcjY5MTc3Mg==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/691772?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lumbric",
      "html_url": "https://github.com/lumbric",
      "followers_url": "https://api.github.com/users/lumbric/followers",
      "following_url": "https://api.github.com/users/lumbric/following{/other_user}",
      "gists_url": "https://api.github.com/users/lumbric/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lumbric/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lumbric/subscriptions",
      "organizations_url": "https://api.github.com/users/lumbric/orgs",
      "repos_url": "https://api.github.com/users/lumbric/repos",
      "events_url": "https://api.github.com/users/lumbric/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lumbric/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-25T15:15:44Z",
    "updated_at": "2019-02-25T15:15:44Z",
    "author_association": "NONE",
    "body": "Kind of. xarray's master is not affected anylonger, it has been fixed in pydata/xarray@0b9ab2d1 I'm not 100% sure if fixing this was the intention of the commit. The commit is titled \"Refactor nanops\" and the diff more than 1000 lines. So I'm not sure if this is a clear decision. The discussion is [here](https://github.com/pydata/xarray/issues/1346#issuecomment-456173428), the ticket is still open."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/468421135",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25307#issuecomment-468421135",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25307",
    "id": 468421135,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2ODQyMTEzNQ==",
    "user": {
      "login": "lumbric",
      "id": 691772,
      "node_id": "MDQ6VXNlcjY5MTc3Mg==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/691772?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lumbric",
      "html_url": "https://github.com/lumbric",
      "followers_url": "https://api.github.com/users/lumbric/followers",
      "following_url": "https://api.github.com/users/lumbric/following{/other_user}",
      "gists_url": "https://api.github.com/users/lumbric/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lumbric/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lumbric/subscriptions",
      "organizations_url": "https://api.github.com/users/lumbric/orgs",
      "repos_url": "https://api.github.com/users/lumbric/repos",
      "events_url": "https://api.github.com/users/lumbric/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lumbric/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-28T20:14:36Z",
    "updated_at": "2019-02-28T20:14:36Z",
    "author_association": "NONE",
    "body": "I think I found a hint, why xarray users might be more affacted than pandas users: the pagacke python3-xarray recommends python3-bottleneck in [Debian](https://packages.debian.org/buster/python3-xarray#pdeplegend) and [Ubuntu](https://packages.ubuntu.com/cosmic/python3-xarray), but python3-pandas does not recommend python3-bottleneck (neither in [Debian](https://packages.debian.org/buster/python3-pandas#pdeplegend) nor in [Ubuntu](https://packages.ubuntu.com/cosmic/python3-pandas))."
  }
]
