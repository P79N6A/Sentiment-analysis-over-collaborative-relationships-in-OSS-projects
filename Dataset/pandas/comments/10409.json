[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/114443756",
    "html_url": "https://github.com/pandas-dev/pandas/issues/10409#issuecomment-114443756",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/10409",
    "id": 114443756,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExNDQ0Mzc1Ng==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-06-23T10:54:13Z",
    "updated_at": "2015-06-23T10:54:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "ok, this works for a simple `concat`, but merging will not preserve the categoricals. Needs some post processing logic. Keep in mind this will ONLY work for identically categorized blocks. I think we originally left this out and didn't automagically recategorize, but let me see what I can do.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/115216231",
    "html_url": "https://github.com/pandas-dev/pandas/issues/10409#issuecomment-115216231",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/10409",
    "id": 115216231,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExNTIxNjIzMQ==",
    "user": {
      "login": "wikiped",
      "id": 5990528,
      "node_id": "MDQ6VXNlcjU5OTA1Mjg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/5990528?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wikiped",
      "html_url": "https://github.com/wikiped",
      "followers_url": "https://api.github.com/users/wikiped/followers",
      "following_url": "https://api.github.com/users/wikiped/following{/other_user}",
      "gists_url": "https://api.github.com/users/wikiped/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wikiped/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wikiped/subscriptions",
      "organizations_url": "https://api.github.com/users/wikiped/orgs",
      "repos_url": "https://api.github.com/users/wikiped/repos",
      "events_url": "https://api.github.com/users/wikiped/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wikiped/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-06-25T11:32:26Z",
    "updated_at": "2015-06-25T11:32:26Z",
    "author_association": "NONE",
    "body": "@jreback \n\n> Keep in mind this will ONLY work for identically categorized blocks.\n\nDo you mean that attempting to merge on `Categorical` with one of categories missing should normally fail like this:\n\n```\nA = pd.DataFrame({'X': np.random.choice(['foo', 'bar'],size=(5,)), \n                  'Y': np.random.choice(['one', 'two', 'three'], size=(5,))})\nA['X'] = A['X'].astype('category')\n\nB = pd.DataFrame({'X': np.random.choice(['foo', 'baz'],size=(5,)),   # baz instead of bar\n                  'Z': np.random.choice(['jjj', 'kkk', 'sss'], size=(5,))})\nB['X'] = B['X'].astype('category')\n\npd.merge(A, B, on='X', how='outer')\n```\n\nReturning error:\n\n```\nd:\\Anaconda\\envs\\py2k\\lib\\site-packages\\pandas\\core\\common.pyc in take_nd(arr, indexer, axis, out, fill_value, mask_info, allow_fill)\n    829         out_shape[axis] = len(indexer)\n    830         out_shape = tuple(out_shape)\n--> 831         if arr.flags.f_contiguous and axis == arr.ndim - 1:\n    832             # minor tweak that can make an order-of-magnitude difference\n    833             # for dataframes initialized directly from 2-d ndarrays\n\nAttributeError: 'Categorical' object has no attribute 'flags'\n```\n\nPerhaps it is linked to issue [#10374](https://github.com/pydata/pandas/issues/10374)...\n\nIdeally this would return a new `Categorical` with inserted `NaN`s.\n\nThe above was tried on pandas 0.16.2 \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/115217846",
    "html_url": "https://github.com/pandas-dev/pandas/issues/10409#issuecomment-115217846",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/10409",
    "id": 115217846,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExNTIxNzg0Ng==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-06-25T11:43:27Z",
    "updated_at": "2015-06-25T11:43:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "well aside from the bug in #10324 \n- An ordered Categorical merge should raise as the new ordering would be impossible to determine. \n- A merge on a Categorical and an object column would be ok with nan for any non-represented categories. \n- A merge with 2 different Categoricals I suppose could succeed with a union of the categoricals. \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/119207919",
    "html_url": "https://github.com/pandas-dev/pandas/issues/10409#issuecomment-119207919",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/10409",
    "id": 119207919,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExOTIwNzkxOQ==",
    "user": {
      "login": "joshlk",
      "id": 5648645,
      "node_id": "MDQ6VXNlcjU2NDg2NDU=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/5648645?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/joshlk",
      "html_url": "https://github.com/joshlk",
      "followers_url": "https://api.github.com/users/joshlk/followers",
      "following_url": "https://api.github.com/users/joshlk/following{/other_user}",
      "gists_url": "https://api.github.com/users/joshlk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/joshlk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/joshlk/subscriptions",
      "organizations_url": "https://api.github.com/users/joshlk/orgs",
      "repos_url": "https://api.github.com/users/joshlk/repos",
      "events_url": "https://api.github.com/users/joshlk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/joshlk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-07-07T13:53:48Z",
    "updated_at": "2015-07-07T13:53:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "Additionally the performance benefits of the underlying int representation of the categories are lost when doing the merge. For example:\n\n``` python\n# Here we are joining on a int column and appending two string columns\nA = pd.DataFrame({'X': np.random.choice(range(0, 10), size=(100000,)), \n                                'Y': np.random.choice(['one', 'two', 'three'], size=(100000,))})\n\nB = pd.DataFrame({'X': np.random.choice(range(0, 10), size=(100000,)), \n                                'Z': np.random.choice(['jjj', 'kkk', 'sss'], size=(100000,))})\n\n%time r = pd.merge(A, B, on='X')\nWall time: 57.3 s\n\n# Lets do the same but convert the appending columns 'Y' and 'Z' to a category\nA['Y'] = A['Y'].astype('category')\nB['Z'] = B['Z'].astype('category')\n\n%time r = pd.merge(A, B, on='X')\nWall time: 54.9 s          # Slightly less\n\n# Now lets use the int representation of the categorical columns and merge\nA['Y'] = A['Y'].cat.codes\nB['Z'] = B['Z'].cat.codes\n\n%time r = pd.merge(A, B, on='X')\nWall time: 41.7 s           # 72% of the original time taken\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/119208870",
    "html_url": "https://github.com/pandas-dev/pandas/issues/10409#issuecomment-119208870",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/10409",
    "id": 119208870,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExOTIwODg3MA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-07-07T13:56:01Z",
    "updated_at": "2015-07-07T13:56:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "@joshlk all true\n\nif u would like to try an impl would be great\nI will get to this but prob not for a little bit\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/263283983",
    "html_url": "https://github.com/pandas-dev/pandas/issues/10409#issuecomment-263283983",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/10409",
    "id": 263283983,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MzI4Mzk4Mw==",
    "user": {
      "login": "littlegreenbean33",
      "id": 18648417,
      "node_id": "MDQ6VXNlcjE4NjQ4NDE3",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18648417?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/littlegreenbean33",
      "html_url": "https://github.com/littlegreenbean33",
      "followers_url": "https://api.github.com/users/littlegreenbean33/followers",
      "following_url": "https://api.github.com/users/littlegreenbean33/following{/other_user}",
      "gists_url": "https://api.github.com/users/littlegreenbean33/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/littlegreenbean33/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/littlegreenbean33/subscriptions",
      "organizations_url": "https://api.github.com/users/littlegreenbean33/orgs",
      "repos_url": "https://api.github.com/users/littlegreenbean33/repos",
      "events_url": "https://api.github.com/users/littlegreenbean33/events{/privacy}",
      "received_events_url": "https://api.github.com/users/littlegreenbean33/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-28T14:26:53Z",
    "updated_at": "2016-11-28T14:26:53Z",
    "author_association": "NONE",
    "body": "\r\nHi,\r\n\r\nis there any plans to solve this issue ? losing categorical types when merging data frames ?\r\n\r\nThanks.\r\n\r\nJCG\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/263289360",
    "html_url": "https://github.com/pandas-dev/pandas/issues/10409#issuecomment-263289360",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/10409",
    "id": 263289360,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MzI4OTM2MA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-28T14:47:47Z",
    "updated_at": "2016-11-28T14:47:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "@littlegreenbean33 its an open issue. A community pull-request would make this go faster."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/263298212",
    "html_url": "https://github.com/pandas-dev/pandas/issues/10409#issuecomment-263298212",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/10409",
    "id": 263298212,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MzI5ODIxMg==",
    "user": {
      "login": "littlegreenbean33",
      "id": 18648417,
      "node_id": "MDQ6VXNlcjE4NjQ4NDE3",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18648417?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/littlegreenbean33",
      "html_url": "https://github.com/littlegreenbean33",
      "followers_url": "https://api.github.com/users/littlegreenbean33/followers",
      "following_url": "https://api.github.com/users/littlegreenbean33/following{/other_user}",
      "gists_url": "https://api.github.com/users/littlegreenbean33/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/littlegreenbean33/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/littlegreenbean33/subscriptions",
      "organizations_url": "https://api.github.com/users/littlegreenbean33/orgs",
      "repos_url": "https://api.github.com/users/littlegreenbean33/repos",
      "events_url": "https://api.github.com/users/littlegreenbean33/events{/privacy}",
      "received_events_url": "https://api.github.com/users/littlegreenbean33/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-28T15:20:28Z",
    "updated_at": "2016-11-28T15:20:28Z",
    "author_association": "NONE",
    "body": "Thanks for taking the time to respond. Regrettably my skills and competences won't allow me to pitch in.  "
  }
]
