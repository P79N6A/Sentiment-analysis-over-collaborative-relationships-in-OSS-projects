[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/472847469",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25723#issuecomment-472847469",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25723",
    "id": 472847469,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3Mjg0NzQ2OQ==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-14T13:13:44Z",
    "updated_at": "2019-03-14T13:13:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "cc @WillAyd do you recall when this changed?\r\n\r\n@Hugovdberg does passing that to `ExelFile.parse` work instead?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/472856685",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25723#issuecomment-472856685",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25723",
    "id": 472856685,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3Mjg1NjY4NQ==",
    "user": {
      "login": "Hugovdberg",
      "id": 6945503,
      "node_id": "MDQ6VXNlcjY5NDU1MDM=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6945503?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Hugovdberg",
      "html_url": "https://github.com/Hugovdberg",
      "followers_url": "https://api.github.com/users/Hugovdberg/followers",
      "following_url": "https://api.github.com/users/Hugovdberg/following{/other_user}",
      "gists_url": "https://api.github.com/users/Hugovdberg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Hugovdberg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Hugovdberg/subscriptions",
      "organizations_url": "https://api.github.com/users/Hugovdberg/orgs",
      "repos_url": "https://api.github.com/users/Hugovdberg/repos",
      "events_url": "https://api.github.com/users/Hugovdberg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Hugovdberg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-14T13:35:50Z",
    "updated_at": "2019-03-14T13:35:50Z",
    "author_association": "NONE",
    "body": "@TomAugspurger `on_demand` is used to open a connection to the file without loading all data in the file, which is the default behaviour of `xlrd`. The example I posted was from this question on StackExchange: https://stackoverflow.com/q/12250024/4398595.\r\n\r\nThis appears to have changed in version 0.24, when `ExcelFile` was decoupled from the `xlrd` implementation."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/472858365",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25723#issuecomment-472858365",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25723",
    "id": 472858365,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3Mjg1ODM2NQ==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-14T13:39:53Z",
    "updated_at": "2019-03-14T13:39:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for the clarification. So using `.parse` won't work because pandas has already opened the file?\r\n\r\nIn that case, is opening the file yourself with `on_demand=True` and passing that to pandas.ExcelFile an option?\r\n\r\nIt looks somewhat difficult to pass kwargs through to the opening of the file."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/472862204",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25723#issuecomment-472862204",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25723",
    "id": 472862204,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3Mjg2MjIwNA==",
    "user": {
      "login": "Hugovdberg",
      "id": 6945503,
      "node_id": "MDQ6VXNlcjY5NDU1MDM=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6945503?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Hugovdberg",
      "html_url": "https://github.com/Hugovdberg",
      "followers_url": "https://api.github.com/users/Hugovdberg/followers",
      "following_url": "https://api.github.com/users/Hugovdberg/following{/other_user}",
      "gists_url": "https://api.github.com/users/Hugovdberg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Hugovdberg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Hugovdberg/subscriptions",
      "organizations_url": "https://api.github.com/users/Hugovdberg/orgs",
      "repos_url": "https://api.github.com/users/Hugovdberg/repos",
      "events_url": "https://api.github.com/users/Hugovdberg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Hugovdberg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-14T13:48:43Z",
    "updated_at": "2019-03-14T13:48:43Z",
    "author_association": "NONE",
    "body": "I would think that the current implementation could pass the kwargs straight to the reader implementation, which could then handle the arguments as necessary. In this case I think it would suffice to add `**kwds` on lines [380](https://github.com/pandas-dev/pandas/blob/1700680381bdbfbc1abe9774f96881801b24d6ca/pandas/io/excel.py#L380), [422](https://github.com/pandas-dev/pandas/blob/1700680381bdbfbc1abe9774f96881801b24d6ca/pandas/io/excel.py#L422), [424](https://github.com/pandas-dev/pandas/blob/1700680381bdbfbc1abe9774f96881801b24d6ca/pandas/io/excel.py#L424), [642](https://github.com/pandas-dev/pandas/blob/1700680381bdbfbc1abe9774f96881801b24d6ca/pandas/io/excel.py#L642), and [653](https://github.com/pandas-dev/pandas/blob/1700680381bdbfbc1abe9774f96881801b24d6ca/pandas/io/excel.py#L653). Future readers should then also accept a `**kwds` argument, and handle those as necessary (possibly throwing an error that the engine doesn't accept additional arguments)."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/472888966",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25723#issuecomment-472888966",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25723",
    "id": 472888966,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3Mjg4ODk2Ng==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-14T14:35:31Z",
    "updated_at": "2019-03-14T14:35:31Z",
    "author_association": "MEMBER",
    "body": "Not at a computer to check but I think we recently disabled this because it was causing confusion. \n\nAre you sure on_demand was even get passed through? I didn’t think ExcelFile was passing along kwargs to open_workbook but was silently discarding. \n\nYou could alternately instantiate an xlrd Book with that argument and pass to ExcelFile. \n\nSent from my iPhone\n\n> On Mar 14, 2019, at 6:48 AM, Hugo van den Berg <notifications@github.com> wrote:\n> \n> I would think that the current implementation could pass the kwargs straight to the reader implementation, which could then handle the arguments as necessary. In this case I think it would suffice to add **kwds on lines 380, 422, 424, 642, and 653. Future readers should then also accept a **kwds argument, and handle those as necessary (possibly throwing an error that the engine doesn't accept additional arguments).\n> \n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub, or mute the thread.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/472916812",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25723#issuecomment-472916812",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25723",
    "id": 472916812,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MjkxNjgxMg==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-14T15:24:29Z",
    "updated_at": "2019-03-14T15:24:29Z",
    "author_association": "MEMBER",
    "body": "Right so this was intentionally changed in #24423. The keywords before were silently ignored so this actually had no effect - the error now is intentional and being explicit about this.\r\n\r\nAs mentioned can you try something like:\r\n\r\n```python\r\nbook = xlrd.open_workbook('your_book.xlsx', on_demand=True)\r\nwith pd.ExcelFile(book) as the_file:\r\n    ...\r\n```\r\n\r\nThat should actually do something with the keyword"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/472920647",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25723#issuecomment-472920647",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25723",
    "id": 472920647,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MjkyMDY0Nw==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-14T15:31:52Z",
    "updated_at": "2019-03-14T15:31:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for verifying @WillAyd. I agree that if you need control over how the file is opened, then opening it yourself and supplying the opened object to ExcelFile is the best option.\r\n\r\n@Hugovdberg would you be interested in submitting a PR explaining that at http://pandas-docs.github.io/pandas-docs-travis/user_guide/io.html?highlight=excelfile?"
  }
]
