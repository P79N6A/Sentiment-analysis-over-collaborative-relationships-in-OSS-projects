[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/63390798",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8844#issuecomment-63390798",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8844",
    "id": 63390798,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMzkwNzk4",
    "user": {
      "login": "seth-p",
      "id": 7441788,
      "node_id": "MDQ6VXNlcjc0NDE3ODg=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/7441788?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/seth-p",
      "html_url": "https://github.com/seth-p",
      "followers_url": "https://api.github.com/users/seth-p/followers",
      "following_url": "https://api.github.com/users/seth-p/following{/other_user}",
      "gists_url": "https://api.github.com/users/seth-p/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/seth-p/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/seth-p/subscriptions",
      "organizations_url": "https://api.github.com/users/seth-p/orgs",
      "repos_url": "https://api.github.com/users/seth-p/repos",
      "events_url": "https://api.github.com/users/seth-p/events{/privacy}",
      "received_events_url": "https://api.github.com/users/seth-p/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-17T22:44:10Z",
    "updated_at": "2014-11-17T22:54:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "Curiously doing a deep copy doesn't help:\n\n```\nIn [14]: dfa2 = dfa[dfa.columns[:2]].copy()\n\nIn [15]: dfa2.stack(dropna=False)\nOut[15]:\nnum     1\n  let\n0 A     0\n  B     0\n  C   NaN\n  D   NaN\n  E   NaN\n1 A     0\n  B     0\n  C   NaN\n  D   NaN\n  E   NaN\n```\n\nThough specifying all levels does:\n\n```\nIn [46]: dfa1.stack(level=[0,1], dropna=False)\nOut[46]:\n   num  let\n0  1    A      0\n        B      0\n1  1    A      0\n        B      0\ndtype: float64\n```\n\nOther variants:\n\n```\nIn [51]: dfa1.stack(level=0, dropna=False)\nOut[51]:\nlet    A  B\n  num\n0 1    0  0\n1 1    0  0\n\nIn [52]: dfa1.stack(level=1, dropna=False)\nOut[52]:\nnum     1\n  let\n0 A     0\n  B     0\n  C   NaN\n  D   NaN\n  E   NaN\n1 A     0\n  B     0\n  C   NaN\n  D   NaN\n  E   NaN\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/63395325",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8844#issuecomment-63395325",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8844",
    "id": 63395325,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMzk1MzI1",
    "user": {
      "login": "seth-p",
      "id": 7441788,
      "node_id": "MDQ6VXNlcjc0NDE3ODg=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/7441788?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/seth-p",
      "html_url": "https://github.com/seth-p",
      "followers_url": "https://api.github.com/users/seth-p/followers",
      "following_url": "https://api.github.com/users/seth-p/following{/other_user}",
      "gists_url": "https://api.github.com/users/seth-p/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/seth-p/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/seth-p/subscriptions",
      "organizations_url": "https://api.github.com/users/seth-p/orgs",
      "repos_url": "https://api.github.com/users/seth-p/repos",
      "events_url": "https://api.github.com/users/seth-p/events{/privacy}",
      "received_events_url": "https://api.github.com/users/seth-p/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-17T23:18:13Z",
    "updated_at": "2014-11-17T23:19:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "More oddities I don't understand:\n\n```\nIn [90]: dfb = pd.DataFrame(np.zeros((2,5)),\n   ....:                    columns=pd.MultiIndex.from_tuples([(1,'A'), (1,'B'), (2,'C'), (2,'D'), (3,'E')],\n   ....:                                                      names=['num', 'let']))\n\nIn [91]: dfb\nOut[91]:\nnum  1     2     3\nlet  A  B  C  D  E\n0    0  0  0  0  0\n1    0  0  0  0  0\n\nIn [92]: dfb1 = dfb[dfb.columns[:3]]\n\nIn [93]: dfb1\nOut[93]:\nnum  1     2\nlet  A  B  C\n0    0  0  0\n1    0  0  0\n\nIn [94]: dfb1.stack()\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-94-a43c6a602bfd> in <module>()\n----> 1 dfb1.stack()\n\nC:\\Python34\\lib\\site-packages\\pandas\\core\\frame.py in stack(self, level, dropna)\n   3430             return stack_multiple(self, level, dropna=dropna)\n   3431         else:\n-> 3432             return stack(self, level, dropna=dropna)\n   3433\n   3434     def unstack(self, level=-1):\n\nC:\\Python34\\lib\\site-packages\\pandas\\core\\reshape.py in stack(frame, level, dropna)\n    529\n    530     if isinstance(frame.columns, MultiIndex):\n--> 531         return _stack_multi_columns(frame, level=level, dropna=dropna)\n    532     elif isinstance(frame.index, MultiIndex):\n    533         new_levels = list(frame.index.levels)\n\nC:\\Python34\\lib\\site-packages\\pandas\\core\\reshape.py in _stack_multi_columns(frame, level, dropna)\n    648\n    649     if len(drop_cols) > 0:\n--> 650         new_columns = new_columns - drop_cols\n    651\n    652     N = len(this)\n\nC:\\Python34\\lib\\site-packages\\pandas\\core\\index.py in _evaluate_numeric_binop(self, other)\n   2139                 else:\n   2140                     if not (com.is_float(other) or com.is_integer(other)):\n-> 2141                         raise TypeError(\"can only perform ops with scalar values\")\n   2142\n   2143                 # if we are a reversed non-communative op\n\nTypeError: can only perform ops with scalar values\n\nIn [95]: dfb1.stack(level=0)\nOut[95]:\nlet     A   B   C\n  num\n0 1     0   0 NaN\n  2   NaN NaN   0\n1 1     0   0 NaN\n  2   NaN NaN   0\n\nIn [96]: dfb1.stack(level=1)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-96-c2c854f1a484> in <module>()\n----> 1 dfb1.stack(level=1)\n\nC:\\Python34\\lib\\site-packages\\pandas\\core\\frame.py in stack(self, level, dropna)\n   3430             return stack_multiple(self, level, dropna=dropna)\n   3431         else:\n-> 3432             return stack(self, level, dropna=dropna)\n   3433\n   3434     def unstack(self, level=-1):\n\nC:\\Python34\\lib\\site-packages\\pandas\\core\\reshape.py in stack(frame, level, dropna)\n    529\n    530     if isinstance(frame.columns, MultiIndex):\n--> 531         return _stack_multi_columns(frame, level=level, dropna=dropna)\n    532     elif isinstance(frame.index, MultiIndex):\n    533         new_levels = list(frame.index.levels)\n\nC:\\Python34\\lib\\site-packages\\pandas\\core\\reshape.py in _stack_multi_columns(frame, level, dropna)\n    648\n    649     if len(drop_cols) > 0:\n--> 650         new_columns = new_columns - drop_cols\n    651\n    652     N = len(this)\n\nC:\\Python34\\lib\\site-packages\\pandas\\core\\index.py in _evaluate_numeric_binop(self, other)\n   2139                 else:\n   2140                     if not (com.is_float(other) or com.is_integer(other)):\n-> 2141                         raise TypeError(\"can only perform ops with scalar values\")\n   2142\n   2143                 # if we are a reversed non-communative op\n\nTypeError: can only perform ops with scalar values\n\nIn [97]: dfb1.stack(level=[0,1])\nOut[97]:\n   num  let\n0  1    A      0\n        B      0\n   2    C      0\n1  1    A      0\n        B      0\n   2    C      0\ndtype: float64\n\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/63395723",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8844#issuecomment-63395723",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8844",
    "id": 63395723,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMzk1NzIz",
    "user": {
      "login": "seth-p",
      "id": 7441788,
      "node_id": "MDQ6VXNlcjc0NDE3ODg=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/7441788?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/seth-p",
      "html_url": "https://github.com/seth-p",
      "followers_url": "https://api.github.com/users/seth-p/followers",
      "following_url": "https://api.github.com/users/seth-p/following{/other_user}",
      "gists_url": "https://api.github.com/users/seth-p/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/seth-p/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/seth-p/subscriptions",
      "organizations_url": "https://api.github.com/users/seth-p/orgs",
      "repos_url": "https://api.github.com/users/seth-p/repos",
      "events_url": "https://api.github.com/users/seth-p/events{/privacy}",
      "received_events_url": "https://api.github.com/users/seth-p/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-17T23:21:41Z",
    "updated_at": "2014-11-17T23:22:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "And yet more oddities (I'd expect `[102]` to produce the same output as `[101]`):\n\n```\nIn [98]: dfb\nOut[98]:\nnum  1     2     3\nlet  A  B  C  D  E\n0    0  0  0  0  0\n1    0  0  0  0  0\n\nIn [99]: dfb2 = dfb[dfb.columns[:2]]\n\nIn [100]: dfb2\nOut[100]:\nnum  1\nlet  A  B\n0    0  0\n1    0  0\n\nIn [101]: dfb2.stack(level=[0,1])\nOut[101]:\n   num  let\n0  1    A      0\n        B      0\n1  1    A      0\n        B      0\ndtype: float64\n\nIn [102]: dfb2.stack(level=[0,1], dropna=False)\nOut[102]:\n   num  let\n0  1    A       0\n        B       0\n   2    A     NaN\n        B     NaN\n   3    A     NaN\n        B     NaN\n1  1    A       0\n        B       0\n   2    A     NaN\n        B     NaN\n   3    A     NaN\n        B     NaN\ndtype: float64\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/63396225",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8844#issuecomment-63396225",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8844",
    "id": 63396225,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMzk2MjI1",
    "user": {
      "login": "rockg",
      "id": 3195015,
      "node_id": "MDQ6VXNlcjMxOTUwMTU=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/3195015?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rockg",
      "html_url": "https://github.com/rockg",
      "followers_url": "https://api.github.com/users/rockg/followers",
      "following_url": "https://api.github.com/users/rockg/following{/other_user}",
      "gists_url": "https://api.github.com/users/rockg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rockg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rockg/subscriptions",
      "organizations_url": "https://api.github.com/users/rockg/orgs",
      "repos_url": "https://api.github.com/users/rockg/repos",
      "events_url": "https://api.github.com/users/rockg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rockg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-17T23:25:39Z",
    "updated_at": "2014-11-17T23:25:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "Regarding your last comment, `dropna=True` by default so I expect [101] and [102] to be different.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/63424691",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8844#issuecomment-63424691",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8844",
    "id": 63424691,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNDI0Njkx",
    "user": {
      "login": "seth-p",
      "id": 7441788,
      "node_id": "MDQ6VXNlcjc0NDE3ODg=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/7441788?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/seth-p",
      "html_url": "https://github.com/seth-p",
      "followers_url": "https://api.github.com/users/seth-p/followers",
      "following_url": "https://api.github.com/users/seth-p/following{/other_user}",
      "gists_url": "https://api.github.com/users/seth-p/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/seth-p/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/seth-p/subscriptions",
      "organizations_url": "https://api.github.com/users/seth-p/orgs",
      "repos_url": "https://api.github.com/users/seth-p/repos",
      "events_url": "https://api.github.com/users/seth-p/events{/privacy}",
      "received_events_url": "https://api.github.com/users/seth-p/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-18T05:30:19Z",
    "updated_at": "2014-11-18T05:30:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "But there are no NaNs, so I'd expect them to be the same.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/63457445",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8844#issuecomment-63457445",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8844",
    "id": 63457445,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNDU3NDQ1",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-18T11:36:34Z",
    "updated_at": "2014-11-18T11:36:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "this is somewhat related to this: https://github.com/pydata/pandas/issues/2770\n\nthough its an easy fix, just recompute the levels (rather than just take them as is). Index objects are shared, so you need to create a new one here. (rather than using the original and just appending levels). That's why you get the 'hidden' values showing up.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/63542471",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8844#issuecomment-63542471",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8844",
    "id": 63542471,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNTQyNDcx",
    "user": {
      "login": "seth-p",
      "id": 7441788,
      "node_id": "MDQ6VXNlcjc0NDE3ODg=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/7441788?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/seth-p",
      "html_url": "https://github.com/seth-p",
      "followers_url": "https://api.github.com/users/seth-p/followers",
      "following_url": "https://api.github.com/users/seth-p/following{/other_user}",
      "gists_url": "https://api.github.com/users/seth-p/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/seth-p/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/seth-p/subscriptions",
      "organizations_url": "https://api.github.com/users/seth-p/orgs",
      "repos_url": "https://api.github.com/users/seth-p/repos",
      "events_url": "https://api.github.com/users/seth-p/events{/privacy}",
      "received_events_url": "https://api.github.com/users/seth-p/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-18T20:52:01Z",
    "updated_at": "2014-11-18T20:52:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "So far as I can tell, all the problems listed above are solved by first calling the following function:\n\n```\ndef fix_multiindex_axes(obj):\n    for axis_number, axis_index in enumerate(obj.axes):\n        if isinstance(axis_index, pd.MultiIndex):\n            obj.set_axis(axis_number,\n                         pd.MultiIndex.from_tuples(axis_index.get_values(),\n                                                   names=axis_index.names))\n    return obj\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/63550389",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8844#issuecomment-63550389",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8844",
    "id": 63550389,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNTUwMzg5",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-18T21:41:33Z",
    "updated_at": "2014-11-18T21:41:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "@seth-p yes, that essentially recreates the index from scratch thereby removing an aliasing issues.\n\nThis should prob be done in unstack though. (with a method called out to MultiIndex, something like _deep_copy / _recreate or something similar).\n\nfyi, similar issue in #8850 \n\nlike to do a PR?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/63553382",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8844#issuecomment-63553382",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8844",
    "id": 63553382,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNTUzMzgy",
    "user": {
      "login": "rockg",
      "id": 3195015,
      "node_id": "MDQ6VXNlcjMxOTUwMTU=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/3195015?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rockg",
      "html_url": "https://github.com/rockg",
      "followers_url": "https://api.github.com/users/rockg/followers",
      "following_url": "https://api.github.com/users/rockg/following{/other_user}",
      "gists_url": "https://api.github.com/users/rockg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rockg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rockg/subscriptions",
      "organizations_url": "https://api.github.com/users/rockg/orgs",
      "repos_url": "https://api.github.com/users/rockg/repos",
      "events_url": "https://api.github.com/users/rockg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rockg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-18T21:59:58Z",
    "updated_at": "2014-11-18T21:59:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "And I think we need to be cognizant of speed issues here as well if we are talking about recreating the entire index again, namely, how does it perform on large frames (500,000x5 DataFrame)? \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/63582228",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8844#issuecomment-63582228",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8844",
    "id": 63582228,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNTgyMjI4",
    "user": {
      "login": "seth-p",
      "id": 7441788,
      "node_id": "MDQ6VXNlcjc0NDE3ODg=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/7441788?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/seth-p",
      "html_url": "https://github.com/seth-p",
      "followers_url": "https://api.github.com/users/seth-p/followers",
      "following_url": "https://api.github.com/users/seth-p/following{/other_user}",
      "gists_url": "https://api.github.com/users/seth-p/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/seth-p/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/seth-p/subscriptions",
      "organizations_url": "https://api.github.com/users/seth-p/orgs",
      "repos_url": "https://api.github.com/users/seth-p/repos",
      "events_url": "https://api.github.com/users/seth-p/events{/privacy}",
      "received_events_url": "https://api.github.com/users/seth-p/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-19T02:21:55Z",
    "updated_at": "2014-11-19T02:21:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "OK, I'll give it a shot, though if what I have in mind is right I don't think it will address #8850.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/63724427",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8844#issuecomment-63724427",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8844",
    "id": 63724427,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzI0NDI3",
    "user": {
      "login": "seth-p",
      "id": 7441788,
      "node_id": "MDQ6VXNlcjc0NDE3ODg=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/7441788?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/seth-p",
      "html_url": "https://github.com/seth-p",
      "followers_url": "https://api.github.com/users/seth-p/followers",
      "following_url": "https://api.github.com/users/seth-p/following{/other_user}",
      "gists_url": "https://api.github.com/users/seth-p/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/seth-p/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/seth-p/subscriptions",
      "organizations_url": "https://api.github.com/users/seth-p/orgs",
      "repos_url": "https://api.github.com/users/seth-p/repos",
      "events_url": "https://api.github.com/users/seth-p/events{/privacy}",
      "received_events_url": "https://api.github.com/users/seth-p/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-19T22:16:01Z",
    "updated_at": "2014-11-19T22:16:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "OK, I think I have this more or less done, but have a question about the desired behavior of `DataFrame.stack()` when the MultiIndex levels aren't sorted. Granted this is rare, as it appears that `MultiIndex.from_arrays()`, `MultiIndex.from_product()`, and `MultiIndex.from_tuples()` all produce sorted levels; but one can construct a `MultiIndex` with unsorted levels directly via the constructor.\n\nIn the following example (production 0.15.1), should `[140] df.stack()` and `[141] df1.stack()` not produce the same results?\n\n```\nIn [129]: mi = MultiIndex.from_tuples([('B','x'), ('B','z'), ('A','y'), ('C','x')],\n                                      names=['Upper', 'Lower'])\n\nIn [130]: mi1 = MultiIndex(levels=[['B','A','C'], ['y','x','z']],\n                           labels=[[0,0,1,2], [1,2,0,1]],\n                           names=['Upper', 'Lower'])\n\nIn [131]: mi\nOut[131]:\nMultiIndex(levels=[['A', 'B', 'C'], ['x', 'y', 'z']],\n           labels=[[1, 1, 0, 2], [0, 2, 1, 0]],\n           names=['Upper', 'Lower'])\n\nIn [132]: mi1\nOut[132]:\nMultiIndex(levels=[['B', 'A', 'C'], ['y', 'x', 'z']],\n           labels=[[0, 0, 1, 2], [1, 2, 0, 1]],\n           names=['Upper', 'Lower'])\n\nIn [133]: mi.get_values()\nOut[133]: array([('B', 'x'), ('B', 'z'), ('A', 'y'), ('C', 'x')], dtype=object)\n\nIn [134]: mi1.get_values()\nOut[134]: array([('B', 'x'), ('B', 'z'), ('A', 'y'), ('C', 'x')], dtype=object)\n\nIn [135]: df = DataFrame(np.arange(12).reshape(3,4), columns=mi)\n\nIn [136]: df1 = DataFrame(np.arange(12).reshape(3,4), columns=mi1)\n\nIn [137]: df\nOut[137]:\nUpper  B      A   C\nLower  x  z   y   x\n0      0  1   2   3\n1      4  5   6   7\n2      8  9  10  11\n\nIn [138]: df1\nOut[138]:\nUpper  B      A   C\nLower  x  z   y   x\n0      0  1   2   3\n1      4  5   6   7\n2      8  9  10  11\n\nIn [139]: df.equals(df1)\nOut[139]: True\n\nIn [140]: df.stack()\nOut[140]:\nUpper     A   B   C\n  Lower\n0 x     NaN   0   3\n  y       2 NaN NaN\n  z     NaN   1 NaN\n1 x     NaN   4   7\n  y       6 NaN NaN\n  z     NaN   5 NaN\n2 x     NaN   8  11\n  y      10 NaN NaN\n  z     NaN   9 NaN\n\nIn [141]: df1.stack()\nOut[141]:\nUpper     B   A   C\n  Lower\n0 y     NaN   2 NaN\n  x       0 NaN   3\n  z       1 NaN NaN\n1 y     NaN   6 NaN\n  x       4 NaN   7\n  z       5 NaN NaN\n2 y     NaN  10 NaN\n  x       8 NaN  11\n  z       9 NaN NaN\n\nIn [142]: df.stack().equals(df1.stack())\nOut[142]: False\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/63900531",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8844#issuecomment-63900531",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8844",
    "id": 63900531,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzOTAwNTMx",
    "user": {
      "login": "seth-p",
      "id": 7441788,
      "node_id": "MDQ6VXNlcjc0NDE3ODg=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/7441788?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/seth-p",
      "html_url": "https://github.com/seth-p",
      "followers_url": "https://api.github.com/users/seth-p/followers",
      "following_url": "https://api.github.com/users/seth-p/following{/other_user}",
      "gists_url": "https://api.github.com/users/seth-p/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/seth-p/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/seth-p/subscriptions",
      "organizations_url": "https://api.github.com/users/seth-p/orgs",
      "repos_url": "https://api.github.com/users/seth-p/repos",
      "events_url": "https://api.github.com/users/seth-p/events{/privacy}",
      "received_events_url": "https://api.github.com/users/seth-p/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-20T23:37:33Z",
    "updated_at": "2014-11-20T23:37:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jreback, I think this is done in #8855 pending the answer to the question above re: unordered `MultiIndex.levels`. Also, let me know if you think additional tests are required.\n"
  }
]
