[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/137986783",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11007#issuecomment-137986783",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11007",
    "id": 137986783,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzk4Njc4Mw==",
    "user": {
      "login": "terrytangyuan",
      "id": 4269898,
      "node_id": "MDQ6VXNlcjQyNjk4OTg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/4269898?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/terrytangyuan",
      "html_url": "https://github.com/terrytangyuan",
      "followers_url": "https://api.github.com/users/terrytangyuan/followers",
      "following_url": "https://api.github.com/users/terrytangyuan/following{/other_user}",
      "gists_url": "https://api.github.com/users/terrytangyuan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/terrytangyuan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/terrytangyuan/subscriptions",
      "organizations_url": "https://api.github.com/users/terrytangyuan/orgs",
      "repos_url": "https://api.github.com/users/terrytangyuan/repos",
      "events_url": "https://api.github.com/users/terrytangyuan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/terrytangyuan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-05T18:58:44Z",
    "updated_at": "2015-09-05T18:58:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jorisvandenbossche I got this bug when running your new example `df.to_excel('test_excel_duplicate_columns.xlsx')`:\n\n```\n/Library/Python/2.7/site-packages/openpyxl/styles/styleable.py:111: UserWarning: Use formatting objects such as font directly\n  warn(\"Use formatting objects such as font directly\")\n/Library/Python/2.7/site-packages/openpyxl/styles/__init__.py:52: UserWarning: Call to deprecated function or class copy (Copy formatting objects like font directly).\n  def copy(self):\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-4-66313a95798a> in <module>()\n----> 1 df.to_excel('test_excel_duplicate_columns.xlsx')\n\n/Library/Python/2.7/site-packages/pandas/core/frame.pyc in to_excel(self, excel_writer, sheet_name, na_rep, float_format, columns, header, index, index_label, startrow, startcol, engine, merge_cells, encoding, inf_rep)\n   1272         formatted_cells = formatter.get_formatted_cells()\n   1273         excel_writer.write_cells(formatted_cells, sheet_name,\n-> 1274                                  startrow=startrow, startcol=startcol)\n   1275         if need_save:\n   1276             excel_writer.save()\n\n/Library/Python/2.7/site-packages/pandas/io/excel.pyc in write_cells(self, cells, sheet_name, startrow, startcol)\n    776\n    777             if style_kwargs:\n--> 778                 xcell.style = xcell.style.copy(**style_kwargs)\n    779\n    780             if cell.mergestart is not None and cell.mergeend is not None:\n\n/Library/Python/2.7/site-packages/openpyxl/compat/__init__.pyc in new_func(*args, **kwargs)\n     65                 lineno=_code.co_firstlineno + 1\n     66             )\n---> 67             return obj(*args, **kwargs)\n     68         return new_func\n     69\n\nTypeError: copy() got an unexpected keyword argument 'font'\n```\n\nDo you know what went wrong? \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/137986806",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11007#issuecomment-137986806",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11007",
    "id": 137986806,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzk4NjgwNg==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-05T18:59:22Z",
    "updated_at": "2015-09-05T18:59:22Z",
    "author_association": "MEMBER",
    "body": "as @jreback said, you have to look at the openpyxl version\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/137987215",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11007#issuecomment-137987215",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11007",
    "id": 137987215,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzk4NzIxNQ==",
    "user": {
      "login": "terrytangyuan",
      "id": 4269898,
      "node_id": "MDQ6VXNlcjQyNjk4OTg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/4269898?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/terrytangyuan",
      "html_url": "https://github.com/terrytangyuan",
      "followers_url": "https://api.github.com/users/terrytangyuan/followers",
      "following_url": "https://api.github.com/users/terrytangyuan/following{/other_user}",
      "gists_url": "https://api.github.com/users/terrytangyuan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/terrytangyuan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/terrytangyuan/subscriptions",
      "organizations_url": "https://api.github.com/users/terrytangyuan/orgs",
      "repos_url": "https://api.github.com/users/terrytangyuan/repos",
      "events_url": "https://api.github.com/users/terrytangyuan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/terrytangyuan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-05T19:06:00Z",
    "updated_at": "2015-09-05T19:06:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "Still got this error after upgrade. (I was actually using the most updated one earlier)\n\n```\npd.__version__\nOut[4]: '0.16.2'\n\nopenpyxl.__version__\nOut[6]: '2.2.6'\n\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/137987261",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11007#issuecomment-137987261",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11007",
    "id": 137987261,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzk4NzI2MQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-05T19:07:20Z",
    "updated_at": "2015-09-05T19:07:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "yeh, that version is borked :)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/137987305",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11007#issuecomment-137987305",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11007",
    "id": 137987305,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzk4NzMwNQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-05T19:08:31Z",
    "updated_at": "2015-09-05T19:08:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "latest conda version is ok, its the pip version that is a problem (which we are not testing with .... :<)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/137987327",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11007#issuecomment-137987327",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11007",
    "id": 137987327,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzk4NzMyNw==",
    "user": {
      "login": "terrytangyuan",
      "id": 4269898,
      "node_id": "MDQ6VXNlcjQyNjk4OTg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/4269898?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/terrytangyuan",
      "html_url": "https://github.com/terrytangyuan",
      "followers_url": "https://api.github.com/users/terrytangyuan/followers",
      "following_url": "https://api.github.com/users/terrytangyuan/following{/other_user}",
      "gists_url": "https://api.github.com/users/terrytangyuan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/terrytangyuan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/terrytangyuan/subscriptions",
      "organizations_url": "https://api.github.com/users/terrytangyuan/orgs",
      "repos_url": "https://api.github.com/users/terrytangyuan/repos",
      "events_url": "https://api.github.com/users/terrytangyuan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/terrytangyuan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-05T19:09:08Z",
    "updated_at": "2015-09-05T19:09:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "Okay. I'll try conda then. \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/137987334",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11007#issuecomment-137987334",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11007",
    "id": 137987334,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzk4NzMzNA==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-05T19:09:17Z",
    "updated_at": "2015-09-05T19:12:06Z",
    "author_association": "MEMBER",
    "body": "There have been some duplicate-column fixes previously: #5237, but clearly not solved all.\n\ncc @neirbowj \ncc @jtratner \ncc @jmcnamara\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/140989293",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11007#issuecomment-140989293",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11007",
    "id": 140989293,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MDk4OTI5Mw==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-17T07:13:01Z",
    "updated_at": "2015-09-17T07:13:01Z",
    "author_association": "MEMBER",
    "body": "Another report of this on SO: http://stackoverflow.com/questions/32592526/potential-bug-in-pandas-xlsxwriter-pd-to-excel-not-working-well\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/141009032",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11007#issuecomment-141009032",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11007",
    "id": 141009032,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MTAwOTAzMg==",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-17T08:47:14Z",
    "updated_at": "2015-09-17T08:52:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think the code causing the issue the following (and was introduced by me):\n\n``` python\n        # Get a frame that will account for any duplicates in the column names.\n        col_mapped_frame = self.df.loc[:, self.columns]\n\n        # Write the body of the frame data series by series.\n        for colidx in range(len(self.columns)):\n            series = col_mapped_frame.iloc[:, colidx]\n            for i, val in enumerate(series):\n                yield ExcelCell(self.rowcounter + i, colidx + coloffset, val)\n\n```\n\nIf so then the `loc/iloc` code isn't retrieving/writing the column data in the correct order. Also, perhaps `len(self.columns)` should be `len(col_mapped_frame)`.\n\nAny suggestions on a better way to fix this?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/141019207",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11007#issuecomment-141019207",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11007",
    "id": 141019207,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MTAxOTIwNw==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-17T09:14:33Z",
    "updated_at": "2015-09-17T09:14:33Z",
    "author_association": "MEMBER",
    "body": "So the problem is of course that the `self.df.loc[:, self.columns]` is not working with duplicate column names. \nAs a small illustration:\n\n```\nIn [33]: df = pd.DataFrame([[1,2,3]], columns=['A','B','A'])\n\nIn [34]: df\nOut[34]:\n   A  B  A\n0  1  2  3\n\nIn [35]: df.loc[:, df.columns]\nOut[35]:\n   A  A  B  A  A\n0  1  3  2  1  3\n```\n\nSo a possible solution I think, is to only use `self.df.loc[:, self.columns]` if the user has specified `columns`, and otherwise just to use `df`. So maybe already in the init function to set `self.df = df.loc[:, cols]` if cols is not None and otherwise as `self.df = df` ?\n\n@jmcnamara do you have time to try to push a fix? Would be nice if we could still put this in 0.17 as this is quite a serious bug\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/141022001",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11007#issuecomment-141022001",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11007",
    "id": 141022001,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MTAyMjAwMQ==",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-17T09:29:06Z",
    "updated_at": "2015-09-17T09:29:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jorisvandenbossche I can work on a fix at the weekend.\n"
  }
]
