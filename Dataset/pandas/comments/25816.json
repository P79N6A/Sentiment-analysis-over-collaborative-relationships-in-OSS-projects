[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/475284316",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25816#issuecomment-475284316",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25816",
    "id": 475284316,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTI4NDMxNg==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-21T15:44:33Z",
    "updated_at": "2019-03-21T15:44:33Z",
    "author_association": "MEMBER",
    "body": "Can you provide the output of pd.show_versions\n\nSent from my iPhone\n\n> On Mar 20, 2019, at 11:13 PM, Yida Tao <notifications@github.com> wrote:\n> \n> Code Sample, a copy-pastable example if possible\n> \n> d = 1000000\n> df = pd.DataFrame({'A': np.random.randint(1,100,d)})\n> mapvalue = {i: i+1 for i in range(d)}\n> res = df['A'].replace(mapvalue)\n> Problem description\n> \n> This throws \"TypeError: Cannot compare types 'ndarray(dtype=int32)' and 'int'\".\n> \n> What's weird is that, the code works fine when d = 100000, 10000, 1000 or lower. The error occurs only when d = 1000000\n> \n> I found that if I changed line 3 to mapvalue = {i: i+1 for i in range(100)}, the problem goes away. However, the above behavior is still weird.\n> \n> pandas version: 0.24.2\n> numpy version: 1.16.2\n> \n> â€”\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub, or mute the thread.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/475471383",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25816#issuecomment-475471383",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25816",
    "id": 475471383,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTQ3MTM4Mw==",
    "user": {
      "login": "yidatao",
      "id": 1487820,
      "node_id": "MDQ6VXNlcjE0ODc4MjA=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/1487820?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yidatao",
      "html_url": "https://github.com/yidatao",
      "followers_url": "https://api.github.com/users/yidatao/followers",
      "following_url": "https://api.github.com/users/yidatao/following{/other_user}",
      "gists_url": "https://api.github.com/users/yidatao/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yidatao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yidatao/subscriptions",
      "organizations_url": "https://api.github.com/users/yidatao/orgs",
      "repos_url": "https://api.github.com/users/yidatao/repos",
      "events_url": "https://api.github.com/users/yidatao/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yidatao/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-22T02:24:12Z",
    "updated_at": "2019-03-22T02:24:12Z",
    "author_association": "NONE",
    "body": "@WillAyd the output of pd.show_versions is:\r\n```python\r\nINSTALLED VERSIONS\r\n------------------\r\ncommit: None\r\npython: 3.6.5.final.0\r\npython-bits: 64\r\nOS: Windows\r\nOS-release: 10\r\nmachine: AMD64\r\nprocessor: Intel64 Family 6 Model 142 Stepping 9, GenuineIntel\r\nbyteorder: little\r\nLC_ALL: None\r\nLANG: None\r\nLOCALE: None.None\r\n\r\npandas: 0.24.2\r\npytest: 3.5.1\r\npip: 10.0.1\r\nsetuptools: 39.1.0\r\nCython: 0.28.2\r\nnumpy: 1.16.2\r\nscipy: 1.2.1\r\npyarrow: None\r\nxarray: None\r\nIPython: 6.4.0\r\nsphinx: 1.7.4\r\npatsy: 0.5.0\r\ndateutil: 2.7.3\r\npytz: 2018.4\r\nblosc: None\r\nbottleneck: 1.2.1\r\ntables: 3.4.3\r\nnumexpr: 2.6.9\r\nfeather: None\r\nmatplotlib: 2.2.2\r\nopenpyxl: 2.5.3\r\nxlrd: 1.1.0\r\nxlwt: 1.3.0\r\nxlsxwriter: 1.0.4\r\nlxml.etree: 4.2.1\r\nbs4: 4.6.0\r\nhtml5lib: 1.0.1\r\nsqlalchemy: 1.2.7\r\npymysql: None\r\npsycopg2: None\r\njinja2: 2.10\r\ns3fs: None\r\nfastparquet: None\r\npandas_gbq: None\r\npandas_datareader: None\r\ngcsfs: None\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/475473443",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25816#issuecomment-475473443",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25816",
    "id": 475473443,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTQ3MzQ0Mw==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-22T02:36:24Z",
    "updated_at": "2019-03-22T02:36:24Z",
    "author_association": "MEMBER",
    "body": "Can you also provide full traceback?\r\n\r\nFWIW I don't get the same error but this just crashes for me on OSX"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/475474518",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25816#issuecomment-475474518",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25816",
    "id": 475474518,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTQ3NDUxOA==",
    "user": {
      "login": "yidatao",
      "id": 1487820,
      "node_id": "MDQ6VXNlcjE0ODc4MjA=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/1487820?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yidatao",
      "html_url": "https://github.com/yidatao",
      "followers_url": "https://api.github.com/users/yidatao/followers",
      "following_url": "https://api.github.com/users/yidatao/following{/other_user}",
      "gists_url": "https://api.github.com/users/yidatao/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yidatao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yidatao/subscriptions",
      "organizations_url": "https://api.github.com/users/yidatao/orgs",
      "repos_url": "https://api.github.com/users/yidatao/repos",
      "events_url": "https://api.github.com/users/yidatao/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yidatao/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-22T02:42:53Z",
    "updated_at": "2019-03-22T02:42:53Z",
    "author_association": "NONE",
    "body": "@WillAyd Here it goes:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-28-67d66ee1971a> in <module>()\r\n      2 df = pd.DataFrame({'A': np.random.randint(1,100,d)})\r\n      3 mapvalue = {i: i+1 for i in range(d)}\r\n----> 4 res = df['A'].replace(mapvalue)\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\pandas\\core\\series.py in replace(self, to_replace, value, inplace, limit, regex, method)\r\n   3843         return super(Series, self).replace(to_replace=to_replace, value=value,\r\n   3844                                            inplace=inplace, limit=limit,\r\n-> 3845                                            regex=regex, method=method)\r\n   3846 \r\n   3847     @Appender(generic._shared_docs['shift'] % _shared_doc_kwargs)\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\pandas\\core\\generic.py in replace(self, to_replace, value, inplace, limit, regex, method)\r\n   6496 \r\n   6497             return self.replace(to_replace, value, inplace=inplace,\r\n-> 6498                                 limit=limit, regex=regex)\r\n   6499         else:\r\n   6500 \r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\pandas\\core\\series.py in replace(self, to_replace, value, inplace, limit, regex, method)\r\n   3843         return super(Series, self).replace(to_replace=to_replace, value=value,\r\n   3844                                            inplace=inplace, limit=limit,\r\n-> 3845                                            regex=regex, method=method)\r\n   3846 \r\n   3847     @Appender(generic._shared_docs['shift'] % _shared_doc_kwargs)\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\pandas\\core\\generic.py in replace(self, to_replace, value, inplace, limit, regex, method)\r\n   6545                                                        dest_list=value,\r\n   6546                                                        inplace=inplace,\r\n-> 6547                                                        regex=regex)\r\n   6548 \r\n   6549                 else:  # [NA, ''] -> 0\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\pandas\\core\\internals\\managers.py in replace_list(self, src_list, dest_list, inplace, regex)\r\n    557             return _compare_or_regex_search(values, s, regex)\r\n    558 \r\n--> 559         masks = [comp(s, regex) for i, s in enumerate(src_list)]\r\n    560 \r\n    561         result_blocks = []\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\pandas\\core\\internals\\managers.py in <listcomp>(.0)\r\n    557             return _compare_or_regex_search(values, s, regex)\r\n    558 \r\n--> 559         masks = [comp(s, regex) for i, s in enumerate(src_list)]\r\n    560 \r\n    561         result_blocks = []\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\pandas\\core\\internals\\managers.py in comp(s, regex)\r\n    555                 return _compare_or_regex_search(maybe_convert_objects(values),\r\n    556                                                 getattr(s, 'asm8'), regex)\r\n--> 557             return _compare_or_regex_search(values, s, regex)\r\n    558 \r\n    559         masks = [comp(s, regex) for i, s in enumerate(src_list)]\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\lib\\site-packages\\pandas\\core\\internals\\managers.py in _compare_or_regex_search(a, b, regex)\r\n   1949         raise TypeError(\r\n   1950             \"Cannot compare types {a!r} and {b!r}\".format(a=type_names[0],\r\n-> 1951                                                           b=type_names[1]))\r\n   1952     return result\r\n   1953 \r\n\r\nTypeError: Cannot compare types 'ndarray(dtype=int32)' and 'int'\r\n\r\n```"
  }
]
