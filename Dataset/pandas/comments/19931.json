[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/369041608",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19931#issuecomment-369041608",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19931",
    "id": 369041608,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2OTA0MTYwOA==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-27T21:59:36Z",
    "updated_at": "2018-02-27T21:59:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "You code works for me without throwing. Can you post the full traceback?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/369042438",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19931#issuecomment-369042438",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19931",
    "id": 369042438,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2OTA0MjQzOA==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-27T22:02:21Z",
    "updated_at": "2018-02-27T22:02:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "I do get a warning when closing that processes about a still-open file though\r\n\r\n```\r\nClosing remaining open files:<filename>.hdf...done\r\n```\r\n\r\ndid you run that multiple times? If so, that would make sense I think since you `self.tt` is open at the end?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/369046473",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19931#issuecomment-369046473",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19931",
    "id": 369046473,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2OTA0NjQ3Mw==",
    "user": {
      "login": "spott",
      "id": 53284,
      "node_id": "MDQ6VXNlcjUzMjg0",
      "avatar_url": "https://avatars2.githubusercontent.com/u/53284?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/spott",
      "html_url": "https://github.com/spott",
      "followers_url": "https://api.github.com/users/spott/followers",
      "following_url": "https://api.github.com/users/spott/following{/other_user}",
      "gists_url": "https://api.github.com/users/spott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/spott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/spott/subscriptions",
      "organizations_url": "https://api.github.com/users/spott/orgs",
      "repos_url": "https://api.github.com/users/spott/repos",
      "events_url": "https://api.github.com/users/spott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/spott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-27T22:16:40Z",
    "updated_at": "2018-02-27T22:16:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "```python\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-12-fdea65d60c59> in <module>()\r\n----> 1 Foo()\r\n\r\n<ipython-input-11-2fa5d70ccf4d> in __init__(self)\r\n      3 class Foo():\r\n      4     def __init__(self):\r\n----> 5         self.tt = pd.HDFStore('<filename>.hdf', mode = 'a')\r\n      6         self.tt.close()\r\n      7         self.tt = pd.HDFStore('<filename>.hdf', mode='r')\r\n\r\n~/.virtualenvs/idnet_conv_net--ROjEtZd/lib/python3.6/site-packages/pandas/io/pytables.py in __init__(self, path, mode, complevel, complib, fletcher32, **kwargs)\r\n    465         self._fletcher32 = fletcher32\r\n    466         self._filters = None\r\n--> 467         self.open(mode=mode, **kwargs)\r\n    468 \r\n    469     def __fspath__(self):\r\n\r\n~/.virtualenvs/idnet_conv_net--ROjEtZd/lib/python3.6/site-packages/pandas/io/pytables.py in open(self, mode, **kwargs)\r\n    603                             hdf_version=tables.get_hdf5_version()))\r\n    604 \r\n--> 605             raise e\r\n    606 \r\n    607         except (Exception) as e:\r\n\r\n~/.virtualenvs/idnet_conv_net--ROjEtZd/lib/python3.6/site-packages/pandas/io/pytables.py in open(self, mode, **kwargs)\r\n    578 \r\n    579         try:\r\n--> 580             self._handle = tables.open_file(self._path, self._mode, **kwargs)\r\n    581         except (IOError) as e:  # pragma: no cover\r\n    582             if 'can not be written' in str(e):\r\n\r\n~/.virtualenvs/idnet_conv_net--ROjEtZd/lib/python3.6/site-packages/tables/file.py in open_file(filename, mode, title, root_uep, filters, **kwargs)\r\n    310                     \"The file '%s' is already opened, but \"\r\n    311                     \"in read-only mode.  Please close it before \"\r\n--> 312                     \"reopening in append mode.\" % filename)\r\n    313             # 'w' means that we want to destroy existing contents\r\n    314             elif mode == 'w':\r\n\r\nValueError: The file '<filename>.hdf' is already opened, but in read-only mode.  Please close it before reopening in append mode.\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/369050088",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19931#issuecomment-369050088",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19931",
    "id": 369050088,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2OTA1MDA4OA==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-27T22:29:50Z",
    "updated_at": "2018-02-27T22:30:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "Can you post the output of running that as a script? e.g. if the file is\r\n\r\n```python\r\n# foo.py\r\nimport pandas as pd\r\n\r\nclass Foo():\r\n    def __init__(self):\r\n        self.tt = pd.HDFStore('<filename>.hdf', mode = 'a')\r\n        self.tt.close()\r\n        self.tt = pd.HDFStore('<filename>.hdf', mode='r')\r\n\r\nFoo()\r\n```\r\n\r\nwhat's the output of `python foo.py`?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/369052203",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19931#issuecomment-369052203",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19931",
    "id": 369052203,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2OTA1MjIwMw==",
    "user": {
      "login": "spott",
      "id": 53284,
      "node_id": "MDQ6VXNlcjUzMjg0",
      "avatar_url": "https://avatars2.githubusercontent.com/u/53284?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/spott",
      "html_url": "https://github.com/spott",
      "followers_url": "https://api.github.com/users/spott/followers",
      "following_url": "https://api.github.com/users/spott/following{/other_user}",
      "gists_url": "https://api.github.com/users/spott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/spott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/spott/subscriptions",
      "organizations_url": "https://api.github.com/users/spott/orgs",
      "repos_url": "https://api.github.com/users/spott/repos",
      "events_url": "https://api.github.com/users/spott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/spott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-27T22:37:45Z",
    "updated_at": "2018-02-27T22:37:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "It looks like you are right, it is attempting to reopen the same file, and running into issues there.\r\n\r\nThere isn't a way to close a file when an object is destroyed in python, is there?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/369102601",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19931#issuecomment-369102601",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19931",
    "id": 369102601,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2OTEwMjYwMQ==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-28T02:44:47Z",
    "updated_at": "2018-02-28T02:44:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "That's up to the file object choosing to implement `__del__` or not. IIRC, implementing `__del__` to close file handles properly is tricky, especially when the user can just close it manually, or even better use a context manager."
  }
]
