[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/471642689",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25656#issuecomment-471642689",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25656",
    "id": 471642689,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MTY0MjY4OQ==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-11T17:34:35Z",
    "updated_at": "2019-03-11T17:34:35Z",
    "author_association": "MEMBER",
    "body": "The `func` argument is documented as follows:\r\n\r\n```\r\nMust produce a single value from an ndarray input if raw=True or a Series if raw=False.\r\n```\r\n\r\nSo the problem is that your expression doesn't reduce to a scalar. \r\n\r\nWhat distinction are you trying to make with Series here? This will fail if you replace with a NumPy array as well (though admittedly with a different error message)"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/472514346",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25656#issuecomment-472514346",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25656",
    "id": 472514346,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MjUxNDM0Ng==",
    "user": {
      "login": "js3711",
      "id": 15849929,
      "node_id": "MDQ6VXNlcjE1ODQ5OTI5",
      "avatar_url": "https://avatars3.githubusercontent.com/u/15849929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/js3711",
      "html_url": "https://github.com/js3711",
      "followers_url": "https://api.github.com/users/js3711/followers",
      "following_url": "https://api.github.com/users/js3711/following{/other_user}",
      "gists_url": "https://api.github.com/users/js3711/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/js3711/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/js3711/subscriptions",
      "organizations_url": "https://api.github.com/users/js3711/orgs",
      "repos_url": "https://api.github.com/users/js3711/repos",
      "events_url": "https://api.github.com/users/js3711/events{/privacy}",
      "received_events_url": "https://api.github.com/users/js3711/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-13T17:02:42Z",
    "updated_at": "2019-03-13T17:02:42Z",
    "author_association": "NONE",
    "body": "Yup, that makes it clearer.  It initially read as though multiple values could be returned through the Series"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/473491280",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25656#issuecomment-473491280",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25656",
    "id": 473491280,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MzQ5MTI4MA==",
    "user": {
      "login": "lycanthropes",
      "id": 38000321,
      "node_id": "MDQ6VXNlcjM4MDAwMzIx",
      "avatar_url": "https://avatars3.githubusercontent.com/u/38000321?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lycanthropes",
      "html_url": "https://github.com/lycanthropes",
      "followers_url": "https://api.github.com/users/lycanthropes/followers",
      "following_url": "https://api.github.com/users/lycanthropes/following{/other_user}",
      "gists_url": "https://api.github.com/users/lycanthropes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lycanthropes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lycanthropes/subscriptions",
      "organizations_url": "https://api.github.com/users/lycanthropes/orgs",
      "repos_url": "https://api.github.com/users/lycanthropes/repos",
      "events_url": "https://api.github.com/users/lycanthropes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lycanthropes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-16T02:31:37Z",
    "updated_at": "2019-03-16T02:34:06Z",
    "author_association": "NONE",
    "body": "> The `func` argument is documented as follows:\r\n> \r\n> ```\r\n> Must produce a single value from an ndarray input if raw=True or a Series if raw=False.\r\n> ```\r\n> So the problem is that your expression doesn't reduce to a scalar.\r\n> \r\n> What distinction are you trying to make with Series here? This will fail if you replace with a NumPy array as well (though admittedly with a different error message)\r\n\r\nI want to realize some ideas like this:\r\n**df.groupby('stock_code').rolling(window=12).apply(wavg,'column1',weight_variable)**\r\nthis means  applying a given weight variable to a rolling  column (here it is df.column1). But I can not design a available wavg function .My wavg function is:\r\n**def wavg(group, avg_name):\r\n    d = group[avg_name]\r\n    w = pd.Series(data=[0,0,0.5,0,0,0.5,0,0,0.5,0,0,1])\r\n    d=d.reset_index(drop=True)\r\n    try:\r\n        return (d * w).sum() / w.sum()\r\n    except ZeroDivisionError:\r\n        return np.nan**\r\nBut when I run the code : df.groupby('stock_code').rolling(window=12).apply(wavg,'column1',weight_variable), it always return a **TypeError: wavg() missing 1 required positional argument: 'avg_name'**"
  }
]
