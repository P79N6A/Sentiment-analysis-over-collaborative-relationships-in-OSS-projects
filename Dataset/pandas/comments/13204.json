[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/219750363",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13204#issuecomment-219750363",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13204",
    "id": 219750363,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxOTc1MDM2Mw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-05-17T15:15:09Z",
    "updated_at": "2016-05-17T15:15:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "pls post an example & show_versions. SO links are nice, but an in-line example much better.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/219781964",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13204#issuecomment-219781964",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13204",
    "id": 219781964,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxOTc4MTk2NA==",
    "user": {
      "login": "dsm054",
      "id": 980054,
      "node_id": "MDQ6VXNlcjk4MDA1NA==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/980054?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dsm054",
      "html_url": "https://github.com/dsm054",
      "followers_url": "https://api.github.com/users/dsm054/followers",
      "following_url": "https://api.github.com/users/dsm054/following{/other_user}",
      "gists_url": "https://api.github.com/users/dsm054/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dsm054/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dsm054/subscriptions",
      "organizations_url": "https://api.github.com/users/dsm054/orgs",
      "repos_url": "https://api.github.com/users/dsm054/repos",
      "events_url": "https://api.github.com/users/dsm054/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dsm054/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-05-17T16:54:39Z",
    "updated_at": "2016-05-17T16:54:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "FWIW my example would be something like\n\n```\n>>> pd.__version__\n'0.18.1'\n>>> \n>>> df = pd.DataFrame({\"A\": [1,1,1], \"B\": [2,2,2], \"C\": pd.Categorical([1,2,3])})\n>>> df.groupby([\"A\",\"C\"]).sum().reset_index()\n   A  C  B\n0  1  1  2\n1  1  2  2\n2  1  3  2\n>>> df.groupby([\"A\",\"C\"],as_index=False).sum()\n      A   C   B\nA C            \n1 1 NaN NaN NaN\n  2 NaN NaN NaN\n  3 NaN NaN NaN\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/219785210",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13204#issuecomment-219785210",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13204",
    "id": 219785210,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxOTc4NTIxMA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-05-17T17:05:34Z",
    "updated_at": "2016-05-17T17:05:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "yeah, this is reindexing I think somewhere inside and is prob not setting it up right. pull-requests welcome.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/223997260",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13204#issuecomment-223997260",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13204",
    "id": 223997260,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyMzk5NzI2MA==",
    "user": {
      "login": "pijucha",
      "id": 9507544,
      "node_id": "MDQ6VXNlcjk1MDc1NDQ=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/9507544?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pijucha",
      "html_url": "https://github.com/pijucha",
      "followers_url": "https://api.github.com/users/pijucha/followers",
      "following_url": "https://api.github.com/users/pijucha/following{/other_user}",
      "gists_url": "https://api.github.com/users/pijucha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pijucha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pijucha/subscriptions",
      "organizations_url": "https://api.github.com/users/pijucha/orgs",
      "repos_url": "https://api.github.com/users/pijucha/repos",
      "events_url": "https://api.github.com/users/pijucha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pijucha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-06-06T15:37:53Z",
    "updated_at": "2016-06-07T00:20:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "Looks quite easy to fix. Function [`_reindex_output()`](https://github.com/pydata/pandas/blob/master/pandas/core/groupby.py#L3724) doesn't take account of the variable `self.as_index`. \n\nAnother issue in the same function. The [multiindex](https://github.com/pydata/pandas/blob/master/pandas/core/groupby.py#L3724) loses information about dtypes. For example:\n\n``` python\ndf = pd.DataFrame({'cat': pd.Categorical([5,6,6,7,7], [5,6,7,8]),\n                  'i1' : [10, 11, 11, 10, 11],\n                  'i2' : [101,102,102,102,103]})\n\ndf.groupby(['cat', 'i1']).sum().reset_index().dtypes\nOut[12]: \ncat      int64\ni1       int64\ni2     float64\ndtype: object\n```\n\nWhile for a usual one level index:\n\n``` python\ndf.groupby(['cat']).sum().reset_index().dtypes\nOut[13]: \ncat    category\ni1      float64\ni2      float64\ndtype: object\n```\n\nAnd I guess `df.groupby(..., as_index=False).agg(...)` should be consistent with `df.groupby(..., as_index=True).agg(...).reset_index()`.\n\n**Edit:** On second thought, I'd rather leave the index as it is. If a change is needed, it'd better be done in MultiIndex constructor, I suppose.\n\nI'll prepare a PR for it later.\n\n---\n\nBTW, I couldn't find any info whether the following behaviour of categoricals in DataFrame is by design or just a side effect:\n\n``` python\n# df - same as above\ndf.sum()\nOut[14]: \ncat     31.0\ni1      53.0\ni2     510.0\ndtype: float64\n\ndf[['cat']].sum()\nOut[15]: \ncat    31\ndtype: int64\n\n# while for Series:\ndf['cat'].sum()\n...\nTypeError: Categorical cannot perform the operation sum\n```\n\nShouldn't categricals be rather excluded when aggregating as it is with datetime columns?\n"
  }
]
