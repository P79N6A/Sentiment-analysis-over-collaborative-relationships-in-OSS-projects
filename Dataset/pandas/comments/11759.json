[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/161982496",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11759#issuecomment-161982496",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11759",
    "id": 161982496,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2MTk4MjQ5Ng==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-12-04T14:40:06Z",
    "updated_at": "2015-12-04T14:40:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "you are trying to rank on a string column, which is not supported. \n\nBut should give a better message I would think.\n\n```\nIn [20]: df.set_index('a').groupby('c').first()\nOut[20]: \n    b\nc    \n1  B1\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/167432823",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11759#issuecomment-167432823",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11759",
    "id": 167432823,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2NzQzMjgyMw==",
    "user": {
      "login": "nbonnotte",
      "id": 9929982,
      "node_id": "MDQ6VXNlcjk5Mjk5ODI=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/9929982?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nbonnotte",
      "html_url": "https://github.com/nbonnotte",
      "followers_url": "https://api.github.com/users/nbonnotte/followers",
      "following_url": "https://api.github.com/users/nbonnotte/following{/other_user}",
      "gists_url": "https://api.github.com/users/nbonnotte/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nbonnotte/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nbonnotte/subscriptions",
      "organizations_url": "https://api.github.com/users/nbonnotte/orgs",
      "repos_url": "https://api.github.com/users/nbonnotte/repos",
      "events_url": "https://api.github.com/users/nbonnotte/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nbonnotte/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-12-27T18:30:36Z",
    "updated_at": "2015-12-27T18:30:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "That's weird, because `.rank()` work with `method='average'` (the default value) but not with `method='first'`.\n\n```\nIn [2]: df = DataFrame({'a':['A1', 'A1', 'A1'], 'b':['B1','B1','B2'], 'c':1})\n\nIn [3]: df.set_index('a').groupby('c').rank()\nOut[3]: \n      b\na      \nA1  1.5\nA1  1.5\nA1  3.0\n\nIn [4]: df.set_index('a').groupby('c').rank(method='first')\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-4-6b8d4cae9d91> in <module>()\n----> 1 df.set_index('a').groupby('c').rank(method='first')\n\n/home/nicolas/Git/pandas/pandas/core/groupby.pyc in rank(self, axis, numeric_only, method, na_option, ascending, pct)\n\n/home/nicolas/Git/pandas/pandas/core/groupby.pyc in wrapper(*args, **kwargs)\n    582                     # mark this column as an error\n    583                     try:\n--> 584                         return self._aggregate_item_by_item(name, *args, **kwargs)\n    585                     except (AttributeError):\n    586                         raise ValueError\n\n/home/nicolas/Git/pandas/pandas/core/groupby.pyc in _aggregate_item_by_item(self, func, *args, **kwargs)\n   3017             # GH6337\n   3018             if not len(result_columns) and errors is not None:\n-> 3019                 raise errors\n   3020 \n   3021         return DataFrame(result, columns=result_columns)\n\nTypeError: rank() got an unexpected keyword argument 'numeric_only'\n```\n\nI'm looking into it.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/167510081",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11759#issuecomment-167510081",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11759",
    "id": 167510081,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2NzUxMDA4MQ==",
    "user": {
      "login": "nbonnotte",
      "id": 9929982,
      "node_id": "MDQ6VXNlcjk5Mjk5ODI=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/9929982?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nbonnotte",
      "html_url": "https://github.com/nbonnotte",
      "followers_url": "https://api.github.com/users/nbonnotte/followers",
      "following_url": "https://api.github.com/users/nbonnotte/following{/other_user}",
      "gists_url": "https://api.github.com/users/nbonnotte/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nbonnotte/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nbonnotte/subscriptions",
      "organizations_url": "https://api.github.com/users/nbonnotte/orgs",
      "repos_url": "https://api.github.com/users/nbonnotte/repos",
      "events_url": "https://api.github.com/users/nbonnotte/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nbonnotte/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-12-28T08:31:04Z",
    "updated_at": "2015-12-28T08:31:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think I understand what is going on.\n\n`DataFrameGroupBy.rank` is created as part of a whitelist of operators, and its signature is taken from `DataFrame.rank`, which uses a wrapper obtained with `DataFrame._make_wrapper`. There, different things are tried to produce the result.\n\nWith `method='average'`, the first `try` succeeds.\n\nWith `method='first'`, the first two `try`s raise an exception with the message \"first not supported for non-numeric data\", which is good, but then at the last `try` the method `NDFrame._aggregate_item_by_item` is called. Things go wrong here, as it uses `SeriesGroupBy.rank`, the signature of which is taken from `Series.rank`. And the parameter `numeric_only` does not exist there, hence the error.\n\nThere is a design flaw here: \n- either the `DataFrame` and `Series` (and `Panel`, I guess) versions of `rank` (and the like) should always have the same signature\n- or the `DataFrameGroupBy.rank` should not use `SeriesGroupBy.rank\n\nI'll think about a solution that is as minimalist as possible, solves the initial issue, and if possible addresses this flaw. If I can't, I'll just add a hack somewhere to solve the initial issue.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/167562393",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11759#issuecomment-167562393",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11759",
    "id": 167562393,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2NzU2MjM5Mw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-12-28T12:35:23Z",
    "updated_at": "2015-12-28T12:35:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "the right way to fix this is to move `Series.rank` and `DataFrame.rank` into `generic.py` and make the signature uniform.\n\nYou then accept `numeric_only=None` in the `Series.rank` (and raise `NotImplementedError` if its not `None`).\n\nFurther need to add `axis` as a parameter (the `_get_axis_name` handles the case where the axis is > than the ndim FYI).\n\nyou can raise if `ndim>2` as well\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/167596221",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11759#issuecomment-167596221",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11759",
    "id": 167596221,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2NzU5NjIyMQ==",
    "user": {
      "login": "nbonnotte",
      "id": 9929982,
      "node_id": "MDQ6VXNlcjk5Mjk5ODI=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/9929982?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nbonnotte",
      "html_url": "https://github.com/nbonnotte",
      "followers_url": "https://api.github.com/users/nbonnotte/followers",
      "following_url": "https://api.github.com/users/nbonnotte/following{/other_user}",
      "gists_url": "https://api.github.com/users/nbonnotte/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nbonnotte/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nbonnotte/subscriptions",
      "organizations_url": "https://api.github.com/users/nbonnotte/orgs",
      "repos_url": "https://api.github.com/users/nbonnotte/repos",
      "events_url": "https://api.github.com/users/nbonnotte/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nbonnotte/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-12-28T16:11:56Z",
    "updated_at": "2015-12-28T16:11:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "So now, `SeriesGroupBy.rank` has the right signature, and `Series._make_wrapper` is used, so again there is a call to `._aggregate_item_by_item()`... except that this method comes from `NDFrameGroupBy`, and `SeriesGroupBy` does not inherit from `NDFrameGroupBy`, so now an `AttributeError` is raised. This is caught and transformed into a simple `ValueError`, with the following comment:\n\n> related to : GH #3688\n> try item-by-item\n> this can be called recursively, so need to raise ValueError if\n> we don't have this method to indicated to aggregate to\n> mark this column as an error\n\nIndeed, the first call to `_aggregate_item_by_item` (the one that called `SeriesGroupBy.rank`... still following?) uses this `ValueError` to simply discard the column, and we end up with an empty dataframe with the example I gave in the beginning.\n\nI'm going to prevent the call to `SeriesGroupBy._aggregate_item_by_item` (instead of asking for forgiveness), so that the exceptions can be sorted and a meaningful error message can be given to the user.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/168075853",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11759#issuecomment-168075853",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11759",
    "id": 168075853,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2ODA3NTg1Mw==",
    "user": {
      "login": "kuanche",
      "id": 5086755,
      "node_id": "MDQ6VXNlcjUwODY3NTU=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/5086755?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kuanche",
      "html_url": "https://github.com/kuanche",
      "followers_url": "https://api.github.com/users/kuanche/followers",
      "following_url": "https://api.github.com/users/kuanche/following{/other_user}",
      "gists_url": "https://api.github.com/users/kuanche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kuanche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kuanche/subscriptions",
      "organizations_url": "https://api.github.com/users/kuanche/orgs",
      "repos_url": "https://api.github.com/users/kuanche/repos",
      "events_url": "https://api.github.com/users/kuanche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kuanche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-12-30T21:21:55Z",
    "updated_at": "2015-12-30T21:21:55Z",
    "author_association": "NONE",
    "body": "Hi guys!\nDealing with the exact same issue- any tips on what to try instead? \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/168078334",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11759#issuecomment-168078334",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11759",
    "id": 168078334,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE2ODA3ODMzNA==",
    "user": {
      "login": "nbonnotte",
      "id": 9929982,
      "node_id": "MDQ6VXNlcjk5Mjk5ODI=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/9929982?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nbonnotte",
      "html_url": "https://github.com/nbonnotte",
      "followers_url": "https://api.github.com/users/nbonnotte/followers",
      "following_url": "https://api.github.com/users/nbonnotte/following{/other_user}",
      "gists_url": "https://api.github.com/users/nbonnotte/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nbonnotte/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nbonnotte/subscriptions",
      "organizations_url": "https://api.github.com/users/nbonnotte/orgs",
      "repos_url": "https://api.github.com/users/nbonnotte/repos",
      "events_url": "https://api.github.com/users/nbonnotte/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nbonnotte/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-12-30T21:37:45Z",
    "updated_at": "2015-12-30T21:37:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "What are you trying to do, exactly?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/195914048",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11759#issuecomment-195914048",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11759",
    "id": 195914048,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NTkxNDA0OA==",
    "user": {
      "login": "nbonnotte",
      "id": 9929982,
      "node_id": "MDQ6VXNlcjk5Mjk5ODI=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/9929982?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nbonnotte",
      "html_url": "https://github.com/nbonnotte",
      "followers_url": "https://api.github.com/users/nbonnotte/followers",
      "following_url": "https://api.github.com/users/nbonnotte/following{/other_user}",
      "gists_url": "https://api.github.com/users/nbonnotte/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nbonnotte/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nbonnotte/subscriptions",
      "organizations_url": "https://api.github.com/users/nbonnotte/orgs",
      "repos_url": "https://api.github.com/users/nbonnotte/repos",
      "events_url": "https://api.github.com/users/nbonnotte/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nbonnotte/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-13T08:29:29Z",
    "updated_at": "2016-03-13T08:29:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "Following pull request #11924, we now get an empty dataframe:\n\n```\nIn [2]: df = DataFrame({'a': ['A1', 'A1', 'A1'],\n   ...:     'b': ['B1', 'B1', 'B2'],\n   ...:     'c': 1})\n\nIn [3]: dg = df.set_index('a').groupby('c')\n\nIn [5]: dg.rank(method='first')\nOut[5]:\nEmpty DataFrame\nColumns: []\nIndex: []\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/262221816",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11759#issuecomment-262221816",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11759",
    "id": 262221816,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MjIyMTgxNg==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-22T11:52:29Z",
    "updated_at": "2016-11-22T11:52:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "these seem to be working in currently master\r\n\r\n```\r\nIn [3]: df = DataFrame({'a':['A1', 'A1', 'A1'], 'b':['B1','B1','B2'], 'c':1})\r\n\r\nIn [4]: df\r\nOut[4]: \r\n    a   b  c\r\n0  A1  B1  1\r\n1  A1  B1  1\r\n2  A1  B2  1\r\n\r\nIn [5]: \r\n\r\nIn [5]: df.set_index('a').groupby('c').rank(method='first')\r\nOut[5]: \r\nEmpty DataFrame\r\nColumns: []\r\nIndex: []\r\n\r\nIn [6]: df.set_index('a').groupby('b').rank(method='first')\r\nOut[6]: \r\n      c\r\na      \r\nA1  1.0\r\nA1  2.0\r\nA1  1.0\r\n\r\nIn [7]: df.set_index('a').groupby('c').rank()\r\nOut[7]: \r\n      b\r\na      \r\nA1  1.5\r\nA1  1.5\r\nA1  3.0\r\n\r\nIn [8]: df.set_index('a').groupby('b').rank()\r\nOut[8]: \r\n      c\r\na      \r\nA1  1.5\r\nA1  1.5\r\nA1  1.0\r\n```\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/364676632",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11759#issuecomment-364676632",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11759",
    "id": 364676632,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NDY3NjYzMg==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-10T18:02:10Z",
    "updated_at": "2018-02-10T18:02:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "closing in favor of #19560 which will report the proper error message."
  }
]
