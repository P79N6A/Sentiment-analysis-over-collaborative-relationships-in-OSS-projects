[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/476467898",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25871#issuecomment-476467898",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25871",
    "id": 476467898,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjQ2Nzg5OA==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-26T04:08:20Z",
    "updated_at": "2019-03-26T04:08:20Z",
    "author_association": "MEMBER",
    "body": "Unless I am overlooking something this looks to be a duplicate of the issue you've linked to. As such closing this and let's stick to that one"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/476480686",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25871#issuecomment-476480686",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25871",
    "id": 476480686,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjQ4MDY4Ng==",
    "user": {
      "login": "kpflugshaupt",
      "id": 2961313,
      "node_id": "MDQ6VXNlcjI5NjEzMTM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/2961313?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kpflugshaupt",
      "html_url": "https://github.com/kpflugshaupt",
      "followers_url": "https://api.github.com/users/kpflugshaupt/followers",
      "following_url": "https://api.github.com/users/kpflugshaupt/following{/other_user}",
      "gists_url": "https://api.github.com/users/kpflugshaupt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kpflugshaupt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kpflugshaupt/subscriptions",
      "organizations_url": "https://api.github.com/users/kpflugshaupt/orgs",
      "repos_url": "https://api.github.com/users/kpflugshaupt/repos",
      "events_url": "https://api.github.com/users/kpflugshaupt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kpflugshaupt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-26T05:27:34Z",
    "updated_at": "2019-03-26T05:27:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "Fair enough.  \r\nThe scenario is not identical, though (ordered Categorical vs. ‚sort=True‘).\r\nLooking at the code in grouper.py, it certainly seems to stem from the same place, but the ‚ordered‘ attribute and the ‚sort‘ parameter are separate concepts there, as well.\r\nMaybe make this another unit Test?\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/476482452",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25871#issuecomment-476482452",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25871",
    "id": 476482452,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjQ4MjQ1Mg==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-26T05:37:10Z",
    "updated_at": "2019-03-26T05:37:10Z",
    "author_association": "MEMBER",
    "body": "A good test should be able to parametrize all of those parameters - if you'd like to take a look at the other issue and post a PR that would certainly be welcome!"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/476502888",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25871#issuecomment-476502888",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25871",
    "id": 476502888,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjUwMjg4OA==",
    "user": {
      "login": "kpflugshaupt",
      "id": 2961313,
      "node_id": "MDQ6VXNlcjI5NjEzMTM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/2961313?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kpflugshaupt",
      "html_url": "https://github.com/kpflugshaupt",
      "followers_url": "https://api.github.com/users/kpflugshaupt/followers",
      "following_url": "https://api.github.com/users/kpflugshaupt/following{/other_user}",
      "gists_url": "https://api.github.com/users/kpflugshaupt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kpflugshaupt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kpflugshaupt/subscriptions",
      "organizations_url": "https://api.github.com/users/kpflugshaupt/orgs",
      "repos_url": "https://api.github.com/users/kpflugshaupt/repos",
      "events_url": "https://api.github.com/users/kpflugshaupt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kpflugshaupt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-26T07:15:06Z",
    "updated_at": "2019-03-26T07:15:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "Right, I will try. Paid work keeps intruding, though...  "
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/476594608",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25871#issuecomment-476594608",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25871",
    "id": 476594608,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjU5NDYwOA==",
    "user": {
      "login": "kpflugshaupt",
      "id": 2961313,
      "node_id": "MDQ6VXNlcjI5NjEzMTM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/2961313?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kpflugshaupt",
      "html_url": "https://github.com/kpflugshaupt",
      "followers_url": "https://api.github.com/users/kpflugshaupt/followers",
      "following_url": "https://api.github.com/users/kpflugshaupt/following{/other_user}",
      "gists_url": "https://api.github.com/users/kpflugshaupt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kpflugshaupt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kpflugshaupt/subscriptions",
      "organizations_url": "https://api.github.com/users/kpflugshaupt/orgs",
      "repos_url": "https://api.github.com/users/kpflugshaupt/repos",
      "events_url": "https://api.github.com/users/kpflugshaupt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kpflugshaupt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-26T11:59:49Z",
    "updated_at": "2019-03-26T12:02:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "## I have digged further, and found that this issue is **_not_** a duplicate of #25167:\r\n\r\n### The fix for #25167 does not fix this one completely\r\nThe PR #25173 fixes #25167. So, I applied the two code changes from that PR to my local installation (files **grouper.py** and **categorical.py** in **pandas/core/groupby/**).\r\n**This fixes my test case, but only if the 'sort' parameter is set to True**. If ```sort=False```, the bug persists (same result as shown above):\r\n```python\r\ndf.groupby('cat', observed=True, sort=False)['val'].agg('sum')\r\n```\r\nstill returns\r\n```\r\ncat\r\n3    1.0\r\n1    2.0\r\n2    3.0\r\nName: val, dtype: float64\r\n```\r\nafter installing PR #25173.\r\n\r\n### If I modify it a bit, PR #25173 also fixes my problem\r\nThe relevant change from PR #25173 that fixes my ```sort=True``` case are these two new lines in **grouper.py** (inserted after line 302):\r\n```python\r\n                    if sort:\r\n                        codes = np.sort(codes)\r\n```\r\nIf I extend the condition and also check for the grouper being ordered, the ```sort=False``` case also works:\r\n```python\r\n                    if sort or self.grouper.ordered:\r\n                        codes = np.sort(codes)\r\n```\r\n(This implies that grouping by an ordered Categorical and setting ```sort=True``` should result in the same ordering of codes. Also, that grouping by an ordered Categorical always sorts.)\r\n\r\n**With this modification, my test case seems OK both for ```sort=True```and ```sort=False```**.\r\n\r\n## How to proceed\r\nIf my modification is OK (as in, breaks no tests and fits into Things), I propose to \r\n\r\n- either reopen #25173 and add my modification\r\n- or reopen this issue, and fix it as shown above"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/476608929",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25871#issuecomment-476608929",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25871",
    "id": 476608929,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjYwODkyOQ==",
    "user": {
      "login": "kpflugshaupt",
      "id": 2961313,
      "node_id": "MDQ6VXNlcjI5NjEzMTM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/2961313?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kpflugshaupt",
      "html_url": "https://github.com/kpflugshaupt",
      "followers_url": "https://api.github.com/users/kpflugshaupt/followers",
      "following_url": "https://api.github.com/users/kpflugshaupt/following{/other_user}",
      "gists_url": "https://api.github.com/users/kpflugshaupt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kpflugshaupt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kpflugshaupt/subscriptions",
      "organizations_url": "https://api.github.com/users/kpflugshaupt/orgs",
      "repos_url": "https://api.github.com/users/kpflugshaupt/repos",
      "events_url": "https://api.github.com/users/kpflugshaupt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kpflugshaupt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-26T12:44:49Z",
    "updated_at": "2019-03-26T12:44:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks, @WillAyd. Will you do the change, or is this expected from me?\r\nWhen I clone the repository, I somehow do not see the changed sources of PR #25173, even though it was closed 7 days ago. It's probably me doing something wrong, but it makes me wary of trying this myself.\r\n\r\n(Besides, as mentioned, Paid Work)"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/476643555",
    "html_url": "https://github.com/pandas-dev/pandas/issues/25871#issuecomment-476643555",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25871",
    "id": 476643555,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjY0MzU1NQ==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-26T13:44:07Z",
    "updated_at": "2019-03-26T13:44:07Z",
    "author_association": "MEMBER",
    "body": "If you could push a PR I can take a look on the review side. Be sure to check out the contributing guide if you have trouble and you an ask specific development questions on Gitter:\r\n\r\nhttps://pandas.pydata.org/pandas-docs/stable/development/contributing.html\r\n\r\n> (Besides, as mentioned, Paid Work)\r\n\r\nPandas is for all practical purposes maintained entirely by volunteers - any help you can add to that is certainly welcome!"
  }
]
