[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/414847683",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22453#issuecomment-414847683",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22453",
    "id": 414847683,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNDg0NzY4Mw==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-21T22:55:28Z",
    "updated_at": "2018-08-21T22:55:28Z",
    "author_association": "MEMBER",
    "body": "Can you try on master? The examples from the docs worked fine for me and I think we have CI to check that as well"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/414966223",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22453#issuecomment-414966223",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22453",
    "id": 414966223,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNDk2NjIyMw==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-22T09:10:08Z",
    "updated_at": "2018-08-22T09:10:08Z",
    "author_association": "MEMBER",
    "body": "Example run on master:\r\n\r\n```\r\nIn [13]: foo = pd.Categorical(['a', 'b'], categories=['a', 'b', 'c'])\r\n\r\nIn [14]: bar = pd.Categorical(['d', 'e'], categories=['d', 'e', 'f'])\r\n\r\nIn [15]: pd.crosstab(foo, bar)\r\nOut[15]: \r\ncol_0  d  e\r\nrow_0      \r\na      1  0\r\nb      0  1\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/414969393",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22453#issuecomment-414969393",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22453",
    "id": 414969393,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNDk2OTM5Mw==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-22T09:21:36Z",
    "updated_at": "2018-08-22T09:21:36Z",
    "author_association": "MEMBER",
    "body": "It seems to be a regression in 0.23.0. As on 0.22 I still get the correct result (on pandas 0.20 it is also only partially working, only the index is correct) "
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/414969651",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22453#issuecomment-414969651",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22453",
    "id": 414969651,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNDk2OTY1MQ==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-22T09:22:21Z",
    "updated_at": "2018-08-22T09:22:21Z",
    "author_association": "MEMBER",
    "body": "@andrewcassidy if you would have time, very welcome to look into it what could be the cause"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/416472578",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22453#issuecomment-416472578",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22453",
    "id": 416472578,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNjQ3MjU3OA==",
    "user": {
      "login": "kokes",
      "id": 8451755,
      "node_id": "MDQ6VXNlcjg0NTE3NTU=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8451755?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kokes",
      "html_url": "https://github.com/kokes",
      "followers_url": "https://api.github.com/users/kokes/followers",
      "following_url": "https://api.github.com/users/kokes/following{/other_user}",
      "gists_url": "https://api.github.com/users/kokes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kokes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kokes/subscriptions",
      "organizations_url": "https://api.github.com/users/kokes/orgs",
      "repos_url": "https://api.github.com/users/kokes/repos",
      "events_url": "https://api.github.com/users/kokes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kokes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-28T06:57:40Z",
    "updated_at": "2018-08-28T06:57:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi there, a handy bisect led me to this commit: b020891dbd3c53028cdfef4ce990dced7283dc3b, which references PR #20583 (in short: there is no reindexing of categoricals now, so empty groups are omitted). This appears to be intentional behaviour wherein empty groups are dropped in a groupby, which affects other operations that use groupby under the hood.\r\n\r\nThey don't mention crosstab specifically, but they do deal with a very similar issue in `pivot_table`. The discussion is quite lengthy, so I don't know what the outcome is precisely (maybe one of those participants will shed some light on this matter), but I managed to reproduce the desired output using pandas 0.23.3, by adding `dropna=False` to the `crosstab` call.\r\n\r\n```\r\nIn [1]: import numpy as np\r\n   ...: import pandas as pd\r\n   ...: from pandas import crosstab\r\n   ...: \r\n   ...: \r\n   ...: a = np.array([\"foo\", \"foo\", \"foo\", \"foo\", \"bar\", \"bar\", \"bar\", \"bar\", \"foo\", \"foo\", \"foo\"], dty\r\n   ...: pe=object)\r\n   ...: b = np.array([\"one\", \"one\", \"one\", \"two\", \"one\", \"one\", \"one\", \"two\", \"two\", \"two\", \"one\"], dty\r\n   ...: pe=object)\r\n   ...: c = np.array([\"dull\", \"dull\", \"shiny\", \"dull\", \"dull\", \"shiny\", \"shiny\", \"dull\", \"shiny\", \"shin\r\n   ...: y\", \"shiny\"], dtype=object)\r\n   ...: foo = pd.Categorical(['a', 'b'], categories=['a', 'b', 'c'])\r\n   ...: bar = pd.Categorical(['d', 'e'], categories=['d', 'e', 'f'])\r\n   ...: \r\n   ...: \r\n\r\nIn [2]: crosstab(foo, bar)\r\nOut[2]: \r\ncol_0  d  e\r\nrow_0      \r\na      1  0\r\nb      0  1\r\n\r\nIn [3]: crosstab(foo, bar, dropna=False)\r\nOut[3]: \r\ncol_0  d  e  f\r\nrow_0         \r\na      1  0  0\r\nb      0  1  0\r\nc      0  0  0\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/416476566",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22453#issuecomment-416476566",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22453",
    "id": 416476566,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNjQ3NjU2Ng==",
    "user": {
      "login": "kokes",
      "id": 8451755,
      "node_id": "MDQ6VXNlcjg0NTE3NTU=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8451755?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kokes",
      "html_url": "https://github.com/kokes",
      "followers_url": "https://api.github.com/users/kokes/followers",
      "following_url": "https://api.github.com/users/kokes/following{/other_user}",
      "gists_url": "https://api.github.com/users/kokes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kokes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kokes/subscriptions",
      "organizations_url": "https://api.github.com/users/kokes/orgs",
      "repos_url": "https://api.github.com/users/kokes/repos",
      "events_url": "https://api.github.com/users/kokes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kokes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-28T07:15:08Z",
    "updated_at": "2018-08-28T07:15:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "By the way not only does the example not work, the [documentation](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html) preceding does not reflect the current functionality:\r\n\r\n> Any input passed containing Categorical data will have **all** of its categories included in the cross-tabulation, even if the actual data does not contain any instances of a particular category.\r\n\r\nThis was already pointed out in a related (open!) issue, #16367."
  }
]
