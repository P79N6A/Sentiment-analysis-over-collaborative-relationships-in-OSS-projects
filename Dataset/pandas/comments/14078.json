[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/242231173",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14078#issuecomment-242231173",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14078",
    "id": 242231173,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0MjIzMTE3Mw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-08-24T22:42:24Z",
    "updated_at": "2016-08-24T22:42:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "use `.apply`; `.agg` has some guarantees about inference on the return type\n\n```\nIn [5]: pd.DataFrame(np.ones((2,2)), columns=[0,1]).groupby(1)[[0]].apply(frozenset)\nOut[5]: \n1\n1.0    (0)\ndtype: object\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/242340511",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14078#issuecomment-242340511",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14078",
    "id": 242340511,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0MjM0MDUxMQ==",
    "user": {
      "login": "timdiels",
      "id": 847329,
      "node_id": "MDQ6VXNlcjg0NzMyOQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/847329?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/timdiels",
      "html_url": "https://github.com/timdiels",
      "followers_url": "https://api.github.com/users/timdiels/followers",
      "following_url": "https://api.github.com/users/timdiels/following{/other_user}",
      "gists_url": "https://api.github.com/users/timdiels/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/timdiels/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/timdiels/subscriptions",
      "organizations_url": "https://api.github.com/users/timdiels/orgs",
      "repos_url": "https://api.github.com/users/timdiels/repos",
      "events_url": "https://api.github.com/users/timdiels/events{/privacy}",
      "received_events_url": "https://api.github.com/users/timdiels/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-08-25T10:14:41Z",
    "updated_at": "2016-08-25T10:14:41Z",
    "author_association": "NONE",
    "body": "Thanks, though note that when selecting multiple columns, one still has to use `agg(lambda)`:\n\n``` python\n>>> df = pd.DataFrame([[1,2,1],[3,4,1],[5,6,2],[7,8,2]])\n>>> df['irrelevant'] = [1,2,3,4]\n>>> df\n   0  1  2  irrelevant\n0  1  2  1           1\n1  3  4  1           2\n2  5  6  2           3\n3  7  8  2           4\n>>> df.groupby(2)[[0,1]].apply(frozenset)\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/home/limyreth/.local/lib/python3.5/site-packages/pandas/core/groupby.py\", line 651, in apply\n    return self._python_apply_general(f)\n  File \"/home/limyreth/.local/lib/python3.5/site-packages/pandas/core/groupby.py\", line 660, in _python_apply_general\n    not_indexed_same=mutated or self.mutated)\n  File \"/home/limyreth/.local/lib/python3.5/site-packages/pandas/core/groupby.py\", line 3375, in _wrap_applied_output\n    return (Series(values, index=key_index, name=self.name)\n  File \"/home/limyreth/.local/lib/python3.5/site-packages/pandas/core/series.py\", line 233, in __init__\n    self.name = name\n  File \"/home/limyreth/.local/lib/python3.5/site-packages/pandas/core/generic.py\", line 2694, in __setattr__\n    object.__setattr__(self, name, value)\n  File \"/home/limyreth/.local/lib/python3.5/site-packages/pandas/core/series.py\", line 309, in name\n    raise TypeError('Series.name must be a hashable type')\nTypeError: Series.name must be a hashable type\n>>> df.groupby(2)[[0,1]].agg(lambda x: frozenset(x))\n        0       1\n2                \n1  (1, 3)  (2, 4)\n2  (5, 7)  (8, 6)\n```\n"
  }
]
