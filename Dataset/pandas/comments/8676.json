[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/61020253",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8676#issuecomment-61020253",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8676",
    "id": 61020253,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMDIwMjUz",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-10-29T23:02:33Z",
    "updated_at": "2014-10-29T23:02:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "cc @shoyer\ncc @JanSchulz\ncc @jorisvandenbossche \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/61023402",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8676#issuecomment-61023402",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8676",
    "id": 61023402,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMDIzNDAy",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-10-29T23:32:32Z",
    "updated_at": "2014-10-29T23:32:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "@shoyer both done\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/61026610",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8676#issuecomment-61026610",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8676",
    "id": 61026610,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMDI2NjEw",
    "user": {
      "login": "shoyer",
      "id": 1217238,
      "node_id": "MDQ6VXNlcjEyMTcyMzg=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1217238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shoyer",
      "html_url": "https://github.com/shoyer",
      "followers_url": "https://api.github.com/users/shoyer/followers",
      "following_url": "https://api.github.com/users/shoyer/following{/other_user}",
      "gists_url": "https://api.github.com/users/shoyer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shoyer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shoyer/subscriptions",
      "organizations_url": "https://api.github.com/users/shoyer/orgs",
      "repos_url": "https://api.github.com/users/shoyer/repos",
      "events_url": "https://api.github.com/users/shoyer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shoyer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-10-30T00:07:17Z",
    "updated_at": "2014-10-30T00:07:17Z",
    "author_association": "MEMBER",
    "body": "looks pretty good to me!\n\nnote: not really sure why pandas has `_ensure_int8` functions (and the like)... I would think `np.asarray(x, 'int8')` would be succinct enough!\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/66888559",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8676#issuecomment-66888559",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8676",
    "id": 66888559,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODg4NTU5",
    "user": {
      "login": "behzadnouri",
      "id": 1288998,
      "node_id": "MDQ6VXNlcjEyODg5OTg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1288998?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/behzadnouri",
      "html_url": "https://github.com/behzadnouri",
      "followers_url": "https://api.github.com/users/behzadnouri/followers",
      "following_url": "https://api.github.com/users/behzadnouri/following{/other_user}",
      "gists_url": "https://api.github.com/users/behzadnouri/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/behzadnouri/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/behzadnouri/subscriptions",
      "organizations_url": "https://api.github.com/users/behzadnouri/orgs",
      "repos_url": "https://api.github.com/users/behzadnouri/repos",
      "events_url": "https://api.github.com/users/behzadnouri/events{/privacy}",
      "received_events_url": "https://api.github.com/users/behzadnouri/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-13T19:46:13Z",
    "updated_at": "2014-12-13T19:46:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jreback \nplease consider reverting this change; casting to smaller integer types comes with the risk of overflow/wraparound, plus a performance cost anywhere there is a call to `com._ensure_int64` or when numpy internally has to up-cast. as an example indexing into sorted multi-index has been impacted by this commit, because numpy has to up-cast before doing binary search:\n\n```\n-------------------------------------------------------------------------------\nTest name                                    | head[ms] | base[ms] |  ratio   |\n-------------------------------------------------------------------------------\nframe_xs_mi_ix                               |   8.5303 |   0.6206 |  13.7452 |\nseries_xs_mi_ix                              |   8.0659 |   0.5600 |  14.4023 |\n-------------------------------------------------------------------------------\nTest name                                    | head[ms] | base[ms] |  ratio   |\n-------------------------------------------------------------------------------\n\nRatio < 1.0 means the target commit is faster then the baseline.\nSeed used: 1234\n\nTarget [c11e75c] : PERF: set multiindex labels with coerced dtype (GH8456)\nBase   [6bbb39e] : Merge pull request #8675 from pydata/setitem\n```\n\nso it will change an `O(log(n))` performance to `O(n)`. (down-casting the scalar value is _not_ an option here because of the risk of overflow, so an entire array has to be up-cast).\n\nthere are also many places in the code that explicitly call into `com._ensure_int64`, and this commit will impact their performance as well.\n\nalso _practically_, down casting has a _negative_ impact on the memory usage, because many operations generate a temporary version of the array with upcasted types (even when viable, down-casting the other operand is risky or costly to do it safely), so then there will be two copies of the same values in the memory instead of only one, and that definitely increases memory usage.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/66890252",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8676#issuecomment-66890252",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8676",
    "id": 66890252,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODkwMjUy",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-13T20:32:52Z",
    "updated_at": "2014-12-13T20:33:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "@behzadnouri these are only for indexers. The risk of overflow is 0. Yet you gain enormous memory savings. \n\nIf you see a perf impact then it would be much easier to NOT upcast when doing the indexing.\n\nI would say that their are some negative perf implications of this, but I suspect they can be fixed and/or outweiged by holding a smaller dtype of indexer.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/66892222",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8676#issuecomment-66892222",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8676",
    "id": 66892222,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODkyMjIy",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-13T21:28:17Z",
    "updated_at": "2014-12-13T21:28:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "pls create a new issue for this, with a specific example of the problem. keep in mind that the benchmarks you are showing are for a scalar indexing operation which is not very useful in and of itself. (that said if it can be fixed great). \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/66892611",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8676#issuecomment-66892611",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8676",
    "id": 66892611,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODkyNjEx",
    "user": {
      "login": "behzadnouri",
      "id": 1288998,
      "node_id": "MDQ6VXNlcjEyODg5OTg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1288998?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/behzadnouri",
      "html_url": "https://github.com/behzadnouri",
      "followers_url": "https://api.github.com/users/behzadnouri/followers",
      "following_url": "https://api.github.com/users/behzadnouri/following{/other_user}",
      "gists_url": "https://api.github.com/users/behzadnouri/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/behzadnouri/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/behzadnouri/subscriptions",
      "organizations_url": "https://api.github.com/users/behzadnouri/orgs",
      "repos_url": "https://api.github.com/users/behzadnouri/repos",
      "events_url": "https://api.github.com/users/behzadnouri/events{/privacy}",
      "received_events_url": "https://api.github.com/users/behzadnouri/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-13T21:39:51Z",
    "updated_at": "2014-12-13T21:39:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jreback as in the last paragraph of my comment this will cause _more_ memory usage.\nmemory profile results added in the https://github.com/pydata/pandas/issues/9073\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/66892657",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8676#issuecomment-66892657",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8676",
    "id": 66892657,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODkyNjU3",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-13T21:41:40Z",
    "updated_at": "2014-12-13T21:41:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "you will have to prove it on several use cases. E.g. need more than a single example. I agree that their is some casting issues, but I suspect those can be addressed.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/66892899",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8676#issuecomment-66892899",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8676",
    "id": 66892899,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODkyODk5",
    "user": {
      "login": "behzadnouri",
      "id": 1288998,
      "node_id": "MDQ6VXNlcjEyODg5OTg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1288998?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/behzadnouri",
      "html_url": "https://github.com/behzadnouri",
      "followers_url": "https://api.github.com/users/behzadnouri/followers",
      "following_url": "https://api.github.com/users/behzadnouri/following{/other_user}",
      "gists_url": "https://api.github.com/users/behzadnouri/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/behzadnouri/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/behzadnouri/subscriptions",
      "organizations_url": "https://api.github.com/users/behzadnouri/orgs",
      "repos_url": "https://api.github.com/users/behzadnouri/repos",
      "events_url": "https://api.github.com/users/behzadnouri/events{/privacy}",
      "received_events_url": "https://api.github.com/users/behzadnouri/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-13T21:48:56Z",
    "updated_at": "2014-12-13T21:49:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jreback below is the proof; any time the code hits the lines below with smaller integer type, it creates a copy of the same data and that costs both memory and performance:\n\n```\n$ find -maxdepth 4 -iname '*.py' -exec grep -IrHn -i 'ensure_int64.*index' '{}' \\;\n./pandas/core/groupby.py:3692:        sorter, _ = _algos.groupsort_indexer(com._ensure_int64(group_index),\n./pandas/core/groupby.py:3708:    group_index = com._ensure_int64(group_index)\n./pandas/core/generic.py:1828:                indexer = com._ensure_int64(indexer)\n./pandas/core/common.py:729:        indexer = _ensure_int64(indexer)\n./pandas/core/common.py:768:        indexer = _ensure_int64(indexer)\n./pandas/core/common.py:822:    indexer = _ensure_int64(indexer)\n./pandas/core/common.py:971:    return _ensure_int64(indexer)\n./pandas/core/common.py:980:    return _ensure_int64(indexer)\n./pandas/core/frame.py:4125:        labels = com._ensure_int64(frame.index.labels[level])\n./pandas/core/series.py:1123:            labels = com._ensure_int64(self.index.labels[level])\n./pandas/core/index.py:1896:            left_lev_indexer = com._ensure_int64(left_lev_indexer)\n./pandas/tseries/index.py:464:                index = tslib.tz_localize_to_utc(com._ensure_int64(index), tz,\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/66893015",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8676#issuecomment-66893015",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8676",
    "id": 66893015,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODkzMDE1",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-13T21:52:27Z",
    "updated_at": "2014-12-13T21:52:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "you are missing the point. These should in theory be removable. This bizness of conversions between int64 is just a distraction. These _can_ be indexed via a smaller indexer.\n"
  }
]
