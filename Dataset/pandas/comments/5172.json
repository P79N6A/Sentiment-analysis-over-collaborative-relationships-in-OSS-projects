[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26072076",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5172#issuecomment-26072076",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5172",
    "id": 26072076,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MDcyMDc2",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-10T17:08:35Z",
    "updated_at": "2013-10-10T17:08:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "cc @rockg\n\ncan you take a look?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/26539421",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5172#issuecomment-26539421",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5172",
    "id": 26539421,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTM5NDIx",
    "user": {
      "login": "rockg",
      "id": 3195015,
      "node_id": "MDQ6VXNlcjMxOTUwMTU=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/3195015?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rockg",
      "html_url": "https://github.com/rockg",
      "followers_url": "https://api.github.com/users/rockg/followers",
      "following_url": "https://api.github.com/users/rockg/following{/other_user}",
      "gists_url": "https://api.github.com/users/rockg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rockg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rockg/subscriptions",
      "organizations_url": "https://api.github.com/users/rockg/orgs",
      "repos_url": "https://api.github.com/users/rockg/repos",
      "events_url": "https://api.github.com/users/rockg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rockg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-17T19:06:42Z",
    "updated_at": "2013-10-17T19:06:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "A little background...what is done behind the scenes is to make a DatetimeIndex that has the passed frequency that forms the basis for the resample.  In this case, it's a daily curve.  Unfortunately, the AmbiguousTime s is related to what we've seen with other things (e.g., #5175).  Basically your date is normalized (_adjust_dates_anchored in tseries.resample), but it returns 2012-11-04 00:00:00-05:00 when it should return 2012-11-04 00:00:00-04:00.  The dates are normalized using datetime.replace() by setting components to zero, but the tzoffset does not change.  I believe the fix is to localize.  Let me do some digging on possible solutions.  @dflatow, in the meantime a simple fix would be to use UTC or not localize at all.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27359305",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5172#issuecomment-27359305",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5172",
    "id": 27359305,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MzU5MzA1",
    "user": {
      "login": "dflatow",
      "id": 5514147,
      "node_id": "MDQ6VXNlcjU1MTQxNDc=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/5514147?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dflatow",
      "html_url": "https://github.com/dflatow",
      "followers_url": "https://api.github.com/users/dflatow/followers",
      "following_url": "https://api.github.com/users/dflatow/following{/other_user}",
      "gists_url": "https://api.github.com/users/dflatow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dflatow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dflatow/subscriptions",
      "organizations_url": "https://api.github.com/users/dflatow/orgs",
      "repos_url": "https://api.github.com/users/dflatow/repos",
      "events_url": "https://api.github.com/users/dflatow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dflatow/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-10-30T01:46:10Z",
    "updated_at": "2013-10-30T01:46:10Z",
    "author_association": "NONE",
    "body": "My workaround is to use a groupby instead of resample (the timezones matter for the analysis I'm doing - so UTC won't work). Any word on a fix though?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/62261611",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5172#issuecomment-62261611",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5172",
    "id": 62261611,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMjYxNjEx",
    "user": {
      "login": "rockg",
      "id": 3195015,
      "node_id": "MDQ6VXNlcjMxOTUwMTU=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/3195015?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rockg",
      "html_url": "https://github.com/rockg",
      "followers_url": "https://api.github.com/users/rockg/followers",
      "following_url": "https://api.github.com/users/rockg/following{/other_user}",
      "gists_url": "https://api.github.com/users/rockg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rockg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rockg/subscriptions",
      "organizations_url": "https://api.github.com/users/rockg/orgs",
      "repos_url": "https://api.github.com/users/rockg/repos",
      "events_url": "https://api.github.com/users/rockg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rockg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-08T15:27:52Z",
    "updated_at": "2014-11-12T13:34:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "Good news is that I have all of these figured out.  One issue I'm having is related to #8601.  Basically when you take a time in non-DST and apply the +MS rule, it goes to the last hour of the month because of DST (see #5175) for more explanation.  In that commit the logic was applied to DateOffset, but all the other offsets need to remove the timezone, apply the offset, and then put it back.   This seems pretty ugly and I'm looking for suggestions to handle this in a uniform way rather than duplicating the logic for every single offset.\n\n```\nimport pandas as pd\nts = pd.Timestamp('11/2/2012', tz='US/Eastern')\nts + pd.offsets.MonthBegin()\nOut[4]: Timestamp('2012-11-30 23:00:00-0500', tz='US/Eastern') #Should be 2012-12-01 00\n```\n\nThe below basically needs to be added to `apply` for each offset.\n\n```\n        tzinfo = getattr(other, 'tzinfo', None)\n        if tzinfo is not None:\n            other = other.replace(tzinfo=None)\n\n        # Apply offset, e.g., other = other + relativedelta(...)\n        if tzinfo is not None:\n            other = tslib._localize_pydatetime(other, tzinfo)\n```\n\nThe other issue was caused by `_adjust_dates_anchored` and the assumption made about the hours in a day.  This assumption fails when you are on a DST day, but it was a pretty simple fix (basically move everything to UTC, calculate the anchor, and then relocalize).\n\nAnother problem is that `tslib.normalize_date` doesn't handle DST properly.  I'm inclined to change this so that when you normalize an hour on the DST day and after the offset change, it returns the right offset.  \n\nWrong:\n\n```\nimport pandas as pd\nts = pd.Timestamp('11/4/2012 23:00', tz='US/Eastern')\nts\nOut[4]: Timestamp('2012-11-04 23:00:00-0500', tz='US/Eastern')\npd.tseries.tools.normalize_date(ts)\nOut[5]: Timestamp('2012-11-04 00:00:00-0500', tz='US/Eastern') #Should be -0400\n```\n\nRight:\n\n```\nimport pandas as pd\nts = pd.Timestamp('11/4/2012 23:00', tz='US/Eastern')\nts\nOut[4]: Timestamp('2012-11-04 23:00:00-0500', tz='US/Eastern')\npd.tseries.tools.normalize_date(ts)\nOut[5]: Timestamp('2012-11-04 00:00:00-0400', tz='US/Eastern')\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/62261792",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5172#issuecomment-62261792",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5172",
    "id": 62261792,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMjYxNzky",
    "user": {
      "login": "rockg",
      "id": 3195015,
      "node_id": "MDQ6VXNlcjMxOTUwMTU=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/3195015?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rockg",
      "html_url": "https://github.com/rockg",
      "followers_url": "https://api.github.com/users/rockg/followers",
      "following_url": "https://api.github.com/users/rockg/following{/other_user}",
      "gists_url": "https://api.github.com/users/rockg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rockg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rockg/subscriptions",
      "organizations_url": "https://api.github.com/users/rockg/orgs",
      "repos_url": "https://api.github.com/users/rockg/repos",
      "events_url": "https://api.github.com/users/rockg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rockg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-11-08T15:33:09Z",
    "updated_at": "2014-11-08T15:40:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "I guess the removal of `tzinfo`from the offset should really happen in `apply_wraps` which there is some logic for but the `tzinfo` is not removed from `other`.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/78251318",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5172#issuecomment-78251318",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5172",
    "id": 78251318,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MjUxMzE4",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-03-11T12:10:19Z",
    "updated_at": "2015-03-11T12:10:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "closed by #9623 \n"
  }
]
