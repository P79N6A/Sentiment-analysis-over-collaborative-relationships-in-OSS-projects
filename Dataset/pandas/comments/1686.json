[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/7295449",
    "html_url": "https://github.com/pandas-dev/pandas/issues/1686#issuecomment-7295449",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/1686",
    "id": 7295449,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyOTU0NDk=",
    "user": {
      "login": "taavi",
      "id": 35443,
      "node_id": "MDQ6VXNlcjM1NDQz",
      "avatar_url": "https://avatars2.githubusercontent.com/u/35443?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/taavi",
      "html_url": "https://github.com/taavi",
      "followers_url": "https://api.github.com/users/taavi/followers",
      "following_url": "https://api.github.com/users/taavi/following{/other_user}",
      "gists_url": "https://api.github.com/users/taavi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/taavi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/taavi/subscriptions",
      "organizations_url": "https://api.github.com/users/taavi/orgs",
      "repos_url": "https://api.github.com/users/taavi/repos",
      "events_url": "https://api.github.com/users/taavi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/taavi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-07-27T01:31:55Z",
    "updated_at": "2012-07-27T01:31:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "That's pandas 0.8.1, numpy 1.6.2, ipython 0.13, Python 2.6.1 (OSX 10.6.8) on a Core2Duo 2.26GHz.\n\nThe timings only get worse as `datelist` grows longer.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/7349627",
    "html_url": "https://github.com/pandas-dev/pandas/issues/1686#issuecomment-7349627",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/1686",
    "id": 7349627,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDk2Mjc=",
    "user": {
      "login": "taavi",
      "id": 35443,
      "node_id": "MDQ6VXNlcjM1NDQz",
      "avatar_url": "https://avatars2.githubusercontent.com/u/35443?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/taavi",
      "html_url": "https://github.com/taavi",
      "followers_url": "https://api.github.com/users/taavi/followers",
      "following_url": "https://api.github.com/users/taavi/following{/other_user}",
      "gists_url": "https://api.github.com/users/taavi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/taavi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/taavi/subscriptions",
      "organizations_url": "https://api.github.com/users/taavi/orgs",
      "repos_url": "https://api.github.com/users/taavi/repos",
      "events_url": "https://api.github.com/users/taavi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/taavi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-07-29T03:42:36Z",
    "updated_at": "2012-07-29T03:42:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "So, using `line_profiler`, I tracked it down to this function (called 3 times, once each from `_get_annual_rule`, `_get_quarterly_rule`, and `_get_monthly_rule`):\n\n```\nLine #      Hits         Time  Per Hit   % Time  Line Contents\n==============================================================\n   783                                               @profile\n   784                                               def month_position_check(self):\n   785                                                   # TODO: cythonize this, very slow\n   786         3            8      2.7      0.0          calendar_end = True\n   787         3            5      1.7      0.0          business_end = True\n   788         3            4      1.3      0.0          calendar_start = True\n   789         3            4      1.3      0.0          business_start = True\n   790                                           \n   791         3           17      5.7      0.0          years = self.fields['Y']\n   792         3            7      2.3      0.0          months = self.fields['M']\n   793         3            9      3.0      0.0          days = self.fields['D']\n   794         3         7771   2590.3      0.4          weekdays = self.index.dayofweek\n   795                                           \n   796         3          130     43.3      0.0          from calendar import monthrange\n   797     30003        92505      3.1      4.5          for y, m, d, wd in zip(years, months, days, weekdays):\n   798     30000        98499      3.3      4.8              wd = datetime(y, m, d).weekday()\n   799                                           \n   800     30000        49471      1.6      2.4              if calendar_start:\n   801         3          161     53.7      0.0                  calendar_start &= d == 1\n   802     30000        47977      1.6      2.3              if business_start:\n   803         3           84     28.0      0.0                  business_start &= d == 1 or (d <= 3 and wd == 0)\n   804                                           \n   805     30000      1344334     44.8     65.5              _, daysinmonth = monthrange(y, m)\n   806     30000       300513     10.0     14.7              cal = d == daysinmonth\n   807     30000        59340      2.0      2.9              if calendar_end:\n   808         3           23      7.7      0.0                  calendar_end &= cal\n   809     30000        50104      1.7      2.4              if business_end:\n   810         3           43     14.3      0.0                  business_end &= cal or (daysinmonth - d < 3 and wd == 4)\n   811                                           \n   812         3           14      4.7      0.0          if calendar_end:\n   813                                                       return 'ce'\n   814         3            5      1.7      0.0          elif business_end:\n   815                                                       return 'be'\n   816         3            5      1.7      0.0          elif calendar_start:\n   817                                                       return 'cs'\n   818         3            4      1.3      0.0          elif business_start:\n   819                                                       return 'bs'\n   820                                                   else:\n   821         3            6      2.0      0.0              return None\n```\n\nSo that code chunk gets executed 3x per data point. That seemsâ€¦not scalable. I do have a patch (worked with Erik Welch at the PyOhio sprints) to make the example above go from 2.4s to 1.0s, which helps. :) I'll try to attach it to this bug request, but might end up just having to create a new pull request.\n\nAnd after that I guess I should learn some Cython? :)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/7353451",
    "html_url": "https://github.com/pandas-dev/pandas/issues/1686#issuecomment-7353451",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/1686",
    "id": 7353451,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNTM0NTE=",
    "user": {
      "login": "taavi",
      "id": 35443,
      "node_id": "MDQ6VXNlcjM1NDQz",
      "avatar_url": "https://avatars2.githubusercontent.com/u/35443?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/taavi",
      "html_url": "https://github.com/taavi",
      "followers_url": "https://api.github.com/users/taavi/followers",
      "following_url": "https://api.github.com/users/taavi/following{/other_user}",
      "gists_url": "https://api.github.com/users/taavi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/taavi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/taavi/subscriptions",
      "organizations_url": "https://api.github.com/users/taavi/orgs",
      "repos_url": "https://api.github.com/users/taavi/repos",
      "events_url": "https://api.github.com/users/taavi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/taavi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-07-29T14:45:46Z",
    "updated_at": "2012-07-29T14:45:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "Given the code comment about Cython, maybe it's worthwhile keeping this issue open for now, despite the extra speed provided from #1699?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/7679180",
    "html_url": "https://github.com/pandas-dev/pandas/issues/1686#issuecomment-7679180",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/1686",
    "id": 7679180,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2NzkxODA=",
    "user": {
      "login": "wesm",
      "id": 329591,
      "node_id": "MDQ6VXNlcjMyOTU5MQ==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/329591?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wesm",
      "html_url": "https://github.com/wesm",
      "followers_url": "https://api.github.com/users/wesm/followers",
      "following_url": "https://api.github.com/users/wesm/following{/other_user}",
      "gists_url": "https://api.github.com/users/wesm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wesm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wesm/subscriptions",
      "organizations_url": "https://api.github.com/users/wesm/orgs",
      "repos_url": "https://api.github.com/users/wesm/repos",
      "events_url": "https://api.github.com/users/wesm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wesm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-08-12T19:49:47Z",
    "updated_at": "2012-08-12T19:49:47Z",
    "author_association": "MEMBER",
    "body": "Well, sorry about this one. I see the problem immediately (it's easier if you use cProfile) and will fix\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/7679226",
    "html_url": "https://github.com/pandas-dev/pandas/issues/1686#issuecomment-7679226",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/1686",
    "id": 7679226,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2NzkyMjY=",
    "user": {
      "login": "wesm",
      "id": 329591,
      "node_id": "MDQ6VXNlcjMyOTU5MQ==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/329591?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wesm",
      "html_url": "https://github.com/wesm",
      "followers_url": "https://api.github.com/users/wesm/followers",
      "following_url": "https://api.github.com/users/wesm/following{/other_user}",
      "gists_url": "https://api.github.com/users/wesm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wesm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wesm/subscriptions",
      "organizations_url": "https://api.github.com/users/wesm/orgs",
      "repos_url": "https://api.github.com/users/wesm/repos",
      "events_url": "https://api.github.com/users/wesm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wesm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-08-12T19:55:41Z",
    "updated_at": "2012-08-12T19:55:41Z",
    "author_association": "MEMBER",
    "body": "OK you'll be pleased to see it's basically instantaneous now\n"
  }
]
