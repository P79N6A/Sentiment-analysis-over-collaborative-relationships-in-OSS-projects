[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/350258170",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18686#issuecomment-350258170",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18686",
    "id": 350258170,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MDI1ODE3MA==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-08T13:04:01Z",
    "updated_at": "2017-12-08T13:04:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "Could you make a reproducible examples? What's `dfTotalCat`?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/353661522",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18686#issuecomment-353661522",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18686",
    "id": 353661522,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MzY2MTUyMg==",
    "user": {
      "login": "dfaivre",
      "id": 1211772,
      "node_id": "MDQ6VXNlcjEyMTE3NzI=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1211772?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dfaivre",
      "html_url": "https://github.com/dfaivre",
      "followers_url": "https://api.github.com/users/dfaivre/followers",
      "following_url": "https://api.github.com/users/dfaivre/following{/other_user}",
      "gists_url": "https://api.github.com/users/dfaivre/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dfaivre/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dfaivre/subscriptions",
      "organizations_url": "https://api.github.com/users/dfaivre/orgs",
      "repos_url": "https://api.github.com/users/dfaivre/repos",
      "events_url": "https://api.github.com/users/dfaivre/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dfaivre/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-22T19:30:44Z",
    "updated_at": "2017-12-22T19:30:44Z",
    "author_association": "NONE",
    "body": "If not _all_ of your columns are dummy encoded, then it will return some columns that are not sparse.  Seems like if you `df.to_sparse()` before dummy encoding, the error should go away.\r\n\r\n@TomAugspurger -- I don't know enough to know if this is expected behavior and docs just need to be updated (took me a bit to figure it out...)\r\n\r\nRepro code below\r\n\r\n```\r\nimport pandas as pd\r\n\r\ndf = pd.DataFrame(\r\n    {\r\n        \"A\": [\"a\", \"b\", \"c\", \"a\"],\r\n        \"B\": [1, 2, 3, 4]\r\n    })\r\ndf['A'] = df['A'].astype('category')\r\n\r\n\r\ndef _throw_no_attribute_sp_index_err():\r\n    one_hot = pd.get_dummies(df, sparse=True)\r\n    print(one_hot.columns)\r\n    one_hot.to_coo()\r\n\r\n\r\ndef _no_throw():\r\n    one_hot = pd.get_dummies(df.to_sparse(), sparse=True)\r\n    print(one_hot.columns)\r\n    one_hot.to_coo()\r\n````"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/353802790",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18686#issuecomment-353802790",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18686",
    "id": 353802790,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MzgwMjc5MA==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-24T20:54:49Z",
    "updated_at": "2017-12-24T20:54:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks. I'm not sure that `get_dummies(sparse=True)` should convert numeric columns. I think it's best to just document this."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/354002371",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18686#issuecomment-354002371",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18686",
    "id": 354002371,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NDAwMjM3MQ==",
    "user": {
      "login": "hexgnu",
      "id": 138510,
      "node_id": "MDQ6VXNlcjEzODUxMA==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/138510?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hexgnu",
      "html_url": "https://github.com/hexgnu",
      "followers_url": "https://api.github.com/users/hexgnu/followers",
      "following_url": "https://api.github.com/users/hexgnu/following{/other_user}",
      "gists_url": "https://api.github.com/users/hexgnu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hexgnu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hexgnu/subscriptions",
      "organizations_url": "https://api.github.com/users/hexgnu/orgs",
      "repos_url": "https://api.github.com/users/hexgnu/repos",
      "events_url": "https://api.github.com/users/hexgnu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hexgnu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-26T19:10:35Z",
    "updated_at": "2017-12-26T19:10:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "I did a little digging into this... and what happens is that get_dummies somehow casts the non-sparse column as sparse even though the underlying block is not sparse. Which causes some cascading issues like the sp_index error. Haven't quite figured out what is going on with that but right now my hypothesis is that it's something to do with how concat is working with sparse frames."
  }
]
