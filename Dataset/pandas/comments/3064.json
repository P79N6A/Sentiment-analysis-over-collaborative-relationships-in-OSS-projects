[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/14998363",
    "html_url": "https://github.com/pandas-dev/pandas/pull/3064#issuecomment-14998363",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3064",
    "id": 14998363,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0OTk4MzYz",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-03-16T02:57:39Z",
    "updated_at": "2013-03-16T02:57:39Z",
    "author_association": "NONE",
    "body": "needs a test case\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/14998469",
    "html_url": "https://github.com/pandas-dev/pandas/pull/3064#issuecomment-14998469",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3064",
    "id": 14998469,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0OTk4NDY5",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-03-16T03:06:59Z",
    "updated_at": "2013-03-16T07:23:10Z",
    "author_association": "NONE",
    "body": "should mean() be cast to int if the series has int dtype or vice-versa?\n\n``` python\nIn [30]: from pandas.util.testing import makeCustomDataframe as mkdf\nIn [26]: df=mkdf(3,2,data_gen_f=lambda *args: np.random.randint(5))\n\nIn [27]: df\nOut[27]: \nC0       C_l0_g0  C_l0_g1\nR0                       \nR_l0_g0        1        0\nR_l0_g1        3        4\nR_l0_g2        0        3\n\nIn [28]: df.mean()\nOut[28]: \nC0\nC_l0_g0    1.333333\nC_l0_g1    2.333333\ndtype: float64\n\nIn [29]: df.replace(3, df.mean())\nOut[29]: \nC0       C_l0_g0  C_l0_g1\nR0                       \nR_l0_g0        1        0\nR_l0_g1        1        4\nR_l0_g2        0        2\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/14999190",
    "html_url": "https://github.com/pandas-dev/pandas/pull/3064#issuecomment-14999190",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3064",
    "id": 14999190,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0OTk5MTkw",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-03-16T04:13:51Z",
    "updated_at": "2013-03-16T04:14:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "BlockManager handles this kind of upcasting for many other cases (e.g. the Int -> Float blocks), BUT, a casual glance at replace/replace_list in internals/BlockManager shows that this was never updated.\n\nBasically even though an inplace update happens, blocks are ALWAYS returned (which may be different/more than one), so that you have to return the blocks (see for example the eval methods)....\n\nSo instead of returning self (which COULD have the old blocks if new ones are created), need to create a new block manager (which you then assign at a higer level), e.g., DataFrame.where does this\n\n```\n    def replace_list(self, src_lst, dest_lst, inplace=False):\n        \"\"\" do a list replace \"\"\"\n        if not inplace:\n            self = self.copy()\n\n        sset = set(src_lst)\n        if any([k in sset for k in dest_lst]):\n            masks = {}\n            for s in src_lst:\n                masks[s] = [b.values == s for b in self.blocks]\n\n            THIS NEEDS A CHANGE\n            for s, d in zip(src_lst, dest_lst):\n                [b.putmask(masks[s][i], d, inplace=True) for i, b in\n                 enumerate(self.blocks)]\n        else:\n            for s, d in zip(src_lst, dest_lst):\n                self.replace(s, d, inplace=True)\n\n        return self\n```\n\nSomething like (you are doing what the apply method does, you can prob call apply in fact to do this)\n\n```\n   for s, d in zip(src_lst, dest_lst):\n      result _blocks= []\n      for i, b in enumerate(self.blocks):\n         result_blocks.extend(b.putmask(masks[s][i], d, inplace=True))\n\n    bm = self.__class__(result_blocks, self.axes)\n    bm._consolidate_inplace()\n    return bm\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/15006108",
    "html_url": "https://github.com/pandas-dev/pandas/pull/3064#issuecomment-15006108",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3064",
    "id": 15006108,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MDA2MTA4",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-03-16T15:01:01Z",
    "updated_at": "2013-03-16T15:01:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "@dieterv77 rebase on master and @y-p test case should work (with your fix)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/15006645",
    "html_url": "https://github.com/pandas-dev/pandas/pull/3064#issuecomment-15006645",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3064",
    "id": 15006645,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MDA2NjQ1",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-03-16T15:33:56Z",
    "updated_at": "2013-03-16T15:33:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "this is still broken....working on a fix\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/15008843",
    "html_url": "https://github.com/pandas-dev/pandas/pull/3064#issuecomment-15008843",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3064",
    "id": 15008843,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MDA4ODQz",
    "user": {
      "login": "dieterv77",
      "id": 453086,
      "node_id": "MDQ6VXNlcjQ1MzA4Ng==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/453086?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dieterv77",
      "html_url": "https://github.com/dieterv77",
      "followers_url": "https://api.github.com/users/dieterv77/followers",
      "following_url": "https://api.github.com/users/dieterv77/following{/other_user}",
      "gists_url": "https://api.github.com/users/dieterv77/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dieterv77/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dieterv77/subscriptions",
      "organizations_url": "https://api.github.com/users/dieterv77/orgs",
      "repos_url": "https://api.github.com/users/dieterv77/repos",
      "events_url": "https://api.github.com/users/dieterv77/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dieterv77/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-03-16T17:38:46Z",
    "updated_at": "2013-03-16T17:38:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "@y-p The original commit contains tests for handling Series, though not any related to the upcasting issues.  I can add some tests for that, though once that is sorted out.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/15011523",
    "html_url": "https://github.com/pandas-dev/pandas/pull/3064#issuecomment-15011523",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3064",
    "id": 15011523,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MDExNTIz",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-03-16T20:20:48Z",
    "updated_at": "2013-03-16T20:20:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "@dieterv77 update to master, this has been sorted\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/15014975",
    "html_url": "https://github.com/pandas-dev/pandas/pull/3064#issuecomment-15014975",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3064",
    "id": 15014975,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MDE0OTc1",
    "user": {
      "login": "dieterv77",
      "id": 453086,
      "node_id": "MDQ6VXNlcjQ1MzA4Ng==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/453086?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dieterv77",
      "html_url": "https://github.com/dieterv77",
      "followers_url": "https://api.github.com/users/dieterv77/followers",
      "following_url": "https://api.github.com/users/dieterv77/following{/other_user}",
      "gists_url": "https://api.github.com/users/dieterv77/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dieterv77/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dieterv77/subscriptions",
      "organizations_url": "https://api.github.com/users/dieterv77/orgs",
      "repos_url": "https://api.github.com/users/dieterv77/repos",
      "events_url": "https://api.github.com/users/dieterv77/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dieterv77/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-03-17T00:38:52Z",
    "updated_at": "2013-03-17T00:38:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "I did a rebase on my branch and resolved the conflicts.  However, now one of the unittests i added is failing:\n\ndf = DataFrame({'zero': {'a': 0.0, 'b': 1.0}, 'one': {'a': 2.0, 'b': 0.0}})\nresult = df.replace(0.0, {'zero': 0.5, 'one': 1.0})\nexpected = DataFrame({'zero': {'a': 0.5, 'b': 1}, 'one': {'a': 2.0, 'b': 1.0}})\nprint result, expected\n\nIs my expectation incorrect? i thought it should make the df['one']['b'] entry equal to 1.0, but instead it is giving 0.5\n\nthanks for all your time on this.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/15015272",
    "html_url": "https://github.com/pandas-dev/pandas/pull/3064#issuecomment-15015272",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3064",
    "id": 15015272,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MDE1Mjcy",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-03-17T01:07:54Z",
    "updated_at": "2013-03-17T01:07:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "I believe your expected is correct\nI think I know where the issue is\nI will put a revised up soon\n\nhad consolidated a bunch of code\nand must have missed this\n\nthxs \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/15016951",
    "html_url": "https://github.com/pandas-dev/pandas/pull/3064#issuecomment-15016951",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3064",
    "id": 15016951,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MDE2OTUx",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-03-17T03:56:29Z",
    "updated_at": "2013-03-17T03:56:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "@dieterv77 i fixed replace to work with your test case (it was an issue on some sub-filtering in internals.py)\n\nI incorporated your test cases and code changes....just easier that way\n\npls feel free to put in any more test cases if you'd like\n\nthis turned into a rabbit hole .....\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/15026252",
    "html_url": "https://github.com/pandas-dev/pandas/pull/3064#issuecomment-15026252",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3064",
    "id": 15026252,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MDI2MjUy",
    "user": {
      "login": "dieterv77",
      "id": 453086,
      "node_id": "MDQ6VXNlcjQ1MzA4Ng==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/453086?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dieterv77",
      "html_url": "https://github.com/dieterv77",
      "followers_url": "https://api.github.com/users/dieterv77/followers",
      "following_url": "https://api.github.com/users/dieterv77/following{/other_user}",
      "gists_url": "https://api.github.com/users/dieterv77/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dieterv77/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dieterv77/subscriptions",
      "organizations_url": "https://api.github.com/users/dieterv77/orgs",
      "repos_url": "https://api.github.com/users/dieterv77/repos",
      "events_url": "https://api.github.com/users/dieterv77/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dieterv77/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-03-17T17:00:04Z",
    "updated_at": "2013-03-17T17:00:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks a lot for all your time on this!  And sorry for taking you into this rabbit hole.\n"
  }
]
