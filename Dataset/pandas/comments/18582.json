[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/348469984",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18582#issuecomment-348469984",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18582",
    "id": 348469984,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODQ2OTk4NA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-01T11:18:06Z",
    "updated_at": "2017-12-01T11:18:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "the 2d ndarray input hits a path where a 1d array is expected, so this is a bug\r\n\r\nIdiomatically and what the ``DataFrame`` input hits is ``.where()`` \r\n```\r\nIn [1]: df = pd.DataFrame(np.random.randn(10, 5))\r\n   ...: INVALID = (df < -1)|(df > 1)\r\n\r\nIn [3]: df.where(INVALID.values)\r\nOut[3]: \r\n          0         1         2         3         4\r\n0  1.444995 -1.274442       NaN  1.252285  1.744645\r\n1       NaN       NaN  1.780958       NaN -1.790128\r\n2       NaN       NaN       NaN  1.737279       NaN\r\n3       NaN  1.854267       NaN  1.742598 -1.475852\r\n4       NaN       NaN  1.284623       NaN  1.002319\r\n5       NaN       NaN       NaN       NaN       NaN\r\n6  1.182883       NaN       NaN       NaN       NaN\r\n7       NaN       NaN       NaN       NaN       NaN\r\n8       NaN       NaN -2.538289       NaN  1.767622\r\n9 -1.057514  2.161599       NaN       NaN       NaN\r\n\r\nIn [4]: df.where(INVALID)\r\nOut[4]: \r\n          0         1         2         3         4\r\n0  1.444995 -1.274442       NaN  1.252285  1.744645\r\n1       NaN       NaN  1.780958       NaN -1.790128\r\n2       NaN       NaN       NaN  1.737279       NaN\r\n3       NaN  1.854267       NaN  1.742598 -1.475852\r\n4       NaN       NaN  1.284623       NaN  1.002319\r\n5       NaN       NaN       NaN       NaN       NaN\r\n6  1.182883       NaN       NaN       NaN       NaN\r\n7       NaN       NaN       NaN       NaN       NaN\r\n8       NaN       NaN -2.538289       NaN  1.767622\r\n9 -1.057514  2.161599       NaN       NaN       NaN\r\n```\r\n\r\nHere's a patch to implement the correct conversion (note might fail some existing tests). Alternatively we could raise\r\n```\r\ndiff --git a/pandas/core/frame.py b/pandas/core/frame.py\r\nindex d3561f8a0..82d9375e5 100644\r\n--- a/pandas/core/frame.py\r\n+++ b/pandas/core/frame.py\r\n@@ -2524,10 +2524,10 @@ class DataFrame(NDFrame):\r\n         if indexer is not None:\r\n             return self._setitem_slice(indexer, value)\r\n \r\n-        if isinstance(key, (Series, np.ndarray, list, Index)):\r\n-            self._setitem_array(key, value)\r\n-        elif isinstance(key, DataFrame):\r\n+        if isinstance(key, DataFrame) or getattr(key, 'ndim', None) == 2:\r\n             self._setitem_frame(key, value)\r\n+        elif isinstance(key, (Series, np.ndarray, list, Index)):\r\n+            self._setitem_array(key, value)\r\n         else:\r\n             # set column\r\n             self._set_item(key, value)\r\n@@ -2560,8 +2560,16 @@ class DataFrame(NDFrame):\r\n     def _setitem_frame(self, key, value):\r\n         # support boolean setting with DataFrame input, e.g.\r\n         # df[df > df2] = 0\r\n+\r\n+        if isinstance(key, np.ndarray):\r\n+            if key.shape != self.shape:\r\n+                raise ValueError('Array conditional must be same shape as '\r\n+                                 'self')\r\n+            key = self._constructor(key, **self._construct_axes_dict())\r\n+\r\n         if key.values.size and not is_bool_dtype(key.values):\r\n-            raise TypeError('Must pass DataFrame with boolean values only')\r\n+            raise TypeError('Must pass DataFrame or 2-d ndarray'\r\n+                            'with boolean values only')\r\n \r\n         self._check_inplace_setting(value)\r\n         self._check_setitem_copy()\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/348470004",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18582#issuecomment-348470004",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18582",
    "id": 348470004,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODQ3MDAwNA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-01T11:18:14Z",
    "updated_at": "2017-12-01T11:18:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "would love a PR!"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/348471718",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18582#issuecomment-348471718",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18582",
    "id": 348471718,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODQ3MTcxOA==",
    "user": {
      "login": "dhirschfeld",
      "id": 881019,
      "node_id": "MDQ6VXNlcjg4MTAxOQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/881019?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhirschfeld",
      "html_url": "https://github.com/dhirschfeld",
      "followers_url": "https://api.github.com/users/dhirschfeld/followers",
      "following_url": "https://api.github.com/users/dhirschfeld/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhirschfeld/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhirschfeld/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhirschfeld/subscriptions",
      "organizations_url": "https://api.github.com/users/dhirschfeld/orgs",
      "repos_url": "https://api.github.com/users/dhirschfeld/repos",
      "events_url": "https://api.github.com/users/dhirschfeld/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhirschfeld/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-01T11:27:13Z",
    "updated_at": "2017-12-01T11:27:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "> would love a PR!\r\n\r\nHa! Seems to be my weekend for getting stuck into pandas so I'll give it a crack..."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/348473742",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18582#issuecomment-348473742",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18582",
    "id": 348473742,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODQ3Mzc0Mg==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-01T11:37:53Z",
    "updated_at": "2017-12-01T11:37:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "thanks @dhirschfeld "
  }
]
