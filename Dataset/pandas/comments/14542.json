[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/257280043",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14542#issuecomment-257280043",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14542",
    "id": 257280043,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NzI4MDA0Mw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-31T12:22:00Z",
    "updated_at": "2016-10-31T12:22:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "what you are trying to do is simply unsupported. `numexpr` provides a fast evaluation engine, but is limited in the semantics.\n\n```\nIn [6]: df = pd.DataFrame(data=[(1,2),(3,4)], columns=['a', 'b'])\n   ...: pd.eval(\"sum(df) / 7\")\nValueError: \"sum\" is not a supported function\n```\n\nis a quite reasonable error message. You swapping out a function definition which is not supported.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/257447449",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14542#issuecomment-257447449",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14542",
    "id": 257447449,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NzQ0NzQ0OQ==",
    "user": {
      "login": "rmancy-smg",
      "id": 18017815,
      "node_id": "MDQ6VXNlcjE4MDE3ODE1",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18017815?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rmancy-smg",
      "html_url": "https://github.com/rmancy-smg",
      "followers_url": "https://api.github.com/users/rmancy-smg/followers",
      "following_url": "https://api.github.com/users/rmancy-smg/following{/other_user}",
      "gists_url": "https://api.github.com/users/rmancy-smg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rmancy-smg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rmancy-smg/subscriptions",
      "organizations_url": "https://api.github.com/users/rmancy-smg/orgs",
      "repos_url": "https://api.github.com/users/rmancy-smg/repos",
      "events_url": "https://api.github.com/users/rmancy-smg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rmancy-smg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-31T23:13:54Z",
    "updated_at": "2016-10-31T23:13:54Z",
    "author_association": "NONE",
    "body": "Ahh, the above code that you pasted is not the original that I put in the Issue.\n\nNotice that `sum()` in the eval is actually the `np.sum` because it was added to the 'local_dict' of the `pd.eval()` function. In your snippet above you are using the python `sum()` which is indeed unsupported. That's a _different_ error to the one my snippet is generating though.\n\nThe crux of the original error as I understand it is that `numexpr` (?) is trying to call `frozenset()` on an `ndarray` which is indeed unhashable.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/257448091",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14542#issuecomment-257448091",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14542",
    "id": 257448091,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NzQ0ODA5MQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-31T23:17:54Z",
    "updated_at": "2016-10-31T23:17:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "@rmancy-smg I did that on purpose. you are trying to substitue for a named function, which is not supported. This kind of evaluation is very specific in what it does; your usage is very odd .\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/257458536",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14542#issuecomment-257458536",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14542",
    "id": 257458536,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NzQ1ODUzNg==",
    "user": {
      "login": "rmancy-smg",
      "id": 18017815,
      "node_id": "MDQ6VXNlcjE4MDE3ODE1",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18017815?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rmancy-smg",
      "html_url": "https://github.com/rmancy-smg",
      "followers_url": "https://api.github.com/users/rmancy-smg/followers",
      "following_url": "https://api.github.com/users/rmancy-smg/following{/other_user}",
      "gists_url": "https://api.github.com/users/rmancy-smg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rmancy-smg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rmancy-smg/subscriptions",
      "organizations_url": "https://api.github.com/users/rmancy-smg/orgs",
      "repos_url": "https://api.github.com/users/rmancy-smg/repos",
      "events_url": "https://api.github.com/users/rmancy-smg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rmancy-smg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-01T00:17:45Z",
    "updated_at": "2016-11-01T00:17:45Z",
    "author_association": "NONE",
    "body": "Hmm, perhaps I'm not picking up what you're putting down, but even if you do the following:\n\n`pd.eval(\"df.sum() / 7\", engine='numexpr', local_dict={'df': df})`\n\nIt gives the same error. There is no substitution of a named function in this example. \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/257531157",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14542#issuecomment-257531157",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14542",
    "id": 257531157,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NzUzMTE1Nw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-01T10:13:51Z",
    "updated_at": "2016-11-01T10:13:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "The pandas semantics are geared towards columnwise operations, so the following is valid\n\n```\nIn [5]: df = pd.DataFrame(data=[(1,2),(3,4)], columns=['a', 'b'])\n   ...: pd.eval(\"a.sum() / 7\", engine='numexpr', local_dict={'a':df.a})\nOut[5]: 0.5714285714285714\n```\n\npassing a 2-d object directly is not supported, not really sure why you would want to go down this path. `df.sum() / 7` is much more intuitive / expected.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/257751275",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14542#issuecomment-257751275",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14542",
    "id": 257751275,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1Nzc1MTI3NQ==",
    "user": {
      "login": "rmancy-smg",
      "id": 18017815,
      "node_id": "MDQ6VXNlcjE4MDE3ODE1",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18017815?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rmancy-smg",
      "html_url": "https://github.com/rmancy-smg",
      "followers_url": "https://api.github.com/users/rmancy-smg/followers",
      "following_url": "https://api.github.com/users/rmancy-smg/following{/other_user}",
      "gists_url": "https://api.github.com/users/rmancy-smg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rmancy-smg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rmancy-smg/subscriptions",
      "organizations_url": "https://api.github.com/users/rmancy-smg/orgs",
      "repos_url": "https://api.github.com/users/rmancy-smg/repos",
      "events_url": "https://api.github.com/users/rmancy-smg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rmancy-smg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-02T01:55:14Z",
    "updated_at": "2016-11-02T01:55:14Z",
    "author_association": "NONE",
    "body": "Mostly because I'm trying to use `pd.eval()` for evaluating user defined functions (i.e `sum(x) / 7`) over pandas Dataframes. Specifically ,I needed it for the whole Dataframe as it was constructed such that each column represented user's timeseries data (and the intent was to apply the function over all user's data).\n\nAnyway, it's clear that it will not work like this, and i've since found a workaround. The only minor gripe I have is that the documentation states quite unequivocally that it should.\n\nThanks again for your insights @jreback\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/257814491",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14542#issuecomment-257814491",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14542",
    "id": 257814491,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NzgxNDQ5MQ==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-02T09:32:47Z",
    "updated_at": "2016-11-02T09:32:47Z",
    "author_association": "MEMBER",
    "body": "@rmancy-smg Passing dataframes works fine, eg:\n\n```\nIn [15]: pd.eval(\"df / 7\", local_dict={'df': df}, engine='numexpr')\nOut[15]: \n          a         b\n0  0.142857  0.285714\n1  0.428571  0.571429\n```\n\nIt was the function call `'df.sum()'` or `sum(df)` that is not supported. \n\nCan you point to the docs where you see this incorrectly stated? (unless you meant the dataframe-part) \nHere: http://pandas.pydata.org/pandas-docs/stable/enhancingperf.html#supported-syntax is a detailed overview of the supported syntax, and functions calls are listed in the 'not' section.\n\nWhen trying to evaluate auser defined function, you can simply do `sum(df)` instead of `pd.eval('sum(df)')`.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/258059641",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14542#issuecomment-258059641",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14542",
    "id": 258059641,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODA1OTY0MQ==",
    "user": {
      "login": "rmancy-smg",
      "id": 18017815,
      "node_id": "MDQ6VXNlcjE4MDE3ODE1",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18017815?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rmancy-smg",
      "html_url": "https://github.com/rmancy-smg",
      "followers_url": "https://api.github.com/users/rmancy-smg/followers",
      "following_url": "https://api.github.com/users/rmancy-smg/following{/other_user}",
      "gists_url": "https://api.github.com/users/rmancy-smg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rmancy-smg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rmancy-smg/subscriptions",
      "organizations_url": "https://api.github.com/users/rmancy-smg/orgs",
      "repos_url": "https://api.github.com/users/rmancy-smg/repos",
      "events_url": "https://api.github.com/users/rmancy-smg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rmancy-smg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-03T03:51:39Z",
    "updated_at": "2016-11-03T03:55:59Z",
    "author_association": "NONE",
    "body": "@jorisvandenbossche \n\nHmm, yeah the original quote from here[1] says this:\n\n> Series and DataFrame objects are supported and behave as they would with plain olâ€™ Python evaluation.\n\nWhich I just took to mean that using Series and Dataframe objects would work just as they do in \"plain ol' Python\", but maybe there are some semantics in there that I'm not interpreting correctly?\n\n1 http://pandas.pydata.org/pandas-docs/stable/generated/pandas.eval.html\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/258095272",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14542#issuecomment-258095272",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14542",
    "id": 258095272,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODA5NTI3Mg==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-03T09:26:16Z",
    "updated_at": "2016-11-03T09:26:16Z",
    "author_association": "MEMBER",
    "body": "@rmancy-smg What is meant is that the _supported operations_ work with series/dataframes as they would do in python. So that `\"df / 7\"` does what you expect. \nIt does not mean that every operation on dataframes will work, since not all syntax is supported, eg function calls are not supported. \nIf you want to clarify the wording in the docstring, feel free to open a PR!\n"
  }
]
