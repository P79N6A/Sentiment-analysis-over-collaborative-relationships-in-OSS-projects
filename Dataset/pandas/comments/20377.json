[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/373685881",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20377#issuecomment-373685881",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20377",
    "id": 373685881,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MzY4NTg4MQ==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-16T11:27:16Z",
    "updated_at": "2018-03-16T11:27:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for the report. Mind taking a look to see what's going on?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/373753973",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20377#issuecomment-373753973",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20377",
    "id": 373753973,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3Mzc1Mzk3Mw==",
    "user": {
      "login": "arnau126",
      "id": 7932044,
      "node_id": "MDQ6VXNlcjc5MzIwNDQ=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/7932044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arnau126",
      "html_url": "https://github.com/arnau126",
      "followers_url": "https://api.github.com/users/arnau126/followers",
      "following_url": "https://api.github.com/users/arnau126/following{/other_user}",
      "gists_url": "https://api.github.com/users/arnau126/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arnau126/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arnau126/subscriptions",
      "organizations_url": "https://api.github.com/users/arnau126/orgs",
      "repos_url": "https://api.github.com/users/arnau126/repos",
      "events_url": "https://api.github.com/users/arnau126/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arnau126/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-16T15:42:42Z",
    "updated_at": "2018-03-16T15:42:54Z",
    "author_association": "NONE",
    "body": "I've found the function that converts the `np.nan` to `'nan'`: `pandas.core.dtypes.astype_nansafe`.\r\n\r\n`read_excel` uses `PythonParser`. This parser has a function called `self._cast_types`, which uses `astype_nansafe`.\r\n\r\nhttps://github.com/pandas-dev/pandas/blob/master/pandas/io/parsers.py#L1570\r\n\r\nAn example of  `astype_nansafe`:\r\n```python\r\nIn [4]: from pandas.core.dtypes.cast import astype_nansafe\r\n\r\nIn [5]: arr = np.array([np.nan, 'a', 'b'], object)\r\n\r\nIn [6]: arr\r\nOut[6]: array([nan, 'a', 'b'], dtype=object)\r\n\r\nIn [7]: astype_nansafe(arr, str)\r\nOut[7]: array(['nan', 'a', 'b'], dtype=object)\r\n```\r\n\r\nI don't know if it's the expected behavior or not.\r\nShould we modify `astype_nansafe`? or `_cast_types`?.\r\n\r\nI'm not sure how to fix the issue."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/373935528",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20377#issuecomment-373935528",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20377",
    "id": 373935528,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MzkzNTUyOA==",
    "user": {
      "login": "cbertinato",
      "id": 20772838,
      "node_id": "MDQ6VXNlcjIwNzcyODM4",
      "avatar_url": "https://avatars2.githubusercontent.com/u/20772838?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cbertinato",
      "html_url": "https://github.com/cbertinato",
      "followers_url": "https://api.github.com/users/cbertinato/followers",
      "following_url": "https://api.github.com/users/cbertinato/following{/other_user}",
      "gists_url": "https://api.github.com/users/cbertinato/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cbertinato/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cbertinato/subscriptions",
      "organizations_url": "https://api.github.com/users/cbertinato/orgs",
      "repos_url": "https://api.github.com/users/cbertinato/repos",
      "events_url": "https://api.github.com/users/cbertinato/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cbertinato/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-17T16:57:12Z",
    "updated_at": "2018-03-17T17:05:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "Is that what one should expect when using `dtype=str`?  Not specifying `dtype` produces the expected result.  The default value is `None` and dtype conversion is done by row.\r\n\r\n```\r\nIn [16]: df = pd.read_excel('temp.xlsx')\r\n\r\nIn [17]: df\r\nOut[17]:\r\n     a\r\n0    x\r\n1    y\r\n2  NaN\r\n3    z\r\n\r\nIn [18]: df.loc[2, 'a']\r\nOut[18]: nan\r\n\r\nIn [19]: type(df.loc[2, 'a'])\r\nOut[19]: float\r\n\r\nIn [20]: type(df.loc[1, 'a'])\r\nOut[20]: str\r\n```\r\n\r\nI think that the output for `dtype=str` is expected behavior."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/373958142",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20377#issuecomment-373958142",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20377",
    "id": 373958142,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3Mzk1ODE0Mg==",
    "user": {
      "login": "nikoskaragiannakis",
      "id": 10605673,
      "node_id": "MDQ6VXNlcjEwNjA1Njcz",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10605673?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikoskaragiannakis",
      "html_url": "https://github.com/nikoskaragiannakis",
      "followers_url": "https://api.github.com/users/nikoskaragiannakis/followers",
      "following_url": "https://api.github.com/users/nikoskaragiannakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikoskaragiannakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikoskaragiannakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikoskaragiannakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikoskaragiannakis/orgs",
      "repos_url": "https://api.github.com/users/nikoskaragiannakis/repos",
      "events_url": "https://api.github.com/users/nikoskaragiannakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikoskaragiannakis/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-17T22:40:14Z",
    "updated_at": "2018-03-17T22:40:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "`read_csv` returns what you would expect\r\n```python\r\nfrom io import StringIO\r\nimport pandas as pd\r\n\r\narr = pd.read_csv(StringIO('col1, col2, col3\\n,a,b'), dtype=str)\r\n```\r\nit will give you\r\n```\r\n  col1  col2  col3\r\n0  NaN     a     b\r\n```\r\nso, I guess, what you expect from `read_excel` seems to be consistent with this.\r\n\r\nI guess, if this needs to be changed, the best would be to change `astype_unicode` in `pandas/_libs/lib.pyx`.\r\nWhat do you think?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/373959093",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20377#issuecomment-373959093",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20377",
    "id": 373959093,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3Mzk1OTA5Mw==",
    "user": {
      "login": "nikoskaragiannakis",
      "id": 10605673,
      "node_id": "MDQ6VXNlcjEwNjA1Njcz",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10605673?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikoskaragiannakis",
      "html_url": "https://github.com/nikoskaragiannakis",
      "followers_url": "https://api.github.com/users/nikoskaragiannakis/followers",
      "following_url": "https://api.github.com/users/nikoskaragiannakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikoskaragiannakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikoskaragiannakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikoskaragiannakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikoskaragiannakis/orgs",
      "repos_url": "https://api.github.com/users/nikoskaragiannakis/repos",
      "events_url": "https://api.github.com/users/nikoskaragiannakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikoskaragiannakis/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-17T22:58:40Z",
    "updated_at": "2018-03-17T22:58:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "@cbertinato just saw your comment! Good point. "
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/374146362",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20377#issuecomment-374146362",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20377",
    "id": 374146362,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NDE0NjM2Mg==",
    "user": {
      "login": "arnau126",
      "id": 7932044,
      "node_id": "MDQ6VXNlcjc5MzIwNDQ=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/7932044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arnau126",
      "html_url": "https://github.com/arnau126",
      "followers_url": "https://api.github.com/users/arnau126/followers",
      "following_url": "https://api.github.com/users/arnau126/following{/other_user}",
      "gists_url": "https://api.github.com/users/arnau126/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arnau126/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arnau126/subscriptions",
      "organizations_url": "https://api.github.com/users/arnau126/orgs",
      "repos_url": "https://api.github.com/users/arnau126/repos",
      "events_url": "https://api.github.com/users/arnau126/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arnau126/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-19T09:15:22Z",
    "updated_at": "2018-03-19T09:15:33Z",
    "author_association": "NONE",
    "body": "@cbertinato, if I have a column with numbers, but I want to read them as strings I need to specify `dtype=str`, otherwise they will be read as float.\r\n```python\r\nIn [1]: df = pd.DataFrame({'a': ['1', '2', '', '3']})\r\n\r\nIn [2]: df.to_excel('temp.xlsx')\r\n\r\nIn [3]: pd.read_excel('temp.xlsx', dtype=str)\r\nOut[3]: \r\n     a\r\n0   1\r\n1   2\r\n2  nan\r\n3   3\r\n\r\nIn [5]: pd.read_excel('temp.xlsx')\r\nOut[5]: \r\n     a\r\n0  1.0\r\n1  2.0\r\n2  NaN\r\n3  3.0\r\n\r\n```\r\n\r\nMoreover, as @nikoskaragiannakis says, it should be consistent with `read_csv`."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/374199322",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20377#issuecomment-374199322",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20377",
    "id": 374199322,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NDE5OTMyMg==",
    "user": {
      "login": "cbertinato",
      "id": 20772838,
      "node_id": "MDQ6VXNlcjIwNzcyODM4",
      "avatar_url": "https://avatars2.githubusercontent.com/u/20772838?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cbertinato",
      "html_url": "https://github.com/cbertinato",
      "followers_url": "https://api.github.com/users/cbertinato/followers",
      "following_url": "https://api.github.com/users/cbertinato/following{/other_user}",
      "gists_url": "https://api.github.com/users/cbertinato/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cbertinato/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cbertinato/subscriptions",
      "organizations_url": "https://api.github.com/users/cbertinato/orgs",
      "repos_url": "https://api.github.com/users/cbertinato/repos",
      "events_url": "https://api.github.com/users/cbertinato/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cbertinato/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-19T12:45:47Z",
    "updated_at": "2018-03-19T12:45:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "I missed the use case for numbers, and @nikoskaragiannakis's comment. It should probably be consistent with `read_csv`."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/374208616",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20377#issuecomment-374208616",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20377",
    "id": 374208616,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NDIwODYxNg==",
    "user": {
      "login": "nikoskaragiannakis",
      "id": 10605673,
      "node_id": "MDQ6VXNlcjEwNjA1Njcz",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10605673?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikoskaragiannakis",
      "html_url": "https://github.com/nikoskaragiannakis",
      "followers_url": "https://api.github.com/users/nikoskaragiannakis/followers",
      "following_url": "https://api.github.com/users/nikoskaragiannakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikoskaragiannakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikoskaragiannakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikoskaragiannakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikoskaragiannakis/orgs",
      "repos_url": "https://api.github.com/users/nikoskaragiannakis/repos",
      "events_url": "https://api.github.com/users/nikoskaragiannakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikoskaragiannakis/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-19T13:19:58Z",
    "updated_at": "2018-03-19T13:20:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "@cbertinato if the case is as @arnau126 says, then I can make a fix for this."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/374453692",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20377#issuecomment-374453692",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20377",
    "id": 374453692,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NDQ1MzY5Mg==",
    "user": {
      "login": "nikoskaragiannakis",
      "id": 10605673,
      "node_id": "MDQ6VXNlcjEwNjA1Njcz",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10605673?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikoskaragiannakis",
      "html_url": "https://github.com/nikoskaragiannakis",
      "followers_url": "https://api.github.com/users/nikoskaragiannakis/followers",
      "following_url": "https://api.github.com/users/nikoskaragiannakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikoskaragiannakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikoskaragiannakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikoskaragiannakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikoskaragiannakis/orgs",
      "repos_url": "https://api.github.com/users/nikoskaragiannakis/repos",
      "events_url": "https://api.github.com/users/nikoskaragiannakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikoskaragiannakis/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-20T02:43:30Z",
    "updated_at": "2018-03-20T02:43:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Question: When we use `dtype=str` do we want `np.nan` to turn to a string `\"nan\"` or to stay as it is?\r\nI made a fix for this issue, but the above functionality is affected."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/374512887",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20377#issuecomment-374512887",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20377",
    "id": 374512887,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NDUxMjg4Nw==",
    "user": {
      "login": "arnau126",
      "id": 7932044,
      "node_id": "MDQ6VXNlcjc5MzIwNDQ=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/7932044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arnau126",
      "html_url": "https://github.com/arnau126",
      "followers_url": "https://api.github.com/users/arnau126/followers",
      "following_url": "https://api.github.com/users/arnau126/following{/other_user}",
      "gists_url": "https://api.github.com/users/arnau126/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arnau126/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arnau126/subscriptions",
      "organizations_url": "https://api.github.com/users/arnau126/orgs",
      "repos_url": "https://api.github.com/users/arnau126/repos",
      "events_url": "https://api.github.com/users/arnau126/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arnau126/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-20T08:24:46Z",
    "updated_at": "2018-03-20T08:24:46Z",
    "author_association": "NONE",
    "body": "The purpose of this issue is just change this functionality: currently `np.nan` turns to a string `\"nan\"`, and I think that it should stay as it."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/374659716",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20377#issuecomment-374659716",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20377",
    "id": 374659716,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NDY1OTcxNg==",
    "user": {
      "login": "cbertinato",
      "id": 20772838,
      "node_id": "MDQ6VXNlcjIwNzcyODM4",
      "avatar_url": "https://avatars2.githubusercontent.com/u/20772838?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cbertinato",
      "html_url": "https://github.com/cbertinato",
      "followers_url": "https://api.github.com/users/cbertinato/followers",
      "following_url": "https://api.github.com/users/cbertinato/following{/other_user}",
      "gists_url": "https://api.github.com/users/cbertinato/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cbertinato/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cbertinato/subscriptions",
      "organizations_url": "https://api.github.com/users/cbertinato/orgs",
      "repos_url": "https://api.github.com/users/cbertinato/repos",
      "events_url": "https://api.github.com/users/cbertinato/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cbertinato/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-20T16:17:38Z",
    "updated_at": "2018-03-20T16:17:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "As @arnau126 points out, the result from `pd.read_excel` with `dtype=str` is inconsistent with that from `pd.read_csv`.  The value of placing a `np.nan` instead of the string representation is that you can use `pd.isna`, which does not work for 'nan'. So the thought is to make `read_excel` consistent with `read_csv`."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/374693647",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20377#issuecomment-374693647",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20377",
    "id": 374693647,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NDY5MzY0Nw==",
    "user": {
      "login": "nikoskaragiannakis",
      "id": 10605673,
      "node_id": "MDQ6VXNlcjEwNjA1Njcz",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10605673?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikoskaragiannakis",
      "html_url": "https://github.com/nikoskaragiannakis",
      "followers_url": "https://api.github.com/users/nikoskaragiannakis/followers",
      "following_url": "https://api.github.com/users/nikoskaragiannakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikoskaragiannakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikoskaragiannakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikoskaragiannakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikoskaragiannakis/orgs",
      "repos_url": "https://api.github.com/users/nikoskaragiannakis/repos",
      "events_url": "https://api.github.com/users/nikoskaragiannakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikoskaragiannakis/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-20T17:49:15Z",
    "updated_at": "2018-03-20T17:49:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "@cbertinato @arnau126 maybe my question wasn't very clear.\r\nI suggested changing `astype_unicode` and `astype_str` (https://github.com/pandas-dev/pandas/blob/master/pandas/_libs/lib.pyx#L460-L483), which would mean that `'nan'` would **always** become `np.nan`.\r\n\r\nIf we only want to change the `read_excel` function, then we could just substitute all the `'nan'` to `np.nan` before we return the result to the user. Not very elegant, but it would only affect `read_excel`.\r\n\r\nWhich one do we want here?\r\n\r\nSorry if I misunderstood what you guys are saying."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/374696375",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20377#issuecomment-374696375",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20377",
    "id": 374696375,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NDY5NjM3NQ==",
    "user": {
      "login": "cbertinato",
      "id": 20772838,
      "node_id": "MDQ6VXNlcjIwNzcyODM4",
      "avatar_url": "https://avatars2.githubusercontent.com/u/20772838?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cbertinato",
      "html_url": "https://github.com/cbertinato",
      "followers_url": "https://api.github.com/users/cbertinato/followers",
      "following_url": "https://api.github.com/users/cbertinato/following{/other_user}",
      "gists_url": "https://api.github.com/users/cbertinato/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cbertinato/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cbertinato/subscriptions",
      "organizations_url": "https://api.github.com/users/cbertinato/orgs",
      "repos_url": "https://api.github.com/users/cbertinato/repos",
      "events_url": "https://api.github.com/users/cbertinato/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cbertinato/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-20T17:56:34Z",
    "updated_at": "2018-03-20T17:58:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think that the latter would be safer and less likely to break something else. This is clearly only an issue for `read_excel` and not `read_csv`."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/374709301",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20377#issuecomment-374709301",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20377",
    "id": 374709301,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NDcwOTMwMQ==",
    "user": {
      "login": "nikoskaragiannakis",
      "id": 10605673,
      "node_id": "MDQ6VXNlcjEwNjA1Njcz",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10605673?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikoskaragiannakis",
      "html_url": "https://github.com/nikoskaragiannakis",
      "followers_url": "https://api.github.com/users/nikoskaragiannakis/followers",
      "following_url": "https://api.github.com/users/nikoskaragiannakis/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikoskaragiannakis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikoskaragiannakis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikoskaragiannakis/subscriptions",
      "organizations_url": "https://api.github.com/users/nikoskaragiannakis/orgs",
      "repos_url": "https://api.github.com/users/nikoskaragiannakis/repos",
      "events_url": "https://api.github.com/users/nikoskaragiannakis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikoskaragiannakis/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-20T18:33:07Z",
    "updated_at": "2018-03-20T18:33:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "It is clear now, thanks. I'll do the changes."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/446221734",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20377#issuecomment-446221734",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20377",
    "id": 446221734,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NjIyMTczNA==",
    "user": {
      "login": "yoonghm",
      "id": 4215991,
      "node_id": "MDQ6VXNlcjQyMTU5OTE=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/4215991?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yoonghm",
      "html_url": "https://github.com/yoonghm",
      "followers_url": "https://api.github.com/users/yoonghm/followers",
      "following_url": "https://api.github.com/users/yoonghm/following{/other_user}",
      "gists_url": "https://api.github.com/users/yoonghm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yoonghm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yoonghm/subscriptions",
      "organizations_url": "https://api.github.com/users/yoonghm/orgs",
      "repos_url": "https://api.github.com/users/yoonghm/repos",
      "events_url": "https://api.github.com/users/yoonghm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yoonghm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-11T14:30:11Z",
    "updated_at": "2018-12-11T16:11:16Z",
    "author_association": "NONE",
    "body": "Treating an empty value in Excel as `nan` has another side effect: integer will be converted to float. Subsequent operation on that columns will have other effects again.\r\n\r\nAlso `read_excel()` does not honor empty value handling offered by function in converters:\r\n\r\nI have an Excel file `temp.xlsx` with the following data:\r\n\r\n```\r\nKey1,Key2,Key3,Key4\r\n0,11.0,  Apple  ,1.12\r\n1,12.0,,1.02\r\n2,13.0,  Orange,\r\n3,  Banana  ,0.01\r\n```\r\n\r\nThis is the code:\r\n\r\n```Python\r\nimport numpy as np\r\nimport pandas as pd\r\n\r\ndef handle_string(value):\r\n    return value.replace(' ', '')\r\n\r\ndef handle_integer(value):\r\n    if value == '':\r\n        return 0\r\n    else:\r\n        int(value)\r\n\r\ndef handle_float(value):\r\n    if value == '':\r\n        return 0.0\r\n    else:\r\n        float(value)\r\n\r\ndf = pd.read_excel(\r\n        'temp.xlsx',\r\n)\r\nprint(df)\r\nprint(f\"type(df.loc[3,'Key2']) = {type(df.loc[3,'Key2'])}\")\r\nprint(f\"type(df.loc[1,'Key3']) = {type(df.loc[1,'Key3'])}\")\r\nprint(f\"type(df.loc[2,'Key4']) = {type(df.loc[2,'Key4'])}\")\r\n\r\nprint('')\r\n\r\ndf = pd.read_excel(\r\n        'temp.xlsx',\r\n        converters={\\\r\n            'Key1' : handle_integer,\r\n            'Key2' : handle_integer,\r\n            'Key3' : handle_string,\r\n            'Key4' : handle_float,\r\n        }\r\n)\r\nprint(df)\r\nprint(f\"type(df.loc[3,'Key2']) = {type(df.loc[3,'Key2'])}\")\r\nprint(f\"type(df.loc[1,'Key3']) = {type(df.loc[1,'Key3'])}\")\r\nprint(f\"type(df.loc[2,'Key4']) = {type(df.loc[2,'Key4'])}\")\r\n\r\nThe output:\r\n\r\n```\r\n   Key1  Key2        Key3  Key4\r\n0     0  11.0     Apple    1.12\r\n1     1  12.0         NaN  1.02\r\n2     2  13.0    Orange     NaN\r\n3     3   NaN    Banana    0.01\r\ntype(df.loc[3,'Key2']) = <class 'numpy.float64'>\r\ntype(df.loc[1,'Key3']) = <class 'float'>\r\ntype(df.loc[2,'Key4']) = <class 'numpy.float64'>\r\n\r\n   Key1  Key2    Key3  Key4\r\n0  None   NaN   Apple   NaN\r\n1  None   NaN     NaN   NaN\r\n2  None   NaN  Orange   0.0\r\n3  None   0.0  Banana   NaN\r\ntype(df.loc[3,'Key2']) = <class 'numpy.float64'>\r\ntype(df.loc[1,'Key3']) = <class 'float'>\r\ntype(df.loc[2,'Key4']) = <class 'numpy.float64'>\r\n```"
  }
]
