[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/258801112",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14600#issuecomment-258801112",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14600",
    "id": 258801112,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODgwMTExMg==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-07T10:35:17Z",
    "updated_at": "2016-11-07T10:35:17Z",
    "author_association": "MEMBER",
    "body": "The underlying reason is possibly that `union` does not return a sorted result in case of Categoricals (which is a bug I think):\n\n```\nIn [116]: s1.index.union(s2.index)    ## <--- not sorted result\nOut[116]: CategoricalIndex(['female', 'male', 'unknown', 'f', 'm'], categories=['f', 'female', 'm', 'male', 'unknown'], ordered=False, dtype='category')\n\nIn [117]: s1.index.union(s2.index).sort_values()\nOut[117]: CategoricalIndex(['f', 'female', 'm', 'male', 'unknown'], categories=['f', 'female', 'm', 'male', 'unknown'], ordered=False, dtype='category')\n\nIn [119]: s1.index.astype(object).union(s2.index.astype(object))    ## <--- sorted result\nOut[119]: Index(['f', 'female', 'm', 'male', 'unknown'], dtype='object')\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/271615711",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14600#issuecomment-271615711",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14600",
    "id": 271615711,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTYxNTcxMQ==",
    "user": {
      "login": "nathalier",
      "id": 7697396,
      "node_id": "MDQ6VXNlcjc2OTczOTY=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/7697396?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathalier",
      "html_url": "https://github.com/nathalier",
      "followers_url": "https://api.github.com/users/nathalier/followers",
      "following_url": "https://api.github.com/users/nathalier/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathalier/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathalier/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathalier/subscriptions",
      "organizations_url": "https://api.github.com/users/nathalier/orgs",
      "repos_url": "https://api.github.com/users/nathalier/repos",
      "events_url": "https://api.github.com/users/nathalier/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathalier/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-10T16:02:54Z",
    "updated_at": "2017-01-10T16:02:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hello!\r\nI looked at this bug and I found that the source of that particular error was in the next section of code (in union() ):\r\n```\r\nif self.is_monotonic and other.is_monotonic:\r\n   try:\r\n      result = self._outer_indexer(self._values, other._values)[0]\r\n   except TypeError:\r\n      # incomparable objects\r\n.......\r\n```\r\nwhere _outer_indexer() expected ndarray and not categorical. That caused TypeError.\r\nAvoiding this section for categorical values resolve the bug.\r\n\r\nBut after I wrote tests another problem was discovered.\r\nindices of different values (of self and other) in union() is defined based on categories list, while diff values themselves are defined based on values of CategorialIndex. Thus, it uses incorect mask to define differences, and if the order of CategoricalIndex values does not correspond to ordered categories list, different errors appear. \r\nI'm not sure I'm clear enough:-) \r\nThe example could be as follows:\r\n```\r\ns1 = pd.Series([6, 39, 4], index=pd.CategoricalIndex(['male', 'female', 'unknown']))\r\ns2 = pd.Series([150, 2, 1, 242], index=pd.CategoricalIndex(['unknown', 'm', 'f', 'male'],\r\n                categories=['m', 'male', 'f', 'unknown'], ordered=True))\r\nres = pd.DataFrame([s1, s2])\r\n```\r\nThis causes IndexError: list index out of range.\r\n\r\nSo based on which should union() work: on indices or on underlying categories? Or they both should be joined, taking into account that the list of categories may be wider than the list of indices ? Or maybe it worse to sort indices firstly and than pass it to union()? "
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/271737729",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14600#issuecomment-271737729",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14600",
    "id": 271737729,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTczNzcyOQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-11T00:04:45Z",
    "updated_at": "2017-01-11T00:04:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "@nathalier thanks for having a look!\r\n\r\nyes both of these things appear wrong. The general principal that we try to follow is that Categoricals (or CategoricalIndex) can be combined if they are dtype equal (is_dtype_equal is True). IOW, there categories and ordered flags match.\r\n\r\nThen they should be combined and stay categoricals.\r\n\r\nOtherwise we still allow combinations, BUT coerce to object, then follow union / diff logic.\r\n\r\nSo happy to have more tests / fixes."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/395983761",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14600#issuecomment-395983761",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14600",
    "id": 395983761,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NTk4Mzc2MQ==",
    "user": {
      "login": "jcontesti",
      "id": 25779507,
      "node_id": "MDQ6VXNlcjI1Nzc5NTA3",
      "avatar_url": "https://avatars1.githubusercontent.com/u/25779507?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jcontesti",
      "html_url": "https://github.com/jcontesti",
      "followers_url": "https://api.github.com/users/jcontesti/followers",
      "following_url": "https://api.github.com/users/jcontesti/following{/other_user}",
      "gists_url": "https://api.github.com/users/jcontesti/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jcontesti/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jcontesti/subscriptions",
      "organizations_url": "https://api.github.com/users/jcontesti/orgs",
      "repos_url": "https://api.github.com/users/jcontesti/repos",
      "events_url": "https://api.github.com/users/jcontesti/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jcontesti/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-09T16:55:41Z",
    "updated_at": "2018-06-09T16:55:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "I start to work with this issue."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/413318910",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14600#issuecomment-413318910",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14600",
    "id": 413318910,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMzMxODkxMA==",
    "user": {
      "login": "jcontesti",
      "id": 25779507,
      "node_id": "MDQ6VXNlcjI1Nzc5NTA3",
      "avatar_url": "https://avatars1.githubusercontent.com/u/25779507?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jcontesti",
      "html_url": "https://github.com/jcontesti",
      "followers_url": "https://api.github.com/users/jcontesti/followers",
      "following_url": "https://api.github.com/users/jcontesti/following{/other_user}",
      "gists_url": "https://api.github.com/users/jcontesti/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jcontesti/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jcontesti/subscriptions",
      "organizations_url": "https://api.github.com/users/jcontesti/orgs",
      "repos_url": "https://api.github.com/users/jcontesti/repos",
      "events_url": "https://api.github.com/users/jcontesti/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jcontesti/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-15T20:06:07Z",
    "updated_at": "2018-08-15T20:06:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "This bug was fixed in version 0.20.1.\r\n\r\nUsing the current development version, this code:\r\n\r\n```\r\ns1 = pd.Series([39,6,4], index=pd.CategoricalIndex(['female','male','unknown']))\r\ns2 = pd.Series([2,152,2,242,150], index=pd.CategoricalIndex(['f','female','m','male','unknown']))\r\npd.DataFrame([s1,s2])\r\n```\r\n\r\nreturns the correct result:\r\n\r\n```\r\n   female   male  unknown    f    m\r\n0    39.0    6.0      4.0  NaN  NaN\r\n1   152.0  242.0    150.0  2.0  2.0\r\n```\r\n\r\nAnd the nathalier’s code runs without error too:\r\n\r\n```\r\ns1 = pd.Series([6, 39, 4], index=pd.CategoricalIndex(['male', 'female', 'unknown']))\r\ns2 = pd.Series([150, 2, 1, 242], index=pd.CategoricalIndex(['unknown', 'm', 'f', 'male'],\r\n                categories=['m', 'male', 'f', 'unknown'], ordered=True))\r\npd.DataFrame([s1, s2])\r\n```\r\n\r\nThe result is:\r\n```\r\n     f  female    m   male  unknown\r\n0  NaN    39.0  NaN    6.0      4.0\r\n1  1.0     NaN  2.0  242.0    150.0\r\n```\r\n\r\nPlease, let me know if I can help with anything else! "
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/413345656",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14600#issuecomment-413345656",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14600",
    "id": 413345656,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMzM0NTY1Ng==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-15T21:36:14Z",
    "updated_at": "2018-08-15T21:36:14Z",
    "author_association": "MEMBER",
    "body": "@jcontesti Thanks for checking this! \r\nTo close this issue, it would be good to still add some tests to ensure the cases from this issue keep working (or at least investigate if such tests have been added when it was fixed). PR with tests welcome!"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/449976794",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14600#issuecomment-449976794",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14600",
    "id": 449976794,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0OTk3Njc5NA==",
    "user": {
      "login": "jcontesti",
      "id": 25779507,
      "node_id": "MDQ6VXNlcjI1Nzc5NTA3",
      "avatar_url": "https://avatars1.githubusercontent.com/u/25779507?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jcontesti",
      "html_url": "https://github.com/jcontesti",
      "followers_url": "https://api.github.com/users/jcontesti/followers",
      "following_url": "https://api.github.com/users/jcontesti/following{/other_user}",
      "gists_url": "https://api.github.com/users/jcontesti/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jcontesti/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jcontesti/subscriptions",
      "organizations_url": "https://api.github.com/users/jcontesti/orgs",
      "repos_url": "https://api.github.com/users/jcontesti/repos",
      "events_url": "https://api.github.com/users/jcontesti/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jcontesti/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-26T14:51:19Z",
    "updated_at": "2018-12-26T14:51:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "I go on with this one."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/455879544",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14600#issuecomment-455879544",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14600",
    "id": 455879544,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NTg3OTU0NA==",
    "user": {
      "login": "jcontesti",
      "id": 25779507,
      "node_id": "MDQ6VXNlcjI1Nzc5NTA3",
      "avatar_url": "https://avatars1.githubusercontent.com/u/25779507?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jcontesti",
      "html_url": "https://github.com/jcontesti",
      "followers_url": "https://api.github.com/users/jcontesti/followers",
      "following_url": "https://api.github.com/users/jcontesti/following{/other_user}",
      "gists_url": "https://api.github.com/users/jcontesti/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jcontesti/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jcontesti/subscriptions",
      "organizations_url": "https://api.github.com/users/jcontesti/orgs",
      "repos_url": "https://api.github.com/users/jcontesti/repos",
      "events_url": "https://api.github.com/users/jcontesti/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jcontesti/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-20T16:15:05Z",
    "updated_at": "2019-01-20T16:15:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi, I have the tests prepared to commit, but now the bug strikes back again :-(\r\n\r\nThis code:\r\n```\r\ns1 = pd.Series([1, 2], index=pd.CategoricalIndex(['A', 'B']))\r\ns2 = pd.Series([3, 4], index=pd.CategoricalIndex(['B', 'C']))\r\npd.DataFrame([s1,s2])\r\n```\r\nreturns:\r\n```\r\n     A    B  NaN\r\n0  1.0  2.0  NaN\r\n1  NaN  3.0  NaN\r\n```\r\ninstead of:\r\n```\r\n     A    B    C\r\n0  1.0  2.0  NaN\r\n1  NaN  3.0  4.0\r\n```\r\nVersion 0.23.4 executes it right, but v0.24.0rc1 and development version fail. Remember that this bug was solved since version 0.20.1.\r\n\r\nI can help with the solution, but I need some help to know how to proceed because of my little knowledge of the internals of this project.\r\n\r\nThank you!"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/455885955",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14600#issuecomment-455885955",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14600",
    "id": 455885955,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NTg4NTk1NQ==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-20T17:37:00Z",
    "updated_at": "2019-01-20T17:37:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jcontesti can you open a new issue for that constructor bug?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/458722638",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14600#issuecomment-458722638",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14600",
    "id": 458722638,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1ODcyMjYzOA==",
    "user": {
      "login": "jcontesti",
      "id": 25779507,
      "node_id": "MDQ6VXNlcjI1Nzc5NTA3",
      "avatar_url": "https://avatars1.githubusercontent.com/u/25779507?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jcontesti",
      "html_url": "https://github.com/jcontesti",
      "followers_url": "https://api.github.com/users/jcontesti/followers",
      "following_url": "https://api.github.com/users/jcontesti/following{/other_user}",
      "gists_url": "https://api.github.com/users/jcontesti/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jcontesti/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jcontesti/subscriptions",
      "organizations_url": "https://api.github.com/users/jcontesti/orgs",
      "repos_url": "https://api.github.com/users/jcontesti/repos",
      "events_url": "https://api.github.com/users/jcontesti/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jcontesti/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-29T21:55:33Z",
    "updated_at": "2019-01-29T21:55:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "@TomAugspurger Could it be already opened in #24845? It's a very similar bug. Let me know if you want me to add a new issue anyway. "
  }
]
