[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/341970015",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18123#issuecomment-341970015",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18123",
    "id": 341970015,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTk3MDAxNQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-05T12:38:20Z",
    "updated_at": "2017-11-05T12:38:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "in 1.13.3\r\n```\r\nIn [19]: DataFrame([1.12345678901234567890]).astype(str)\r\nOut[19]: \r\n               0\r\n0  1.12345678901\r\n\r\n```\r\n\r\ncc @charris\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/341981450",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18123#issuecomment-341981450",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18123",
    "id": 341981450,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTk4MTQ1MA==",
    "user": {
      "login": "charris",
      "id": 77272,
      "node_id": "MDQ6VXNlcjc3Mjcy",
      "avatar_url": "https://avatars3.githubusercontent.com/u/77272?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/charris",
      "html_url": "https://github.com/charris",
      "followers_url": "https://api.github.com/users/charris/followers",
      "following_url": "https://api.github.com/users/charris/following{/other_user}",
      "gists_url": "https://api.github.com/users/charris/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/charris/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/charris/subscriptions",
      "organizations_url": "https://api.github.com/users/charris/orgs",
      "repos_url": "https://api.github.com/users/charris/repos",
      "events_url": "https://api.github.com/users/charris/events{/privacy}",
      "received_events_url": "https://api.github.com/users/charris/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-05T15:28:46Z",
    "updated_at": "2017-11-05T15:28:46Z",
    "author_association": "NONE",
    "body": "1.13.3 or current 1,14? In any case, this is probably https://github.com/numpy/numpy/pull/9941. NumPy now has its own value -> string conversion functions and there will probably be some small changes in the output. However, the strings should maintain value on back conversion."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/341982278",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18123#issuecomment-341982278",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18123",
    "id": 341982278,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTk4MjI3OA==",
    "user": {
      "login": "charris",
      "id": 77272,
      "node_id": "MDQ6VXNlcjc3Mjcy",
      "avatar_url": "https://avatars3.githubusercontent.com/u/77272?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/charris",
      "html_url": "https://github.com/charris",
      "followers_url": "https://api.github.com/users/charris/followers",
      "following_url": "https://api.github.com/users/charris/following{/other_user}",
      "gists_url": "https://api.github.com/users/charris/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/charris/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/charris/subscriptions",
      "organizations_url": "https://api.github.com/users/charris/orgs",
      "repos_url": "https://api.github.com/users/charris/repos",
      "events_url": "https://api.github.com/users/charris/events{/privacy}",
      "received_events_url": "https://api.github.com/users/charris/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-05T15:40:59Z",
    "updated_at": "2017-11-05T15:40:59Z",
    "author_association": "NONE",
    "body": "Although back conversion doesn't succeed here.\r\n```\r\nIn [3]: a\r\nOut[3]: array([1.12345679])\r\n\r\nIn [4]: b = array([1.12345679])\r\n\r\nIn [5]: a == b\r\nOut[5]: array([False], dtype=bool)\r\n```\r\nSo there may be other things going on.\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/341982372",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18123#issuecomment-341982372",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18123",
    "id": 341982372,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTk4MjM3Mg==",
    "user": {
      "login": "charris",
      "id": 77272,
      "node_id": "MDQ6VXNlcjc3Mjcy",
      "avatar_url": "https://avatars3.githubusercontent.com/u/77272?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/charris",
      "html_url": "https://github.com/charris",
      "followers_url": "https://api.github.com/users/charris/followers",
      "following_url": "https://api.github.com/users/charris/following{/other_user}",
      "gists_url": "https://api.github.com/users/charris/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/charris/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/charris/subscriptions",
      "organizations_url": "https://api.github.com/users/charris/orgs",
      "repos_url": "https://api.github.com/users/charris/repos",
      "events_url": "https://api.github.com/users/charris/events{/privacy}",
      "received_events_url": "https://api.github.com/users/charris/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-05T15:42:17Z",
    "updated_at": "2017-11-05T15:42:17Z",
    "author_association": "NONE",
    "body": "@ahaldane Thoughts?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/341985373",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18123#issuecomment-341985373",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18123",
    "id": 341985373,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTk4NTM3Mw==",
    "user": {
      "login": "charris",
      "id": 77272,
      "node_id": "MDQ6VXNlcjc3Mjcy",
      "avatar_url": "https://avatars3.githubusercontent.com/u/77272?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/charris",
      "html_url": "https://github.com/charris",
      "followers_url": "https://api.github.com/users/charris/followers",
      "following_url": "https://api.github.com/users/charris/following{/other_user}",
      "gists_url": "https://api.github.com/users/charris/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/charris/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/charris/subscriptions",
      "organizations_url": "https://api.github.com/users/charris/orgs",
      "repos_url": "https://api.github.com/users/charris/repos",
      "events_url": "https://api.github.com/users/charris/events{/privacy}",
      "received_events_url": "https://api.github.com/users/charris/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-05T16:24:26Z",
    "updated_at": "2017-11-05T16:24:26Z",
    "author_association": "NONE",
    "body": "Yeah, just looks like a printing change\r\n```\r\nIn [1]: a = array([1.12345678901234567890])\r\n\r\nIn [2]: a[0]\r\nOut[2]: 1.1234567890123457\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/341985546",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18123#issuecomment-341985546",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18123",
    "id": 341985546,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTk4NTU0Ng==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-05T16:26:34Z",
    "updated_at": "2017-11-05T16:26:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "yep i think we can just fix the test on our side"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/341987009",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18123#issuecomment-341987009",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18123",
    "id": 341987009,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTk4NzAwOQ==",
    "user": {
      "login": "ahaldane",
      "id": 9040124,
      "node_id": "MDQ6VXNlcjkwNDAxMjQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9040124?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ahaldane",
      "html_url": "https://github.com/ahaldane",
      "followers_url": "https://api.github.com/users/ahaldane/followers",
      "following_url": "https://api.github.com/users/ahaldane/following{/other_user}",
      "gists_url": "https://api.github.com/users/ahaldane/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ahaldane/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ahaldane/subscriptions",
      "organizations_url": "https://api.github.com/users/ahaldane/orgs",
      "repos_url": "https://api.github.com/users/ahaldane/repos",
      "events_url": "https://api.github.com/users/ahaldane/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ahaldane/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-05T16:46:48Z",
    "updated_at": "2017-11-05T17:25:25Z",
    "author_association": "NONE",
    "body": "I see what is going on here. Numpy's casting code actually uses `str` with a python-float as intermediate, which drops the extra precision.\r\n\r\nWhen casting from a `f8` array to an `S` array, numpy essentially does this:\r\n```\r\nfor i in range(len(arr)):\r\n    dst[i] = str(float(src[i]))\r\n```\r\nand that's using python's `str` and `float` functions. Note that `str(float)` in python truncates at 10 digits while the `repr` prints all necessary digits.\r\n\r\nWe can see this more clearly as follows using the numpy casting loop:\r\n```python\r\n>>> a = np.array([1.12345678901234567890])\r\n>>> b = np.zeros(1, dtype='S20')\r\n>>> b[:] = a\r\n>>> b\r\narray(['1.12345678901'],\r\n      dtype='|S20')\r\n```\r\n\r\nNow let's avoid numpy's casting code by assigning directly:\r\n```python\r\n>>> b[0] = a[0]\r\n>>> b\r\narray(['1.1234567890123457'],\r\n      dtype='|S20')\r\n```\r\nCompare to:\r\n```python\r\n>>> b[0] = str(float(a[0]))\r\n>>> b\r\narray(['1.12345678901'],\r\n      dtype='|S20')\r\n```\r\n\r\nI see a few possible things we could do to make your tests work:\r\n 1. In numpy_gh-9941 I made the `str(np.float64)` output full precision. I could roll that back so it only outputs 8 digits, to be like python `str(float)`.\r\n 2. It is easy to make the `np.float -> str` casting code use `repr` instead of `str`. That would also make it so we can round-trip floats through the casts. However, it would be a behavior change for all casts to string type. (Also, it wouldn't be right for float128)\r\n 3. Write more careful casting-code for `np.float -> string`. A lot of work, I don't really want to do it right now.\r\n\r\nI might just try out option 1."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/342018617",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18123#issuecomment-342018617",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18123",
    "id": 342018617,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MjAxODYxNw==",
    "user": {
      "login": "ahaldane",
      "id": 9040124,
      "node_id": "MDQ6VXNlcjkwNDAxMjQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9040124?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ahaldane",
      "html_url": "https://github.com/ahaldane",
      "followers_url": "https://api.github.com/users/ahaldane/followers",
      "following_url": "https://api.github.com/users/ahaldane/following{/other_user}",
      "gists_url": "https://api.github.com/users/ahaldane/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ahaldane/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ahaldane/subscriptions",
      "organizations_url": "https://api.github.com/users/ahaldane/orgs",
      "repos_url": "https://api.github.com/users/ahaldane/repos",
      "events_url": "https://api.github.com/users/ahaldane/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ahaldane/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-06T00:26:11Z",
    "updated_at": "2017-11-06T00:26:11Z",
    "author_association": "NONE",
    "body": "Note that this is only a problem in python2, since `str(float)` is truncaded only there. In python3, both `str(float)` and `repr(float)` output all the digits. \r\n\r\nThis means  your test probably fails in python3, even I don't precisely understand why our recent changes affected this test the way it did. Pandas probably has an overriden `astype` function that calls `str(np.float64())` somehow.\r\n\r\nIn any case, in numpy 1.14 we are planning not to truncate the `str`, even in python2. So I think you will need to add a few digits of precision here."
  }
]
