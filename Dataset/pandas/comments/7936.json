[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/51171278",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7936#issuecomment-51171278",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7936",
    "id": 51171278,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMTcxMjc4",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-08-05T09:15:20Z",
    "updated_at": "2014-08-05T09:20:15Z",
    "author_association": "MEMBER",
    "body": "Thanks for reporting! But some questions to make it more clear / easier to work with:\n- can you make a smaller, self-contained example (without the need to have special packages installed to download the data). Try to generate some artificial data that reproduces the problem. Something simple like `df = pd.DataFrame({'Date':pd.date_range('2000-12-29', freq='D', periods=5), 'Open': range(5)})` can maybe already be enough.\n- Further try to clean up your example script (again, to the essential code that reproduces the problem), remove some of the comments\n- give the resulting error first without passing your custom converter, and then with.\n- Can you list the versions of the relevant packages? (pandas, numpy, sqlalchemy, mysql.connector)\n\nYou can do that by just adapting your initial post.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/51177979",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7936#issuecomment-51177979",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7936",
    "id": 51177979,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMTc3OTc5",
    "user": {
      "login": "femtotrader",
      "id": 5049737,
      "node_id": "MDQ6VXNlcjUwNDk3Mzc=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/5049737?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/femtotrader",
      "html_url": "https://github.com/femtotrader",
      "followers_url": "https://api.github.com/users/femtotrader/followers",
      "following_url": "https://api.github.com/users/femtotrader/following{/other_user}",
      "gists_url": "https://api.github.com/users/femtotrader/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/femtotrader/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/femtotrader/subscriptions",
      "organizations_url": "https://api.github.com/users/femtotrader/orgs",
      "repos_url": "https://api.github.com/users/femtotrader/repos",
      "events_url": "https://api.github.com/users/femtotrader/events{/privacy}",
      "received_events_url": "https://api.github.com/users/femtotrader/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-08-05T10:13:09Z",
    "updated_at": "2014-08-05T10:13:09Z",
    "author_association": "NONE",
    "body": "I also notice an other issue (if I change `scheme = 'mysql+mysqlconnector'` to `scheme = 'mysql+mysqldb'` this code execute fine but if I query database I notice that I have only second resolution timestamp (no microsecond, in fact no fractional seconds).\n\n```\n$ mysql -u root mysql -p\nEnter password:\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 40\nServer version: 5.5.38-0ubuntu0.14.04.1 (Ubuntu)\n\nCopyright (c) 2000, 2014, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql> use test;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql> select * from orcl;\n+---------------------+------+\n| Date                | Open |\n+---------------------+------+\n| 2000-12-29 00:00:00 |    0 |\n| 2000-12-30 00:00:00 |    1 |\n| 2000-12-31 00:00:00 |    2 |\n| 2001-01-01 00:00:00 |    3 |\n| 2001-01-02 00:00:00 |    4 |\n+---------------------+------+\n5 rows in set (0.00 sec)\n\nmysql> show columns from orcl;\n+-------+------------+------+-----+---------+-------+\n| Field | Type       | Null | Key | Default | Extra |\n+-------+------------+------+-----+---------+-------+\n| Date  | datetime   | YES  | MUL | NULL    |       |\n| Open  | bigint(20) | YES  |     | NULL    |       |\n+-------+------------+------+-----+---------+-------+\n2 rows in set (0.00 sec)\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/51179101",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7936#issuecomment-51179101",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7936",
    "id": 51179101,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMTc5MTAx",
    "user": {
      "login": "femtotrader",
      "id": 5049737,
      "node_id": "MDQ6VXNlcjUwNDk3Mzc=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/5049737?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/femtotrader",
      "html_url": "https://github.com/femtotrader",
      "followers_url": "https://api.github.com/users/femtotrader/followers",
      "following_url": "https://api.github.com/users/femtotrader/following{/other_user}",
      "gists_url": "https://api.github.com/users/femtotrader/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/femtotrader/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/femtotrader/subscriptions",
      "organizations_url": "https://api.github.com/users/femtotrader/orgs",
      "repos_url": "https://api.github.com/users/femtotrader/repos",
      "events_url": "https://api.github.com/users/femtotrader/events{/privacy}",
      "received_events_url": "https://api.github.com/users/femtotrader/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-08-05T10:25:20Z",
    "updated_at": "2014-08-05T10:27:05Z",
    "author_association": "NONE",
    "body": "Now code with mysql.connector and custom converter\n\n```\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\nimport pandas as pd\nimport numpy as np\nimport sqlalchemy\nimport mysql.connector\n\nclass Datetime64Converter(mysql.connector.conversion.MySQLConverter):\n    \"\"\" A mysql.connector Converter that handles datetime64 types \"\"\"\n\n    def _timestamp_to_mysql(self, value):\n        return value.value\n\ndef connect():\n    config = {\n        'host'    : 'localhost',\n        'database': 'test',\n        'user'    : 'root',\n        'password': '123456',\n        'port': 3306\n    }\n    conn = mysql.connector.connect(**config)\n    conn.set_converter_class(Datetime64Converter)\n    return(conn)\n\ndef main():\n    N = 5\n    df = pd.DataFrame({'Date':pd.date_range('2000-12-29', freq='D', periods=N), 'Open': range(N)})\n\n    scheme = 'mysql+mysqlconnector'\n    #scheme = 'mysql+mysqldb'\n\n    db_uri = \"{scheme}://\".format(scheme=scheme)\n\n    engine = sqlalchemy.create_engine(db_uri, creator=connect)\n\n    df[\"Date\"] = df[\"Date\"] + np.timedelta64(1, 'us') # to test resolution issue\n\n    df = df.set_index(\"Date\")\n\n    print(df)\n    print(df.dtypes)\n    print(type(df.index), df.index.dtype)\n    print(type(df.index[0]))\n\n    df.to_sql(\"orcl\", engine, flavor=\"mysql\", if_exists=\"replace\")\n\nif __name__ == '__main__':\n    main()\n```\n\ndoesn't raise any error but table index is wrong in database:\n\n```\nmysql> select * from orcl;\n+---------------------+------+\n| Date                | Open |\n+---------------------+------+\n| 0000-00-00 00:00:00 |    0 |\n| 0000-00-00 00:00:00 |    1 |\n| 0000-00-00 00:00:00 |    2 |\n| 0000-00-00 00:00:00 |    3 |\n| 0000-00-00 00:00:00 |    4 |\n+---------------------+------+\n5 rows in set (0.00 sec)\n\nmysql> show columns from orcl;\n+-------+------------+------+-----+---------+-------+\n| Field | Type       | Null | Key | Default | Extra |\n+-------+------------+------+-----+---------+-------+\n| Date  | datetime   | YES  | MUL | NULL    |       |\n| Open  | bigint(20) | YES  |     | NULL    |       |\n+-------+------------+------+-----+---------+-------+\n2 rows in set (0.00 sec)\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/51186791",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7936#issuecomment-51186791",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7936",
    "id": 51186791,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMTg2Nzkx",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-08-05T11:54:34Z",
    "updated_at": "2014-08-05T11:54:34Z",
    "author_association": "MEMBER",
    "body": "OK, I can reproduce this (although with a slightly different error: `Failed processing pyformat-parameters; Python 'timestamp' cannot be converted to a MySQL type`). \nSo `mysql.connector` can be added to the list of drivers with which datetime does not work (this is also the case with `pymysql`, while it does work with `mysqldb` (as you also experienced), see also issue #7103).\n\nFor the sub-second resolution, can you open a seperate issue?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/51188586",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7936#issuecomment-51188586",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7936",
    "id": 51188586,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMTg4NTg2",
    "user": {
      "login": "femtotrader",
      "id": 5049737,
      "node_id": "MDQ6VXNlcjUwNDk3Mzc=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/5049737?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/femtotrader",
      "html_url": "https://github.com/femtotrader",
      "followers_url": "https://api.github.com/users/femtotrader/followers",
      "following_url": "https://api.github.com/users/femtotrader/following{/other_user}",
      "gists_url": "https://api.github.com/users/femtotrader/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/femtotrader/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/femtotrader/subscriptions",
      "organizations_url": "https://api.github.com/users/femtotrader/orgs",
      "repos_url": "https://api.github.com/users/femtotrader/repos",
      "events_url": "https://api.github.com/users/femtotrader/events{/privacy}",
      "received_events_url": "https://api.github.com/users/femtotrader/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-08-05T12:08:54Z",
    "updated_at": "2014-08-05T12:08:54Z",
    "author_association": "NONE",
    "body": "Sub-second resolution issue with mysqldb driver opened here https://github.com/pydata/pandas/issues/7938\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/51188919",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7936#issuecomment-51188919",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7936",
    "id": 51188919,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMTg4OTE5",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-08-05T12:11:34Z",
    "updated_at": "2014-08-05T12:12:01Z",
    "author_association": "MEMBER",
    "body": "With the custom converter, I get it working when using:\n\n```\nclass Datetime64Converter(mysql.connector.conversion.MySQLConverter):\n    \"\"\" A mysql.connector Converter that handles datetime64 types \"\"\"\n    def _timestamp_to_mysql(self, value):\n        return value.strftime('%Y-%m-%d %H:%M:%S')\n```\n\nSo returning a string instead of an int (for some reason sqlalchemy specifies it as text, although I thought mysql supported datetime types, have to check that). I only get occasional an error like `InternalError: Unread result found.` (seems to have something to do with replacing an existing table, if I change the name, it always works)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/51189809",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7936#issuecomment-51189809",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7936",
    "id": 51189809,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMTg5ODA5",
    "user": {
      "login": "femtotrader",
      "id": 5049737,
      "node_id": "MDQ6VXNlcjUwNDk3Mzc=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/5049737?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/femtotrader",
      "html_url": "https://github.com/femtotrader",
      "followers_url": "https://api.github.com/users/femtotrader/followers",
      "following_url": "https://api.github.com/users/femtotrader/following{/other_user}",
      "gists_url": "https://api.github.com/users/femtotrader/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/femtotrader/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/femtotrader/subscriptions",
      "organizations_url": "https://api.github.com/users/femtotrader/orgs",
      "repos_url": "https://api.github.com/users/femtotrader/repos",
      "events_url": "https://api.github.com/users/femtotrader/events{/privacy}",
      "received_events_url": "https://api.github.com/users/femtotrader/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-08-05T12:22:00Z",
    "updated_at": "2014-08-05T12:22:00Z",
    "author_association": "NONE",
    "body": "Anyway this solution will lead to second rounding (no sub-second resolution), isn't it ?\nI think that if rounding occurs, we should at least see a warning message... but I would prefer to have sub-second resolution.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/51190172",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7936#issuecomment-51190172",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7936",
    "id": 51190172,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMTkwMTcy",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-08-05T12:26:03Z",
    "updated_at": "2014-08-05T12:26:03Z",
    "author_association": "MEMBER",
    "body": "Correction: mysql just expects a string format for the datetime, but it _is_ stored as a `datetime` type in the database with the solution above.\n\nIndeed, this will round to second resolution, but as I say in the other issue, this is a limitation of mysql, not pandas. So if you want to use the `datetime` type in mysql, you have to live with that, or otherwise you can yourself first convert it to a string or int (as is most convenient for you) and then write to mysql. \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/51193454",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7936#issuecomment-51193454",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7936",
    "id": 51193454,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMTkzNDU0",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-08-05T12:59:29Z",
    "updated_at": "2014-08-05T12:59:29Z",
    "author_association": "MEMBER",
    "body": "For future reference, the problem is the following: mysql-connector has a `mysql.connector.conversion.MySQLConverter._datetime_to_mysql` function that deals with converting a `datetime.datetime` object to mysql, but this does not work for the `Timestamp` class (although it is a subclass of `datetime.datetime`), which is the same problem as with pymysql.\n\nSo doing:\n\n```\nmysql.connector.conversion.MySQLConverter._timestamp_to_mysql = mysql.connector.conversion.MySQLConverter._datetime_to_mysql\n```\n\nshould also work as a workaround.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/56158368",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7936#issuecomment-56158368",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7936",
    "id": 56158368,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTU4MzY4",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-19T09:56:26Z",
    "updated_at": "2014-09-19T09:56:26Z",
    "author_association": "MEMBER",
    "body": "This was closed by #8208 (apparantly github didn't do it automatically)\n"
  }
]
