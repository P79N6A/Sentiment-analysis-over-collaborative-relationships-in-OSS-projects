[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/330185000",
    "html_url": "https://github.com/pandas-dev/pandas/issues/17567#issuecomment-330185000",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/17567",
    "id": 330185000,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMDE4NTAwMA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-18T10:47:51Z",
    "updated_at": "2017-09-18T10:47:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "So you would have to show a reproducible example; the following works.\r\n\r\n```\r\nIn [1]: df = pd.DataFrame({'A': np.arange(10), 'B': pd.date_range('20130101',periods=10)}).set_index('B')\r\n   ...: store = pd.HDFStore('test.h5')\r\n   ...: store.append('df', df)\r\n   ...: assert len(store.select('df')) == 10\r\n   ...: store.remove('df', where='index in [\"20130102\", \"20130103\"]')\r\n   ...: assert len(store.select('df')) == 8\r\n   ...: \r\n\r\nIn [2]: store.select('df')\r\nOut[2]: \r\n            A\r\nB            \r\n2013-01-01  0\r\n2013-01-04  3\r\n2013-01-05  4\r\n2013-01-06  5\r\n2013-01-07  6\r\n2013-01-08  7\r\n2013-01-09  8\r\n2013-01-10  9\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/330194105",
    "html_url": "https://github.com/pandas-dev/pandas/issues/17567#issuecomment-330194105",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/17567",
    "id": 330194105,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMDE5NDEwNQ==",
    "user": {
      "login": "omytea",
      "id": 1098710,
      "node_id": "MDQ6VXNlcjEwOTg3MTA=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1098710?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/omytea",
      "html_url": "https://github.com/omytea",
      "followers_url": "https://api.github.com/users/omytea/followers",
      "following_url": "https://api.github.com/users/omytea/following{/other_user}",
      "gists_url": "https://api.github.com/users/omytea/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/omytea/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/omytea/subscriptions",
      "organizations_url": "https://api.github.com/users/omytea/orgs",
      "repos_url": "https://api.github.com/users/omytea/repos",
      "events_url": "https://api.github.com/users/omytea/events{/privacy}",
      "received_events_url": "https://api.github.com/users/omytea/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-18T11:35:34Z",
    "updated_at": "2017-09-18T11:38:19Z",
    "author_association": "NONE",
    "body": "@jreback \r\n\r\nI did a slight change to your test code then it reproduces now.\r\n\r\n```python\r\nIn [1]:\r\ndf = pd.DataFrame({'A': np.arange(1000), 'B': pd.date_range('20130101',periods=1000)}).set_index('B')\r\nselect = list(df.reset_index().B.sample(100))\r\nstore = pd.HDFStore('test.h5')\r\nstore.put('df', df, format='table')\r\nassert len(store.select('df')) == 1000\r\nprint('select len %d' % len(store.select('df', where='index in %s' % select)))\r\nstore.remove('df', where='index in %s' % select)\r\nprint('after remove %d' % len(store.select('df')))\r\nassert len(store.select('df')) == 900\r\n\r\nselect len 100\r\nafter remove 0\r\n---------------------------------------------------------------------------\r\nAssertionError                            Traceback (most recent call last)\r\n<ipython-input-136-cf9062a4d575> in <module>()\r\n      7 store.remove('df', where='index in %s' % select)\r\n      8 print('after remove %d' % len(store.select('df')))\r\n----> 9 assert len(store.select('df')) == 900\r\n\r\n\r\nAssertionError: \r\n\r\nIn [2]:\r\nstore.select('df')\r\n\r\nOut[2]:\r\nA\r\nB\t\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/330199962",
    "html_url": "https://github.com/pandas-dev/pandas/issues/17567#issuecomment-330199962",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/17567",
    "id": 330199962,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMDE5OTk2Mg==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-18T12:05:57Z",
    "updated_at": "2017-09-18T12:05:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "ok, would appreciate if you can debug. there are not very many test cases for this, so certainly can add this one and fix."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/338380340",
    "html_url": "https://github.com/pandas-dev/pandas/issues/17567#issuecomment-338380340",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/17567",
    "id": 338380340,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzODM4MDM0MA==",
    "user": {
      "login": "GuessWhoSamFoo",
      "id": 10288252,
      "node_id": "MDQ6VXNlcjEwMjg4MjUy",
      "avatar_url": "https://avatars1.githubusercontent.com/u/10288252?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/GuessWhoSamFoo",
      "html_url": "https://github.com/GuessWhoSamFoo",
      "followers_url": "https://api.github.com/users/GuessWhoSamFoo/followers",
      "following_url": "https://api.github.com/users/GuessWhoSamFoo/following{/other_user}",
      "gists_url": "https://api.github.com/users/GuessWhoSamFoo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/GuessWhoSamFoo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GuessWhoSamFoo/subscriptions",
      "organizations_url": "https://api.github.com/users/GuessWhoSamFoo/orgs",
      "repos_url": "https://api.github.com/users/GuessWhoSamFoo/repos",
      "events_url": "https://api.github.com/users/GuessWhoSamFoo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/GuessWhoSamFoo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-21T10:04:55Z",
    "updated_at": "2017-10-21T10:04:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "Tangentially related to #15937. The `remove` method uses `numexpr` so selecting as shown above would work as long as <= 31 elements. A warning pointing to http://pandas.pydata.org/pandas-docs/stable/io.html#selecting-using-a-where-mask seems reasonable.\r\n\r\nSwapping the commented lines here will return an empty dataframe.\r\n```python\r\nIn [2]:\r\ndf = pd.DataFrame({'A': np.arange(1000),\r\n                   'B': pd.date_range('20130101', periods=1000)}\r\n                  ).set_index('B')\r\n\r\nselect = list(df.reset_index().B.sample(32))\r\nstore = pd.HDFStore('temp.h5')\r\nstore.put('df', df, format='table')\r\nwhere = df.index.isin(select)\r\n\r\nstore.select('df', where=where)\r\n\r\n#store.remove('df', where='index in %s' % select)\r\nstore.remove('df', where=where)\r\n\r\nOut[2]:\r\n32\r\n\r\nIn [3]:\r\nlen(store.select('df'))\r\n\r\nOut[3]:\r\n968"
  }
]
