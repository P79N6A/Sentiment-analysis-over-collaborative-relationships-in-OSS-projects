[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/391689708",
    "html_url": "https://github.com/pandas-dev/pandas/issues/21188#issuecomment-391689708",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/21188",
    "id": 391689708,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MTY4OTcwOA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-24T12:05:30Z",
    "updated_at": "2018-05-24T12:05:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "you would need to show the initial construction via code"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/391733608",
    "html_url": "https://github.com/pandas-dev/pandas/issues/21188#issuecomment-391733608",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/21188",
    "id": 391733608,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MTczMzYwOA==",
    "user": {
      "login": "answerquest",
      "id": 9089552,
      "node_id": "MDQ6VXNlcjkwODk1NTI=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9089552?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/answerquest",
      "html_url": "https://github.com/answerquest",
      "followers_url": "https://api.github.com/users/answerquest/followers",
      "following_url": "https://api.github.com/users/answerquest/following{/other_user}",
      "gists_url": "https://api.github.com/users/answerquest/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/answerquest/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/answerquest/subscriptions",
      "organizations_url": "https://api.github.com/users/answerquest/orgs",
      "repos_url": "https://api.github.com/users/answerquest/repos",
      "events_url": "https://api.github.com/users/answerquest/events{/privacy}",
      "received_events_url": "https://api.github.com/users/answerquest/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-24T14:23:20Z",
    "updated_at": "2018-05-24T14:41:18Z",
    "author_association": "NONE",
    "body": "@jreback thanks for looking into this! By initial construction do you mean how the 'db/trips.h5' file was created? It's from a CSV called `trips.txt` from here: http://transitfeeds.com/p/verkehrsverbund-berlin-brandenburg/213/latest . \r\n\r\nI just found I can directly load it from the net (so nice to work on open data), so will re-do the sample code so you can copy-paste this whole thing at your end:\r\n\r\n#### Code Sample, a copy-pastable example if possible\r\n```\r\nimport pandas as pd\r\nGTFS_dtypes = { 'trip_id' :'str', 'block_id':'str', 'trip_headsign':'str', 'direction_id':'int64', 'route_id':'str' }\r\nurl = 'https://transitfeeds-data.s3-us-west-1.amazonaws.com/public/feeds/verkehrsverbund-berlin-brandenburg/213/20180426/original/trips.txt'\r\n\r\ndf = pd.read_csv(url , na_filter=False, dtype=GTFS_dtypes)\r\ndf.to_hdf('trips.h5', 'df', format='table', mode='w', complevel=1)\r\n\r\nhdf = pd.HDFStore('trips.h5')\r\nprint(hdf.info()) # works\r\nprint(hdf.select('df',columns=['trip_id'])) # works\r\nprint(hdf.select_column('df','index') ) # works\r\nprint(hdf.select_column('df','trip_id') ) # throws KeyError\r\n```\r\nOn running this all over again I'm getting the same error I posted."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/391735525",
    "html_url": "https://github.com/pandas-dev/pandas/issues/21188#issuecomment-391735525",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/21188",
    "id": 391735525,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MTczNTUyNQ==",
    "user": {
      "login": "answerquest",
      "id": 9089552,
      "node_id": "MDQ6VXNlcjkwODk1NTI=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9089552?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/answerquest",
      "html_url": "https://github.com/answerquest",
      "followers_url": "https://api.github.com/users/answerquest/followers",
      "following_url": "https://api.github.com/users/answerquest/following{/other_user}",
      "gists_url": "https://api.github.com/users/answerquest/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/answerquest/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/answerquest/subscriptions",
      "organizations_url": "https://api.github.com/users/answerquest/orgs",
      "repos_url": "https://api.github.com/users/answerquest/repos",
      "events_url": "https://api.github.com/users/answerquest/events{/privacy}",
      "received_events_url": "https://api.github.com/users/answerquest/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-24T14:28:51Z",
    "updated_at": "2018-05-24T14:53:03Z",
    "author_association": "NONE",
    "body": "- I just tried this with a completely different .csv file. Same error. `hdf.select` is working fine but `hdf.select_column` only works if the column is `index`.\r\n- Recreated .h5 file with `complevel=0`. No difference, Same error."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/391767236",
    "html_url": "https://github.com/pandas-dev/pandas/issues/21188#issuecomment-391767236",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/21188",
    "id": 391767236,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MTc2NzIzNg==",
    "user": {
      "login": "answerquest",
      "id": 9089552,
      "node_id": "MDQ6VXNlcjkwODk1NTI=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9089552?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/answerquest",
      "html_url": "https://github.com/answerquest",
      "followers_url": "https://api.github.com/users/answerquest/followers",
      "following_url": "https://api.github.com/users/answerquest/following{/other_user}",
      "gists_url": "https://api.github.com/users/answerquest/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/answerquest/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/answerquest/subscriptions",
      "organizations_url": "https://api.github.com/users/answerquest/orgs",
      "repos_url": "https://api.github.com/users/answerquest/repos",
      "events_url": "https://api.github.com/users/answerquest/events{/privacy}",
      "received_events_url": "https://api.github.com/users/answerquest/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-24T15:57:04Z",
    "updated_at": "2018-05-24T15:57:04Z",
    "author_association": "NONE",
    "body": "@jreback I got it! Dug into the code and came upon this data indexable thing again..\r\n```\r\ndef read_column(self, column, where=None, start=None, stop=None, **kwargs):\r\n...\r\n        # find the axes\r\n        for a in self.axes:\r\n            if column == a.name:\r\n                if not a.is_data_indexable:\r\n                    raise ValueError(\r\n                        \"column [%s] can not be extracted individually; it is \"\r\n                        \"not data indexable\" % column)\r\n```\r\nif I ran this: `[a.name for a in hdf.get_storer('df').axes]`\r\nthen I'd get this: `['index', 'values_block_0', 'values_block_1']`\r\nAnd it was clear that my column would never show up.\r\n\r\nThen I looked at the `to_hdf()` function doc again: https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.to_hdf.html\r\n\r\n> **data_columns** : list of columns or True, optional\r\n> List of columns to create as indexed data columns for on-disk queries, or True to use all columns. By default only the axes of the object are indexed. See Query via Data Columns. Applicable only to format=’table’.\r\n\r\nSo now I created the .h5 file again, this time with one more argument: `data_columns=True`. And now all the columns got listed in the axes.\r\n\r\n```python\r\n>>> df.to_hdf('trips.h5', 'df', format='table', mode='w', complevel=1, data_columns=True)\r\n>>> hdf = pd.HDFStore('trips.h5')\r\n>>> [a.name for a in hdf.get_storer('df').axes]\r\n['index', 'route_id', 'service_id', 'trip_id', 'trip_headsign', 'trip_short_name', 'direction_id', 'block_id', 'shape_id', 'wheelchair_accessible', 'bikes_allowed']\r\n>>> print(hdf.select_column('df','trip_id') ) # NOW IT WORKS!\r\n```\r\n\r\nNote: the time taken by the compiler to create the .h5 file seems to increase when all `data_columns=True`. So, it's better to know which columns we'll be likely to use and `data_columns=['trip_id']` instead.\r\n\r\nI think we ought to change this:  \r\n`raise KeyError(\"column [%s] not found in the table\" % column)`\r\n... to convey that in addition to the column perhaps not being present in the table, that it also may not be data indexable and  `data_columns` option has to be used when storing the table in the .h5 file (`pd.to_hdf()`,  or `HDFStore.put()` or `HDFStore.append()`).\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/391776837",
    "html_url": "https://github.com/pandas-dev/pandas/issues/21188#issuecomment-391776837",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/21188",
    "id": 391776837,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MTc3NjgzNw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-24T16:26:02Z",
    "updated_at": "2018-05-24T16:26:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "you can certainly put up a PR to make this more informative "
  }
]
