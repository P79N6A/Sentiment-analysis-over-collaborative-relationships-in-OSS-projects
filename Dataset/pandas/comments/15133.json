[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/272855034",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15133#issuecomment-272855034",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15133",
    "id": 272855034,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3Mjg1NTAzNA==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-16T12:53:42Z",
    "updated_at": "2017-01-16T12:53:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "Sorry, I don't entirely understand the issue. Could you include the tracebacks so we can see what's happening? Can you narrow down what the problem is?\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/273232298",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15133#issuecomment-273232298",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15133",
    "id": 273232298,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MzIzMjI5OA==",
    "user": {
      "login": "ArtyomKaltovich",
      "id": 10615183,
      "node_id": "MDQ6VXNlcjEwNjE1MTgz",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10615183?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ArtyomKaltovich",
      "html_url": "https://github.com/ArtyomKaltovich",
      "followers_url": "https://api.github.com/users/ArtyomKaltovich/followers",
      "following_url": "https://api.github.com/users/ArtyomKaltovich/following{/other_user}",
      "gists_url": "https://api.github.com/users/ArtyomKaltovich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ArtyomKaltovich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ArtyomKaltovich/subscriptions",
      "organizations_url": "https://api.github.com/users/ArtyomKaltovich/orgs",
      "repos_url": "https://api.github.com/users/ArtyomKaltovich/repos",
      "events_url": "https://api.github.com/users/ArtyomKaltovich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ArtyomKaltovich/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-17T17:08:13Z",
    "updated_at": "2017-01-17T17:08:13Z",
    "author_association": "NONE",
    "body": ">>> train = read_excel(\r\n...     'Wilson_Schistosome Esophagus_differentially expressed transcripts.xlsx',\r\n...     sheetname=3, header=[0, 1], skip_footer=11)\r\n>>> OK\r\n\r\n>>>train = read_excel(\r\n    'Wilson_Schistosome Esophagus_differentially expressed transcripts.xlsx',\r\n    sheetname=3, header=[0, 1], skip_footer=11,  names=[0] + list(range(2, 12)))\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 3, in <module>\r\n  File \"/home/my/.local/lib/python3.5/site-packages/pandas/io/excel.py\", line 200, in read_excel\r\n    **kwds)\r\n  File \"/home/my/.local/lib/python3.5/site-packages/pandas/io/excel.py\", line 511, in _parse_excel\r\n    asheetname].columns.set_names(header_names)\r\n  File \"/home/my/.local/lib/python3.5/site-packages/pandas/indexes/base.py\", line 1010, in set_names\r\n    idx._set_names(names, level=level)\r\n  File \"/home/my/.local/lib/python3.5/site-packages/pandas/indexes/base.py\", line 950, in _set_names\r\n    len(values))\r\nValueError: Length of new names must be 1, got 2\r\n\r\n\r\n>>> train = read_excel('Wilson_Schistosome Esophagus_differentially expressed transcripts.xlsx',\r\n...                    sheetname=2, header=[0, 1],  skip_footer=6)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 2, in <module>\r\n  File \"/home/my/.local/lib/python3.5/site-packages/pandas/io/excel.py\", line 200, in read_excel\r\n    **kwds)\r\n  File \"/home/my/.local/lib/python3.5/site-packages/pandas/io/excel.py\", line 511, in _parse_excel\r\n    asheetname].columns.set_names(header_names)\r\n  File \"/home/my/.local/lib/python3.5/site-packages/pandas/indexes/base.py\", line 1010, in set_names\r\n    idx._set_names(names, level=level)\r\n  File \"/home/my/.local/lib/python3.5/site-packages/pandas/indexes/base.py\", line 950, in _set_names\r\n    len(values))\r\nValueError: Length of new names must be 1, got 2\r\n\r\n\r\n\r\n\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/273232747",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15133#issuecomment-273232747",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15133",
    "id": 273232747,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MzIzMjc0Nw==",
    "user": {
      "login": "ArtyomKaltovich",
      "id": 10615183,
      "node_id": "MDQ6VXNlcjEwNjE1MTgz",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10615183?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ArtyomKaltovich",
      "html_url": "https://github.com/ArtyomKaltovich",
      "followers_url": "https://api.github.com/users/ArtyomKaltovich/followers",
      "following_url": "https://api.github.com/users/ArtyomKaltovich/following{/other_user}",
      "gists_url": "https://api.github.com/users/ArtyomKaltovich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ArtyomKaltovich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ArtyomKaltovich/subscriptions",
      "organizations_url": "https://api.github.com/users/ArtyomKaltovich/orgs",
      "repos_url": "https://api.github.com/users/ArtyomKaltovich/repos",
      "events_url": "https://api.github.com/users/ArtyomKaltovich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ArtyomKaltovich/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-17T17:09:47Z",
    "updated_at": "2017-01-17T17:10:16Z",
    "author_association": "NONE",
    "body": "As documentation says I can use list as argument in read_excel().\r\nAm I right? Or are there some restriction?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/273739922",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15133#issuecomment-273739922",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15133",
    "id": 273739922,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MzczOTkyMg==",
    "user": {
      "login": "ArtyomKaltovich",
      "id": 10615183,
      "node_id": "MDQ6VXNlcjEwNjE1MTgz",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10615183?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ArtyomKaltovich",
      "html_url": "https://github.com/ArtyomKaltovich",
      "followers_url": "https://api.github.com/users/ArtyomKaltovich/followers",
      "following_url": "https://api.github.com/users/ArtyomKaltovich/following{/other_user}",
      "gists_url": "https://api.github.com/users/ArtyomKaltovich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ArtyomKaltovich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ArtyomKaltovich/subscriptions",
      "organizations_url": "https://api.github.com/users/ArtyomKaltovich/orgs",
      "repos_url": "https://api.github.com/users/ArtyomKaltovich/repos",
      "events_url": "https://api.github.com/users/ArtyomKaltovich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ArtyomKaltovich/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-19T10:39:17Z",
    "updated_at": "2017-01-19T10:46:31Z",
    "author_association": "NONE",
    "body": "Hello. Do tracebacks help understand problem?\r\nAs i understand sometimes MultiIndex does not create, but why?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/273781315",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15133#issuecomment-273781315",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15133",
    "id": 273781315,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3Mzc4MTMxNQ==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-19T13:53:04Z",
    "updated_at": "2017-01-19T13:53:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "IIRC, to pass `sheetname=[list of sheets]` requires that each sheet have the same structure, since the `header`, `skipfooter`, etc. are applied to each sheet. Is that true of your data?\r\n\r\nAn easy way to test is to see if\r\n\r\n```python\r\ntrain = read_excel(\r\n    'Wilson_Schistosome Esophagus_differentially expressed transcripts.xlsx',\r\n    sheetname=[3], header=[0, 1], skip_footer=11)\r\n```\r\n\r\nworks, since `sheetname` is a list with one element."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/299255519",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15133#issuecomment-299255519",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15133",
    "id": 299255519,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTI1NTUxOQ==",
    "user": {
      "login": "dorvak",
      "id": 1542066,
      "node_id": "MDQ6VXNlcjE1NDIwNjY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1542066?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dorvak",
      "html_url": "https://github.com/dorvak",
      "followers_url": "https://api.github.com/users/dorvak/followers",
      "following_url": "https://api.github.com/users/dorvak/following{/other_user}",
      "gists_url": "https://api.github.com/users/dorvak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dorvak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dorvak/subscriptions",
      "organizations_url": "https://api.github.com/users/dorvak/orgs",
      "repos_url": "https://api.github.com/users/dorvak/repos",
      "events_url": "https://api.github.com/users/dorvak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dorvak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-04T17:33:34Z",
    "updated_at": "2017-05-04T17:33:34Z",
    "author_association": "NONE",
    "body": "I got this error as well, this seems to be due to some changes in version 0.19., because the code works in version 0.18.0"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/337207806",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15133#issuecomment-337207806",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15133",
    "id": 337207806,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNzIwNzgwNg==",
    "user": {
      "login": "jeanbaptisteb",
      "id": 5843240,
      "node_id": "MDQ6VXNlcjU4NDMyNDA=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/5843240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jeanbaptisteb",
      "html_url": "https://github.com/jeanbaptisteb",
      "followers_url": "https://api.github.com/users/jeanbaptisteb/followers",
      "following_url": "https://api.github.com/users/jeanbaptisteb/following{/other_user}",
      "gists_url": "https://api.github.com/users/jeanbaptisteb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jeanbaptisteb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jeanbaptisteb/subscriptions",
      "organizations_url": "https://api.github.com/users/jeanbaptisteb/orgs",
      "repos_url": "https://api.github.com/users/jeanbaptisteb/repos",
      "events_url": "https://api.github.com/users/jeanbaptisteb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jeanbaptisteb/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-17T11:56:17Z",
    "updated_at": "2017-10-17T11:56:17Z",
    "author_association": "NONE",
    "body": "I got this error too, no matter how I set the header and sheetname parameters. I also tried on a one-sheet file, the same error is raised."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/429934038",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15133#issuecomment-429934038",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15133",
    "id": 429934038,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyOTkzNDAzOA==",
    "user": {
      "login": "billtubbs",
      "id": 7958850,
      "node_id": "MDQ6VXNlcjc5NTg4NTA=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/7958850?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/billtubbs",
      "html_url": "https://github.com/billtubbs",
      "followers_url": "https://api.github.com/users/billtubbs/followers",
      "following_url": "https://api.github.com/users/billtubbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/billtubbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/billtubbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/billtubbs/subscriptions",
      "organizations_url": "https://api.github.com/users/billtubbs/orgs",
      "repos_url": "https://api.github.com/users/billtubbs/repos",
      "events_url": "https://api.github.com/users/billtubbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/billtubbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-15T17:03:21Z",
    "updated_at": "2018-10-15T17:03:21Z",
    "author_association": "NONE",
    "body": "I have this error too.  Here is a demonstration of the error with a simple spreadsheet.  The error only occurs when there is an empty column to the left of the first index col.\r\n\r\n**Test 1** (fails):\r\n\r\nFile 'excel_test1.xlsx' looks like [this](https://ibb.co/izSr0f).\r\n\r\n```python\r\ninput_data_filename = 'excel_test1.xlsx'\r\ndf = pd.read_excel(\r\n    os.path.join(data_dir, input_data_filename), \r\n    header=[3, 4],\r\n    index_col=[1, 2]\r\n)\r\n```\r\n\r\nTraceback:\r\n```\r\n-----------------------------------------------------------------------\r\nValueError                            Traceback (most recent call last)\r\n<ipython-input-56-a7da75b33a63> in <module>()\r\n      3     os.path.join(data_dir, input_data_filename),\r\n      4     header=[3, 4],\r\n----> 5     index_col=[1, 2]\r\n      6 )\r\n\r\n/Users/billtubbs/anaconda/lib/python2.7/site-packages/pandas/util/_decorators.pyc in wrapper(*args, **kwargs)\r\n    176                 else:\r\n    177                     kwargs[new_arg_name] = new_arg_value\r\n--> 178             return func(*args, **kwargs)\r\n    179         return wrapper\r\n    180     return _deprecate_kwarg\r\n\r\n/Users/billtubbs/anaconda/lib/python2.7/site-packages/pandas/util/_decorators.pyc in wrapper(*args, **kwargs)\r\n    176                 else:\r\n    177                     kwargs[new_arg_name] = new_arg_value\r\n--> 178             return func(*args, **kwargs)\r\n    179         return wrapper\r\n    180     return _deprecate_kwarg\r\n\r\n/Users/billtubbs/anaconda/lib/python2.7/site-packages/pandas/io/excel.pyc in read_excel(io, sheet_name, header, names, index_col, usecols, squeeze, dtype, engine, converters, true_values, false_values, skiprows, nrows, na_values, parse_dates, date_parser, thousands, comment, skipfooter, convert_float, **kwds)\r\n    327         skipfooter=skipfooter,\r\n    328         convert_float=convert_float,\r\n--> 329         **kwds)\r\n    330 \r\n    331 \r\n\r\n/Users/billtubbs/anaconda/lib/python2.7/site-packages/pandas/io/excel.pyc in parse(self, sheet_name, header, names, index_col, usecols, squeeze, converters, true_values, false_values, skiprows, nrows, na_values, parse_dates, date_parser, thousands, comment, skipfooter, convert_float, **kwds)\r\n    454                                  skipfooter=skipfooter,\r\n    455                                  convert_float=convert_float,\r\n--> 456                                  **kwds)\r\n    457 \r\n    458     def _should_parse(self, i, usecols):\r\n\r\n/Users/billtubbs/anaconda/lib/python2.7/site-packages/pandas/io/excel.pyc in _parse_excel(self, sheet_name, header, names, index_col, usecols, squeeze, dtype, true_values, false_values, skiprows, nrows, na_values, verbose, parse_dates, date_parser, thousands, comment, skipfooter, convert_float, **kwds)\r\n    690                 if not squeeze or isinstance(output[asheetname], DataFrame):\r\n    691                     output[asheetname].columns = output[\r\n--> 692                         asheetname].columns.set_names(header_names)\r\n    693             except EmptyDataError:\r\n    694                 # No Data, return an empty DataFrame\r\n\r\n/Users/billtubbs/anaconda/lib/python2.7/site-packages/pandas/core/indexes/base.pyc in set_names(self, names, level, inplace)\r\n   1419         else:\r\n   1420             idx = self._shallow_copy()\r\n-> 1421         idx._set_names(names, level=level)\r\n   1422         if not inplace:\r\n   1423             return idx\r\n\r\n/Users/billtubbs/anaconda/lib/python2.7/site-packages/pandas/core/indexes/base.pyc in _set_names(self, values, level)\r\n   1350         if len(values) != 1:\r\n   1351             raise ValueError('Length of new names must be 1, got %d' %\r\n-> 1352                              len(values))\r\n   1353 \r\n   1354         # GH 20527\r\n\r\nValueError: Length of new names must be 1, got 2\r\n```\r\n\r\n**Test 2** (works):\r\n\r\nFile 'excel_test2.xlsx' looks like [this](https://ibb.co/dhK4Lf).\r\n\r\n```python\r\ninput_data_filename = 'excel_test2.xlsx'\r\ndf = pd.read_excel(\r\n    os.path.join(data_dir, input_data_filename), \r\n    header=[3, 4],\r\n    index_col=[0, 1]\r\n)\r\n```\r\nOutput of test 2 is [here](https://ibb.co/goTW0f). \r\n\r\n\r\nWould be happy to see a solution to this or advice on how to fix!\r\n\r\n\r\n"
  }
]
