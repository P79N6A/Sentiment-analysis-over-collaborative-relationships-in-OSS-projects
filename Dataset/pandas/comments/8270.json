[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/55648887",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-55648887",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 55648887,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NjQ4ODg3",
    "user": {
      "login": "seth-p",
      "id": 7441788,
      "node_id": "MDQ6VXNlcjc0NDE3ODg=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/7441788?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/seth-p",
      "html_url": "https://github.com/seth-p",
      "followers_url": "https://api.github.com/users/seth-p/followers",
      "following_url": "https://api.github.com/users/seth-p/following{/other_user}",
      "gists_url": "https://api.github.com/users/seth-p/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/seth-p/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/seth-p/subscriptions",
      "organizations_url": "https://api.github.com/users/seth-p/orgs",
      "repos_url": "https://api.github.com/users/seth-p/repos",
      "events_url": "https://api.github.com/users/seth-p/events{/privacy}",
      "received_events_url": "https://api.github.com/users/seth-p/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-15T19:58:17Z",
    "updated_at": "2014-09-15T19:58:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "Note also #8086.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/55650269",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-55650269",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 55650269,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NjUwMjY5",
    "user": {
      "login": "behzadnouri",
      "id": 1288998,
      "node_id": "MDQ6VXNlcjEyODg5OTg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1288998?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/behzadnouri",
      "html_url": "https://github.com/behzadnouri",
      "followers_url": "https://api.github.com/users/behzadnouri/followers",
      "following_url": "https://api.github.com/users/behzadnouri/following{/other_user}",
      "gists_url": "https://api.github.com/users/behzadnouri/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/behzadnouri/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/behzadnouri/subscriptions",
      "organizations_url": "https://api.github.com/users/behzadnouri/orgs",
      "repos_url": "https://api.github.com/users/behzadnouri/repos",
      "events_url": "https://api.github.com/users/behzadnouri/events{/privacy}",
      "received_events_url": "https://api.github.com/users/behzadnouri/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-15T20:08:57Z",
    "updated_at": "2014-09-15T20:08:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "@seth-p FYI, a constant series has zero standard deviation, so the skew should be `nan` not zero. so, that is a bug in `Series.skew` not `rolling/expanding_skew` and this PR is independent of https://github.com/pydata/pandas/issues/8086\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/55651569",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-55651569",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 55651569,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NjUxNTY5",
    "user": {
      "login": "seth-p",
      "id": 7441788,
      "node_id": "MDQ6VXNlcjc0NDE3ODg=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/7441788?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/seth-p",
      "html_url": "https://github.com/seth-p",
      "followers_url": "https://api.github.com/users/seth-p/followers",
      "following_url": "https://api.github.com/users/seth-p/following{/other_user}",
      "gists_url": "https://api.github.com/users/seth-p/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/seth-p/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/seth-p/subscriptions",
      "organizations_url": "https://api.github.com/users/seth-p/orgs",
      "repos_url": "https://api.github.com/users/seth-p/repos",
      "events_url": "https://api.github.com/users/seth-p/events{/privacy}",
      "received_events_url": "https://api.github.com/users/seth-p/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-15T20:17:32Z",
    "updated_at": "2014-09-15T20:17:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yep, separate issue. Just hoping someone (:-)) will want to unify `Series.skew` and `rolling/expanding_skew` so that they rely on a single code base and are consistent. And similarly with the kurt() functions.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/55753137",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-55753137",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 55753137,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzUzMTM3",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-16T14:41:36Z",
    "updated_at": "2014-09-16T14:41:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "@behzadnouri can you create a separate issue about `Series.skew` returning `nan` (not 0) for a constant series?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/55753194",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-55753194",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 55753194,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzUzMTk0",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-16T14:41:57Z",
    "updated_at": "2014-09-16T14:41:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "@behzadnouri tests!\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/55753256",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-55753256",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 55753256,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzUzMjU2",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-16T14:42:22Z",
    "updated_at": "2014-09-16T14:42:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "does ths close #6929 or is their a further extension needed and ths is a partial cas\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/55753680",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-55753680",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 55753680,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzUzNjgw",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-16T14:44:49Z",
    "updated_at": "2014-09-16T14:44:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "cc @jaimefro\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/55754203",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-55754203",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 55754203,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzU0MjAz",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-16T14:48:03Z",
    "updated_at": "2014-09-16T14:48:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "@behzadnouri I realized #8086 is this issue @seth-p pointing at (unifying skew)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/56820075",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-56820075",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 56820075,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2ODIwMDc1",
    "user": {
      "login": "behzadnouri",
      "id": 1288998,
      "node_id": "MDQ6VXNlcjEyODg5OTg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1288998?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/behzadnouri",
      "html_url": "https://github.com/behzadnouri",
      "followers_url": "https://api.github.com/users/behzadnouri/followers",
      "following_url": "https://api.github.com/users/behzadnouri/following{/other_user}",
      "gists_url": "https://api.github.com/users/behzadnouri/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/behzadnouri/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/behzadnouri/subscriptions",
      "organizations_url": "https://api.github.com/users/behzadnouri/orgs",
      "repos_url": "https://api.github.com/users/behzadnouri/repos",
      "events_url": "https://api.github.com/users/behzadnouri/events{/privacy}",
      "received_events_url": "https://api.github.com/users/behzadnouri/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-25T13:44:19Z",
    "updated_at": "2014-09-25T13:44:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jreback tests added\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/56982728",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-56982728",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 56982728,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2OTgyNzI4",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-26T16:08:56Z",
    "updated_at": "2014-09-26T16:08:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "well, I think a more complete soln to #6929 is in order no? \n\n@seth-p \ncc @jaimefrio \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/56984374",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-56984374",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 56984374,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2OTg0Mzc0",
    "user": {
      "login": "jaimefrio",
      "id": 3343990,
      "node_id": "MDQ6VXNlcjMzNDM5OTA=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/3343990?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jaimefrio",
      "html_url": "https://github.com/jaimefrio",
      "followers_url": "https://api.github.com/users/jaimefrio/followers",
      "following_url": "https://api.github.com/users/jaimefrio/following{/other_user}",
      "gists_url": "https://api.github.com/users/jaimefrio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jaimefrio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jaimefrio/subscriptions",
      "organizations_url": "https://api.github.com/users/jaimefrio/orgs",
      "repos_url": "https://api.github.com/users/jaimefrio/repos",
      "events_url": "https://api.github.com/users/jaimefrio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jaimefrio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-26T16:21:56Z",
    "updated_at": "2014-09-26T16:21:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "You can do much, much better... I have a PR halfway through [here](https://github.com/jaimefrio/pandas/commit/ae6fd5252739785a84155eb1057073c0326a9119), which uses the Welford-like algorithm described [here](http://en.wikipedia.org/wiki/Algorithms_for_calculating_variance#Higher-order_statistics). The case where and observation is removed and another added is not worked out there (or anywhere else as far as I can tell) and you have to figure it out on your own.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/56995659",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-56995659",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 56995659,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2OTk1NjU5",
    "user": {
      "login": "behzadnouri",
      "id": 1288998,
      "node_id": "MDQ6VXNlcjEyODg5OTg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1288998?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/behzadnouri",
      "html_url": "https://github.com/behzadnouri",
      "followers_url": "https://api.github.com/users/behzadnouri/followers",
      "following_url": "https://api.github.com/users/behzadnouri/following{/other_user}",
      "gists_url": "https://api.github.com/users/behzadnouri/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/behzadnouri/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/behzadnouri/subscriptions",
      "organizations_url": "https://api.github.com/users/behzadnouri/orgs",
      "repos_url": "https://api.github.com/users/behzadnouri/repos",
      "events_url": "https://api.github.com/users/behzadnouri/events{/privacy}",
      "received_events_url": "https://api.github.com/users/behzadnouri/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-26T17:46:34Z",
    "updated_at": "2014-09-26T17:46:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jaimefrio I tried to take that route before making my code changes and that is definitely the right way to go if the code was doing _expanding_ window moments not _rolling_ window skew/kurt while _handling nan values gracefully_.\n\ntake kurtosis for example, you need to maintain _effective_ number of observations `n` (that is the count of not null values within the window), and 4 central moments. that is 5 updating equations which is fine. _but_ there are 4 cases for each equation based on the new value and dropping value being null or not. that is 5 \\* 4 = 20 equations with all their corner cases and chances of making mistakes. (think about which `n` you should use to update the moments if the first value is null versus the new value is null, new `n` or old `n`)\n\nand even doing all that, at the end of the day, it is not like:\n\n> You can do much, much better...\n\nno! definitely not. for all real world series that I have seen, and any time series which does not change scale/location with _multiple_ orders of magnitude z-scores will do the job with minimal code complexity and a lot more code maintainability.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/57028657",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-57028657",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 57028657,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDI4NjU3",
    "user": {
      "login": "jaimefrio",
      "id": 3343990,
      "node_id": "MDQ6VXNlcjMzNDM5OTA=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/3343990?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jaimefrio",
      "html_url": "https://github.com/jaimefrio",
      "followers_url": "https://api.github.com/users/jaimefrio/followers",
      "following_url": "https://api.github.com/users/jaimefrio/following{/other_user}",
      "gists_url": "https://api.github.com/users/jaimefrio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jaimefrio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jaimefrio/subscriptions",
      "organizations_url": "https://api.github.com/users/jaimefrio/orgs",
      "repos_url": "https://api.github.com/users/jaimefrio/repos",
      "events_url": "https://api.github.com/users/jaimefrio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jaimefrio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-26T22:27:57Z",
    "updated_at": "2014-09-26T22:27:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "I don't know... A mock up of your solution runs on my system a little over 2x slower than the current code. And while it improves stability for what arguably are the most common use cases, it is still going to fail for a number of not-so-pathological ones, e.g. `x= np.random.rand(1000); x[500:] += 10000; rolling_skew(x, 100, 0)` is all wrong. That could be OK, were it not because there is an algorithm that provides superior stability, and better performance (`roll_var` was slowed down about 15%, if memory serves me well).\n\nI am not much of a Pandas user or contributor, so I may be getting the philosophy all wrong. But on a project that uses home brewed implementations of skip lists (for `roll_median`) and of circular deques (for `roll_min` and `roll_max`), and that advertises itself as \"providing high-performance, easy-to-use data structures\", choosing an objectively worse algorithm because it makes code less complex and more maintainable seems like a pretty weak argument. Especially since you have the complexity packaged away inside a function, that can very easily be checked to ensure that all code paths are working fine with 10 or 20 lines of test code.\n\nJust to make it explicitly clear, I am -1 on this approach. But if it is deemed the right one, I would suggest that you put your code in the Python wrapper, as I really don't think you are taking any advantage of Cython.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/57029739",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-57029739",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 57029739,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDI5NzM5",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-26T22:40:30Z",
    "updated_at": "2014-09-26T22:40:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jaimefrio your impl that you pointed above seems pretty straightforward and you have nicely refactored out the counting issue. I think it seems pretty reasonable and is likely to have similar perf to the current routines, pls continue work and submit a PR when ready.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/57036744",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-57036744",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 57036744,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDM2NzQ0",
    "user": {
      "login": "behzadnouri",
      "id": 1288998,
      "node_id": "MDQ6VXNlcjEyODg5OTg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1288998?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/behzadnouri",
      "html_url": "https://github.com/behzadnouri",
      "followers_url": "https://api.github.com/users/behzadnouri/followers",
      "following_url": "https://api.github.com/users/behzadnouri/following{/other_user}",
      "gists_url": "https://api.github.com/users/behzadnouri/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/behzadnouri/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/behzadnouri/subscriptions",
      "organizations_url": "https://api.github.com/users/behzadnouri/orgs",
      "repos_url": "https://api.github.com/users/behzadnouri/repos",
      "events_url": "https://api.github.com/users/behzadnouri/events{/privacy}",
      "received_events_url": "https://api.github.com/users/behzadnouri/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-27T00:45:56Z",
    "updated_at": "2014-09-27T00:45:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jaimefrio what you are calling _\"not-so-pathological\"_ has a jump more thank 34K of trailing standard deviation:\n\n```\nIn [28]: np.diff(x)[499] / x[:500].std()\nOut[28]: 34371.41\n```\n\nwhat actual real-world time series makes such a jump and still someone would ask \"lets look at skew numbers\"?\n\n> choosing an **objectively worse** algorithm because it makes code less complex and more maintainable seems like a **pretty weak argument**\n\nyou are calling it _\"objectively worse\"_ based on a contrived example, while at the same time admitting \n\n> improves stability for what arguably are the most common use cases,\n\nand looking at [this](https://github.com/jaimefrio/pandas/commit/ae6fd5252739785a84155eb1057073c0326a9119) i honestly do not know what to say for what you call _\"pretty weak argument\"_.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/57038270",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-57038270",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 57038270,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDM4Mjcw",
    "user": {
      "login": "jaimefrio",
      "id": 3343990,
      "node_id": "MDQ6VXNlcjMzNDM5OTA=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/3343990?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jaimefrio",
      "html_url": "https://github.com/jaimefrio",
      "followers_url": "https://api.github.com/users/jaimefrio/followers",
      "following_url": "https://api.github.com/users/jaimefrio/following{/other_user}",
      "gists_url": "https://api.github.com/users/jaimefrio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jaimefrio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jaimefrio/subscriptions",
      "organizations_url": "https://api.github.com/users/jaimefrio/orgs",
      "repos_url": "https://api.github.com/users/jaimefrio/repos",
      "events_url": "https://api.github.com/users/jaimefrio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jaimefrio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-27T01:32:35Z",
    "updated_at": "2014-09-27T01:32:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "@behzadnouri I was calling it objectively worse because I timed it an it run 2x slower than the current code. Which is kind of surprisingly fast, since you are iterating at least eight times over the input array before spitting an answer.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/57043827",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-57043827",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 57043827,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDQzODI3",
    "user": {
      "login": "jaimefrio",
      "id": 3343990,
      "node_id": "MDQ6VXNlcjMzNDM5OTA=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/3343990?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jaimefrio",
      "html_url": "https://github.com/jaimefrio",
      "followers_url": "https://api.github.com/users/jaimefrio/followers",
      "following_url": "https://api.github.com/users/jaimefrio/following{/other_user}",
      "gists_url": "https://api.github.com/users/jaimefrio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jaimefrio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jaimefrio/subscriptions",
      "organizations_url": "https://api.github.com/users/jaimefrio/orgs",
      "repos_url": "https://api.github.com/users/jaimefrio/repos",
      "events_url": "https://api.github.com/users/jaimefrio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jaimefrio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-27T06:15:17Z",
    "updated_at": "2014-09-27T06:15:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "It turns out that it isn't that hard to come up with very simple examples that fail big time:\n\n```\nimport pandas as pd\nfrom pandas.algos import roll_kurt\nimport numpy as np\nfrom scipy.stats import kurtosis\n\n# Sanity check\nx = np.random.rand(1e6)\ny = x - x.mean(); y /= y.std()\n>>> roll_kurt(x, 1000, 0)[-1]\n-1.1175114235008137\n>>> roll_kurt(y, 1000, 0)[-1]\n-1.1175114234982957\n>>> kurtosis(y[-1000:], bias=False)\n-1.1175114234980807\n\n# Meltdown\nx = np.linspace(0, 1000, 1e6)\ny = x - x.mean(); y /= y.std()\n>>> roll_kurt(x, 1000, 0)[-1]\n10.397302582213468\n>>> roll_kurt(y, 1000, 0)[-1]\n-0.46924667029766476\n>>> kurtosis(x[-1000:], bias=False)\n-1.2000000000000006\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/57053677",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-57053677",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 57053677,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDUzNjc3",
    "user": {
      "login": "behzadnouri",
      "id": 1288998,
      "node_id": "MDQ6VXNlcjEyODg5OTg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1288998?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/behzadnouri",
      "html_url": "https://github.com/behzadnouri",
      "followers_url": "https://api.github.com/users/behzadnouri/followers",
      "following_url": "https://api.github.com/users/behzadnouri/following{/other_user}",
      "gists_url": "https://api.github.com/users/behzadnouri/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/behzadnouri/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/behzadnouri/subscriptions",
      "organizations_url": "https://api.github.com/users/behzadnouri/orgs",
      "repos_url": "https://api.github.com/users/behzadnouri/repos",
      "events_url": "https://api.github.com/users/behzadnouri/events{/privacy}",
      "received_events_url": "https://api.github.com/users/behzadnouri/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-27T14:07:18Z",
    "updated_at": "2014-09-27T14:07:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jaimefrio the numbers you are quoting do not come out of this code (especially that `10.39...` which is extremely off from output of this patch). you may want to check your mock up code.\n\n_That you have got even this simpler algorithm wrong, proves my point of why code simplicity and maintainability matters._\n\nalso, you are looking at a series with such characteristics:\n\n```\nIn [48]: (x[-1000:].std()) / x.std()\nOut[48]: 0.0010\n\nIn [49]: (x[-1000:].mean() - x[:1000].mean()) / x.std()\nOut[49]: 3.4606\n\nIn [50]: (x[-1000:].mean() - x[:1000].mean()) / x[-1000:].std() # same as `/ x[:1000].std()`\nOut[50]: 3460.6\n```\n\nDo you honestly believe that a series which changes location around `3.5` times of its standard deviation (3460 of rolling window standard deviation) is a _use case_ for kurtosis as a measure of tail heaviness? does anyone out there care if tails are heavy when the location can already move by orders of magnitude?\n\nI am happy that you mentioned earlier that this patch\n\n> improves stability for what arguably are the most common use cases,\n\nand that your mock up code passes sanity check for the sane example. That said, I do not feel this discussion is an effective use of our time. If you think I am wrong, please spend time on implementing what you think is right, rather than trying to prove me wrong.\n\nPlease do not continue this argument, and instead focus on correct implementation of what you think is a better path.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/57124890",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-57124890",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 57124890,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTI0ODkw",
    "user": {
      "login": "jaimefrio",
      "id": 3343990,
      "node_id": "MDQ6VXNlcjMzNDM5OTA=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/3343990?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jaimefrio",
      "html_url": "https://github.com/jaimefrio",
      "followers_url": "https://api.github.com/users/jaimefrio/followers",
      "following_url": "https://api.github.com/users/jaimefrio/following{/other_user}",
      "gists_url": "https://api.github.com/users/jaimefrio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jaimefrio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jaimefrio/subscriptions",
      "organizations_url": "https://api.github.com/users/jaimefrio/orgs",
      "repos_url": "https://api.github.com/users/jaimefrio/repos",
      "events_url": "https://api.github.com/users/jaimefrio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jaimefrio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-29T07:21:55Z",
    "updated_at": "2014-09-29T07:21:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "Trust me, @behzadnouri, I have better things to do than proving you wrong. This is supposed to be a collaborative effort to produce great software, not a contest to see who has the bestest PR. Let's try to get back to that...\n\nI have done some more tests over the weekend, and it is terribly easy to find simple examples with terrible behavior. Perhaps the most illustrative is a long enough linear ramp, with a sufficiently small window. The kurtosis should be `-1.2` for any window size, but here's what you get:\n\n```\nx = np.linspace(0, 1, 10000)\n>>> roll_kurt(x, 10, 0)[-1]  # current master, completely broken\n39.756569994447986\n>>> roll_kurt((x - x.mean()) / x.std(), 10, 0)[-1]  # this PR, better but 30% off\n-1.5704869226377387\n>>> roll_kurt(x - x.mean(), 10, 0)[-1]  # similar idea to this PR, faster, less robust\n-0.15264283115696387\n>>> roll_kurt2(x ,10, 0)[-1]  # a stabler algorithm, not bad, but 40% off\n-1.6595757481342461\n>>> roll_kurt2(x - x.mean(), 10, 0)[-1]  # stabler algo + centering, getting close\n-1.4211005796851859\n>>> roll_kurt2((x - x.mean()) / x.std(), 10, 0)[-1]  # stabler algo + this PR, almost (4% off)\n-1.2454174095606518\n```\n\nThere is also the thing with performance... Some timings to put things in context, with the same above `x`:\n\n```\n%timeit roll_kurt(x, 10, 0)  # current master is terribly slow\n1000 loops, best of 3: 890 µs per loop\n\n%timeit roll_kurt2(x, 10, 0)  # better stability and 2.5x faster\n1000 loops, best of 3: 375 µs per loop\n\n%%timeit  # this PR preprocessing mock-up\n... mask = np.isfinite(x)\n... y = x.copy()\n... y[mask] -= np.mean(x[mask])\n... y[mask] /= np.std(x[mask])\n1000 loops, best of 3: 333 µs per loop\n\n%%timeit  # similar to this PR, 25% faster\n... mask = np.isfinite(x)\n... y = x.copy()\n... y -= np.mean(x[mask])\n... y /= np.std(x[mask])\n1000 loops, best of 3: 244 µs per loop\n\n%%timeit  # centering w/o normalizing is 2.5x faster\n... mask = np.isfinite(x)\n... y = x.copy()\n... y -= np.mean(x[mask])\n10000 loops, best of 3: 103 µs per loop\n\nIn [27]: %timeit y = x - x[mask].mean()  # building the mask is not cheap\n10000 loops, best of 3: 64.4 µs per loop\n```\n\nI think there is plenty of food for thought here. My views on this:\n- The current algorithms in the core `roll_skew` and `roll_kurt` are very, very bad, and need to be replaced. I will do that shortly.\n- Getting rolling skewness and kurtosis right is hard! Using z-scores, or at least centering, may be a good idea, but you have to be careful with performance.\n\nSo based on all of the above, my original -1 is now a +0.25. To make it a full +1, I would suggest:\n- Move the code to the Python wrapper. When the Python functions `rolling_skew` or `rolling_kurt` are called, before calling the Cython functions `roll_skew` or `roll_kurt`, a call is made to `_rolling_moment`, which calls `_process_data_structure`, where a mask of `inf` values in the arrays is  already being calculated, see [here](https://github.com/pydata/pandas/blob/master/pandas/stats/moments.py#L437). If you can mix both maskings into a single one, you can minimize the effect on performance, and get the extra robustness almost for free.\n- I would skip the division by the standard deviation. It is taking 50% of the time (more if the maskings are joined), and for most cases it seems to have a marginal effect on robustness.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/57156264",
    "html_url": "https://github.com/pandas-dev/pandas/pull/8270#issuecomment-57156264",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8270",
    "id": 57156264,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTU2MjY0",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-29T12:57:55Z",
    "updated_at": "2014-09-29T12:57:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jaimefrio sounds like a nice comprehensive approach. Pls submit a PR when ready.\n"
  }
]
