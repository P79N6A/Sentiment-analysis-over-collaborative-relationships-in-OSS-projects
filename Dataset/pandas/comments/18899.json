[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/353459118",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18899#issuecomment-353459118",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18899",
    "id": 353459118,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MzQ1OTExOA==",
    "user": {
      "login": "chris-b1",
      "id": 1924092,
      "node_id": "MDQ6VXNlcjE5MjQwOTI=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1924092?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chris-b1",
      "html_url": "https://github.com/chris-b1",
      "followers_url": "https://api.github.com/users/chris-b1/followers",
      "following_url": "https://api.github.com/users/chris-b1/following{/other_user}",
      "gists_url": "https://api.github.com/users/chris-b1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chris-b1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chris-b1/subscriptions",
      "organizations_url": "https://api.github.com/users/chris-b1/orgs",
      "repos_url": "https://api.github.com/users/chris-b1/repos",
      "events_url": "https://api.github.com/users/chris-b1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chris-b1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-21T21:13:24Z",
    "updated_at": "2017-12-21T21:13:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "Can you please provide a reproducible example?  I just tried the below and seems to work?\r\n```python\r\nIn [11]: df = pd.DataFrame({'a': [1, 2, 3]})\r\n\r\nIn [12]: df.to_excel('tmp.xlsx', index=False)\r\n\r\nIn [13]: pd.read_excel('tmp.xlsx').dtypes\r\nOut[13]: \r\na    int64\r\ndtype: object\r\n\r\nIn [14]: pd.read_excel('tmp.xlsx', dtype={'a': float}).dtypes\r\nOut[14]: \r\na    float64\r\ndtype: object\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/353473183",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18899#issuecomment-353473183",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18899",
    "id": 353473183,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MzQ3MzE4Mw==",
    "user": {
      "login": "pzakielarz",
      "id": 3414802,
      "node_id": "MDQ6VXNlcjM0MTQ4MDI=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/3414802?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pzakielarz",
      "html_url": "https://github.com/pzakielarz",
      "followers_url": "https://api.github.com/users/pzakielarz/followers",
      "following_url": "https://api.github.com/users/pzakielarz/following{/other_user}",
      "gists_url": "https://api.github.com/users/pzakielarz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pzakielarz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pzakielarz/subscriptions",
      "organizations_url": "https://api.github.com/users/pzakielarz/orgs",
      "repos_url": "https://api.github.com/users/pzakielarz/repos",
      "events_url": "https://api.github.com/users/pzakielarz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pzakielarz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-21T22:25:06Z",
    "updated_at": "2017-12-21T22:59:24Z",
    "author_association": "NONE",
    "body": "After playing around trying to construct a MWE, I agree, it usually works.  The following code recreates the issue, but I suspect something is causing the `dtype` kwarg to be ignored. \r\n```python\r\nIn [2]: df = pd.DataFrame([['bookmark','A'],\r\n   ...:                    ['data',1],\r\n   ...:                    ['data',2.3]], columns=['record_type','record'])\r\n   ...:                    \r\n\r\nIn [3]: df\r\nOut[3]: \r\n  record_type record\r\n0    bookmark      A\r\n1        data      1\r\n2        data    2.3\r\n\r\nIn [4]: df.to_excel('tmp.xlsx', index=False)\r\n\r\nIn [5]: df = pd.read_excel('tmp.xlsx', names=['record_type','record'],\r\n   ...:                    dtype={'record':float}, skiprows=1, header=None)\r\n   ...:                    \r\n\r\nIn [6]: df\r\nOut[6]: \r\n  record_type record\r\n0    bookmark      A\r\n1        data      1\r\n2        data    2.3\r\n\r\nIn [7]: df.record.apply(type)\r\nOut[7]: \r\n0      <class 'str'>\r\n1      <class 'int'>\r\n2    <class 'float'>\r\nName: record, dtype: object\r\n\r\nIn [8]: df = pd.read_excel('tmp.xlsx', names=['record_type','record'],\r\n   ...:                    dtype={'record':float}, skiprows=1, header=None, convert_float=False)\r\n   ...:                    \r\n   ...:                    \r\n\r\nIn [9]: df.record.apply(type)\r\nOut[9]: \r\n0      <class 'str'>\r\n1    <class 'float'>\r\n2    <class 'float'>\r\nName: record, dtype: object\r\n```\r\nIf you don't specify `names`, `skiprows`, and `header` when reading, you get a ValueError when it attempts to convert \"A\" to a float.  However, the above example runs without raising an exception."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/353749582",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18899#issuecomment-353749582",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18899",
    "id": 353749582,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1Mzc0OTU4Mg==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-23T21:37:11Z",
    "updated_at": "2017-12-23T21:37:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "this is as expected. ``dtype`` doesn't force a type on something that cannot be converted. you should generally use ``pd.to_numeric`` if you want to control this (after reading)."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/353751936",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18899#issuecomment-353751936",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18899",
    "id": 353751936,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1Mzc1MTkzNg==",
    "user": {
      "login": "pzakielarz",
      "id": 3414802,
      "node_id": "MDQ6VXNlcjM0MTQ4MDI=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/3414802?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pzakielarz",
      "html_url": "https://github.com/pzakielarz",
      "followers_url": "https://api.github.com/users/pzakielarz/followers",
      "following_url": "https://api.github.com/users/pzakielarz/following{/other_user}",
      "gists_url": "https://api.github.com/users/pzakielarz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pzakielarz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pzakielarz/subscriptions",
      "organizations_url": "https://api.github.com/users/pzakielarz/orgs",
      "repos_url": "https://api.github.com/users/pzakielarz/repos",
      "events_url": "https://api.github.com/users/pzakielarz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pzakielarz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-23T22:32:35Z",
    "updated_at": "2017-12-23T22:32:35Z",
    "author_association": "NONE",
    "body": "@jreback Thanks for the info on `to_numeric`.  Can you clarify if you're saying `dtype` inconsistently raising `ValueError` when the column cannot be converted is expected?\r\n\r\nThis causes a `ValueError`\r\n```python\r\npd.read_excel('tmp.xlsx', names=['record_type', 'records'], dtype={1:float},\r\n                       skiprows=1, header=None)\r\n```\r\nbut this does not\r\n```python\r\npd.read_excel('tmp.xlsx', names=['record_type', 'records'], dtype={'records':float},\r\n                       skiprows=1, header=None)\r\n```\r\nObviously this isn't the original issue, but is what lead to my confusion.  I can file a new bug report if you agree that the inconsistency is not intended."
  }
]
