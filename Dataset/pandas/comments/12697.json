[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/200316521",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12697#issuecomment-200316521",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12697",
    "id": 200316521,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwMDMxNjUyMQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-23T11:51:52Z",
    "updated_at": "2016-03-23T11:51:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "so this is chained indexing on a multi-index. So a fully-qualified selection works:\n\n```\nIn [33]: dfmi.loc[pd.IndexSlice['d', 30:70], :]\nOut[33]: \n          Test\nd 30  0.244715\n  31  0.692720\n  32  0.100552\n  33 -0.319824\n  34 -0.380916\n...        ...\n  66  4.098519\n  67 -1.592476\n  68  1.057753\n  69 -1.329330\n  70  0.048740\n\n[41 rows x 1 columns]\n\nIn [34]: dfmi.loc[pd.IndexSlice['a', 30:70], :]\nOut[34]: \n          Test\na 30  0.295775\n  31 -1.544894\n  32  0.098592\n  33 -1.111341\n  34 -0.165816\n...        ...\n  66 -0.241730\n  67  0.545091\n  68  0.958949\n  69  0.186351\n  70  0.792855\n\n[41 rows x 1 columns]\n```\n\nMight be something odd going on with the indexers. If you'd have a look and see if you can spot where this is happening would be helpful. You can just use your tests script and step thru the debugger.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/203199744",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12697#issuecomment-203199744",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12697",
    "id": 203199744,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwMzE5OTc0NA==",
    "user": {
      "login": "ruoyu0088",
      "id": 826871,
      "node_id": "MDQ6VXNlcjgyNjg3MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/826871?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ruoyu0088",
      "html_url": "https://github.com/ruoyu0088",
      "followers_url": "https://api.github.com/users/ruoyu0088/followers",
      "following_url": "https://api.github.com/users/ruoyu0088/following{/other_user}",
      "gists_url": "https://api.github.com/users/ruoyu0088/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ruoyu0088/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ruoyu0088/subscriptions",
      "organizations_url": "https://api.github.com/users/ruoyu0088/orgs",
      "repos_url": "https://api.github.com/users/ruoyu0088/repos",
      "events_url": "https://api.github.com/users/ruoyu0088/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ruoyu0088/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-30T02:27:59Z",
    "updated_at": "2016-03-30T02:36:32Z",
    "author_association": "NONE",
    "body": "I found the problem. It's the line in `convert_indexer()` in `MultiIndex._get_level_indexer()`:\n\n```\nm[np.in1d(labels,r,assume_unique=True)] = True\n```\n\nHere is the document of the assume_unique of in1d():\n\n```\n    assume_unique : bool, optional\n        If True, the input arrays are both assumed to be unique, which\n        can speed up the calculation.  Default is False.\n```\n\nbut `labels` is not unique in this case. So set `assume_unique=False` fix the problem:\n\n```\nm[np.in1d(labels,r,assume_unique=False)] = True\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/214783771",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12697#issuecomment-214783771",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12697",
    "id": 214783771,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxNDc4Mzc3MQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-04-26T15:30:07Z",
    "updated_at": "2016-04-26T15:30:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ruoyu0088 if you want to do a PR for this would be great (and set `assume_unique=level.is_unique`) I think.\n"
  }
]
