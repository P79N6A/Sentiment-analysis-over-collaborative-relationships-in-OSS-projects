[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/370978954",
    "html_url": "https://github.com/pandas-dev/pandas/pull/20024#issuecomment-370978954",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20024",
    "id": 370978954,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MDk3ODk1NA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-07T00:29:27Z",
    "updated_at": "2018-03-07T00:29:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "i think we r going to remove mad (there is an issue about this); so not sure we should add this"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/370981546",
    "html_url": "https://github.com/pandas-dev/pandas/pull/20024#issuecomment-370981546",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20024",
    "id": 370981546,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MDk4MTU0Ng==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-07T00:43:33Z",
    "updated_at": "2018-03-07T00:43:33Z",
    "author_association": "MEMBER",
    "body": "I assume you are referencing #11787. FWIW it would be a pretty trivial change here to support 'median' as well. \r\n\r\nOK with deprecating, but I will say the one thing that we may want to consider is how users would roll this on their own. Operating on a series is for sure straightforward:\r\n\r\n```python\r\nabs(df['val'] - df['val'].mean()).mean()\r\n```\r\n\r\nBut attempting the same on a GroupBy object will Raise\r\n\r\n```python\r\nabs(df.groupby('key') - df.groupby('key').mean()).mean()\r\nValueError: Unable to coerce to Series, length must be 1: given 2\r\n```\r\n\r\nSo the user would be responsible for some heavier lifting on that side, assuming there's no built-in way for the plain `GroupBy` object to handle subtraction of its aggregated result."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/370981936",
    "html_url": "https://github.com/pandas-dev/pandas/pull/20024#issuecomment-370981936",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20024",
    "id": 370981936,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MDk4MTkzNg==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-07T00:45:27Z",
    "updated_at": "2018-03-07T00:45:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "try with a group by and then transform\r\nthis is a typical pattern"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/370983405",
    "html_url": "https://github.com/pandas-dev/pandas/pull/20024#issuecomment-370983405",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20024",
    "id": 370983405,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MDk4MzQwNQ==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-07T00:52:45Z",
    "updated_at": "2018-03-07T00:52:45Z",
    "author_association": "MEMBER",
    "body": "Assuming you mean\r\n\r\n```python\r\nabs(df - df.groupby('key').transform('mean')).mean()\r\n```\r\nIt's possible but then requires the user to explicitly drop the grouped field(s) somewhere in the operation.\r\n\r\nA similar implementation (which I used here) doesn't add the grouped fields but is definitely more verbose than what would be required for the Series / DataFrame counterparts\r\n\r\n```python\r\nabs(df.groupby('key').shift(0) - df.groupby('key').transform('mean')).mean()\r\n```\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/370984152",
    "html_url": "https://github.com/pandas-dev/pandas/pull/20024#issuecomment-370984152",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20024",
    "id": 370984152,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MDk4NDE1Mg==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-07T00:56:18Z",
    "updated_at": "2018-03-07T00:56:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "not sure why u need .shift\r\nalso you donâ€™t need the final mean \r\nnot sure what that is for "
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/370985156",
    "html_url": "https://github.com/pandas-dev/pandas/pull/20024#issuecomment-370985156",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20024",
    "id": 370985156,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MDk4NTE1Ng==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-07T01:01:25Z",
    "updated_at": "2018-03-07T01:01:25Z",
    "author_association": "MEMBER",
    "body": "If you remove the shift you get \r\n\r\n```python\r\nValueError: Unable to coerce to Series, length must be 1: given 2\r\n```\r\n\r\nThe inner mean is the \"centering\" op and the outer is the resulting op. I think [this comment](https://github.com/pandas-dev/pandas/issues/11787#issuecomment-172399414) sums up the possible combinations pretty well"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/371005618",
    "html_url": "https://github.com/pandas-dev/pandas/pull/20024#issuecomment-371005618",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20024",
    "id": 371005618,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MTAwNTYxOA==",
    "user": {
      "login": "shoyer",
      "id": 1217238,
      "node_id": "MDQ6VXNlcjEyMTcyMzg=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1217238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shoyer",
      "html_url": "https://github.com/shoyer",
      "followers_url": "https://api.github.com/users/shoyer/followers",
      "following_url": "https://api.github.com/users/shoyer/following{/other_user}",
      "gists_url": "https://api.github.com/users/shoyer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shoyer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shoyer/subscriptions",
      "organizations_url": "https://api.github.com/users/shoyer/orgs",
      "repos_url": "https://api.github.com/users/shoyer/repos",
      "events_url": "https://api.github.com/users/shoyer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shoyer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-07T02:56:10Z",
    "updated_at": "2018-03-07T02:56:29Z",
    "author_association": "MEMBER",
    "body": "In xarray we support [arithmetic with GroupBy objects](http://xarray.pydata.org/en/stable/groupby.html#grouped-arithmetic) so your example would actually work:\r\n```\r\nabs(df.groupby('key') - df.groupby('key').mean()).mean()\r\n```\r\n\r\nIt would be interesting to explore porting this syntax to pandas. Xarray users find it pretty useful for doing these sorts of grouped normalizations (which are common in climate science)."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/371593429",
    "html_url": "https://github.com/pandas-dev/pandas/pull/20024#issuecomment-371593429",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20024",
    "id": 371593429,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MTU5MzQyOQ==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-08T19:17:27Z",
    "updated_at": "2018-03-08T19:17:27Z",
    "author_association": "MEMBER",
    "body": "@shoyer that could be a viable option here, and certainly make the mad operation across `DataFrame` / `Series` / `GroupBy` consistent while opening up some other possibilities (ex: easy demeaning). \r\n\r\nDo you know where that is implemented in xarray? Dug through the source but nothing was immediately apparent to me"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/371594183",
    "html_url": "https://github.com/pandas-dev/pandas/pull/20024#issuecomment-371594183",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20024",
    "id": 371594183,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MTU5NDE4Mw==",
    "user": {
      "login": "shoyer",
      "id": 1217238,
      "node_id": "MDQ6VXNlcjEyMTcyMzg=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1217238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shoyer",
      "html_url": "https://github.com/shoyer",
      "followers_url": "https://api.github.com/users/shoyer/followers",
      "following_url": "https://api.github.com/users/shoyer/following{/other_user}",
      "gists_url": "https://api.github.com/users/shoyer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shoyer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shoyer/subscriptions",
      "organizations_url": "https://api.github.com/users/shoyer/orgs",
      "repos_url": "https://api.github.com/users/shoyer/repos",
      "events_url": "https://api.github.com/users/shoyer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shoyer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-08T19:20:10Z",
    "updated_at": "2018-03-08T19:20:49Z",
    "author_association": "MEMBER",
    "body": "We use some awkward machinery for defining binary ops in xarray (you'd need to figure out how to do this for pandas), but here's where the core groupby arithmetic logic is defined:\r\nhttps://github.com/pydata/xarray/blob/870e4eaf1895cfeffdc27dab61ad739e67133777/xarray/core/groupby.py#L301-L332\r\n\r\nI think you could do something pretty similar for pandas, though obviously the implementation would be pretty different (e.g., you could use `.loc` instead of `.sel()`)."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/403297052",
    "html_url": "https://github.com/pandas-dev/pandas/pull/20024#issuecomment-403297052",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20024",
    "id": 403297052,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMzI5NzA1Mg==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-08T15:53:36Z",
    "updated_at": "2018-07-08T15:53:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "@WillAyd ideally like to move the groupby cython routines to pandas/core/groupby/cython before we attempt this"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/438152637",
    "html_url": "https://github.com/pandas-dev/pandas/pull/20024#issuecomment-438152637",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20024",
    "id": 438152637,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzODE1MjYzNw==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-13T06:28:00Z",
    "updated_at": "2018-11-13T06:28:00Z",
    "author_association": "MEMBER",
    "body": "Closing due to potential deprecation of method cited in #11787"
  }
]
