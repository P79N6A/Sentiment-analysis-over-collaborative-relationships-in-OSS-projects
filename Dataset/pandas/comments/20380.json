[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/373743080",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20380#issuecomment-373743080",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20380",
    "id": 373743080,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3Mzc0MzA4MA==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-16T15:09:36Z",
    "updated_at": "2018-03-16T15:09:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "Can you make your example reproducible? http://stackoverflow.com/help/mcve"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/373815270",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20380#issuecomment-373815270",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20380",
    "id": 373815270,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MzgxNTI3MA==",
    "user": {
      "login": "JackKZ",
      "id": 25467585,
      "node_id": "MDQ6VXNlcjI1NDY3NTg1",
      "avatar_url": "https://avatars2.githubusercontent.com/u/25467585?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JackKZ",
      "html_url": "https://github.com/JackKZ",
      "followers_url": "https://api.github.com/users/JackKZ/followers",
      "following_url": "https://api.github.com/users/JackKZ/following{/other_user}",
      "gists_url": "https://api.github.com/users/JackKZ/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JackKZ/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JackKZ/subscriptions",
      "organizations_url": "https://api.github.com/users/JackKZ/orgs",
      "repos_url": "https://api.github.com/users/JackKZ/repos",
      "events_url": "https://api.github.com/users/JackKZ/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JackKZ/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-16T19:07:05Z",
    "updated_at": "2018-03-16T19:07:05Z",
    "author_association": "NONE",
    "body": "[example_df.zip](https://github.com/pandas-dev/pandas/files/1820497/example_df.zip)\r\nHere is the pickle file that I have trouble with. \r\n\r\nThanks! \r\n\r\nJack "
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/373818916",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20380#issuecomment-373818916",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20380",
    "id": 373818916,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MzgxODkxNg==",
    "user": {
      "login": "JackKZ",
      "id": 25467585,
      "node_id": "MDQ6VXNlcjI1NDY3NTg1",
      "avatar_url": "https://avatars2.githubusercontent.com/u/25467585?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JackKZ",
      "html_url": "https://github.com/JackKZ",
      "followers_url": "https://api.github.com/users/JackKZ/followers",
      "following_url": "https://api.github.com/users/JackKZ/following{/other_user}",
      "gists_url": "https://api.github.com/users/JackKZ/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JackKZ/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JackKZ/subscriptions",
      "organizations_url": "https://api.github.com/users/JackKZ/orgs",
      "repos_url": "https://api.github.com/users/JackKZ/repos",
      "events_url": "https://api.github.com/users/JackKZ/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JackKZ/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-16T19:21:05Z",
    "updated_at": "2018-03-16T19:21:05Z",
    "author_association": "NONE",
    "body": "Also here is the output of pd.show_versions()\r\n\r\nINSTALLED VERSIONS\r\n------------------\r\ncommit: None\r\npython: 3.6.4.final.0\r\npython-bits: 64\r\nOS: Windows\r\nOS-release: 10\r\nmachine: AMD64\r\nprocessor: Intel64 Family 6 Model 69 Stepping 1, GenuineIntel\r\nbyteorder: little\r\nLC_ALL: None\r\nLANG: en\r\nLOCALE: None.None\r\n\r\npandas: 0.22.0\r\npytest: 3.3.2\r\npip: 9.0.1\r\nsetuptools: 38.4.0\r\nCython: 0.27.3\r\nnumpy: 1.14.0\r\nscipy: 1.0.0\r\npyarrow: None\r\nxarray: None\r\nIPython: 6.2.1\r\nsphinx: 1.6.6\r\npatsy: 0.5.0\r\ndateutil: 2.6.1\r\npytz: 2017.3\r\nblosc: None\r\nbottleneck: 1.2.1\r\ntables: 3.4.2\r\nnumexpr: 2.6.4\r\nfeather: None\r\nmatplotlib: 2.1.2\r\nopenpyxl: 2.4.10\r\nxlrd: 1.1.0\r\nxlwt: 1.3.0\r\nxlsxwriter: 1.0.2\r\nlxml: 4.1.1\r\nbs4: 4.6.0\r\nhtml5lib: 1.0.1\r\nsqlalchemy: 1.2.1\r\npymysql: None\r\npsycopg2: None\r\njinja2: 2.10\r\ns3fs: None\r\nfastparquet: None\r\npandas_gbq: None\r\npandas_datareader: None"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/373821209",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20380#issuecomment-373821209",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20380",
    "id": 373821209,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MzgyMTIwOQ==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-16T19:30:11Z",
    "updated_at": "2018-03-16T19:30:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "Are you able to do some digging to see what's going on? I suspect none of\nthe maintainers will have time.\n\nIf not, perhaps post a traceback and someone else can take a look if they\nhit the same issue.\n\nOn Fri, Mar 16, 2018 at 2:21 PM, JackKZ <notifications@github.com> wrote:\n\n> Also here is the output of pd.show_versions()\n> INSTALLED VERSIONS\n>\n> commit: None\n> python: 3.6.4.final.0\n> python-bits: 64\n> OS: Windows\n> OS-release: 10\n> machine: AMD64\n> processor: Intel64 Family 6 Model 69 Stepping 1, GenuineIntel\n> byteorder: little\n> LC_ALL: None\n> LANG: en\n> LOCALE: None.None\n>\n> pandas: 0.22.0\n> pytest: 3.3.2\n> pip: 9.0.1\n> setuptools: 38.4.0\n> Cython: 0.27.3\n> numpy: 1.14.0\n> scipy: 1.0.0\n> pyarrow: None\n> xarray: None\n> IPython: 6.2.1\n> sphinx: 1.6.6\n> patsy: 0.5.0\n> dateutil: 2.6.1\n> pytz: 2017.3\n> blosc: None\n> bottleneck: 1.2.1\n> tables: 3.4.2\n> numexpr: 2.6.4\n> feather: None\n> matplotlib: 2.1.2\n> openpyxl: 2.4.10\n> xlrd: 1.1.0\n> xlwt: 1.3.0\n> xlsxwriter: 1.0.2\n> lxml: 4.1.1\n> bs4: 4.6.0\n> html5lib: 1.0.1\n> sqlalchemy: 1.2.1\n> pymysql: None\n> psycopg2: None\n> jinja2: 2.10\n> s3fs: None\n> fastparquet: None\n> pandas_gbq: None\n> pandas_datareader: None\n>\n> â€”\n> You are receiving this because you commented.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/pandas-dev/pandas/issues/20380#issuecomment-373818916>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/ABQHItJ5pNRLg91TJJmW0ndm1q_vg3A5ks5tfBCpgaJpZM4St8QO>\n> .\n>\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/373837132",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20380#issuecomment-373837132",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20380",
    "id": 373837132,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MzgzNzEzMg==",
    "user": {
      "login": "ChrisMuir",
      "id": 13386824,
      "node_id": "MDQ6VXNlcjEzMzg2ODI0",
      "avatar_url": "https://avatars2.githubusercontent.com/u/13386824?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ChrisMuir",
      "html_url": "https://github.com/ChrisMuir",
      "followers_url": "https://api.github.com/users/ChrisMuir/followers",
      "following_url": "https://api.github.com/users/ChrisMuir/following{/other_user}",
      "gists_url": "https://api.github.com/users/ChrisMuir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ChrisMuir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ChrisMuir/subscriptions",
      "organizations_url": "https://api.github.com/users/ChrisMuir/orgs",
      "repos_url": "https://api.github.com/users/ChrisMuir/repos",
      "events_url": "https://api.github.com/users/ChrisMuir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ChrisMuir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-16T20:34:01Z",
    "updated_at": "2018-03-16T21:43:40Z",
    "author_association": "NONE",
    "body": "Just to chime on this with more info, I'm getting a `RecursionError` exception when running `df = df.replace(np.nan, 'NA')` on Jack's data frame. Here's code to reproduce the issue:\r\n```py\r\nimport pandas as pd\r\nfrom io import BytesIO\r\nimport zipfile\r\nimport requests\r\n\r\n# Read the zipped file from this issue thread.\r\nres = requests.get(\"https://github.com/pandas-dev/pandas/files/1820497/example_df.zip\")\r\n\r\n# Read the pkl file via pandas (pkl contains a data frame).\r\nwith zipfile.ZipFile(BytesIO(res.content)) as z:\r\n    pkl_file = z.namelist()[0]\r\n    with z.open(pkl_file) as pk:\r\n        df = pd.read_pickle(pk)\r\n\r\n# Simple call to replace.\r\ndf = df.replace(\"blah\", \"NA\")\r\n```\r\nHere's the traceback:\r\n```\r\n  File \"<ipython-input-6-0fda1114890b>\", line 1, in <module>\r\n    df = df.replace(np.nan, \"NA\")\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\generic.py\", line 4612, in replace\r\n    regex=regex)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 3468, in replace\r\n    return self.apply('replace', **kwargs)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 3329, in apply\r\n    applied = getattr(b, f)(**kwargs)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 2216, in replace\r\n    convert=convert, mgr=mgr)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 771, in replace\r\n    filter=filter, regex=regex, convert=convert)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 2216, in replace\r\n    convert=convert, mgr=mgr)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 771, in replace\r\n    filter=filter, regex=regex, convert=convert)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 2216, in replace\r\n    convert=convert, mgr=mgr)\r\n\r\n  ....\r\n  <snip a ton of references to line 771 and line 2216>\r\n  ....\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 763, in replace\r\n    copy=not inplace) for b in blocks]\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 763, in <listcomp>\r\n    copy=not inplace) for b in blocks]\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 2135, in convert\r\n    blocks = self.split_and_operate(None, f, False)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 482, in split_and_operate\r\n    block = make_a_block(nv, [ref_loc])\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 458, in make_a_block\r\n    placement=ref_loc, fastpath=True)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 210, in make_block\r\n    return make_block(values, placement=placement, ndim=ndim, **kwargs)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 2957, in make_block\r\n    return klass(values, ndim=ndim, fastpath=fastpath, placement=placement)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 2082, in __init__\r\n    placement=placement, **kwargs)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 114, in __init__\r\n    self.mgr_locs = placement\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 229, in mgr_locs\r\n    new_mgr_locs = BlockPlacement(new_mgr_locs)\r\n\r\n  File \"pandas/_libs/lib.pyx\", line 1696, in pandas._libs.lib.BlockPlacement.__init__\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\numpy\\core\\numeric.py\", line 729, in require\r\n    requirements = set(possible_flags[x.upper()] for x in requirements)\r\n\r\nRecursionError: maximum recursion depth exceeded\r\n```\r\n\r\nI tried isolating the issue to a specific column\r\n```py\r\ntry:\r\n    df = df.replace(\"blah\", \"NA\")\r\nexcept RecursionError:\r\n    for curr_col in df.columns:\r\n        try:    \r\n            df[curr_col] = df.loc[:, curr_col].replace(\"blah\", \"NA\")\r\n            print(\"success for col %s\" % curr_col)\r\n        except RecursionError:\r\n            print(\"fail for col %s\" % curr_col)\r\n```\r\nThis outputs:\r\n```\r\nsuccess for col adulterant\r\nsuccess for col announcement_date\r\nsuccess for col data_source_detailed\r\nsuccess for col data_source_general\r\nsuccess for col failing_results\r\nsuccess for col filename\r\nsuccess for col food_name\r\nsuccess for col inspection_results\r\nsuccess for col legal_limit\r\nsuccess for col manufacturer_address\r\nsuccess for col manufacturer_name\r\nsuccess for col notice_number\r\nsuccess for col product_classification\r\nfail for col production_date\r\nsuccess for col sampled_location_address\r\nsuccess for col sampled_location_name\r\nsuccess for col sampled_location_province\r\nsuccess for col sheetname\r\nsuccess for col specifications_model\r\nsuccess for col task_source_or_project_name\r\nsuccess for col test_outcome\r\nsuccess for col testing_agency\r\n```\r\nSo the issue seems to be with col `production_date`. The data in this col is made up of `str` and `datetime.datetime`.\r\n```py\r\ntypes = set()\r\nfor n in df[\"production_date\"]:\r\n    if type(n) not in types:\r\n        types.add(type(n))\r\n```\r\nprinting `types` gives:\r\n```\r\n{datetime.datetime, str}\r\n```\r\n\r\nThis is as far as I've gotten. Not sure what to do with all this info, but figured I'd share."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/373837565",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20380#issuecomment-373837565",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20380",
    "id": 373837565,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MzgzNzU2NQ==",
    "user": {
      "login": "ChrisMuir",
      "id": 13386824,
      "node_id": "MDQ6VXNlcjEzMzg2ODI0",
      "avatar_url": "https://avatars2.githubusercontent.com/u/13386824?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ChrisMuir",
      "html_url": "https://github.com/ChrisMuir",
      "followers_url": "https://api.github.com/users/ChrisMuir/followers",
      "following_url": "https://api.github.com/users/ChrisMuir/following{/other_user}",
      "gists_url": "https://api.github.com/users/ChrisMuir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ChrisMuir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ChrisMuir/subscriptions",
      "organizations_url": "https://api.github.com/users/ChrisMuir/orgs",
      "repos_url": "https://api.github.com/users/ChrisMuir/repos",
      "events_url": "https://api.github.com/users/ChrisMuir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ChrisMuir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-16T20:35:45Z",
    "updated_at": "2018-03-16T20:35:45Z",
    "author_association": "NONE",
    "body": "Oh and here's my output for `pd.show_versions()`\r\n```\r\nINSTALLED VERSIONS\r\n------------------\r\ncommit: None\r\npython: 3.6.1.final.0\r\npython-bits: 64\r\nOS: Windows\r\nOS-release: 10\r\nmachine: AMD64\r\nprocessor: Intel64 Family 6 Model 60 Stepping 3, GenuineIntel\r\nbyteorder: little\r\nLC_ALL: None\r\nLANG: en\r\nLOCALE: None.None\r\n\r\npandas: 0.22.0\r\npytest: 3.0.7\r\npip: 9.0.1\r\nsetuptools: 37.0.0\r\nCython: 0.25.2\r\nnumpy: 1.12.1\r\nscipy: 0.19.0\r\npyarrow: None\r\nxarray: None\r\nIPython: 5.3.0\r\nsphinx: 1.5.6\r\npatsy: 0.4.1\r\ndateutil: 2.6.0\r\npytz: 2017.2\r\nblosc: None\r\nbottleneck: 1.2.1\r\ntables: 3.2.2\r\nnumexpr: 2.6.2\r\nfeather: None\r\nmatplotlib: 2.0.2\r\nopenpyxl: 2.4.7\r\nxlrd: 1.0.0\r\nxlwt: 1.2.0\r\nxlsxwriter: 0.9.6\r\nlxml: 3.7.3\r\nbs4: 4.6.0\r\nhtml5lib: 0.999\r\nsqlalchemy: 1.1.9\r\npymysql: None\r\npsycopg2: None\r\njinja2: 2.9.6\r\ns3fs: None\r\nfastparquet: None\r\npandas_gbq: None\r\npandas_datareader: None\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/373866031",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20380#issuecomment-373866031",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20380",
    "id": 373866031,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3Mzg2NjAzMQ==",
    "user": {
      "login": "ChrisMuir",
      "id": 13386824,
      "node_id": "MDQ6VXNlcjEzMzg2ODI0",
      "avatar_url": "https://avatars2.githubusercontent.com/u/13386824?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ChrisMuir",
      "html_url": "https://github.com/ChrisMuir",
      "followers_url": "https://api.github.com/users/ChrisMuir/followers",
      "following_url": "https://api.github.com/users/ChrisMuir/following{/other_user}",
      "gists_url": "https://api.github.com/users/ChrisMuir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ChrisMuir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ChrisMuir/subscriptions",
      "organizations_url": "https://api.github.com/users/ChrisMuir/orgs",
      "repos_url": "https://api.github.com/users/ChrisMuir/repos",
      "events_url": "https://api.github.com/users/ChrisMuir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ChrisMuir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-16T22:53:03Z",
    "updated_at": "2018-03-16T23:42:22Z",
    "author_association": "NONE",
    "body": "@TomAugspurger I believe I've narrowed this down to `replace()` trying to throw `OutOfBoundsDatetime` exception when hitting `datetime.datetime` values that are out of range, but instead is getting stuck in an inf loop. Check out the minimal example below.\r\n\r\nThis works without errors (year `2017` in the datetime object):\r\n```py\r\nimport pandas as pd\r\nimport datetime\r\ndf = pd.DataFrame({\r\n    \"dt\" : [datetime.datetime(2017, 12, 20)], \r\n    \"str\" : [\"blah\"]\r\n})\r\ndf.replace(\"blah\", \"cats\")\r\n```\r\nHowever this throws a `RecursionError` (year `3017` in the datetime object):\r\n```py\r\nimport pandas as pd\r\nimport datetime\r\ndf = pd.DataFrame({\r\n    \"dt\" : [datetime.datetime(3017, 12, 20)], \r\n    \"str\" : [\"blah\"]\r\n})\r\ndf.replace(\"blah\", \"cats\")\r\n```\r\nSaving the bad code to file and then calling it from command prompt, I'm able to see the entire traceback. Near the top, this block appears a bunch of times:\r\n```\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 763, in replace\r\n    copy=not inplace) for b in blocks]\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 763, in <listcomp>\r\n    copy=not inplace) for b in blocks]\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 2135, in convert\r\n    blocks = self.split_and_operate(None, f, False)\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 478, in split_and_operate\r\n    nv = f(m, v, i)\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 2125, in f\r\n    values = fn(v.ravel(), **fn_kwargs)\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\dtypes\\cast.py\", line 807, in soft_convert_objects\r\n    values = lib.maybe_convert_objects(values, convert_datetime=datetime)\r\n  File \"pandas/_libs/src/inference.pyx\", line 1290, in pandas._libs.lib.maybe_convert_objects\r\n  File \"pandas/_libs/tslib.pyx\", line 1575, in pandas._libs.tslib.convert_to_tsobject\r\n  File \"pandas/_libs/tslib.pyx\", line 1669, in pandas._libs.tslib.convert_datetime_to_tsobject\r\n  File \"pandas/_libs/tslib.pyx\", line 1848, in pandas._libs.tslib._check_dts_bounds\r\npandas._libs.tslib.OutOfBoundsDatetime: Out of bounds nanosecond timestamp: 3017-12-20 00:00:00\r\n```\r\nFollowed by a bunch of calls referencing lines 771 and 2216, and ending with this:\r\n```\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 771, in replace\r\n    filter=filter, regex=regex, convert=convert)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 2216, in replace\r\n    convert=convert, mgr=mgr)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 771, in replace\r\n    filter=filter, regex=regex, convert=convert)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 2216, in replace\r\n    convert=convert, mgr=mgr)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 760, in replace\r\n    blocks = self.putmask(mask, value, inplace=inplace)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 1021, in putmask\r\n    return [self.make_block(new_values, fastpath=True)]\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 210, in make_block\r\n    return make_block(values, placement=placement, ndim=ndim, **kwargs)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 2957, in make_block\r\n    return klass(values, ndim=ndim, fastpath=fastpath, placement=placement)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 2082, in __init__\r\n    placement=placement, **kwargs)\r\n\r\n  File \"C:\\Users\\cmuir\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\internals.py\", line 114, in __init__\r\n    self.mgr_locs = placement\r\n\r\nRecursionError: maximum recursion depth exceeded\r\n```\r\nLooking at function [check_dts_bounds](https://github.com/pandas-dev/pandas/blob/master/pandas/_libs/tslibs/np_datetime.pyx#L104) in `pandas/_libs/tslibs/np_datetime.pyx`, it looks like the call to `replace` is supposed to throw `OutOfBoundsDatetime` exception."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/373938956",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20380#issuecomment-373938956",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20380",
    "id": 373938956,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MzkzODk1Ng==",
    "user": {
      "login": "cbertinato",
      "id": 20772838,
      "node_id": "MDQ6VXNlcjIwNzcyODM4",
      "avatar_url": "https://avatars2.githubusercontent.com/u/20772838?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cbertinato",
      "html_url": "https://github.com/cbertinato",
      "followers_url": "https://api.github.com/users/cbertinato/followers",
      "following_url": "https://api.github.com/users/cbertinato/following{/other_user}",
      "gists_url": "https://api.github.com/users/cbertinato/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cbertinato/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cbertinato/subscriptions",
      "organizations_url": "https://api.github.com/users/cbertinato/orgs",
      "repos_url": "https://api.github.com/users/cbertinato/repos",
      "events_url": "https://api.github.com/users/cbertinato/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cbertinato/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-17T17:43:37Z",
    "updated_at": "2018-03-17T18:04:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "The recursion is occurring because `OutofBoundsDatetime` subclasses `ValueError`, which is getting caught here at line 807 in core/internals.py:\r\n```\r\n        except (TypeError, ValueError):\r\n\r\n            # try again with a compatible block\r\n            block = self.astype(object)\r\n            return block.replace(\r\n                to_replace=original_to_replace, value=value, inplace=inplace,\r\n                filter=filter, regex=regex, convert=convert)\r\n```\r\nThere is little sense in trying again if the datetime is out of bounds.  This issue can be fixed by adding an except block for `OutofBoundsDatetime` before this block.  A relevant question: should the out-of-bounds datetime have been caught when the DataFrame was created?  \r\n\r\nI'm inclined to think 'yes'.  It's better to fail sooner rather than later."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/373947099",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20380#issuecomment-373947099",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20380",
    "id": 373947099,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3Mzk0NzA5OQ==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-17T19:39:34Z",
    "updated_at": "2018-03-17T19:39:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for digging. In @ChrisMuir's small example, the column is object dtype, so I think that's OK.\r\n\r\npassing `convert=False` also works in this case, though that probably breaks other things."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/400705640",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20380#issuecomment-400705640",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20380",
    "id": 400705640,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDcwNTY0MA==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-27T15:03:09Z",
    "updated_at": "2018-06-27T15:03:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "Updated the original post with the nice example."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/408641282",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20380#issuecomment-408641282",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20380",
    "id": 408641282,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwODY0MTI4Mg==",
    "user": {
      "login": "minggli",
      "id": 14131823,
      "node_id": "MDQ6VXNlcjE0MTMxODIz",
      "avatar_url": "https://avatars0.githubusercontent.com/u/14131823?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/minggli",
      "html_url": "https://github.com/minggli",
      "followers_url": "https://api.github.com/users/minggli/followers",
      "following_url": "https://api.github.com/users/minggli/following{/other_user}",
      "gists_url": "https://api.github.com/users/minggli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/minggli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/minggli/subscriptions",
      "organizations_url": "https://api.github.com/users/minggli/orgs",
      "repos_url": "https://api.github.com/users/minggli/repos",
      "events_url": "https://api.github.com/users/minggli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/minggli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-28T23:28:39Z",
    "updated_at": "2018-07-28T23:28:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "raised a PR trying to fix this. ðŸ˜ƒ convert=False breaks other cases by the look of it. at the moment using try except on cast module, new ideas welcome."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/411445469",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20380#issuecomment-411445469",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20380",
    "id": 411445469,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTQ0NTQ2OQ==",
    "user": {
      "login": "minggli",
      "id": 14131823,
      "node_id": "MDQ6VXNlcjE0MTMxODIz",
      "avatar_url": "https://avatars0.githubusercontent.com/u/14131823?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/minggli",
      "html_url": "https://github.com/minggli",
      "followers_url": "https://api.github.com/users/minggli/followers",
      "following_url": "https://api.github.com/users/minggli/following{/other_user}",
      "gists_url": "https://api.github.com/users/minggli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/minggli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/minggli/subscriptions",
      "organizations_url": "https://api.github.com/users/minggli/orgs",
      "repos_url": "https://api.github.com/users/minggli/repos",
      "events_url": "https://api.github.com/users/minggli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/minggli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-08T15:22:59Z",
    "updated_at": "2018-08-08T15:23:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "@JackKZ @ChrisMuir would you like an error to be raised (for the out of bound datetime) when encountering above example or ignore silently and carry out the replace anyhow?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/411483051",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20380#issuecomment-411483051",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20380",
    "id": 411483051,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTQ4MzA1MQ==",
    "user": {
      "login": "ChrisMuir",
      "id": 13386824,
      "node_id": "MDQ6VXNlcjEzMzg2ODI0",
      "avatar_url": "https://avatars2.githubusercontent.com/u/13386824?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ChrisMuir",
      "html_url": "https://github.com/ChrisMuir",
      "followers_url": "https://api.github.com/users/ChrisMuir/followers",
      "following_url": "https://api.github.com/users/ChrisMuir/following{/other_user}",
      "gists_url": "https://api.github.com/users/ChrisMuir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ChrisMuir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ChrisMuir/subscriptions",
      "organizations_url": "https://api.github.com/users/ChrisMuir/orgs",
      "repos_url": "https://api.github.com/users/ChrisMuir/repos",
      "events_url": "https://api.github.com/users/ChrisMuir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ChrisMuir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-08T17:15:07Z",
    "updated_at": "2018-08-08T17:15:07Z",
    "author_association": "NONE",
    "body": "Well, personally I'd prefer that `replace()` not throw an error when it hits an out of bound datetime, but that's coming from a purely selfish standpoint. I don't use Pandas a ton, and my use cases probably only represent a fraction of total common use cases (I'm always working with data generated by 3rd parties to which I'm completely disconnected). Also, I don't know enough about the Pandas internals and philosophy to weigh-in on which option makes the most sense, with all users in mind."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/411500927",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20380#issuecomment-411500927",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20380",
    "id": 411500927,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTUwMDkyNw==",
    "user": {
      "login": "cbertinato",
      "id": 20772838,
      "node_id": "MDQ6VXNlcjIwNzcyODM4",
      "avatar_url": "https://avatars2.githubusercontent.com/u/20772838?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cbertinato",
      "html_url": "https://github.com/cbertinato",
      "followers_url": "https://api.github.com/users/cbertinato/followers",
      "following_url": "https://api.github.com/users/cbertinato/following{/other_user}",
      "gists_url": "https://api.github.com/users/cbertinato/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cbertinato/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cbertinato/subscriptions",
      "organizations_url": "https://api.github.com/users/cbertinato/orgs",
      "repos_url": "https://api.github.com/users/cbertinato/repos",
      "events_url": "https://api.github.com/users/cbertinato/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cbertinato/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-08T18:12:03Z",
    "updated_at": "2018-08-08T18:12:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "In the example given, and perhaps in most use cases, the OOB datetime is irrelevant.  Of course that datetime could lead to other problems, but as far as replace is concerned it shouldn't matter. In my opinion, it would only make sense to raise the exception when manipulating the datetime."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/435709208",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20380#issuecomment-435709208",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20380",
    "id": 435709208,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTcwOTIwOA==",
    "user": {
      "login": "mroeschke",
      "id": 10647082,
      "node_id": "MDQ6VXNlcjEwNjQ3MDgy",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10647082?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mroeschke",
      "html_url": "https://github.com/mroeschke",
      "followers_url": "https://api.github.com/users/mroeschke/followers",
      "following_url": "https://api.github.com/users/mroeschke/following{/other_user}",
      "gists_url": "https://api.github.com/users/mroeschke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mroeschke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mroeschke/subscriptions",
      "organizations_url": "https://api.github.com/users/mroeschke/orgs",
      "repos_url": "https://api.github.com/users/mroeschke/repos",
      "events_url": "https://api.github.com/users/mroeschke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mroeschke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-04T21:28:41Z",
    "updated_at": "2018-11-04T21:28:41Z",
    "author_association": "MEMBER",
    "body": "Looks like this was closed by #22108"
  }
]
