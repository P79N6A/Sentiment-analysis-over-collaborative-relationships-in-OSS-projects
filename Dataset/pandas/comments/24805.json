[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/454839163",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24805#issuecomment-454839163",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24805",
    "id": 454839163,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDgzOTE2Mw==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-16T16:15:48Z",
    "updated_at": "2019-01-16T16:15:48Z",
    "author_association": "MEMBER",
    "body": "cc @gfyoung "
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/454879572",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24805#issuecomment-454879572",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24805",
    "id": 454879572,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDg3OTU3Mg==",
    "user": {
      "login": "gfyoung",
      "id": 9273653,
      "node_id": "MDQ6VXNlcjkyNzM2NTM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/9273653?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gfyoung",
      "html_url": "https://github.com/gfyoung",
      "followers_url": "https://api.github.com/users/gfyoung/followers",
      "following_url": "https://api.github.com/users/gfyoung/following{/other_user}",
      "gists_url": "https://api.github.com/users/gfyoung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gfyoung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gfyoung/subscriptions",
      "organizations_url": "https://api.github.com/users/gfyoung/orgs",
      "repos_url": "https://api.github.com/users/gfyoung/repos",
      "events_url": "https://api.github.com/users/gfyoung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gfyoung/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-16T18:04:05Z",
    "updated_at": "2019-01-16T18:04:05Z",
    "author_association": "MEMBER",
    "body": "@PMeira : Thanks for reporting this!  I can confirm this error as well.\r\n\r\nDid your code example previously work with `0.23.4` by any chance?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/454902531",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24805#issuecomment-454902531",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24805",
    "id": 454902531,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDkwMjUzMQ==",
    "user": {
      "login": "h-vetinari",
      "id": 33685575,
      "node_id": "MDQ6VXNlcjMzNjg1NTc1",
      "avatar_url": "https://avatars1.githubusercontent.com/u/33685575?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/h-vetinari",
      "html_url": "https://github.com/h-vetinari",
      "followers_url": "https://api.github.com/users/h-vetinari/followers",
      "following_url": "https://api.github.com/users/h-vetinari/following{/other_user}",
      "gists_url": "https://api.github.com/users/h-vetinari/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/h-vetinari/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/h-vetinari/subscriptions",
      "organizations_url": "https://api.github.com/users/h-vetinari/orgs",
      "repos_url": "https://api.github.com/users/h-vetinari/repos",
      "events_url": "https://api.github.com/users/h-vetinari/events{/privacy}",
      "received_events_url": "https://api.github.com/users/h-vetinari/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-16T19:12:10Z",
    "updated_at": "2019-01-16T19:12:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "Code from the OP works for me on 0.23.4."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/454905431",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24805#issuecomment-454905431",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24805",
    "id": 454905431,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDkwNTQzMQ==",
    "user": {
      "login": "PMeira",
      "id": 10246101,
      "node_id": "MDQ6VXNlcjEwMjQ2MTAx",
      "avatar_url": "https://avatars1.githubusercontent.com/u/10246101?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PMeira",
      "html_url": "https://github.com/PMeira",
      "followers_url": "https://api.github.com/users/PMeira/followers",
      "following_url": "https://api.github.com/users/PMeira/following{/other_user}",
      "gists_url": "https://api.github.com/users/PMeira/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PMeira/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PMeira/subscriptions",
      "organizations_url": "https://api.github.com/users/PMeira/orgs",
      "repos_url": "https://api.github.com/users/PMeira/repos",
      "events_url": "https://api.github.com/users/PMeira/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PMeira/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-16T19:20:52Z",
    "updated_at": "2019-01-16T19:20:52Z",
    "author_association": "NONE",
    "body": "@gfyoung Yes, it worked fine with version `0.23.4`, just checked to be sure. \r\n\r\nI first noticed it from a failing test in another module that I'm trying to port to recent versions of Pandas."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/454949413",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24805#issuecomment-454949413",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24805",
    "id": 454949413,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDk0OTQxMw==",
    "user": {
      "login": "gfyoung",
      "id": 9273653,
      "node_id": "MDQ6VXNlcjkyNzM2NTM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/9273653?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gfyoung",
      "html_url": "https://github.com/gfyoung",
      "followers_url": "https://api.github.com/users/gfyoung/followers",
      "following_url": "https://api.github.com/users/gfyoung/following{/other_user}",
      "gists_url": "https://api.github.com/users/gfyoung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gfyoung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gfyoung/subscriptions",
      "organizations_url": "https://api.github.com/users/gfyoung/orgs",
      "repos_url": "https://api.github.com/users/gfyoung/repos",
      "events_url": "https://api.github.com/users/gfyoung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gfyoung/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-16T21:29:19Z",
    "updated_at": "2019-01-16T21:29:19Z",
    "author_association": "MEMBER",
    "body": "@PMeira @h-vetinari : Thanks for looking into this!  Sounds like we have a regression on our hands..."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/455618605",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24805#issuecomment-455618605",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24805",
    "id": 455618605,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NTYxODYwNQ==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-18T17:08:01Z",
    "updated_at": "2019-01-18T17:08:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "@gfyoung do you have time to do this for 0.24.0? I don't think we have a release date set yet, but sometime in the next week or so?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/455634543",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24805#issuecomment-455634543",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24805",
    "id": 455634543,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NTYzNDU0Mw==",
    "user": {
      "login": "gfyoung",
      "id": 9273653,
      "node_id": "MDQ6VXNlcjkyNzM2NTM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/9273653?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gfyoung",
      "html_url": "https://github.com/gfyoung",
      "followers_url": "https://api.github.com/users/gfyoung/followers",
      "following_url": "https://api.github.com/users/gfyoung/following{/other_user}",
      "gists_url": "https://api.github.com/users/gfyoung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gfyoung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gfyoung/subscriptions",
      "organizations_url": "https://api.github.com/users/gfyoung/orgs",
      "repos_url": "https://api.github.com/users/gfyoung/repos",
      "events_url": "https://api.github.com/users/gfyoung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gfyoung/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-18T18:00:40Z",
    "updated_at": "2019-01-18T18:00:40Z",
    "author_association": "MEMBER",
    "body": "@TomAugspurger : Yep, I'm going to look into this on the weekend."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/455772093",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24805#issuecomment-455772093",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24805",
    "id": 455772093,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NTc3MjA5Mw==",
    "user": {
      "login": "gfyoung",
      "id": 9273653,
      "node_id": "MDQ6VXNlcjkyNzM2NTM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/9273653?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gfyoung",
      "html_url": "https://github.com/gfyoung",
      "followers_url": "https://api.github.com/users/gfyoung/followers",
      "following_url": "https://api.github.com/users/gfyoung/following{/other_user}",
      "gists_url": "https://api.github.com/users/gfyoung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gfyoung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gfyoung/subscriptions",
      "organizations_url": "https://api.github.com/users/gfyoung/orgs",
      "repos_url": "https://api.github.com/users/gfyoung/repos",
      "events_url": "https://api.github.com/users/gfyoung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gfyoung/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-19T11:29:16Z",
    "updated_at": "2019-01-19T11:29:16Z",
    "author_association": "MEMBER",
    "body": "@PMeira : Your observations are validated by what happens behind the scenes, as your numbers produce a snowball effect that causes the memory allocation to double with every iteration of reading.  \r\n\r\nIt is indeed an edge case, as your numbers work just perfectly to cause memory allocated to be powers of 2.  In fact, your \"smaller example\" fails for me for that reason on my local machine.\r\n\r\nI think I have a patch for this that prevents the memory usage from growing exponentially, but I need to test to make sure I didn't break anything else with it."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/455808073",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24805#issuecomment-455808073",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24805",
    "id": 455808073,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NTgwODA3Mw==",
    "user": {
      "login": "PMeira",
      "id": 10246101,
      "node_id": "MDQ6VXNlcjEwMjQ2MTAx",
      "avatar_url": "https://avatars1.githubusercontent.com/u/10246101?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PMeira",
      "html_url": "https://github.com/PMeira",
      "followers_url": "https://api.github.com/users/PMeira/followers",
      "following_url": "https://api.github.com/users/PMeira/following{/other_user}",
      "gists_url": "https://api.github.com/users/PMeira/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PMeira/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PMeira/subscriptions",
      "organizations_url": "https://api.github.com/users/PMeira/orgs",
      "repos_url": "https://api.github.com/users/PMeira/repos",
      "events_url": "https://api.github.com/users/PMeira/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PMeira/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-19T19:25:27Z",
    "updated_at": "2019-01-19T19:25:27Z",
    "author_association": "NONE",
    "body": "@gfyoung Thank you for the patch! I reran the affected code with the patch and it now runs without issues for several chunksize values.\r\n\r\nIt seems the edge case is the number of chunks, that is, since it basically doubled the memory when processing each chunk, if the number of chunks was large(ish), it would exhaust the memory resources. E.g. this presented the same issue but works fine now with the patched `tokernizer.c`:\r\n\r\n```python\r\nimport pandas as pd\r\n\r\nCHUNKSIZE = 10_000_000\r\nNUM_ROWS = CHUNKSIZE * 20\r\n\r\nwith open('test.csv', 'w') as f:\r\n    for i in range(NUM_ROWS):\r\n        f.write('{}\\n'.format(i))\r\n\r\nfor chunk_index, chunk in enumerate(pd.read_csv('test.csv', chunksize=CHUNKSIZE, engine='c', low_memory=False)):\r\n    print(chunk_index)\r\n```\r\n"
  }
]
