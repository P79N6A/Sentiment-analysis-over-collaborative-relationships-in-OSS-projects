[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/363263717",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19543#issuecomment-363263717",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19543",
    "id": 363263717,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MzI2MzcxNw==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-06T00:04:42Z",
    "updated_at": "2018-02-06T00:04:42Z",
    "author_association": "MEMBER",
    "body": "> I'm not quite sure which behaviour is the problematic one here: the fact that the first block of code creates an 'empty' MultiIndex that has values in levels,\r\n\r\nThis is normal and expected behaviour. When taking a subset of a MultiIndex, the `levels` are not re-computed but kept intact (the fact that it is empty is expressed in its empty `labels`).\r\n\r\n> or that to_excel doesn't write a DataFrame with such an index to file properly. \r\n\r\nThis could be considered a bug, given that for an empty dataframe without multiindex, this works. Or at least it should give a better error message.\r\n\r\nThe fact that `df.loc[('b', '1', slice(None)), :]` does not raise an error while `df.loc[('b', '1'), :]` does, I am not fully sure about the explanation. But I suppose it is because of having the `slice(None)` makes this seen as \"indexing an MI with multiple indexers (one for each level)\", while in the other case you are selecting only single labels (up to a certain level). But I agree this is a confusing case. \r\nIf we want to discuss this further, let's open a separate issue for it.\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/363450035",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19543#issuecomment-363450035",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19543",
    "id": 363450035,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MzQ1MDAzNQ==",
    "user": {
      "login": "lauhayden",
      "id": 6826174,
      "node_id": "MDQ6VXNlcjY4MjYxNzQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6826174?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lauhayden",
      "html_url": "https://github.com/lauhayden",
      "followers_url": "https://api.github.com/users/lauhayden/followers",
      "following_url": "https://api.github.com/users/lauhayden/following{/other_user}",
      "gists_url": "https://api.github.com/users/lauhayden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lauhayden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lauhayden/subscriptions",
      "organizations_url": "https://api.github.com/users/lauhayden/orgs",
      "repos_url": "https://api.github.com/users/lauhayden/repos",
      "events_url": "https://api.github.com/users/lauhayden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lauhayden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-06T15:05:40Z",
    "updated_at": "2018-02-06T15:05:40Z",
    "author_association": "NONE",
    "body": "Alright, so this issue should be focused on `to_excel` throwing `IndexError`. I'll open a separate issue for the `MultiIndex` slicing behaviour."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/363459363",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19543#issuecomment-363459363",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19543",
    "id": 363459363,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MzQ1OTM2Mw==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-06T15:33:41Z",
    "updated_at": "2018-02-06T15:33:41Z",
    "author_association": "MEMBER",
    "body": "OK, I edited the title to reflect this. Probably the most sensible thing to do is to be consistent with empty dataframes in general (writing only the column headers to excel)\r\n\r\nPR welcome!"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/466937534",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19543#issuecomment-466937534",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19543",
    "id": 466937534,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NjkzNzUzNA==",
    "user": {
      "login": "mhooreman",
      "id": 7373718,
      "node_id": "MDQ6VXNlcjczNzM3MTg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7373718?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mhooreman",
      "html_url": "https://github.com/mhooreman",
      "followers_url": "https://api.github.com/users/mhooreman/followers",
      "following_url": "https://api.github.com/users/mhooreman/following{/other_user}",
      "gists_url": "https://api.github.com/users/mhooreman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mhooreman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mhooreman/subscriptions",
      "organizations_url": "https://api.github.com/users/mhooreman/orgs",
      "repos_url": "https://api.github.com/users/mhooreman/repos",
      "events_url": "https://api.github.com/users/mhooreman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mhooreman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-25T09:23:42Z",
    "updated_at": "2019-02-25T09:23:42Z",
    "author_association": "NONE",
    "body": "Hello,\r\nNot a lot of added value ... but the code below helps to easy reproduce this:\r\n``pd.DataFrame([[],[],[]]).T.set_index([0, 1]).to_excel('test.xlsx') ``"
  }
]
