[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/65858568",
    "html_url": "https://github.com/pandas-dev/pandas/issues/9016#issuecomment-65858568",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/9016",
    "id": 65858568,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1ODU4NTY4",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-05T21:38:18Z",
    "updated_at": "2014-12-05T21:38:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "can you show a full copy/pastable example, and `pd.show_versions()`.\n\nThese _are_ the bitwise operators......(and integers will get coerced)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/65858987",
    "html_url": "https://github.com/pandas-dev/pandas/issues/9016#issuecomment-65858987",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/9016",
    "id": 65858987,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1ODU4OTg3",
    "user": {
      "login": "benkuhn",
      "id": 304831,
      "node_id": "MDQ6VXNlcjMwNDgzMQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/304831?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benkuhn",
      "html_url": "https://github.com/benkuhn",
      "followers_url": "https://api.github.com/users/benkuhn/followers",
      "following_url": "https://api.github.com/users/benkuhn/following{/other_user}",
      "gists_url": "https://api.github.com/users/benkuhn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benkuhn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benkuhn/subscriptions",
      "organizations_url": "https://api.github.com/users/benkuhn/orgs",
      "repos_url": "https://api.github.com/users/benkuhn/repos",
      "events_url": "https://api.github.com/users/benkuhn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benkuhn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-05T21:41:29Z",
    "updated_at": "2014-12-05T21:43:22Z",
    "author_association": "NONE",
    "body": "Here:\n\n```\nIn [43]: pd.show_versions()\n\nINSTALLED VERSIONS\n------------------\ncommit: None\npython: 2.7.8.final.0\npython-bits: 64\nOS: Darwin\nOS-release: 13.4.0\nmachine: x86_64\nprocessor: i386\nbyteorder: little\nLC_ALL: None\nLANG: en_US.UTF-8\n\npandas: 0.14.1\nnose: 1.3.4\nCython: 0.20.2\nnumpy: 1.9.0\nscipy: 0.14.0\nstatsmodels: 0.6.1\nIPython: 2.2.0\nsphinx: None\npatsy: 0.3.0\nscikits.timeseries: None\ndateutil: 2.2\npytz: 2014.7\nbottleneck: None\ntables: None\nnumexpr: None\nmatplotlib: 1.4.0\nopenpyxl: None\nxlrd: None\nxlwt: None\nxlsxwriter: None\nlxml: None\nbs4: None\nhtml5lib: None\nhttplib2: None\napiclient: None\nrpy2: None\nsqlalchemy: 0.9.7\npymysql: None\npsycopg2: None\n\nIn [44]: pd.Series(range(10)) | pd.Series([2] * 10)\nOut[44]:\n0    True\n1    True\n2    True\n3    True\n4    True\n5    True\n6    True\n7    True\n8    True\n9    True\ndtype: bool\n\nIn [45]: pd.Series(range(10)) & pd.Series([15] * 10)\nOut[45]:\n0    False\n1     True\n2    False\n3     True\n4    False\n5     True\n6    False\n7     True\n8    False\n9     True\ndtype: bool\n```\n\nSeems like `|` does a standard bitwise or before coercing to a bool, but `&` does a standard bitwise `&` and then only coerces the lowest-order bit to bool. I'd expect the last one to be 9 `True`s (0 should still be `False`).\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/65859404",
    "html_url": "https://github.com/pandas-dev/pandas/issues/9016#issuecomment-65859404",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/9016",
    "id": 65859404,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1ODU5NDA0",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-05T21:44:34Z",
    "updated_at": "2014-12-05T21:44:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "numpy does this (and that's what Series is doing)\n\n```\nIn [2]: np.arange(10) & 1            \nOut[2]: array([0, 1, 0, 1, 0, 1, 0, 1, 0, 1])\n\nIn [3]: np.arange(10) | 1\nOut[3]: array([1, 1, 3, 3, 5, 5, 7, 7, 9, 9])\n```\n\nWhy are you doing this? These are boolean comparison ops, not bitwise-ops\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/65861352",
    "html_url": "https://github.com/pandas-dev/pandas/issues/9016#issuecomment-65861352",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/9016",
    "id": 65861352,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1ODYxMzUy",
    "user": {
      "login": "benkuhn",
      "id": 304831,
      "node_id": "MDQ6VXNlcjMwNDgzMQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/304831?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benkuhn",
      "html_url": "https://github.com/benkuhn",
      "followers_url": "https://api.github.com/users/benkuhn/followers",
      "following_url": "https://api.github.com/users/benkuhn/following{/other_user}",
      "gists_url": "https://api.github.com/users/benkuhn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benkuhn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benkuhn/subscriptions",
      "organizations_url": "https://api.github.com/users/benkuhn/orgs",
      "repos_url": "https://api.github.com/users/benkuhn/repos",
      "events_url": "https://api.github.com/users/benkuhn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benkuhn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-05T21:59:33Z",
    "updated_at": "2014-12-05T21:59:33Z",
    "author_association": "NONE",
    "body": "Sorry, I edited the post while you were viewing. With `1` on the right hand I would expect that behavior. With `15`, however, I wouldn't, and numpy satisfies that expectation (while Pandas doesn't):\n\n```\nIn [49]: pd.Series(range(10)) & pd.Series([15] * 10)\nOut[49]:\n0    False\n1     True\n2    False\n3     True\n4    False\n5     True\n6    False\n7     True\n8    False\n9     True\ndtype: bool\n\nIn [50]: np.arange(10) & (np.array([15] * 10))\nOut[50]: array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])\n```\n\nWe weren't actually trying to do this, but we had an errant type conversion somewhere else that cause strange behavior due to weak-typing in Pandas, and I found this while investigating what other strange behaviors might result.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/65913942",
    "html_url": "https://github.com/pandas-dev/pandas/issues/9016#issuecomment-65913942",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/9016",
    "id": 65913942,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1OTEzOTQy",
    "user": {
      "login": "shoyer",
      "id": 1217238,
      "node_id": "MDQ6VXNlcjEyMTcyMzg=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1217238?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shoyer",
      "html_url": "https://github.com/shoyer",
      "followers_url": "https://api.github.com/users/shoyer/followers",
      "following_url": "https://api.github.com/users/shoyer/following{/other_user}",
      "gists_url": "https://api.github.com/users/shoyer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shoyer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shoyer/subscriptions",
      "organizations_url": "https://api.github.com/users/shoyer/orgs",
      "repos_url": "https://api.github.com/users/shoyer/repos",
      "events_url": "https://api.github.com/users/shoyer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shoyer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-06T21:07:09Z",
    "updated_at": "2014-12-07T02:43:09Z",
    "author_association": "MEMBER",
    "body": "I can reproduce this on master. I agree that we should probably stick to what numpy does and not coerce to booleans.\n\nI'm not sure I'd call this a _bug_ exactly, but it does seem like an undesirable inconsistency.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/70619112",
    "html_url": "https://github.com/pandas-dev/pandas/issues/9016#issuecomment-70619112",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/9016",
    "id": 70619112,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNjE5MTEy",
    "user": {
      "login": "tvyomkesh",
      "id": 911431,
      "node_id": "MDQ6VXNlcjkxMTQzMQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/911431?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tvyomkesh",
      "html_url": "https://github.com/tvyomkesh",
      "followers_url": "https://api.github.com/users/tvyomkesh/followers",
      "following_url": "https://api.github.com/users/tvyomkesh/following{/other_user}",
      "gists_url": "https://api.github.com/users/tvyomkesh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tvyomkesh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tvyomkesh/subscriptions",
      "organizations_url": "https://api.github.com/users/tvyomkesh/orgs",
      "repos_url": "https://api.github.com/users/tvyomkesh/repos",
      "events_url": "https://api.github.com/users/tvyomkesh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tvyomkesh/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-20T08:21:03Z",
    "updated_at": "2015-01-20T08:21:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "Tried a quick & dirty hack and getting back desired behavior. Tests passed too. Sharing snippet so I can gather some expert comments and advise. Would be happy to work on a pull request if this looks in the correct direction. Thanks.\n\n```\ndiff --git a/pandas/core/ops.py b/pandas/core/ops.py\nindex 46429cc..59be639 100644\n--- a/pandas/core/ops.py\n+++ b/pandas/core/ops.py\n@@ -657,10 +657,16 @@ def _bool_method_SERIES(op, name, str_rep):\n         if isinstance(other, pd.Series):\n             name = _maybe_match_name(self, other)\n\n-            other = other.reindex_like(self).fillna(False)\n-            return self._constructor(na_op(self.values, other.values),\n+            if other.dtype == self.dtype and self.dtype == 'int64':\n+                other = other.reindex_like(self).fillna(False)\n+                return self._constructor(na_op(self.values, other.values),\n                                      index=self.index,\n                                      name=name).fillna(False)\n+            else:\n+                other = other.reindex_like(self).fillna(False).astype(bool)\n+                return self._constructor(na_op(self.values, other.values),\n+                                     index=self.index,\n+                                     name=name).fillna(False).astype(bool)\n         elif isinstance(other, pd.DataFrame):\n             return NotImplemented\n         else:\n```\n\nSome outputs showing results after the above fix\n\n```\nIn [2]: a = Series([True, False, True], list('bca'))\nIn [3]: b = Series([])\nIn [6]: a & b\nOut[6]:\nb    False\nc    False\na    False\ndtype: bool\n\nIn [7]: c = Series(range(10))\nIn [8]: d = Series([15] * 10)\nIn [11]: c & d\nOut[11]:\n0    0\n1    1\n2    2\n3    3\n4    4\n5    5\n6    6\n7    7\n8    8\n9    9\ndtype: int64\n```\n\nThanks,\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/70639700",
    "html_url": "https://github.com/pandas-dev/pandas/issues/9016#issuecomment-70639700",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/9016",
    "id": 70639700,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNjM5NzAw",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-20T11:23:03Z",
    "updated_at": "2015-01-20T11:23:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "this should be handled in `na_op`, with the fill value determined by `dtype`\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/70671182",
    "html_url": "https://github.com/pandas-dev/pandas/issues/9016#issuecomment-70671182",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/9016",
    "id": 70671182,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNjcxMTgy",
    "user": {
      "login": "tvyomkesh",
      "id": 911431,
      "node_id": "MDQ6VXNlcjkxMTQzMQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/911431?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tvyomkesh",
      "html_url": "https://github.com/tvyomkesh",
      "followers_url": "https://api.github.com/users/tvyomkesh/followers",
      "following_url": "https://api.github.com/users/tvyomkesh/following{/other_user}",
      "gists_url": "https://api.github.com/users/tvyomkesh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tvyomkesh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tvyomkesh/subscriptions",
      "organizations_url": "https://api.github.com/users/tvyomkesh/orgs",
      "repos_url": "https://api.github.com/users/tvyomkesh/repos",
      "events_url": "https://api.github.com/users/tvyomkesh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tvyomkesh/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-20T15:27:33Z",
    "updated_at": "2015-01-20T15:27:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jreback thanks. I will look into this and try and work on a PR. \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/71085892",
    "html_url": "https://github.com/pandas-dev/pandas/issues/9016#issuecomment-71085892",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/9016",
    "id": 71085892,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxMDg1ODky",
    "user": {
      "login": "tvyomkesh",
      "id": 911431,
      "node_id": "MDQ6VXNlcjkxMTQzMQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/911431?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tvyomkesh",
      "html_url": "https://github.com/tvyomkesh",
      "followers_url": "https://api.github.com/users/tvyomkesh/followers",
      "following_url": "https://api.github.com/users/tvyomkesh/following{/other_user}",
      "gists_url": "https://api.github.com/users/tvyomkesh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tvyomkesh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tvyomkesh/subscriptions",
      "organizations_url": "https://api.github.com/users/tvyomkesh/orgs",
      "repos_url": "https://api.github.com/users/tvyomkesh/repos",
      "events_url": "https://api.github.com/users/tvyomkesh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tvyomkesh/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-22T19:48:36Z",
    "updated_at": "2015-01-22T19:48:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jreback for now, I have made the changes in wrapper() itself instead of na_op() because it looked to me like wrapper is controlling the input and output fill and dtype. Once wrapper() takes care of this, na_op() seems to be doing the right thing by itself and so I did not have to change anything to get back the expected behavior. Happy to change if things need to be altered toward better design etc. Thanks.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/73033031",
    "html_url": "https://github.com/pandas-dev/pandas/issues/9016#issuecomment-73033031",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/9016",
    "id": 73033031,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczMDMzMDMx",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-02-05T11:37:52Z",
    "updated_at": "2015-02-05T11:37:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "closed by #9338 \n"
  }
]
