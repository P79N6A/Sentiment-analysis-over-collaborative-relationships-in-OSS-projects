[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/286766799",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15692#issuecomment-286766799",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15692",
    "id": 286766799,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4Njc2Njc5OQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-15T14:54:11Z",
    "updated_at": "2017-03-15T14:54:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "changed here: https://github.com/pandas-dev/pandas/commit/e8d9e79fc7d0a31e8c37c82f1e48d51cce59e9e0\r\n\r\nthis tries to coerce keys back to the original dtype, might be buggy"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/286769257",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15692#issuecomment-286769257",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15692",
    "id": 286769257,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4Njc2OTI1Nw==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-15T15:01:20Z",
    "updated_at": "2017-03-15T15:01:20Z",
    "author_association": "MEMBER",
    "body": "So the question is, when not merging on a common column (in this case left:column and right:index), do we want both in the output, and should both be unique? (or only unique in the overlapping values?)\r\n\r\nSome further exploration (with the same example as above):\r\n\r\nSettting the right index to other values makes it clear the index and key column duplicates the 'merge' values:\r\n```\r\nIn [7]: right = pd.DataFrame({'col_right': ['a', 'b', 'c']}, index=[2,3,4])\r\n\r\nIn [8]: left.merge(right, left_on='key', right_index=True, how=\"right\")\r\nOut[8]: \r\n   key col_left col_right\r\n2    2      NaN         a\r\n3    3      NaN         b\r\n4    4      NaN         c\r\n```\r\n\r\nWhen the left frame is not fully empty, but just missing values in comparison to right frame, you also get strange behaviour:\r\n```\r\nIn [10]: left = pd.DataFrame({'key':[3], 'col_left':['e']})\r\n\r\nIn [11]: left\r\nOut[11]: \r\n  col_left  key\r\n0        e    3\r\n\r\nIn [12]: left.merge(right, left_on='key', right_index=True, how=\"right\")\r\nOut[12]: \r\n  col_left  key col_right\r\n0        e    3         b\r\n0      NaN    2         a\r\n0      NaN    4         c\r\n```\r\n\r\nThe 'key' column is also filled like before, but now the index is gone (and not even default values, but all 0's)"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/286771310",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15692#issuecomment-286771310",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15692",
    "id": 286771310,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4Njc3MTMxMA==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-15T15:07:44Z",
    "updated_at": "2017-03-15T15:07:44Z",
    "author_association": "MEMBER",
    "body": "Behaviour in 0.18 of the above:\r\n\r\n```\r\nIn [18]: left = pd.DataFrame({'key':[3], 'col_left':['e']})\r\n\r\nIn [19]: left.merge(right, left_on='key', right_index=True, how=\"right\")\r\nOut[19]: \r\n  col_left  key col_right\r\n0        e  3.0         b\r\n0      NaN  2.0         a\r\n0      NaN  4.0         c\r\n```\r\n\r\nSo the bug with the 0's in the index is the same, and also here the key column gets filled in (only not retained dtype, that is what was fixed in 0.19). So probably the filling of the key column is then the desired behaviour ?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/286771685",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15692#issuecomment-286771685",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15692",
    "id": 286771685,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4Njc3MTY4NQ==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-15T15:08:54Z",
    "updated_at": "2017-03-15T15:08:54Z",
    "author_association": "MEMBER",
    "body": "The behaviour of the resulting index is rather buggy:\r\n\r\n```\r\nIn [15]: left\r\nOut[15]: \r\n  col_left  key\r\n0        e    3\r\n\r\n## All zero's\r\n\r\nIn [16]: left.merge(right, left_on='key', right_index=True, how=\"right\")\r\nOut[16]: \r\n  col_left  key col_right\r\n0        e    3         b\r\n0      NaN    2         a\r\n0      NaN    4         c\r\n\r\nIn [17]: left = pd.DataFrame({'key':[2,3,4], 'col_left':['e', 'd', 'g']})\r\n\r\n## Incorrect \"default\" index (or not sure where that values are coming from)\r\n\r\nIn [18]: left.merge(right, left_on='key', right_index=True, how=\"right\")\r\nOut[18]: \r\n  col_left  key col_right\r\n0        e    2         a\r\n1        d    3         b\r\n2        g    4         c\r\n\r\n## This seems correct?\r\n\r\nIn [19]: left = pd.DataFrame({'key':[0,1,2,3,4,5], 'col_left':['e', 'd', 'g', 'h\r\n    ...: ', 'b', 'p']})\r\n\r\nIn [20]: left.merge(right, left_on='key', right_index=True, how=\"right\")\r\nOut[20]: \r\n  col_left  key col_right\r\n2        g    2         a\r\n3        h    3         b\r\n4        b    4         c\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/286772312",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15692#issuecomment-286772312",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15692",
    "id": 286772312,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4Njc3MjMxMg==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-15T15:10:47Z",
    "updated_at": "2017-03-15T15:10:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "yeah I would say the index of the result is wrong. It should be just a range index. Maybe not getting setup somehow. \r\n\r\n```\r\nIn [10]: left\r\nOut[10]: \r\n  col_left  key\r\n0        e    3\r\n\r\nIn [11]: right\r\nOut[11]: \r\n  col_right\r\n2         a\r\n3         b\r\n4         c\r\n\r\nIn [12]: left.merge(right, left_on='key', right_index=True, how=\"right\", indicator=True)\r\nOut[12]: \r\n  col_left  key col_right      _merge\r\n0        e    3         b        both\r\n0      NaN    2         a  right_only\r\n0      NaN    4         c  right_only\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/286775604",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15692#issuecomment-286775604",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15692",
    "id": 286775604,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4Njc3NTYwNA==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-15T15:20:42Z",
    "updated_at": "2017-03-15T15:20:42Z",
    "author_association": "MEMBER",
    "body": "> It should be just a range index. \r\n\r\nIt is a right join on the index (at least on the right index), so an option is also to preserve the right index. It makes that you have the merge values duplicate (in column and in index), but the same is true when merging on two different named columns.\r\n\r\nBTW, when merging on two different columns, the key columns also don't get filled in on non-matching rows:\r\n\r\n```\r\nIn [33]: left = pd.DataFrame({'key_left': [3], 'col_left': ['e']})\r\n\r\nIn [34]: right = pd.DataFrame({'col_right': ['a', 'b', 'c'], 'key_right':[2,3,4]\r\n    ...: })\r\n\r\nIn [35]: left.merge(right, left_on='key_left', right_on='key_right', how='right'\r\n    ...: )\r\nOut[35]: \r\n  col_left  key_left col_right  key_right\r\n0        e       3.0         b          3\r\n1      NaN       NaN         a          2\r\n2      NaN       NaN         c          4\r\n```\r\n\r\nSo this is a further inconsistency with the `left_on='key', right_index=True` case."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/288199970",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15692#issuecomment-288199970",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15692",
    "id": 288199970,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4ODE5OTk3MA==",
    "user": {
      "login": "randomgambit",
      "id": 8282510,
      "node_id": "MDQ6VXNlcjgyODI1MTA=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8282510?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/randomgambit",
      "html_url": "https://github.com/randomgambit",
      "followers_url": "https://api.github.com/users/randomgambit/followers",
      "following_url": "https://api.github.com/users/randomgambit/following{/other_user}",
      "gists_url": "https://api.github.com/users/randomgambit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/randomgambit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/randomgambit/subscriptions",
      "organizations_url": "https://api.github.com/users/randomgambit/orgs",
      "repos_url": "https://api.github.com/users/randomgambit/repos",
      "events_url": "https://api.github.com/users/randomgambit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/randomgambit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-21T19:59:05Z",
    "updated_at": "2017-03-21T19:59:05Z",
    "author_association": "NONE",
    "body": "seems to work correctly when using dates for the keys ... except for the weird index.\r\n\r\n```\r\n\r\nleft = pd.DataFrame({'key':[pd.to_datetime('2016-01-02')], 'col_left':['e']})\r\nleft\r\nOut[78]: \r\n  col_left        key\r\n0        e 2016-01-02\r\n\r\nright = pd.DataFrame({'col_right': ['a', 'b', 'c']}, index=pd.date_range('2016-01-01', periods =3, freq = 'D'))\r\nright\r\nOut[79]: \r\n           col_right\r\n2016-01-01         a\r\n2016-01-02         b\r\n2016-01-03         c\r\n\r\n\r\nleft.merge(right, how = 'right', left_on = 'key', right_index = True)\r\nOut[80]: \r\n  col_left        key col_right\r\n0        e 2016-01-02         b\r\n0      NaN 2016-01-01         a\r\n0      NaN 2016-01-03         c\r\n\r\n#now works correctly with reset_index\r\nleft.merge(right.reset_index(), how = 'right', left_on = 'key', right_on = 'index')\r\nOut[81]: \r\n  col_left        key      index col_right\r\n0        e 2016-01-02 2016-01-02         b\r\n1      NaN        NaT 2016-01-01         a\r\n2      NaN        NaT 2016-01-03         c\r\n\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/288235752",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15692#issuecomment-288235752",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15692",
    "id": 288235752,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4ODIzNTc1Mg==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-21T22:12:13Z",
    "updated_at": "2017-03-21T22:12:13Z",
    "author_association": "MEMBER",
    "body": "@randomgambit sorry, I don't see how this example is different from the example without dates. The buggy index (all 0's) is exactly one of the issues."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/288237803",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15692#issuecomment-288237803",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15692",
    "id": 288237803,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4ODIzNzgwMw==",
    "user": {
      "login": "randomgambit",
      "id": 8282510,
      "node_id": "MDQ6VXNlcjgyODI1MTA=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8282510?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/randomgambit",
      "html_url": "https://github.com/randomgambit",
      "followers_url": "https://api.github.com/users/randomgambit/followers",
      "following_url": "https://api.github.com/users/randomgambit/following{/other_user}",
      "gists_url": "https://api.github.com/users/randomgambit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/randomgambit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/randomgambit/subscriptions",
      "organizations_url": "https://api.github.com/users/randomgambit/orgs",
      "repos_url": "https://api.github.com/users/randomgambit/repos",
      "events_url": "https://api.github.com/users/randomgambit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/randomgambit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-21T22:21:26Z",
    "updated_at": "2017-03-21T22:21:26Z",
    "author_association": "NONE",
    "body": "hello cher monsieur @jorisvandenbossche ! \r\n\r\nyes you are actually right. I misread my console.  Sorry about that. Well, I guess my point is that this bug carries over also for datetime variables :) I also noticed this pb a couple of times, and I always do my merges after having reset the index anyways"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/288242766",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15692#issuecomment-288242766",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15692",
    "id": 288242766,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4ODI0Mjc2Ng==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-21T22:44:48Z",
    "updated_at": "2017-03-21T22:44:48Z",
    "author_association": "MEMBER",
    "body": "No problem! \r\nYes, indeed, the inconsistencies / special cases are mainly caused by mixing merging on column and index."
  }
]
