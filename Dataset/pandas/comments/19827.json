[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/367488941",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-367488941",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 367488941,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NzQ4ODk0MQ==",
    "user": {
      "login": "chris-b1",
      "id": 1924092,
      "node_id": "MDQ6VXNlcjE5MjQwOTI=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1924092?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chris-b1",
      "html_url": "https://github.com/chris-b1",
      "followers_url": "https://api.github.com/users/chris-b1/followers",
      "following_url": "https://api.github.com/users/chris-b1/following{/other_user}",
      "gists_url": "https://api.github.com/users/chris-b1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chris-b1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chris-b1/subscriptions",
      "organizations_url": "https://api.github.com/users/chris-b1/orgs",
      "repos_url": "https://api.github.com/users/chris-b1/repos",
      "events_url": "https://api.github.com/users/chris-b1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chris-b1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-21T21:59:50Z",
    "updated_at": "2018-02-21T21:59:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "Isn't csv sort of fundamentally a text format?  The python csv writer, which we call out to, is ultimately what's choking.  Certainly could raise a better error.\r\n\r\n```\r\nIn [36]: import csv\r\n\r\nIn [37]: writer = csv.writer(open('test.csv', mode='wb'))\r\n\r\nIn [38]: writer.writerow(['a', 'b', 'c'])\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-38-bb2ef92b0247> in <module>()\r\n----> 1 writer.writerow(['a', 'b', 'c'])\r\n\r\nTypeError: a bytes-like object is required, not 'str'\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/367504937",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-367504937",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 367504937,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NzUwNDkzNw==",
    "user": {
      "login": "colobas",
      "id": 12519843,
      "node_id": "MDQ6VXNlcjEyNTE5ODQz",
      "avatar_url": "https://avatars3.githubusercontent.com/u/12519843?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/colobas",
      "html_url": "https://github.com/colobas",
      "followers_url": "https://api.github.com/users/colobas/followers",
      "following_url": "https://api.github.com/users/colobas/following{/other_user}",
      "gists_url": "https://api.github.com/users/colobas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/colobas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/colobas/subscriptions",
      "organizations_url": "https://api.github.com/users/colobas/orgs",
      "repos_url": "https://api.github.com/users/colobas/repos",
      "events_url": "https://api.github.com/users/colobas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/colobas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-21T22:51:57Z",
    "updated_at": "2018-02-21T22:51:57Z",
    "author_association": "NONE",
    "body": "It is, but sometimes you have a filesystem-sort-of-interface (like Azure's Data Lake Store one - [here](https://github.com/Azure/azure-data-lake-store-python) ) that requires files to be written in binary mode, regardless of the format."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/367542174",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-367542174",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 367542174,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NzU0MjE3NA==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-22T02:00:54Z",
    "updated_at": "2018-02-22T02:00:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "Does passing a ADL's file-like object to `to_csv`, without the `mode` argument, work? I know you can pass an `s3fs.S3File` opened in binary mode to `to_csv` and everything works fine."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/367740273",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-367740273",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 367740273,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2Nzc0MDI3Mw==",
    "user": {
      "login": "colobas",
      "id": 12519843,
      "node_id": "MDQ6VXNlcjEyNTE5ODQz",
      "avatar_url": "https://avatars3.githubusercontent.com/u/12519843?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/colobas",
      "html_url": "https://github.com/colobas",
      "followers_url": "https://api.github.com/users/colobas/followers",
      "following_url": "https://api.github.com/users/colobas/following{/other_user}",
      "gists_url": "https://api.github.com/users/colobas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/colobas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/colobas/subscriptions",
      "organizations_url": "https://api.github.com/users/colobas/orgs",
      "repos_url": "https://api.github.com/users/colobas/repos",
      "events_url": "https://api.github.com/users/colobas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/colobas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-22T16:36:58Z",
    "updated_at": "2018-02-22T16:37:29Z",
    "author_association": "NONE",
    "body": "Hey @TomAugspurger , just tried it. Same error:\r\n\r\n```\r\nwith adlfs_client.open(\"/dummy.csv\", \"wb\") as f:\r\n    dummy.to_csv(f)\r\n```\r\n\r\nyields\r\n\r\n```\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-186-bbe6f623ffa5> in <module>()\r\n      1 with adlfs_client.open(\"/dummy.csv\", \"wb\") as f:\r\n----> 2     dummy.to_csv(f)\r\n\r\n/opt/conda/lib/python3.6/site-packages/pandas/core/frame.py in to_csv(self, path_or_buf, sep, na_rep, float_format, columns, header, index, index_label, mode, encoding, compression, quoting, quotechar, line_terminator, chunksize, tupleize_cols, date_format, doublequote, escapechar, decimal)\r\n   1522                                      doublequote=doublequote,\r\n   1523                                      escapechar=escapechar, decimal=decimal)\r\n-> 1524         formatter.save()\r\n   1525 \r\n   1526         if path_or_buf is None:\r\n\r\n/opt/conda/lib/python3.6/site-packages/pandas/io/formats/format.py in save(self)\r\n   1650                 self.writer = UnicodeWriter(f, **writer_kwargs)\r\n   1651 \r\n-> 1652             self._save()\r\n   1653 \r\n   1654         finally:\r\n\r\n/opt/conda/lib/python3.6/site-packages/pandas/io/formats/format.py in _save(self)\r\n   1738     def _save(self):\r\n   1739 \r\n-> 1740         self._save_header()\r\n   1741 \r\n   1742         nrows = len(self.data_index)\r\n\r\n/opt/conda/lib/python3.6/site-packages/pandas/io/formats/format.py in _save_header(self)\r\n   1706         if not has_mi_columns or has_aliases:\r\n   1707             encoded_labels += list(write_cols)\r\n-> 1708             writer.writerow(encoded_labels)\r\n   1709         else:\r\n   1710             # write out the mi\r\n\r\n/opt/conda/lib/python3.6/site-packages/azure/datalake/store/core.py in write(self, data)\r\n    849             raise ValueError('I/O operation on closed file.')\r\n    850 \r\n--> 851         out = self.buffer.write(ensure_writable(data))\r\n    852         self.loc += out\r\n    853         self.flush(syncFlag='DATA')\r\n\r\nTypeError: a bytes-like object is required, not 'str'\r\n```\r\n\r\nAs of now the workaround is to create a temporary file and upload it explicitly, so it' not like I'm stuck, but it's just ugly."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/367744213",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-367744213",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 367744213,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2Nzc0NDIxMw==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-22T16:48:38Z",
    "updated_at": "2018-02-22T16:48:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "I *think* it works for s3fs because of this line: https://github.com/pandas-dev/pandas/blob/abc4ef9132d8bcc8ad987c18fdd757595fd65d8c/pandas/io/common.py#L326\r\n\r\nPerhaps you can wrap your `f` in an `io.TextIOWrapper`?\r\n\r\nI'm not sure what the best way to solve this is generically."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/367744446",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-367744446",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 367744446,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2Nzc0NDQ0Ng==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-22T16:49:25Z",
    "updated_at": "2018-02-22T16:49:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "Perhaps just checking the buffer for a `mode` and if it's binary then we know we need to wrap in in a `TextIOWrapper`?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/367780768",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-367780768",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 367780768,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2Nzc4MDc2OA==",
    "user": {
      "login": "colobas",
      "id": 12519843,
      "node_id": "MDQ6VXNlcjEyNTE5ODQz",
      "avatar_url": "https://avatars3.githubusercontent.com/u/12519843?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/colobas",
      "html_url": "https://github.com/colobas",
      "followers_url": "https://api.github.com/users/colobas/followers",
      "following_url": "https://api.github.com/users/colobas/following{/other_user}",
      "gists_url": "https://api.github.com/users/colobas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/colobas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/colobas/subscriptions",
      "organizations_url": "https://api.github.com/users/colobas/orgs",
      "repos_url": "https://api.github.com/users/colobas/repos",
      "events_url": "https://api.github.com/users/colobas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/colobas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-22T18:47:13Z",
    "updated_at": "2018-02-22T18:47:13Z",
    "author_association": "NONE",
    "body": "I can confirm that this does work:\r\n```\r\nfrom io import TextIOWrapper\r\n\r\nwith adlfs_client.open(\"/dummy.csv\", \"wb\") as f:\r\n    buf = TextIOWrapper(f)\r\n    dummy.to_csv(buf)\r\n```\r\n\r\nThanks for the suggestion"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/367885369",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-367885369",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 367885369,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2Nzg4NTM2OQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-23T01:56:05Z",
    "updated_at": "2018-02-23T01:56:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "I suppose we could add a mini-example like this to the docs (io.rst). It is a useful case I think.\r\n@colobas would you do a PR?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/368007606",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-368007606",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 368007606,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2ODAwNzYwNg==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-23T13:22:49Z",
    "updated_at": "2018-02-23T13:22:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Can anyone think of a reason not to layer a TextIOWrapper over any buffer\nopened in binary mode? I wonder why the stdlib CSV writer doesn't do this.\n\nOn the one hand, the user has explicitly given a binary-mode buffer to a\nthing writing text, which is \"wrong\". But I think there's no ambiguity to\nlaying\na TextIOWrapper on top of the binary buffer. We'll be using the same\ndefault encoding as if they user had just passed a text-mode file.\n\nOn Thu, Feb 22, 2018 at 7:56 PM, Jeff Reback <notifications@github.com>\nwrote:\n\n> I suppose we could add a mini-example like this to the docs (io.rst). It\n> is a useful case I think.\n> @colobas <https://github.com/colobas> would you do a PR?\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/pandas-dev/pandas/issues/19827#issuecomment-367885369>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/ABQHIlBDeUvismqTo7XrEA_OoYT3LZjCks5tXhq6gaJpZM4SOWoz>\n> .\n>\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/368029599",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-368029599",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 368029599,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2ODAyOTU5OQ==",
    "user": {
      "login": "colobas",
      "id": 12519843,
      "node_id": "MDQ6VXNlcjEyNTE5ODQz",
      "avatar_url": "https://avatars3.githubusercontent.com/u/12519843?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/colobas",
      "html_url": "https://github.com/colobas",
      "followers_url": "https://api.github.com/users/colobas/followers",
      "following_url": "https://api.github.com/users/colobas/following{/other_user}",
      "gists_url": "https://api.github.com/users/colobas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/colobas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/colobas/subscriptions",
      "organizations_url": "https://api.github.com/users/colobas/orgs",
      "repos_url": "https://api.github.com/users/colobas/repos",
      "events_url": "https://api.github.com/users/colobas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/colobas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-23T14:49:11Z",
    "updated_at": "2018-02-23T17:32:44Z",
    "author_association": "NONE",
    "body": "@TomAugspurger doesn't the `mode` parameter in `to_csv` stop having a purpose in that case?\r\n\r\nEDIT: I had typed `read_csv` instead of `to_csv`"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/368031514",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-368031514",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 368031514,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2ODAzMTUxNA==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-23T14:55:37Z",
    "updated_at": "2018-02-23T14:55:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "I assume you meant `to_csv`. In that case the mode still matters for write\nvs. append vs. exclusive. It's just the text vs. binary part of `mode` that\nwould be \"ignored\".\n\nGiven that the current behavior is so unfriendly (raising a not great error\nmessage), is there a harm in ignoring the text vs. binary part?\n\nOn Fri, Feb 23, 2018 at 8:49 AM, Guilherme Pires <notifications@github.com>\nwrote:\n\n> @TomAugspurger <https://github.com/tomaugspurger> doesn't the mode\n> parameter in read_csv stop having a purpose in that case?\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/pandas-dev/pandas/issues/19827#issuecomment-368029599>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/ABQHIrphQeD3uruekW9zZpicyMhrfCm2ks5tXs_rgaJpZM4SOWoz>\n> .\n>\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/368081515",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-368081515",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 368081515,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2ODA4MTUxNQ==",
    "user": {
      "login": "colobas",
      "id": 12519843,
      "node_id": "MDQ6VXNlcjEyNTE5ODQz",
      "avatar_url": "https://avatars3.githubusercontent.com/u/12519843?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/colobas",
      "html_url": "https://github.com/colobas",
      "followers_url": "https://api.github.com/users/colobas/followers",
      "following_url": "https://api.github.com/users/colobas/following{/other_user}",
      "gists_url": "https://api.github.com/users/colobas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/colobas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/colobas/subscriptions",
      "organizations_url": "https://api.github.com/users/colobas/orgs",
      "repos_url": "https://api.github.com/users/colobas/repos",
      "events_url": "https://api.github.com/users/colobas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/colobas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-23T17:35:01Z",
    "updated_at": "2018-02-23T17:35:01Z",
    "author_association": "NONE",
    "body": "No I think there would be no harm. I can make a PR during the weekend"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/398649163",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-398649163",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 398649163,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5ODY0OTE2Mw==",
    "user": {
      "login": "cbrnr",
      "id": 4377312,
      "node_id": "MDQ6VXNlcjQzNzczMTI=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/4377312?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cbrnr",
      "html_url": "https://github.com/cbrnr",
      "followers_url": "https://api.github.com/users/cbrnr/followers",
      "following_url": "https://api.github.com/users/cbrnr/following{/other_user}",
      "gists_url": "https://api.github.com/users/cbrnr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cbrnr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cbrnr/subscriptions",
      "organizations_url": "https://api.github.com/users/cbrnr/orgs",
      "repos_url": "https://api.github.com/users/cbrnr/repos",
      "events_url": "https://api.github.com/users/cbrnr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cbrnr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-20T07:17:16Z",
    "updated_at": "2018-06-20T07:17:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "Appending to a file doesn't work for text mode either:\r\n\r\n```\r\nimport pandas as pd\r\n\r\n\r\nwith open(\"test.csv\", \"w\") as f:\r\n    f.write(\"A,B,C\\n\")\r\n\r\n\r\ndf = pd.DataFrame({\"A\": [1, 2, 3, 4],\r\n                   \"B\": [5, 6, 7, 8],\r\n                   \"C\": [9, 10, 11, 12]})\r\n\r\nwith open(\"test.csv\", \"a\") as f:\r\n    df.to_csv(f, header=False, index=False)\r\n```\r\n\r\nEven though `f` is open in append mode, the file gets overwritten by `to_csv`.\r\n\r\nHowever, appending does work when a file name is passed instead of a file handle:\r\n\r\n```\r\ndf.to_csv(\"test.csv\", header=False, index=False, mode=\"a\")\r\n```\r\n\r\nI think this issue came up only recently, because I *think* this worked with a previous pandas version (although I didn't check)."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/400777932",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-400777932",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 400777932,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDc3NzkzMg==",
    "user": {
      "login": "jmerkin",
      "id": 332945,
      "node_id": "MDQ6VXNlcjMzMjk0NQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/332945?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmerkin",
      "html_url": "https://github.com/jmerkin",
      "followers_url": "https://api.github.com/users/jmerkin/followers",
      "following_url": "https://api.github.com/users/jmerkin/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmerkin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmerkin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmerkin/subscriptions",
      "organizations_url": "https://api.github.com/users/jmerkin/orgs",
      "repos_url": "https://api.github.com/users/jmerkin/repos",
      "events_url": "https://api.github.com/users/jmerkin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmerkin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-27T18:08:10Z",
    "updated_at": "2018-06-27T18:08:10Z",
    "author_association": "NONE",
    "body": "I updated my conda install after probably 6-12 months and this issue crept up for me, so I can confirm that it arose recently.\r\n\r\nRoughly, I was doing the following (essentially as cbrnr describes):\r\n```\r\nwith open(filename, 'w') as fout:\r\n    for input in inputs:\r\n        result = some_function(input)\r\n        result.to_csv(fout)\r\n```\r\n\r\nLooking through the installed versions in anaconda2/pkgs/ I see pandas-0.20.1 and pandas-0.23.1. Previously, the code would produce a single file with all the results produced. Now, the resulting file only contains the final results from the last iteration. The above code would work fine with 0.20, but produces the error as cbrnr describes now. "
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/401894617",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-401894617",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 401894617,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMTg5NDYxNw==",
    "user": {
      "login": "mariusvniekerk",
      "id": 73973,
      "node_id": "MDQ6VXNlcjczOTcz",
      "avatar_url": "https://avatars3.githubusercontent.com/u/73973?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mariusvniekerk",
      "html_url": "https://github.com/mariusvniekerk",
      "followers_url": "https://api.github.com/users/mariusvniekerk/followers",
      "following_url": "https://api.github.com/users/mariusvniekerk/following{/other_user}",
      "gists_url": "https://api.github.com/users/mariusvniekerk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mariusvniekerk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mariusvniekerk/subscriptions",
      "organizations_url": "https://api.github.com/users/mariusvniekerk/orgs",
      "repos_url": "https://api.github.com/users/mariusvniekerk/repos",
      "events_url": "https://api.github.com/users/mariusvniekerk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mariusvniekerk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-02T18:33:16Z",
    "updated_at": "2018-07-02T18:33:16Z",
    "author_association": "NONE",
    "body": "Setting `mode='a'` does clear it in the second example.  This seems to have changed between  0.22.0 and 0.23.1"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/402227737",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-402227737",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 402227737,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMjIyNzczNw==",
    "user": {
      "login": "Huite",
      "id": 13662783,
      "node_id": "MDQ6VXNlcjEzNjYyNzgz",
      "avatar_url": "https://avatars1.githubusercontent.com/u/13662783?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Huite",
      "html_url": "https://github.com/Huite",
      "followers_url": "https://api.github.com/users/Huite/followers",
      "following_url": "https://api.github.com/users/Huite/following{/other_user}",
      "gists_url": "https://api.github.com/users/Huite/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Huite/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Huite/subscriptions",
      "organizations_url": "https://api.github.com/users/Huite/orgs",
      "repos_url": "https://api.github.com/users/Huite/repos",
      "events_url": "https://api.github.com/users/Huite/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Huite/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-03T17:06:37Z",
    "updated_at": "2018-07-03T17:06:37Z",
    "author_association": "NONE",
    "body": "I've downgraded to 0.23.0 to check, and 0.23.0 works as expected. It appears to be specific to 0.23.1."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/403137072",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19827#issuecomment-403137072",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19827",
    "id": 403137072,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMzEzNzA3Mg==",
    "user": {
      "login": "yrhooke",
      "id": 7874046,
      "node_id": "MDQ6VXNlcjc4NzQwNDY=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/7874046?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yrhooke",
      "html_url": "https://github.com/yrhooke",
      "followers_url": "https://api.github.com/users/yrhooke/followers",
      "following_url": "https://api.github.com/users/yrhooke/following{/other_user}",
      "gists_url": "https://api.github.com/users/yrhooke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yrhooke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yrhooke/subscriptions",
      "organizations_url": "https://api.github.com/users/yrhooke/orgs",
      "repos_url": "https://api.github.com/users/yrhooke/repos",
      "events_url": "https://api.github.com/users/yrhooke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yrhooke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-06T20:21:07Z",
    "updated_at": "2018-07-06T20:21:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "Testing on current dev version (pandas: 0.24.0.dev0+232.g04caa569e) on my machine:\r\n\r\nappend works fine.\r\n\r\nWrapping the  file with TextIOWrapper inside the with open() block as suggested above doesn't raise an error, but doesn't write to file either. \r\n\r\nbinary write mode appears to be an issue with python3 csv module (see @chris-b1 's comment).\r\n\r\nIs there a particular fix that needs to happen? I'd be happy to work on it."
  }
]
