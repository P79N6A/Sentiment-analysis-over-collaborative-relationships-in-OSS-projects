[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/387689375",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20986#issuecomment-387689375",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20986",
    "id": 387689375,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NzY4OTM3NQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-09T10:03:16Z",
    "updated_at": "2018-05-09T10:03:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "pls post a copy-pastable reproducible example"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/401228768",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20986#issuecomment-401228768",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20986",
    "id": 401228768,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMTIyODc2OA==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-29T02:27:49Z",
    "updated_at": "2018-06-29T02:27:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Let us know if you can provide an example."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/423940568",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20986#issuecomment-423940568",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20986",
    "id": 423940568,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMzk0MDU2OA==",
    "user": {
      "login": "a-safonau",
      "id": 3219729,
      "node_id": "MDQ6VXNlcjMyMTk3Mjk=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/3219729?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/a-safonau",
      "html_url": "https://github.com/a-safonau",
      "followers_url": "https://api.github.com/users/a-safonau/followers",
      "following_url": "https://api.github.com/users/a-safonau/following{/other_user}",
      "gists_url": "https://api.github.com/users/a-safonau/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/a-safonau/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/a-safonau/subscriptions",
      "organizations_url": "https://api.github.com/users/a-safonau/orgs",
      "repos_url": "https://api.github.com/users/a-safonau/repos",
      "events_url": "https://api.github.com/users/a-safonau/events{/privacy}",
      "received_events_url": "https://api.github.com/users/a-safonau/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-24T11:10:04Z",
    "updated_at": "2018-09-24T11:13:19Z",
    "author_association": "NONE",
    "body": "Similar issue\r\n\r\nPandas version : '0.23.4'\r\npython version : 3.6.5.final.0\r\n\r\n```\r\nfrom pandas.api.types import is_string_dtype\r\ndf = pd.DataFrame({'col1' : [1, 2, 3], 'col2' : [np.NaN, False, False]})\r\n\r\nfor n,c in df.items():\r\n        if is_string_dtype(c): df[n] = c.astype('category').cat.as_ordered()\r\n\r\ndf2['col2'] = pd.Categorical(df2['col2'],categories=df['col2'].cat.categories)\r\n```\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/424346301",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20986#issuecomment-424346301",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20986",
    "id": 424346301,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNDM0NjMwMQ==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-25T13:37:04Z",
    "updated_at": "2018-09-25T13:37:04Z",
    "author_association": "MEMBER",
    "body": "@a-safonau please provide a reproducible example (eg  `df2` is not defined)"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/436065299",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20986#issuecomment-436065299",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20986",
    "id": 436065299,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjA2NTI5OQ==",
    "user": {
      "login": "krassowski",
      "id": 5832902,
      "node_id": "MDQ6VXNlcjU4MzI5MDI=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/5832902?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/krassowski",
      "html_url": "https://github.com/krassowski",
      "followers_url": "https://api.github.com/users/krassowski/followers",
      "following_url": "https://api.github.com/users/krassowski/following{/other_user}",
      "gists_url": "https://api.github.com/users/krassowski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/krassowski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/krassowski/subscriptions",
      "organizations_url": "https://api.github.com/users/krassowski/orgs",
      "repos_url": "https://api.github.com/users/krassowski/repos",
      "events_url": "https://api.github.com/users/krassowski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/krassowski/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-05T22:50:04Z",
    "updated_at": "2018-11-05T22:52:48Z",
    "author_association": "NONE",
    "body": "Here is a reproducible example:\r\n\r\n```python\r\nfrom io import StringIO\r\nfrom pandas import concat, DataFrame, read_table\r\n\r\nbuffer = StringIO(\"\"\"\\\r\nstudy\tSRP052491\tSRP052491\r\nrun\tSRR1762738\tSRR1762739\r\ngene_id\t\t\r\nENSG00000000003.14\t16641\t11561\\\r\n\"\"\")\r\nexpressions = read_table(buffer, header=[0, 1], index_col=[0])\r\nthird_index = DataFrame({'third_index': ['Disease X', 'Disease Y']}).T\r\n\r\nconcat([expressions, third_index], ignore_index=True)\r\n```\r\n#### Problem description\r\n\r\nI wanted add third index to my dataframe expressions, which looks like that:\r\n<table border=\"1\" class=\"dataframe\">  <thead>    <tr>      <th>study</th>      <th colspan=\"2\" halign=\"left\">SRP052491</th>    </tr>    <tr>      <th>run</th>      <th>SRR1762738</th>      <th>SRR1762739</th>    </tr>    <tr>      <th>gene_id</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>ENSG00000000003.14</th>      <td>16641</td>      <td>11561</td>    </tr>  </tbody></table>\r\n\r\nTo do so, I tried to follow [this SO answer](https://stackoverflow.com/a/14746845/6646912) but adapting it to columns instead of rows, as I could not find anything for rows. However, I encountered this bug when trying to add a new row (future index):\r\n\r\n`ValueError: Buffer dtype mismatch, expected 'Python object' but got 'long'`\r\n\r\nPlease see full traceback here:\r\n\r\n<details>\r\n\r\n```\r\n\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-169-f84675475a18> in <module>\r\n     11 third_index = DataFrame({'third_index': ['Disease X', 'Disease Y']}).T\r\n     12 \r\n---> 13 concat([expressions, third_index], ignore_index=True)\r\n\r\n.../lib/python3.7/site-packages/pandas/core/reshape/concat.py in concat(objs, axis, join, join_axes, ignore_index, keys, levels, names, verify_integrity, sort, copy)\r\n    223                        keys=keys, levels=levels, names=names,\r\n    224                        verify_integrity=verify_integrity,\r\n--> 225                        copy=copy, sort=sort)\r\n    226     return op.get_result()\r\n    227 \r\n\r\n.../lib/python3.7/site-packages/pandas/core/reshape/concat.py in __init__(self, objs, axis, join, join_axes, keys, levels, names, ignore_index, verify_integrity, copy, sort)\r\n    376         self.copy = copy\r\n    377 \r\n--> 378         self.new_axes = self._get_new_axes()\r\n    379 \r\n    380     def get_result(self):\r\n\r\n.../lib/python3.7/site-packages/pandas/core/reshape/concat.py in _get_new_axes(self)\r\n    443                 if i == self.axis:\r\n    444                     continue\r\n--> 445                 new_axes[i] = self._get_comb_axis(i)\r\n    446         else:\r\n    447             if len(self.join_axes) != ndim - 1:\r\n\r\n.../lib/python3.7/site-packages/pandas/core/reshape/concat.py in _get_comb_axis(self, i)\r\n    464             return _get_objs_combined_axis(self.objs, axis=data_axis,\r\n    465                                            intersect=self.intersect,\r\n--> 466                                            sort=self.sort)\r\n    467         except IndexError:\r\n    468             types = [type(x).__name__ for x in self.objs]\r\n\r\n.../lib/python3.7/site-packages/pandas/core/indexes/api.py in _get_objs_combined_axis(objs, intersect, axis, sort)\r\n     52                  if hasattr(obj, '_get_axis')]\r\n     53     if obs_idxes:\r\n---> 54         return _get_combined_index(obs_idxes, intersect=intersect, sort=sort)\r\n     55 \r\n     56 \r\n\r\n.../lib/python3.7/site-packages/pandas/core/indexes/api.py in _get_combined_index(indexes, intersect, sort)\r\n     67             index = index.intersection(other)\r\n     68     else:\r\n---> 69         index = _union_indexes(indexes, sort=sort)\r\n     70         index = _ensure_index(index)\r\n     71 \r\n\r\n.../lib/python3.7/site-packages/pandas/core/indexes/api.py in _union_indexes(indexes, sort)\r\n    105         else:\r\n    106             for other in indexes[1:]:\r\n--> 107                 result = result.union(other)\r\n    108             return result\r\n    109     elif kind == 'array':\r\n\r\n.../lib/python3.7/site-packages/pandas/core/indexes/multi.py in union(self, other)\r\n   2738 \r\n   2739         uniq_tuples = lib.fast_unique_multiple([self._ndarray_values,\r\n-> 2740                                                 other._ndarray_values])\r\n   2741         return MultiIndex.from_arrays(lzip(*uniq_tuples), sortorder=0,\r\n   2742                                       names=result_names)\r\n\r\npandas/_libs/lib.pyx in pandas._libs.lib.fast_unique_multiple()\r\n\r\nValueError: Buffer dtype mismatch, expected 'Python object' but got 'long'\r\n```\r\n\r\n</details>\r\n\r\n\r\n#### Expected Output\r\n<table border=\"1\" class=\"dataframe\">  <thead>    <tr>      <th>study</th>      <th colspan=\"2\" halign=\"left\">SRP052491</th>    </tr>    <tr>      <th>run</th>      <th>SRR1762738</th>      <th>SRR1762739</th>    </tr>    <tr>      <th>gene_id</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>ENSG00000000003.14</th>      <td>16641</td>      <td>11561</td>    </tr>   <tr>      <th>third_index</th>      <td>Disease X</td>      <td>Disease Y</td>    </tr>  </tbody></table>\r\n\r\n\r\n#### Output of ``pd.show_versions()``\r\n\r\n<details>\r\n\r\nINSTALLED VERSIONS\r\n------------------\r\ncommit: None\r\npython: 3.7.0.final.0\r\npython-bits: 64\r\nOS: Linux\r\nOS-release: 4.18.0-10-generic\r\nmachine: x86_64\r\nprocessor: x86_64\r\nbyteorder: little\r\nLC_ALL: None\r\nLANG: en_US.UTF-8\r\nLOCALE: en_US.UTF-8\r\n\r\npandas: 0.23.4\r\npytest: None\r\npip: 10.0.1\r\nsetuptools: 39.0.1\r\nCython: None\r\nnumpy: 1.15.2\r\nscipy: 1.1.0\r\npyarrow: None\r\nxarray: None\r\nIPython: 7.0.1\r\nsphinx: None\r\npatsy: None\r\ndateutil: 2.7.3\r\npytz: 2018.5\r\nblosc: None\r\nbottleneck: None\r\ntables: 3.4.4\r\nnumexpr: 2.6.8\r\nfeather: None\r\nmatplotlib: 3.0.0\r\nopenpyxl: None\r\nxlrd: None\r\nxlwt: None\r\nxlsxwriter: None\r\nlxml: None\r\nbs4: None\r\nhtml5lib: 1.0.1\r\nsqlalchemy: None\r\npymysql: None\r\npsycopg2: None\r\njinja2: 2.10\r\ns3fs: None\r\nfastparquet: None\r\npandas_gbq: None\r\npandas_datareader: None\r\n\r\n</details>"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/436402569",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20986#issuecomment-436402569",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20986",
    "id": 436402569,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjQwMjU2OQ==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-06T20:46:43Z",
    "updated_at": "2018-11-06T20:46:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "@krassowski thanks for the example, but I don't agree with your expected output. Your example is similar to \r\n\r\n```python\r\nIn [52]: a = pd.DataFrame([[1, 2]], columns=['a', 'b'])\r\n\r\nIn [53]: b = pd.DataFrame([[3, 4]], columns=['c', 'd'])\r\n\r\nIn [54]: a\r\nOut[54]:\r\n   a  b\r\n0  1  2\r\n\r\nIn [55]: b\r\nOut[55]:\r\n   c  d\r\n0  3  4\r\n\r\nIn [56]: pd.concat([a, b], ignore_index=True, sort=False)\r\nOut[56]:\r\n     a    b    c    d\r\n0  1.0  2.0  NaN  NaN\r\n1  NaN  NaN  3.0  4.0\r\n```\r\n\r\nthe non-concatenation axis (columns in this case) is still aligned. Aside from that expected output though, I do get the same exception."
  }
]
