[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/253610164",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14418#issuecomment-253610164",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14418",
    "id": 253610164,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzYxMDE2NA==",
    "user": {
      "login": "ebolyen",
      "id": 3976804,
      "node_id": "MDQ6VXNlcjM5NzY4MDQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/3976804?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ebolyen",
      "html_url": "https://github.com/ebolyen",
      "followers_url": "https://api.github.com/users/ebolyen/followers",
      "following_url": "https://api.github.com/users/ebolyen/following{/other_user}",
      "gists_url": "https://api.github.com/users/ebolyen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ebolyen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ebolyen/subscriptions",
      "organizations_url": "https://api.github.com/users/ebolyen/orgs",
      "repos_url": "https://api.github.com/users/ebolyen/repos",
      "events_url": "https://api.github.com/users/ebolyen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ebolyen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-13T19:13:20Z",
    "updated_at": "2016-10-13T19:13:20Z",
    "author_association": "NONE",
    "body": "As context for why it would be nice to not close a user-filehandle, we have a function like this:\n\n``` python\n\ndef _parse_blast_data(fh, columns, error, error_message, comment=None,\n                      skiprows=None):\n    read_csv = functools.partial(pd.read_csv, na_values='N/A', sep='\\t',\n                                 header=None, keep_default_na=False,\n                                 comment=comment, skiprows=skiprows)\n    lineone = read_csv(fh, nrows=1)\n\n    if len(lineone.columns) != len(columns):\n        raise error(error_message % (len(columns), len(lineone.columns)))\n\n    fh.seek(0)\n    return read_csv(fh, names=columns, dtype=_possible_columns)\n```\n\nwhich reads the first line to check the columns before reading the entire file.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/253634818",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14418#issuecomment-253634818",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14418",
    "id": 253634818,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzYzNDgxOA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-13T20:50:46Z",
    "updated_at": "2016-10-13T20:50:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ebolyen \n\nwe need to close file handles that _pandas_ opens. These _include_ things like a re-encoding stream and compression streams (e.g. pandas needs to open a new handle). In theory we shouldn't be closing a user stream (though it certainly is possible), its not tested that well. \n\nThe changes above were to fix NOT closing things in the test suite as PY3 reports unclosed handles much better than PY2.\n\nso if you can avoid closing things that are not supposed to be that would be great.\nNeed also to test with actual file handles, and memory mapped ones, in addition to a file-like handle.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/253639911",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14418#issuecomment-253639911",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14418",
    "id": 253639911,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzYzOTkxMQ==",
    "user": {
      "login": "ebolyen",
      "id": 3976804,
      "node_id": "MDQ6VXNlcjM5NzY4MDQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/3976804?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ebolyen",
      "html_url": "https://github.com/ebolyen",
      "followers_url": "https://api.github.com/users/ebolyen/followers",
      "following_url": "https://api.github.com/users/ebolyen/following{/other_user}",
      "gists_url": "https://api.github.com/users/ebolyen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ebolyen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ebolyen/subscriptions",
      "organizations_url": "https://api.github.com/users/ebolyen/orgs",
      "repos_url": "https://api.github.com/users/ebolyen/repos",
      "events_url": "https://api.github.com/users/ebolyen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ebolyen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-13T21:10:39Z",
    "updated_at": "2016-10-13T21:13:22Z",
    "author_association": "NONE",
    "body": "@jreback agree completely, and thank you guys for working to clean up resources opened by pandas. \n\nThe line I noted in combination with [this one](https://github.com/pandas-dev/pandas/commit/4a805216d99b37955c97625d304980eff10cab56#diff-777d7549579ddc0c6e67596ad87e0d27R403) is what I believe is causing user sources to be closed. As unlike the `handles` list (which captures very nicely the filehandles that pandas opened), it is always closed regardless of context and it appears that `parser.TextReader` uses whatever it was handed as it's `dsource` which is always closed when itself is closed. So it seems like there would need to be a more context-aware `._reader` property.\n\nAfter poking through that it occurred to me that it may be specific only to the C parser engine, and testing it looks like that is the case:\n\n``` pytb\nIn [1]: import pandas as pd\n\nIn [2]: import io\n\nIn [3]: fh = io.StringIO('a,b\\n1,2')\n\nIn [4]: pd.read_csv(fh, engine='python')\nOut[4]: \n   a  b\n0  1  2\n\nIn [5]: fh.closed\nOut[5]: False\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/253640666",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14418#issuecomment-253640666",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14418",
    "id": 253640666,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzY0MDY2Ng==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-13T21:13:52Z",
    "updated_at": "2016-10-13T21:13:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ebolyen yes, the c-engine got a facelift w.r.t. handles in 0.19.0.\n\nyeah, we may need to keep some kind of state whether to close a handle\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/253703862",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14418#issuecomment-253703862",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14418",
    "id": 253703862,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzcwMzg2Mg==",
    "user": {
      "login": "gfyoung",
      "id": 9273653,
      "node_id": "MDQ6VXNlcjkyNzM2NTM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/9273653?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gfyoung",
      "html_url": "https://github.com/gfyoung",
      "followers_url": "https://api.github.com/users/gfyoung/followers",
      "following_url": "https://api.github.com/users/gfyoung/following{/other_user}",
      "gists_url": "https://api.github.com/users/gfyoung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gfyoung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gfyoung/subscriptions",
      "organizations_url": "https://api.github.com/users/gfyoung/orgs",
      "repos_url": "https://api.github.com/users/gfyoung/repos",
      "events_url": "https://api.github.com/users/gfyoung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gfyoung/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-14T03:57:08Z",
    "updated_at": "2016-10-14T03:57:08Z",
    "author_association": "MEMBER",
    "body": "That seems logical.  Perhaps close if an actual file BUT keep open any streams (e.g. `StringIO`), as that could be easily check IINM?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/253821234",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14418#issuecomment-253821234",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14418",
    "id": 253821234,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzgyMTIzNA==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-14T14:47:18Z",
    "updated_at": "2016-10-14T14:47:18Z",
    "author_association": "MEMBER",
    "body": "@agraboso or @gfyoung if you would have time to give this is a look, certainly welcome! :-) Would be nice to fix this in 0.19.1\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/253861118",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14418#issuecomment-253861118",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14418",
    "id": 253861118,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1Mzg2MTExOA==",
    "user": {
      "login": "chris-b1",
      "id": 1924092,
      "node_id": "MDQ6VXNlcjE5MjQwOTI=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1924092?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chris-b1",
      "html_url": "https://github.com/chris-b1",
      "followers_url": "https://api.github.com/users/chris-b1/followers",
      "following_url": "https://api.github.com/users/chris-b1/following{/other_user}",
      "gists_url": "https://api.github.com/users/chris-b1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chris-b1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chris-b1/subscriptions",
      "organizations_url": "https://api.github.com/users/chris-b1/orgs",
      "repos_url": "https://api.github.com/users/chris-b1/repos",
      "events_url": "https://api.github.com/users/chris-b1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chris-b1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-14T17:04:46Z",
    "updated_at": "2016-10-14T17:04:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "Could make an argument either way, but if we want to follow what seems to be the stdlib convention, should also leave handles to actual files open too.\n\n``` python\n\nIn [48]: %%file tmp.json\n    ...: {\"a\": \"22\"}\nOverwriting tmp.json\n\nIn [49]: import json\n\nIn [50]: fh = open('tmp.json'); json.load(fh); fh.closed\nOut[50]: False\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/253963594",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14418#issuecomment-253963594",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14418",
    "id": 253963594,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1Mzk2MzU5NA==",
    "user": {
      "login": "gfyoung",
      "id": 9273653,
      "node_id": "MDQ6VXNlcjkyNzM2NTM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/9273653?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gfyoung",
      "html_url": "https://github.com/gfyoung",
      "followers_url": "https://api.github.com/users/gfyoung/followers",
      "following_url": "https://api.github.com/users/gfyoung/following{/other_user}",
      "gists_url": "https://api.github.com/users/gfyoung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gfyoung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gfyoung/subscriptions",
      "organizations_url": "https://api.github.com/users/gfyoung/orgs",
      "repos_url": "https://api.github.com/users/gfyoung/repos",
      "events_url": "https://api.github.com/users/gfyoung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gfyoung/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-15T05:11:43Z",
    "updated_at": "2016-10-15T05:12:22Z",
    "author_association": "MEMBER",
    "body": "But what about the resource warnings in our tests?  I presume we would then just do an assert_produces_warning check?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/257416433",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14418#issuecomment-257416433",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14418",
    "id": 257416433,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NzQxNjQzMw==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-31T20:49:13Z",
    "updated_at": "2016-10-31T20:49:13Z",
    "author_association": "MEMBER",
    "body": "@ebolyen BTW, always welcome to test https://github.com/pandas-dev/pandas/pull/14520 (but given that the tests pass it should work I think). Will be in upcoming 0.19.1\n"
  }
]
