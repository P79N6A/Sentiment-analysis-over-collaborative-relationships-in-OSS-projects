[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/121748644",
    "html_url": "https://github.com/pandas-dev/pandas/issues/10588#issuecomment-121748644",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/10588",
    "id": 121748644,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTc0ODY0NA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-07-15T21:10:57Z",
    "updated_at": "2015-07-15T21:10:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "this is a dupe of #5645 \n\nsoln is at the end of the issue\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/121749653",
    "html_url": "https://github.com/pandas-dev/pandas/issues/10588#issuecomment-121749653",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/10588",
    "id": 121749653,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTc0OTY1Mw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-07-15T21:13:42Z",
    "updated_at": "2015-07-15T21:13:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "```\nIn [21]: df.unstack('Alpha').mul(ser).stack('Alpha').reorder_levels(df.index.names)\nOut[21]: \nGamma                      C\nAlpha Beta Gamma            \n1     A    C        6.761867\n           D      171.944612\n2     B    C        0.154139\n           D        6.371062\n3     C    C        2.311870\n           D       42.898041\n4     D    C        0.390920\n           D        9.479801\n5     E    C        3.484439\n           D       72.011743\n6     F    C        0.740913\n           D       50.382061\n7     G    C        3.459497\n           D       60.541203\n8     H    C        0.467012\n           D       19.030741\n9     I    C        0.071290\n           D       11.620286\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/121757681",
    "html_url": "https://github.com/pandas-dev/pandas/issues/10588#issuecomment-121757681",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/10588",
    "id": 121757681,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTc1NzY4MQ==",
    "user": {
      "login": "dickster77",
      "id": 4152095,
      "node_id": "MDQ6VXNlcjQxNTIwOTU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/4152095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dickster77",
      "html_url": "https://github.com/dickster77",
      "followers_url": "https://api.github.com/users/dickster77/followers",
      "following_url": "https://api.github.com/users/dickster77/following{/other_user}",
      "gists_url": "https://api.github.com/users/dickster77/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dickster77/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dickster77/subscriptions",
      "organizations_url": "https://api.github.com/users/dickster77/orgs",
      "repos_url": "https://api.github.com/users/dickster77/repos",
      "events_url": "https://api.github.com/users/dickster77/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dickster77/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-07-15T21:37:21Z",
    "updated_at": "2015-07-15T22:10:40Z",
    "author_association": "NONE",
    "body": "Thankyou \n\npreviously mentioned error was wrong sorry.\n\nI mention on SO that I believe series needs unstacked as well.\n\n```\nser = ser.unstack('Alpha')\ndf = df.unstack('Alpha')\ndf = df.mul(ser)\ndf = df.stack('Alpha')\ndf = df.reorder_levels(['Alpha','Beta','Gamma'])\n```\n\nBut then i loose the info about D. Was hoping for np.nan.\n\n```\n              value\nAlpha Beta Gamma       \n1     A    C     2.5038\n2     B    C     5.0282\n3     C    C     0.8423\n4     D    C     0.1981\n5     E    C     0.8007\n6     F    C     1.9365\n7     G    C     2.5074\n8     H    C     4.8463\n9     I    C     2.6292\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/121761585",
    "html_url": "https://github.com/pandas-dev/pandas/issues/10588#issuecomment-121761585",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/10588",
    "id": 121761585,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTc2MTU4NQ==",
    "user": {
      "login": "dickster77",
      "id": 4152095,
      "node_id": "MDQ6VXNlcjQxNTIwOTU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/4152095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dickster77",
      "html_url": "https://github.com/dickster77",
      "followers_url": "https://api.github.com/users/dickster77/followers",
      "following_url": "https://api.github.com/users/dickster77/following{/other_user}",
      "gists_url": "https://api.github.com/users/dickster77/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dickster77/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dickster77/subscriptions",
      "organizations_url": "https://api.github.com/users/dickster77/orgs",
      "repos_url": "https://api.github.com/users/dickster77/repos",
      "events_url": "https://api.github.com/users/dickster77/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dickster77/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-07-15T21:56:38Z",
    "updated_at": "2015-07-15T22:05:48Z",
    "author_association": "NONE",
    "body": "So imagine I have this, where I now have a D in the series \"ser\":\n\n```\nimport pandas as pd\nimport numpy as np\n\nnp.random.seed(1)\nd = {'Alpha': [1,2,3,4,5,6,7,8,9]\n   ,'Beta':tuple('ABCDEFGHI')\n   ,'C': np.random.randint(1,10,9)\n   ,'D': np.random.randint(100,200,9)\n }\n\ndf = pd.DataFrame(d)\ndf.set_index(['Alpha','Beta'],inplace=True)\ndf = df.stack() #it's now a series\ndf.index.names = df.index.names[:-1] + ['Gamma']\n\nser = pd.Series(data = np.random.rand(9))\n\n\nidx = list(np.repeat('C',8))\nidx.append('D')\n\nser.index = pd.MultiIndex.from_tuples(zip(range(1,10),idx))\nser.index.names = ['Alpha','Gamma']\n\nprint df\nprint ser\n\ndf_jreback = df.unstack('Alpha').mul(ser).stack('Alpha').reorder_levels(df.index.names)\nprint df_jreback\n\n\ndf_dickster = df.unstack('Alpha').mul(ser.unstack('Alpha')).stack('Alpha').reorder_levels(df.index.names)\nprint df_dickster \n```\n\nOutput is this:\n\n```\nAlpha  Beta  Gamma\n1      A     C          6\n             D        120\n2      B     C          9\n             D        118\n3      C     C          6\n             D        184\n4      D     C          1\n             D        111\n5      E     C          1\n             D        128\n6      F     C          2\n             D        129\n7      G     C          8\n             D        114\n8      H     C          7\n             D        150\n9      I     C          3\n             D        168\ndtype: int32\nAlpha  Gamma\n1      C        0.417305\n2      C        0.558690\n3      C        0.140387\n4      C        0.198101\n5      C        0.800745\n6      C        0.968262\n7      C        0.313424\n8      C        0.692323\n9      D        0.876389\ndtype: float64\n```\n\njreback output:\n\n```\nGamma                      C           D\nAlpha Beta Gamma                        \n1     A    C        2.503829         NaN\n           D       50.076576         NaN\n2     B    C        5.028208         NaN\n           D       65.925400         NaN\n3     C    C        0.842322         NaN\n           D       25.831197         NaN\n4     D    C        0.198101         NaN\n           D       21.989265         NaN\n5     E    C        0.800745         NaN\n           D      102.495305         NaN\n6     F    C        1.936523         NaN\n           D      124.905743         NaN\n7     G    C        2.507393         NaN\n           D       35.730356         NaN\n8     H    C        4.846258         NaN\n           D      103.848392         NaN\n9     I    C             NaN    2.629167\n           D             NaN  147.233378\n```\n\ndickster77 output:\n\n```\nAlpha  Beta  Gamma\n1      A     C          2.503829\n2      B     C          5.028208\n3      C     C          0.842322\n4      D     C          0.198101\n5      E     C          0.800745\n6      F     C          1.936523\n7      G     C          2.507393\n8      H     C          4.846258\n9      I     D        147.233378\ndtype: float64\n```\n"
  }
]
