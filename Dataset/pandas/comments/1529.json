[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/6562486",
    "html_url": "https://github.com/pandas-dev/pandas/issues/1529#issuecomment-6562486",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/1529",
    "id": 6562486,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NjI0ODY=",
    "user": {
      "login": "wesm",
      "id": 329591,
      "node_id": "MDQ6VXNlcjMyOTU5MQ==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/329591?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wesm",
      "html_url": "https://github.com/wesm",
      "followers_url": "https://api.github.com/users/wesm/followers",
      "following_url": "https://api.github.com/users/wesm/following{/other_user}",
      "gists_url": "https://api.github.com/users/wesm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wesm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wesm/subscriptions",
      "organizations_url": "https://api.github.com/users/wesm/orgs",
      "repos_url": "https://api.github.com/users/wesm/repos",
      "events_url": "https://api.github.com/users/wesm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wesm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-06-25T22:56:43Z",
    "updated_at": "2012-06-25T22:56:43Z",
    "author_association": "MEMBER",
    "body": "Have you tried passing a file-like object (e.g. `StringIO`)?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/6562649",
    "html_url": "https://github.com/pandas-dev/pandas/issues/1529#issuecomment-6562649",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/1529",
    "id": 6562649,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NjI2NDk=",
    "user": {
      "login": "nicolashery",
      "id": 1306536,
      "node_id": "MDQ6VXNlcjEzMDY1MzY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1306536?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nicolashery",
      "html_url": "https://github.com/nicolashery",
      "followers_url": "https://api.github.com/users/nicolashery/followers",
      "following_url": "https://api.github.com/users/nicolashery/following{/other_user}",
      "gists_url": "https://api.github.com/users/nicolashery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nicolashery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nicolashery/subscriptions",
      "organizations_url": "https://api.github.com/users/nicolashery/orgs",
      "repos_url": "https://api.github.com/users/nicolashery/repos",
      "events_url": "https://api.github.com/users/nicolashery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nicolashery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-06-25T23:06:32Z",
    "updated_at": "2012-06-25T23:06:32Z",
    "author_association": "NONE",
    "body": "Thanks for the quick reply!\n\nIt seems that `open_workbook` calls `open_workbook_xls` which in turn calls `biff2_8_load` (https://github.com/python-excel/xlrd/blob/master/xlrd/book.py#L549)\n\nThey all have the same logic which basically is:\n\n``` python\nif file_contents:\n   filestr = file_contents\nelse:\n   f = open(filename, 'rb')\n   filestr = f.read()\n   f.close()\n```\n\nSo they don't check a single variable to see what type it is (`string`, ie a path, or `StringIO`). I guess Pandas would have to do it for them.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/6562749",
    "html_url": "https://github.com/pandas-dev/pandas/issues/1529#issuecomment-6562749",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/1529",
    "id": 6562749,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NjI3NDk=",
    "user": {
      "login": "wesm",
      "id": 329591,
      "node_id": "MDQ6VXNlcjMyOTU5MQ==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/329591?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wesm",
      "html_url": "https://github.com/wesm",
      "followers_url": "https://api.github.com/users/wesm/followers",
      "following_url": "https://api.github.com/users/wesm/following{/other_user}",
      "gists_url": "https://api.github.com/users/wesm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wesm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wesm/subscriptions",
      "organizations_url": "https://api.github.com/users/wesm/orgs",
      "repos_url": "https://api.github.com/users/wesm/repos",
      "events_url": "https://api.github.com/users/wesm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wesm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-06-25T23:12:06Z",
    "updated_at": "2012-06-25T23:12:06Z",
    "author_association": "MEMBER",
    "body": "A fair point. the `ExcelFile` class doesn't accept file-like objects on closer inspection. I'll have a look (or you can make a pull request if you get energetic)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/6562967",
    "html_url": "https://github.com/pandas-dev/pandas/issues/1529#issuecomment-6562967",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/1529",
    "id": 6562967,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NjI5Njc=",
    "user": {
      "login": "nicolashery",
      "id": 1306536,
      "node_id": "MDQ6VXNlcjEzMDY1MzY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1306536?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nicolashery",
      "html_url": "https://github.com/nicolashery",
      "followers_url": "https://api.github.com/users/nicolashery/followers",
      "following_url": "https://api.github.com/users/nicolashery/following{/other_user}",
      "gists_url": "https://api.github.com/users/nicolashery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nicolashery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nicolashery/subscriptions",
      "organizations_url": "https://api.github.com/users/nicolashery/orgs",
      "repos_url": "https://api.github.com/users/nicolashery/repos",
      "events_url": "https://api.github.com/users/nicolashery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nicolashery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-06-25T23:26:02Z",
    "updated_at": "2012-06-25T23:26:23Z",
    "author_association": "NONE",
    "body": "Looked at openpyxl, and they do the check \"file object vs path\" themselves (https://github.com/chronossc/openpyxl/blob/master/openpyxl/reader/excel.py#L43). So would mean only doing it for xlrd.\n\nTell you what, I feel energetic, so I'll try and look into it :)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/6643718",
    "html_url": "https://github.com/pandas-dev/pandas/issues/1529#issuecomment-6643718",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/1529",
    "id": 6643718,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NDM3MTg=",
    "user": {
      "login": "wesm",
      "id": 329591,
      "node_id": "MDQ6VXNlcjMyOTU5MQ==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/329591?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wesm",
      "html_url": "https://github.com/wesm",
      "followers_url": "https://api.github.com/users/wesm/followers",
      "following_url": "https://api.github.com/users/wesm/following{/other_user}",
      "gists_url": "https://api.github.com/users/wesm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wesm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wesm/subscriptions",
      "organizations_url": "https://api.github.com/users/wesm/orgs",
      "repos_url": "https://api.github.com/users/wesm/repos",
      "events_url": "https://api.github.com/users/wesm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wesm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-06-28T22:31:21Z",
    "updated_at": "2012-06-28T22:31:21Z",
    "author_association": "MEMBER",
    "body": "Beat you to it. xlrd can't accept file-like objects so as a hack I write the data out to a temporary file\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/6644515",
    "html_url": "https://github.com/pandas-dev/pandas/issues/1529#issuecomment-6644515",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/1529",
    "id": 6644515,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NDQ1MTU=",
    "user": {
      "login": "nicolashery",
      "id": 1306536,
      "node_id": "MDQ6VXNlcjEzMDY1MzY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1306536?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nicolashery",
      "html_url": "https://github.com/nicolashery",
      "followers_url": "https://api.github.com/users/nicolashery/followers",
      "following_url": "https://api.github.com/users/nicolashery/following{/other_user}",
      "gists_url": "https://api.github.com/users/nicolashery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nicolashery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nicolashery/subscriptions",
      "organizations_url": "https://api.github.com/users/nicolashery/orgs",
      "repos_url": "https://api.github.com/users/nicolashery/repos",
      "events_url": "https://api.github.com/users/nicolashery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nicolashery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-06-28T23:19:48Z",
    "updated_at": "2012-06-28T23:21:12Z",
    "author_association": "NONE",
    "body": "Haha well done! I didn't know we were racing ;)\n\nYeah didn't get a chance to work on it as much as I wanted. But I did spot:\n- xlrd accepts path or bytes (coming from file.read())\n  https://github.com/python-excel/xlrd/blob/master/xlrd/__init__.py#L385\n- openpyxl accepts path or `file` object (not file-like, has to be an instance of `file`, which is kind of limitting..)\n  https://github.com/chronossc/openpyxl/blob/master/openpyxl/reader/excel.py#L43\n\nI also saw that xlrd was going to support Excel 2007 in future versions, I don't know what you want to do about that, ie keep using both, or switch to only xlrd.\n\nI didn't know about `tempfile` (nice trick!). I was going to just feed xlrd the bytes from file.read(), but that wouldn't work for openpyxl. I also had put together a function to check what type of Excel file it is, inspired with how the master branch of xlrd does it:\n\n``` python\ndef _excel_type(filepath_or_buffer):\n    # Thanks to xlrd for this\n    peeksz = 4\n    if isinstance(filepath_or_buffer, str):\n        f = open(filepath_or_buffer, \"rb\")\n        peek = f.read(peeksz)\n        f.close()\n    elif hasattr(filepath_or_buffer, 'read') \\\n            and hasattr(filepath_or_buffer, 'seek'):\n        f = filepath_or_buffer\n        peek = f.read(peeksz)\n        f.seek(0)\n    else:\n        raise TypeError(\"You must provide the path to a file \"\n                        \"or a file-like object\")\n    # Check if ZIP file\n    if peek == \"PK\\x03\\x04\" \\\n        or peek == \"PK\\x03\\x04\".encode('latin1'): # Python 3\n        return 'xlsx'\n    else:\n        return 'xls'\n```\n\nThen I would've checked the type (and I like your way of checking for file-like, ie needs a `read` method, possibly a `seek` too, this way it works with \"file objects\" coming from Flask HTTP uploads, or MongoDB GridFS..), and done:\n\n``` python\nwb = xlrd.open_workbook(filename=filename)\n# or\nf = open(filename, 'rb')\nbytes = f.read()\nf.close()\nwb = xlrd.open_workbook(file_contents=bytes)\n```\n\nI guess the only advantage there is it saves having to use a tempfile and an I/O trip to the disk. But your solution has the advantage that it just _works_, and also is compatible with openpyxl.\n\nThanks for taking the time!\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/6644526",
    "html_url": "https://github.com/pandas-dev/pandas/issues/1529#issuecomment-6644526",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/1529",
    "id": 6644526,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NDQ1MjY=",
    "user": {
      "login": "wesm",
      "id": 329591,
      "node_id": "MDQ6VXNlcjMyOTU5MQ==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/329591?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wesm",
      "html_url": "https://github.com/wesm",
      "followers_url": "https://api.github.com/users/wesm/followers",
      "following_url": "https://api.github.com/users/wesm/following{/other_user}",
      "gists_url": "https://api.github.com/users/wesm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wesm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wesm/subscriptions",
      "organizations_url": "https://api.github.com/users/wesm/orgs",
      "repos_url": "https://api.github.com/users/wesm/repos",
      "events_url": "https://api.github.com/users/wesm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wesm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-06-28T23:21:10Z",
    "updated_at": "2012-06-28T23:21:10Z",
    "author_association": "MEMBER",
    "body": "Ah, well you put in more effort on figuring it out than I did. We should return to this at some point and improve the solution, maybe once xlrd/openpyxl have settled down a bit\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/6644539",
    "html_url": "https://github.com/pandas-dev/pandas/issues/1529#issuecomment-6644539",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/1529",
    "id": 6644539,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NDQ1Mzk=",
    "user": {
      "login": "nicolashery",
      "id": 1306536,
      "node_id": "MDQ6VXNlcjEzMDY1MzY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1306536?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nicolashery",
      "html_url": "https://github.com/nicolashery",
      "followers_url": "https://api.github.com/users/nicolashery/followers",
      "following_url": "https://api.github.com/users/nicolashery/following{/other_user}",
      "gists_url": "https://api.github.com/users/nicolashery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nicolashery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nicolashery/subscriptions",
      "organizations_url": "https://api.github.com/users/nicolashery/orgs",
      "repos_url": "https://api.github.com/users/nicolashery/repos",
      "events_url": "https://api.github.com/users/nicolashery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nicolashery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-06-28T23:22:02Z",
    "updated_at": "2012-06-28T23:22:02Z",
    "author_association": "NONE",
    "body": "Agreed!\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/6645345",
    "html_url": "https://github.com/pandas-dev/pandas/issues/1529#issuecomment-6645345",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/1529",
    "id": 6645345,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NDUzNDU=",
    "user": {
      "login": "wesm",
      "id": 329591,
      "node_id": "MDQ6VXNlcjMyOTU5MQ==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/329591?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wesm",
      "html_url": "https://github.com/wesm",
      "followers_url": "https://api.github.com/users/wesm/followers",
      "following_url": "https://api.github.com/users/wesm/following{/other_user}",
      "gists_url": "https://api.github.com/users/wesm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wesm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wesm/subscriptions",
      "organizations_url": "https://api.github.com/users/wesm/orgs",
      "repos_url": "https://api.github.com/users/wesm/repos",
      "events_url": "https://api.github.com/users/wesm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wesm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-06-29T00:15:10Z",
    "updated_at": "2012-06-29T00:15:10Z",
    "author_association": "MEMBER",
    "body": "OK I refactored to not use a tempfile, a StringIO for openpyxl and passing file_contents to xlrd\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/6645657",
    "html_url": "https://github.com/pandas-dev/pandas/issues/1529#issuecomment-6645657",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/1529",
    "id": 6645657,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NDU2NTc=",
    "user": {
      "login": "nicolashery",
      "id": 1306536,
      "node_id": "MDQ6VXNlcjEzMDY1MzY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1306536?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nicolashery",
      "html_url": "https://github.com/nicolashery",
      "followers_url": "https://api.github.com/users/nicolashery/followers",
      "following_url": "https://api.github.com/users/nicolashery/following{/other_user}",
      "gists_url": "https://api.github.com/users/nicolashery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nicolashery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nicolashery/subscriptions",
      "organizations_url": "https://api.github.com/users/nicolashery/orgs",
      "repos_url": "https://api.github.com/users/nicolashery/repos",
      "events_url": "https://api.github.com/users/nicolashery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nicolashery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-06-29T00:40:25Z",
    "updated_at": "2012-06-29T00:40:25Z",
    "author_association": "NONE",
    "body": "https://github.com/pydata/pandas/commit/acb5f03d4bd89ede5d54849d88453299a2c3819a\nGreat! I think that's better :)\n\nJust a couple small things:\n- you might have 'kind' as a parameter still in your doctring, but you didn't end up using it, might want to take it out to avoid confusion?\n- I'm guessing the answer is yes, but did you test the `BytesIO` with openpyxl? Does the `ZipFile` constructor, which they use, accept a buffer?\n\nThanks\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/7886798",
    "html_url": "https://github.com/pandas-dev/pandas/issues/1529#issuecomment-7886798",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/1529",
    "id": 7886798,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4ODY3OTg=",
    "user": {
      "login": "ludaavics",
      "id": 1891756,
      "node_id": "MDQ6VXNlcjE4OTE3NTY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1891756?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ludaavics",
      "html_url": "https://github.com/ludaavics",
      "followers_url": "https://api.github.com/users/ludaavics/followers",
      "following_url": "https://api.github.com/users/ludaavics/following{/other_user}",
      "gists_url": "https://api.github.com/users/ludaavics/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ludaavics/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ludaavics/subscriptions",
      "organizations_url": "https://api.github.com/users/ludaavics/orgs",
      "repos_url": "https://api.github.com/users/ludaavics/repos",
      "events_url": "https://api.github.com/users/ludaavics/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ludaavics/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2012-08-20T23:16:04Z",
    "updated_at": "2012-08-20T23:16:04Z",
    "author_association": "NONE",
    "body": "sweet\n"
  }
]
