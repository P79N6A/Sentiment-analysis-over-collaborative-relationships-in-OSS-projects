[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/277372519",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15302#issuecomment-277372519",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15302",
    "id": 277372519,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NzM3MjUxOQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-03T21:53:37Z",
    "updated_at": "2017-02-03T21:53:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "We had a very similar issue, can't seem to find this now. But on windows, this is fixed I *think* in 0.19.2, but maybe 0.20.0. (still in dev)\r\n\r\ncan you try?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/277556985",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15302#issuecomment-277556985",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15302",
    "id": 277556985,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NzU1Njk4NQ==",
    "user": {
      "login": "rsheftel",
      "id": 11539619,
      "node_id": "MDQ6VXNlcjExNTM5NjE5",
      "avatar_url": "https://avatars3.githubusercontent.com/u/11539619?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rsheftel",
      "html_url": "https://github.com/rsheftel",
      "followers_url": "https://api.github.com/users/rsheftel/followers",
      "following_url": "https://api.github.com/users/rsheftel/following{/other_user}",
      "gists_url": "https://api.github.com/users/rsheftel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rsheftel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rsheftel/subscriptions",
      "organizations_url": "https://api.github.com/users/rsheftel/orgs",
      "repos_url": "https://api.github.com/users/rsheftel/repos",
      "events_url": "https://api.github.com/users/rsheftel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rsheftel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-05T22:54:03Z",
    "updated_at": "2017-02-05T22:54:03Z",
    "author_association": "NONE",
    "body": "I tried with 0.19.2 and the problem remains. When 0.20.0 becomes available on one of my systems I will give that a try."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/277696719",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15302#issuecomment-277696719",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15302",
    "id": 277696719,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NzY5NjcxOQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-06T14:26:07Z",
    "updated_at": "2017-02-06T14:26:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "I thought this was solved, but was able to repro on windows.\r\n\r\nSo it seems that we are not closing on calling a ``date_parser`` function (we raise, but the top-level needs a try/finally around this to close the handle). We do this for other errors, this must have been missed.\r\n\r\n@rsheftel would you like to do a pull-request to fix?\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/277823123",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15302#issuecomment-277823123",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15302",
    "id": 277823123,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NzgyMzEyMw==",
    "user": {
      "login": "rsheftel",
      "id": 11539619,
      "node_id": "MDQ6VXNlcjExNTM5NjE5",
      "avatar_url": "https://avatars3.githubusercontent.com/u/11539619?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rsheftel",
      "html_url": "https://github.com/rsheftel",
      "followers_url": "https://api.github.com/users/rsheftel/followers",
      "following_url": "https://api.github.com/users/rsheftel/following{/other_user}",
      "gists_url": "https://api.github.com/users/rsheftel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rsheftel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rsheftel/subscriptions",
      "organizations_url": "https://api.github.com/users/rsheftel/orgs",
      "repos_url": "https://api.github.com/users/rsheftel/repos",
      "events_url": "https://api.github.com/users/rsheftel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rsheftel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-06T21:42:22Z",
    "updated_at": "2017-02-06T21:42:22Z",
    "author_association": "NONE",
    "body": "I don't think I am enough of an expert in the pandas code to submit a change that fixes this. Do you want me to just create a blank pull-request? (Sorry I'm new to the GitHub / collaborative world and how exactly it works)"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/277824362",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15302#issuecomment-277824362",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15302",
    "id": 277824362,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NzgyNDM2Mg==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-06T21:47:00Z",
    "updated_at": "2017-02-06T21:47:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "no this would be a regular pull-request that has tests and makes the change.\r\n\r\nhttp://pandas.pydata.org/pandas-docs/stable/contributing.html"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/279182769",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15302#issuecomment-279182769",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15302",
    "id": 279182769,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3OTE4Mjc2OQ==",
    "user": {
      "login": "rsheftel",
      "id": 11539619,
      "node_id": "MDQ6VXNlcjExNTM5NjE5",
      "avatar_url": "https://avatars3.githubusercontent.com/u/11539619?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rsheftel",
      "html_url": "https://github.com/rsheftel",
      "followers_url": "https://api.github.com/users/rsheftel/followers",
      "following_url": "https://api.github.com/users/rsheftel/following{/other_user}",
      "gists_url": "https://api.github.com/users/rsheftel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rsheftel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rsheftel/subscriptions",
      "organizations_url": "https://api.github.com/users/rsheftel/orgs",
      "repos_url": "https://api.github.com/users/rsheftel/repos",
      "events_url": "https://api.github.com/users/rsheftel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rsheftel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-11T23:12:27Z",
    "updated_at": "2017-02-11T23:12:27Z",
    "author_association": "NONE",
    "body": "If I gain expertise in the code base and feel I can confidently contribute I will. Thanks."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/282600697",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15302#issuecomment-282600697",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15302",
    "id": 282600697,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MjYwMDY5Nw==",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-27T00:09:47Z",
    "updated_at": "2017-02-27T00:10:20Z",
    "author_association": "MEMBER",
    "body": "I looked into this with the help of @faizanv and finally got to the bottom of what's happening in pandas, but I'm still trying to figure out what's happening in the C API.\r\n\r\nThe proximate cause of this issue is that when we're reading a standard CSV file from a user provided path, we open a file handle in C (using `fopen`) and do not close it if there's an exception.\r\n\r\nIf there's no exception (or we catch the exception) the file handle is closed by a call to `parser_free()` (which calls `del_file_source` -- this function contains a call to `fclose`) in `TextReader.__dealloc__`. `__dealloc__` is a special Cython method that more or less sits in the [`tp_dealloc`](https://docs.python.org/2/c-api/typeobj.html#c.PyTypeObject.tp_dealloc) slot of `PyTypeObject`s.\r\n\r\nIt's not clear to me why it gets called when we catch the exception versus when we don't."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/282601974",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15302#issuecomment-282601974",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15302",
    "id": 282601974,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MjYwMTk3NA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-27T00:27:55Z",
    "updated_at": "2017-02-27T00:27:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "hmm, I think we wrapped most/all of the calls for the low-level ``.read`` in try/excepts to do exactly this (in fact you get ResourceWarnings in py3 if you *don't* close things).\r\n\r\nAll that said @cpcloud something fishy is going on. maybe @gfyoung has an idea."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/282602026",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15302#issuecomment-282602026",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15302",
    "id": 282602026,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MjYwMjAyNg==",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-27T00:28:38Z",
    "updated_at": "2017-02-27T00:28:38Z",
    "author_association": "MEMBER",
    "body": "@jreback The issue is that Python knows nothing about any calls to `fopen` or `fclose`."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/282602225",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15302#issuecomment-282602225",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15302",
    "id": 282602225,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MjYwMjIyNQ==",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-27T00:31:38Z",
    "updated_at": "2017-02-27T00:31:38Z",
    "author_association": "MEMBER",
    "body": "We do something like this:\r\n\r\n```python\r\ntry:\r\n    rows = parser.read()\r\nfinally:\r\n    parser.close()\r\n```\r\nbut we don't track the file handle of files opened by the `parser_t*` related code so we only close it when `__dealloc__` is called. Since `__dealloc__` isn't called when there's an exception, the handle never closes."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/282603627",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15302#issuecomment-282603627",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15302",
    "id": 282603627,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MjYwMzYyNw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-27T00:49:44Z",
    "updated_at": "2017-02-27T00:49:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "you could try explicitly closing IN the actual parser when the .close method is called (ios do cleanup), but would prob have to set a flag so that you don't do it again in dealloc"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/282603983",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15302#issuecomment-282603983",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15302",
    "id": 282603983,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MjYwMzk4Mw==",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-27T00:54:26Z",
    "updated_at": "2017-02-27T00:54:26Z",
    "author_association": "MEMBER",
    "body": ":) Funny you mention that. That is my current working solution"
  }
]
