[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/453231013",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24696#issuecomment-453231013",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24696",
    "id": 453231013,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MzIzMTAxMw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-10T19:52:58Z",
    "updated_at": "2019-01-10T19:52:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "needs to be a self-contained reproducible example"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/453370177",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24696#issuecomment-453370177",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24696",
    "id": 453370177,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MzM3MDE3Nw==",
    "user": {
      "login": "Antsypc",
      "id": 9144627,
      "node_id": "MDQ6VXNlcjkxNDQ2Mjc=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/9144627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Antsypc",
      "html_url": "https://github.com/Antsypc",
      "followers_url": "https://api.github.com/users/Antsypc/followers",
      "following_url": "https://api.github.com/users/Antsypc/following{/other_user}",
      "gists_url": "https://api.github.com/users/Antsypc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Antsypc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Antsypc/subscriptions",
      "organizations_url": "https://api.github.com/users/Antsypc/orgs",
      "repos_url": "https://api.github.com/users/Antsypc/repos",
      "events_url": "https://api.github.com/users/Antsypc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Antsypc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-11T03:56:12Z",
    "updated_at": "2019-01-11T03:56:12Z",
    "author_association": "NONE",
    "body": "@jreback Here is a reproducible example that errors happened in my enviroment.\r\nVersions: `python 3.6.5`, `pandas 0.23.0`, `numpy 1.14.3`, `macOS 10.14.1`\r\n\r\n```\r\nfrom scipy.stats import zscore\r\nimport pandas as pd\r\nimport numpy as np\r\n\r\ndef generate_dataset(df_data, feature_name, continuous_range, normalize=True, time_step=3):\r\n    \"\"\"\r\n    Args:\r\n         df_data: DataFrame, shape=(20000, 61)\r\n         feature_name: list of string, length is 60\r\n         continuous_range: list of tuple (int, int), you can simply set it to [(0, 19990)]\r\n    \"\"\"\r\n    if normalize:\r\n        # modify every column by z-score normalization\r\n        df_data.loc[:, feature_name] = df_data[feature_name].apply(zscore)\r\n\r\n    feats = []  # list of ndarray, shape of ndarray is (time_step, 60)\r\n    for start, end in continuous_range:\r\n        for i in range(start, end - time_step + 1):\r\n            feats.append(df_data[feature_name].iloc[i: i + time_step].values)\r\n    return feats\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    _names = ['x_%s'%i for i in range(60)]\r\n    data = pd.DataFrame(np.random.randn(20000, 60), columns=_names)\r\n    generate_dataset(data, _names, [(0, 19990)])\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/453371161",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24696#issuecomment-453371161",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24696",
    "id": 453371161,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MzM3MTE2MQ==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-11T04:03:04Z",
    "updated_at": "2019-01-11T04:03:04Z",
    "author_association": "MEMBER",
    "body": "Have you isolated the issue to a particular line in your code? We typically ask for bug reports to be minimal so as to avoid time wasted on conflating factors"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/453371831",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24696#issuecomment-453371831",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24696",
    "id": 453371831,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MzM3MTgzMQ==",
    "user": {
      "login": "Antsypc",
      "id": 9144627,
      "node_id": "MDQ6VXNlcjkxNDQ2Mjc=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/9144627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Antsypc",
      "html_url": "https://github.com/Antsypc",
      "followers_url": "https://api.github.com/users/Antsypc/followers",
      "following_url": "https://api.github.com/users/Antsypc/following{/other_user}",
      "gists_url": "https://api.github.com/users/Antsypc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Antsypc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Antsypc/subscriptions",
      "organizations_url": "https://api.github.com/users/Antsypc/orgs",
      "repos_url": "https://api.github.com/users/Antsypc/repos",
      "events_url": "https://api.github.com/users/Antsypc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Antsypc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-11T04:07:57Z",
    "updated_at": "2019-01-11T04:07:57Z",
    "author_association": "NONE",
    "body": "@WillAyd In my code example above that I have tested, if I don't execute `df_data.loc[:, feature_name] = df_data[feature_name].apply(zscore)`, `feats.append()` works well. However as I modify `df_data.loc[:, feature_name] ` and do `feats.append()`, my disk space run out. "
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/453372665",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24696#issuecomment-453372665",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24696",
    "id": 453372665,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MzM3MjY2NQ==",
    "user": {
      "login": "Antsypc",
      "id": 9144627,
      "node_id": "MDQ6VXNlcjkxNDQ2Mjc=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/9144627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Antsypc",
      "html_url": "https://github.com/Antsypc",
      "followers_url": "https://api.github.com/users/Antsypc/followers",
      "following_url": "https://api.github.com/users/Antsypc/following{/other_user}",
      "gists_url": "https://api.github.com/users/Antsypc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Antsypc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Antsypc/subscriptions",
      "organizations_url": "https://api.github.com/users/Antsypc/orgs",
      "repos_url": "https://api.github.com/users/Antsypc/repos",
      "events_url": "https://api.github.com/users/Antsypc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Antsypc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-11T04:14:44Z",
    "updated_at": "2019-01-11T04:16:51Z",
    "author_association": "NONE",
    "body": "@WillAyd Actually, If I normalize `df_data` and save it to disk, then `pd.read_csv` without modification, just do `feats.append()`, disk space run out again. It's very weird. I cannot figure out why this is related to disk, I think all computaion in the memory. There should be nothing about disk stuff. Is that right?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/453374003",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24696#issuecomment-453374003",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24696",
    "id": 453374003,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MzM3NDAwMw==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-11T04:24:35Z",
    "updated_at": "2019-01-11T04:24:35Z",
    "author_association": "MEMBER",
    "body": "Not sure but that's also my point above. It's not entirely clear where the issue is in your code or if it even stems from pandas. \r\n\r\nIf you can remove any code elements not related to the particular issue would be extremely helpful"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/453378053",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24696#issuecomment-453378053",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24696",
    "id": 453378053,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MzM3ODA1Mw==",
    "user": {
      "login": "Antsypc",
      "id": 9144627,
      "node_id": "MDQ6VXNlcjkxNDQ2Mjc=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/9144627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Antsypc",
      "html_url": "https://github.com/Antsypc",
      "followers_url": "https://api.github.com/users/Antsypc/followers",
      "following_url": "https://api.github.com/users/Antsypc/following{/other_user}",
      "gists_url": "https://api.github.com/users/Antsypc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Antsypc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Antsypc/subscriptions",
      "organizations_url": "https://api.github.com/users/Antsypc/orgs",
      "repos_url": "https://api.github.com/users/Antsypc/repos",
      "events_url": "https://api.github.com/users/Antsypc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Antsypc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-11T04:52:15Z",
    "updated_at": "2019-01-11T04:52:15Z",
    "author_association": "NONE",
    "body": "@WillAyd I'm sorry for my expression. I'm not sure the error stems from pandas either.\r\n\r\nThe main code are line `df_data.loc[:, feature_name] = df_data[feature_name].apply(zscore)` and line `feats.append(df_data[feature_name].iloc[i: i + time_step].values)`.  Details what happened to these codes I explain above.\r\n\r\nSo far I think the error happen or not, it depends on np.ndarray in the pandas instance, it dosen't matter modify DataFrame or not. Maybe you can run it in your enviroment. My friends ran code example above for me, they also got the same error.\r\n\r\nHere are some test cases.\r\n- disk run out: `python 3.6.5`, `pandas 0.23.0`, `numpy 1.14.3`, `macOS 10.14.1`, `16G RAM`\r\n- disk run out: `python 3.6.5`, `pandas 0.23.0`, `numpy 1.14.3`, `windows 10`, `8G RAM`\r\n- OOM: `python 3.6.1`, `pandas 0.20.1`, `numpy 1.12.1`, `windows 10`, `8G RAM`\r\n- success, no memory error, no disk change: `python 3.7.1`, `pandas 0.23.4`, `numpy 1.15.4`, `centOS 7`, `256G RAM`"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/453581540",
    "html_url": "https://github.com/pandas-dev/pandas/issues/24696#issuecomment-453581540",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/24696",
    "id": 453581540,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MzU4MTU0MA==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-11T16:49:10Z",
    "updated_at": "2019-01-11T16:49:10Z",
    "author_association": "MEMBER",
    "body": "Going to close this as unfortunately there's nothing that really indicates a pandas error here (feel free to reopen if you can pinpoint). AFAICT you are continually generating rather large slices of your data frame in a loop, so it's certainly possible that your machine doesn't have the memory to contain all of those objects and flushes to disk.\r\n\r\nNot sure the end goal with the function you have but there may be a more holistic design approach you can consider to greatly reduce the memory footprint here and avoid running out of resources, totally agnostic to pandas"
  }
]
