[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/384209632",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20769#issuecomment-384209632",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20769",
    "id": 384209632,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDIwOTYzMg==",
    "user": {
      "login": "Mofef",
      "id": 1809396,
      "node_id": "MDQ6VXNlcjE4MDkzOTY=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1809396?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Mofef",
      "html_url": "https://github.com/Mofef",
      "followers_url": "https://api.github.com/users/Mofef/followers",
      "following_url": "https://api.github.com/users/Mofef/following{/other_user}",
      "gists_url": "https://api.github.com/users/Mofef/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Mofef/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Mofef/subscriptions",
      "organizations_url": "https://api.github.com/users/Mofef/orgs",
      "repos_url": "https://api.github.com/users/Mofef/repos",
      "events_url": "https://api.github.com/users/Mofef/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Mofef/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-25T08:44:42Z",
    "updated_at": "2018-04-25T08:44:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "No comment on this?\r\nIn the meanwhile i think my suggested hotfix is not sufficient.\r\n\r\nBut I get the expected behavior by using the following function to preprocess DataFrames with MultiIndex columns.\r\n```python\r\ndef replace_nan_in_column_names(df):\r\n    filtered_tuples = []\r\n    for tup in df.columns.tolist():\r\n        tup = tuple((s if not pd.isna(s) else \"\") for s in tup)\r\n        filtered_tuples.append(tup)\r\n    df.columns = pd.MultiIndex.from_tuples(filtered_tuples)\r\n```\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/471336225",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20769#issuecomment-471336225",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20769",
    "id": 471336225,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MTMzNjIyNQ==",
    "user": {
      "login": "lkugler",
      "id": 29361544,
      "node_id": "MDQ6VXNlcjI5MzYxNTQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/29361544?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lkugler",
      "html_url": "https://github.com/lkugler",
      "followers_url": "https://api.github.com/users/lkugler/followers",
      "following_url": "https://api.github.com/users/lkugler/following{/other_user}",
      "gists_url": "https://api.github.com/users/lkugler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lkugler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lkugler/subscriptions",
      "organizations_url": "https://api.github.com/users/lkugler/orgs",
      "repos_url": "https://api.github.com/users/lkugler/repos",
      "events_url": "https://api.github.com/users/lkugler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lkugler/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-10T19:30:25Z",
    "updated_at": "2019-03-10T19:32:25Z",
    "author_association": "NONE",
    "body": "I have a similar issue in python 3.7.1, pandas 0.24.1\r\n\r\n```\r\nimport numpy as np\r\nimport datetime as dt\r\nimport pandas as pd\r\nprint(pd.show_versions())\r\n\r\n# create two sample DataFrames\r\nt0 = dt.datetime(2019,1,1,0)\r\nt = [t0 + dt.timedelta(hours=i) for i in range(24)]\r\nobs = pd.DataFrame(index=t, data={'T': np.arange(len(t))})\r\nobs['valid'] = obs.index\r\nobs = pd.concat([obs], axis=1, keys=['obs'])\r\n\r\nidx = range(48)\r\nt1 = dt.datetime(2019,1,1,12)\r\nt_fcst = [t0 + dt.timedelta(hours=i) for i in range(24)] \\\r\n        + [t0 + dt.timedelta(hours=i) for i in range(24)]\r\nfcst = pd.DataFrame(index=idx, data={('ds1', 'T-mod'): np.arange(len(idx)),\r\n                                     ('metadata', 'valid'): t_fcst})\r\n\r\n# try to merge\r\nright_on=('obs', 'valid')\r\nleft_on = ('metadata', 'valid')\r\n\r\nout = pd.merge(fcst, obs, how='left', left_on=left_on, right_on=right_on)\r\n```\r\ngives me `ValueError: The column label 'obs' is not unique.\r\nFor a multi-index, the label must be a tuple with elements corresponding to each level.`\r\n\r\nThough 'obs' is clearly unique in the keys, which are:\r\n```\r\nMultiIndex(levels=[['ds1', 'metadata'], ['T-mod', 'valid']],\r\n           codes=[[0, 1], [0, 1]]) \r\nMultiIndex(levels=[['obs'], ['T', 'valid']],\r\n           codes=[[0, 0], [0, 1]])\r\n```\r\n\r\n<details>\r\n <summary>pd.show_versions()</summary>\r\ncommit: None\r\npython: 3.7.1.final.0\r\npython-bits: 64\r\nOS: Darwin\r\nOS-release: 18.2.0\r\nmachine: x86_64\r\nprocessor: i386\r\nbyteorder: little\r\nLC_ALL: de_AT.UTF-8\r\nLANG: de_AT.UTF-8\r\nLOCALE: de_AT.UTF-8\r\n\r\npandas: 0.24.1\r\npytest: None\r\npip: 18.1\r\nsetuptools: 40.6.3\r\nCython: None\r\nnumpy: 1.16.2\r\nscipy: 1.2.1\r\npyarrow: None\r\nxarray: None\r\nIPython: 7.3.0\r\nsphinx: 1.8.5\r\npatsy: 0.5.1\r\ndateutil: 2.8.0\r\npytz: 2018.9\r\nblosc: None\r\nbottleneck: None\r\ntables: None\r\nnumexpr: None\r\nfeather: None\r\nmatplotlib: 3.0.3\r\nopenpyxl: None\r\nxlrd: None\r\nxlwt: None\r\nxlsxwriter: None\r\nlxml.etree: None\r\nbs4: None\r\nhtml5lib: None\r\nsqlalchemy: None\r\npymysql: None\r\npsycopg2: None\r\njinja2: 2.10\r\ns3fs: None\r\nfastparquet: None\r\npandas_gbq: None\r\npandas_datareader: None\r\ngcsfs: None\r\nNone\r\n</details>\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/471349905",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20769#issuecomment-471349905",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20769",
    "id": 471349905,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MTM0OTkwNQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-10T21:20:22Z",
    "updated_at": "2019-03-10T21:20:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "``NaN` on an index level is not very well supported, and in general should be avoided. I suppose we would take a patch for this."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/476499768",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20769#issuecomment-476499768",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20769",
    "id": 476499768,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjQ5OTc2OA==",
    "user": {
      "login": "carlosxh",
      "id": 33222303,
      "node_id": "MDQ6VXNlcjMzMjIyMzAz",
      "avatar_url": "https://avatars2.githubusercontent.com/u/33222303?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/carlosxh",
      "html_url": "https://github.com/carlosxh",
      "followers_url": "https://api.github.com/users/carlosxh/followers",
      "following_url": "https://api.github.com/users/carlosxh/following{/other_user}",
      "gists_url": "https://api.github.com/users/carlosxh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/carlosxh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/carlosxh/subscriptions",
      "organizations_url": "https://api.github.com/users/carlosxh/orgs",
      "repos_url": "https://api.github.com/users/carlosxh/repos",
      "events_url": "https://api.github.com/users/carlosxh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/carlosxh/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-26T07:01:33Z",
    "updated_at": "2019-03-26T07:01:33Z",
    "author_association": "NONE",
    "body": "I got the same problem for py3.7... with pandas 0.24... , after reverted back to py 2.7... and pandas 0.20.2, everything is OK, no such error message with exactly same code and source data. "
  }
]
