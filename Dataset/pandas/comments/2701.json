[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/15321564",
    "html_url": "https://github.com/pandas-dev/pandas/issues/2701#issuecomment-15321564",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/2701",
    "id": 15321564,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MzIxNTY0",
    "user": {
      "login": "joeb1415",
      "id": 3384337,
      "node_id": "MDQ6VXNlcjMzODQzMzc=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/3384337?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/joeb1415",
      "html_url": "https://github.com/joeb1415",
      "followers_url": "https://api.github.com/users/joeb1415/followers",
      "following_url": "https://api.github.com/users/joeb1415/following{/other_user}",
      "gists_url": "https://api.github.com/users/joeb1415/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/joeb1415/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/joeb1415/subscriptions",
      "organizations_url": "https://api.github.com/users/joeb1415/orgs",
      "repos_url": "https://api.github.com/users/joeb1415/repos",
      "events_url": "https://api.github.com/users/joeb1415/events{/privacy}",
      "received_events_url": "https://api.github.com/users/joeb1415/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-03-22T21:07:50Z",
    "updated_at": "2013-03-22T21:07:50Z",
    "author_association": "NONE",
    "body": "Both to_excel and to_csv should allow a multiindex on the columns to print on multiple rows\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/15321951",
    "html_url": "https://github.com/pandas-dev/pandas/issues/2701#issuecomment-15321951",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/2701",
    "id": 15321951,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MzIxOTUx",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-03-22T21:17:25Z",
    "updated_at": "2013-03-22T21:17:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "I guess then read_csv would have to take a list for the header argument to reconstruct the mi\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/15323508",
    "html_url": "https://github.com/pandas-dev/pandas/issues/2701#issuecomment-15323508",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/2701",
    "id": 15323508,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1MzIzNTA4",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-03-22T21:56:41Z",
    "updated_at": "2013-03-22T21:56:41Z",
    "author_association": "NONE",
    "body": "#2478, this is already hiding in the codebase, just needs some TLC.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/24866544",
    "html_url": "https://github.com/pandas-dev/pandas/issues/2701#issuecomment-24866544",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/2701",
    "id": 24866544,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0ODY2NTQ0",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-21T17:07:54Z",
    "updated_at": "2013-09-21T17:07:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "@hayd @jtratner IIRC this should still be open, right?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/24869233",
    "html_url": "https://github.com/pandas-dev/pandas/issues/2701#issuecomment-24869233",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/2701",
    "id": 24869233,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0ODY5MjMz",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-21T19:38:28Z",
    "updated_at": "2013-09-21T19:38:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "yes, definitely.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/28147746",
    "html_url": "https://github.com/pandas-dev/pandas/issues/2701#issuecomment-28147746",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/2701",
    "id": 28147746,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MTQ3NzQ2",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-10T10:25:00Z",
    "updated_at": "2013-11-10T10:25:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think that has been fixed by #5423:\n\n``` python\nimport pandas as pd\n\nm = pd.MultiIndex.from_tuples([(1,1),(1,2)], names=['a','b'])\ndf = pd.DataFrame([[1,2],[3,4]], columns=m)\n\ndf.to_excel('test.xls')\n```\n\nOutput:\n\n![screenshot](https://f.cloud.github.com/assets/94267/1508360/24a03d14-49f2-11e3-974f-fe80387cf1d6.png)\n\nCan we close this?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/297816758",
    "html_url": "https://github.com/pandas-dev/pandas/issues/2701#issuecomment-297816758",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/2701",
    "id": 297816758,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5NzgxNjc1OA==",
    "user": {
      "login": "mappingvermont",
      "id": 5845672,
      "node_id": "MDQ6VXNlcjU4NDU2NzI=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/5845672?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mappingvermont",
      "html_url": "https://github.com/mappingvermont",
      "followers_url": "https://api.github.com/users/mappingvermont/followers",
      "following_url": "https://api.github.com/users/mappingvermont/following{/other_user}",
      "gists_url": "https://api.github.com/users/mappingvermont/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mappingvermont/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mappingvermont/subscriptions",
      "organizations_url": "https://api.github.com/users/mappingvermont/orgs",
      "repos_url": "https://api.github.com/users/mappingvermont/repos",
      "events_url": "https://api.github.com/users/mappingvermont/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mappingvermont/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-04-27T19:34:43Z",
    "updated_at": "2017-04-27T19:34:43Z",
    "author_association": "NONE",
    "body": "Hi all,\r\n\r\nI'm trying to write a multiindex dataframe to Excel using the example above, and not getting the same results.\r\n\r\nCode:\r\n```\r\nimport pandas as pd\r\n\r\nm = pd.MultiIndex.from_tuples([(1,1),(1,2)], names=['a','b'])\r\ndf = pd.DataFrame([[1,2],[3,4]], columns=m)\r\n\r\ndf.to_excel('test.xls')\r\n```\r\n\r\nOutput:\r\n![capture](https://cloud.githubusercontent.com/assets/5845672/25500862/9c16c132-2b5e-11e7-9247-c06837b2da1d.PNG)\r\n\r\nThere's an extra line being added-- different than the output generated above. \r\n\r\nI'm using pandas version 0.19.2 on Ubuntu 14.04 and have also experienced this on Windows 10. I've tried this using pandas version 0.15.0 and it works properly, replicating the output above:\r\n\r\n![image](https://cloud.githubusercontent.com/assets/5845672/25500972/ff4a90e4-2b5e-11e7-9848-aa8ddad3ed0c.png)\r\n\r\nIs this a bug? And if so, can we re-open this issue?\r\n\r\nThanks,\r\n\r\nCharlie\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/316208635",
    "html_url": "https://github.com/pandas-dev/pandas/issues/2701#issuecomment-316208635",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/2701",
    "id": 316208635,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxNjIwODYzNQ==",
    "user": {
      "login": "jd901215",
      "id": 3971276,
      "node_id": "MDQ6VXNlcjM5NzEyNzY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/3971276?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jd901215",
      "html_url": "https://github.com/jd901215",
      "followers_url": "https://api.github.com/users/jd901215/followers",
      "following_url": "https://api.github.com/users/jd901215/following{/other_user}",
      "gists_url": "https://api.github.com/users/jd901215/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jd901215/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jd901215/subscriptions",
      "organizations_url": "https://api.github.com/users/jd901215/orgs",
      "repos_url": "https://api.github.com/users/jd901215/repos",
      "events_url": "https://api.github.com/users/jd901215/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jd901215/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-07-18T21:50:26Z",
    "updated_at": "2017-07-18T21:50:26Z",
    "author_association": "NONE",
    "body": "@mappingvermont I'm getting the same result with a real example. I think it is a bug. Using latest version pandas 0.19.2"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/339327297",
    "html_url": "https://github.com/pandas-dev/pandas/issues/2701#issuecomment-339327297",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/2701",
    "id": 339327297,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzOTMyNzI5Nw==",
    "user": {
      "login": "ronanpaixao",
      "id": 7624997,
      "node_id": "MDQ6VXNlcjc2MjQ5OTc=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/7624997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ronanpaixao",
      "html_url": "https://github.com/ronanpaixao",
      "followers_url": "https://api.github.com/users/ronanpaixao/followers",
      "following_url": "https://api.github.com/users/ronanpaixao/following{/other_user}",
      "gists_url": "https://api.github.com/users/ronanpaixao/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ronanpaixao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ronanpaixao/subscriptions",
      "organizations_url": "https://api.github.com/users/ronanpaixao/orgs",
      "repos_url": "https://api.github.com/users/ronanpaixao/repos",
      "events_url": "https://api.github.com/users/ronanpaixao/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ronanpaixao/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-25T13:20:39Z",
    "updated_at": "2017-10-25T13:20:39Z",
    "author_association": "NONE",
    "body": "@jreback Can this be reopened? I also get this problem.\r\n\r\nI've commented this on #6618, which seems related. From what I can see, the problem is that pandas is reserving the first column of the header rows to the MultiIndex, and creates a new line for the row index name even if it is unnamed:\r\n\r\n```python\r\n>>> df = pd.DataFrame([[1,2,3],[4,5,6]], columns=pd.MultiIndex.from_tuples([('A'\r\n,''),('B','C'),('B','D')]))\r\n>>> df.to_excel(\"out.xlsx\", index_label=\"Foo\")\r\n```\r\n![pandas_to_excel_bug2](https://user-images.githubusercontent.com/7624997/32000465-2fccaddc-b96d-11e7-9049-2834500a9f9f.png)\r\n\r\nThis bug was fixed some time ago for simple columns, but it was probably not a very good solution, since it is still buggy for MultiIndex columns:\r\n```python\r\n>>> df = pd.DataFrame([[1,2,3],[4,5,6]], columns=['A','B','C'])\r\n>>> df.to_excel(\"out.xlsx\", index_label=\"Foo\")\r\n```\r\n![pandas_to_excel_bug3](https://user-images.githubusercontent.com/7624997/32000632-aeefea70-b96d-11e7-80b8-244e2931624f.png)\r\n\r\nVersion information:\r\n\r\n```\r\n>>> pd.show_versions()\r\n\r\nINSTALLED VERSIONS\r\n------------------\r\ncommit: None\r\npython: 3.6.1.final.0\r\npython-bits: 32\r\nOS: Windows\r\nOS-release: 7\r\nmachine: AMD64\r\nprocessor: Intel64 Family 6 Model 42 Stepping 7, GenuineIntel\r\nbyteorder: little\r\nLC_ALL: None\r\nLANG: None\r\nLOCALE: None.None\r\n\r\npandas: 0.20.1\r\npytest: 3.0.7\r\npip: 9.0.1\r\nsetuptools: 27.2.0\r\nCython: 0.25.2\r\nnumpy: 1.12.1\r\nscipy: 0.19.0\r\nxarray: None\r\nIPython: 5.3.0\r\nsphinx: 1.5.6\r\npatsy: 0.4.1\r\ndateutil: 2.6.0\r\npytz: 2017.2\r\nblosc: None\r\nbottleneck: 1.2.1\r\ntables: 3.2.2\r\nnumexpr: 2.6.2\r\nfeather: None\r\nmatplotlib: 2.0.2\r\nopenpyxl: 2.4.7\r\nxlrd: 1.0.0\r\nxlwt: 1.2.0\r\nxlsxwriter: 0.9.6\r\nlxml: 3.7.3\r\nbs4: 4.6.0\r\nhtml5lib: 0.999\r\nsqlalchemy: 1.1.9\r\npymysql: None\r\npsycopg2: None\r\njinja2: 2.9.6\r\ns3fs: None\r\npandas_gbq: None\r\npandas_datareader: None\r\n```\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/421489466",
    "html_url": "https://github.com/pandas-dev/pandas/issues/2701#issuecomment-421489466",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/2701",
    "id": 421489466,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMTQ4OTQ2Ng==",
    "user": {
      "login": "Tangjiahui26",
      "id": 31683745,
      "node_id": "MDQ6VXNlcjMxNjgzNzQ1",
      "avatar_url": "https://avatars0.githubusercontent.com/u/31683745?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Tangjiahui26",
      "html_url": "https://github.com/Tangjiahui26",
      "followers_url": "https://api.github.com/users/Tangjiahui26/followers",
      "following_url": "https://api.github.com/users/Tangjiahui26/following{/other_user}",
      "gists_url": "https://api.github.com/users/Tangjiahui26/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Tangjiahui26/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Tangjiahui26/subscriptions",
      "organizations_url": "https://api.github.com/users/Tangjiahui26/orgs",
      "repos_url": "https://api.github.com/users/Tangjiahui26/repos",
      "events_url": "https://api.github.com/users/Tangjiahui26/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Tangjiahui26/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-14T21:29:21Z",
    "updated_at": "2018-09-14T21:29:21Z",
    "author_association": "NONE",
    "body": "@jreback still got the same problem for the multi-index, wish this issue can be reopened."
  }
]
