[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/22494059",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-22494059",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 22494059,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyNDk0MDU5",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-08-12T13:48:45Z",
    "updated_at": "2013-08-12T13:48:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "gr8!\n\ncould certainly be added as an optional deps see http://pandas.pydata.org/pandas-docs/dev/install.html#optional-dependencies; and could try in preference (if installed) over other writer libraries, then fallback to others (if installed)\n\nyou may need to rework the infrastructure a bit to do this,\n\ne.g. at the top of the file various imports should be tried (see `io/html.py` for how this is done).\n\nthen the writers should take a list of `writers`? to try in sequence (else will finally raise if nothing is installed)\n\nlmk if you need help\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/22494177",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-22494177",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 22494177,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyNDk0MTc3",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-08-12T13:50:16Z",
    "updated_at": "2013-08-12T13:50:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "pls hook up travis as well; you will also need to add your library to `ci/requirements-???` for testing (you can add to all if you want), with a version specified (if you have multiple versions then you can do that too)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/22495873",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-22495873",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 22495873,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyNDk1ODcz",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-08-12T14:15:02Z",
    "updated_at": "2013-08-12T14:15:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "as a side issue; people have been thinking about how to pass formatting info to excel via these writers; either via some kind of dict or a `Style` type of object (generally per column, though could in theory be per cell), any thoughts on this?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/22495909",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-22495909",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 22495909,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyNDk1OTA5",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-08-12T14:15:28Z",
    "updated_at": "2013-08-12T14:15:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "> you may need to rework the infrastructure a bit to do this,\n\nI'll try to make the changes as noninvasive as possible.\n\n> pls hook up travis as well; you will also need to add your library to ci/requirements-???\n\nWill do. XlsxWriter [already uses Travis](https://travis-ci.org/jmcnamara/XlsxWriter/builds) so it shouldn't be too painful. I normally test locally with a range of Python 2/3 versions as well.\n\nJohn\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/22497615",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-22497615",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 22497615,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyNDk3NjE1",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-08-12T14:37:48Z",
    "updated_at": "2013-08-12T14:37:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "gr8!\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/23599267",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-23599267",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 23599267,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNTk5MjY3",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-08-31T02:40:11Z",
    "updated_at": "2013-08-31T02:40:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jmcnamara how's this going? Definitely interested in being able to hook up other writers to the core...Does ExcelWriter have the same API as openpyxl for saving excel files?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/23623720",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-23623720",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 23623720,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjIzNzIw",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-01T12:11:44Z",
    "updated_at": "2013-09-02T07:07:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jtratner, @jreback \n\n> how's this going?\n\nI made some initial progress getting XlsxWriter integrated and working, the code is on the [enh_xlsxwriter_dev](https://github.com/jmcnamara/pandas/tree/enh_xlsxwriter_dev) branch of my fork. For example the following now works using XlsxWriter:\n\n``` python\n    from pandas import ExcelWriter\n    from pandas import DataFrame\n\n    l1 = [1,2,3,4]\n    l2 = [1,2,3,4]\n    df1 = DataFrame({'Stimulus Time': l1, 'Reaction Time': l2})\n\n    writer = ExcelWriter('path_to_file2.xlsx', writer_options={'use_xlsxwriter': True})\n    df1.to_excel(writer, sheet_name='Sheet1', index=False)\n    writer.save()\n```\n\nDropping the optional `writer_options` parameter defaults back to OpenPyXL with similar results.\n\n> Definitely interested in being able to hook up other writers to the core\n\nI think it should be reasonably easy to plug in other writers as well. The required API changes would be minor and backward compatible: basically the additional dict of options for the underlying Excel writer (shown above).\n\nI'll try to get it to a more complete state in the next week, with tests, so you review it properly and let me know if you think it will fit in with the current code.\n\n> Does ExcelWriter have the same API as openpyxl for saving excel files?\n\nIt's API and scope is closer to Xlwt, i.e., it only creates new files and doesn't it doesn't rewrite files (although that could be simulated via the existing Pandas Excel reading functionality). In terms of functionality and features XlsxWriter goes beyond Xlwt or OpenPyXL and opens the possibility for [adding charts, images, autofilters and conditional formatting](https://xlsxwriter.readthedocs.org/en/latest/index.html) as Pandas Excel writer options.\n\nHowever, I need to do a bit more integration work first. :-)\n\nIt should also be about 10x faster than OpenPyXL for large files. However, to get that performance the cells would have to be written in row order. Currently in `format.py` they are handled in column order via `chain`:\n\n``` python\n    def get_formatted_cells(self):\n        for cell in itertools.chain(self._format_header(), self._format_body()\n                                    ):\n            cell.val = self._format_value(cell.val)\n            yield cell\n```\n\nWould it be acceptable to convert this, and associated header handling functions, to row order via `izip_longest()` or some similar iterator?\n\nWithout it XlsxWriter should still be 5x faster than OpenPyXL but would consume a similar (large) amount of memory for large files. There in some background on this, if you are interested, in the [Working with Memory and Performance](https://xlsxwriter.readthedocs.org/en/latest/working_with_memory.html) section of the XlsxsWriter docs.\n\nAnyway, I'll try push some more complete code for you and the others to look at in the next week.\n\nJohn.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/23623992",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-23623992",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 23623992,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjIzOTky",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-01T12:31:32Z",
    "updated_at": "2013-09-01T12:32:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jmcnamara I would like to see an API more like this\n\n`df.to_excel(path_or_buf, sheet_name, engine='openpyxl|xlsxwriter'...., .....)`\nadditional options can be passed directly to the engine if needed (as kwargs)\n\nand can default the engine (and possible use `get_option('io.excel.default_engine=....')`\n\nthe last bit is actually easy to set up see: https://github.com/pydata/pandas/blob/master/pandas/io/pytables.py#L170\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/23624317",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-23624317",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 23624317,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjI0MzE3",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-01T12:53:05Z",
    "updated_at": "2013-09-01T12:53:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jmcnamara sounds good - it's definitely not a problem to go in row order vs. column order - I wouldn't know (without looking back at the history of the code) whether that was an explicit decision or not anyways. 5x speedup is absolutely non-trivial, so making a change to enable that is definitely a good thing.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/23632813",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-23632813",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 23632813,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjMyODEz",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-01T20:49:22Z",
    "updated_at": "2013-09-01T20:49:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jreback \n\nI changed the API to `engine=`, added a default via the config handler and wrote some tests. The initial code is on my fork/branch.\n\nIn terms of the config it will probably need two items since the user may not be using the same engine for reading and writing. How about something like:\n\n```\nget_option('io.excel.writer_engine=....')\nget_option('io.excel.reader_engine=....')\n```\n\nJohn\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/23636006",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-23636006",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 23636006,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjM2MDA2",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-02T00:08:05Z",
    "updated_at": "2013-09-02T00:08:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jmcnamara pls make sure to hook up Travis\nand you will need to update the ci/requirements file to make sure that the xlsxwriter is downloaded\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/23636530",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-23636530",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 23636530,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjM2NTMw",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-02T00:39:35Z",
    "updated_at": "2013-09-02T01:01:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jmcnamara one thing that would be nice would be to, instead of hard coding the engine, just create the format like: `'_init_%s' % engine` and then check whether the engine exists on the class (so it's simple to bind new methods to the class and hook into the writer). The init method should take the path, so it could raise an error about getting an `.xls` file. (in fact, you could call like `_init_blah(path, **engine_kwargs)`).  I think it shouldn't require too much effort to run it that way (basically just extending the setup you already have).\n\nYou could do something like:\n\n``` python\nclass _UnsupportedFileTypeError(Exception):\n    pass\n\n# __init__ method for ExcelWriter/\n\ndef __init__(self, path, engine=None, **engine_kwargs):\n\n    if engine is None:\n        engine = config.get_option('io.excel.engine')\n\n    try:\n        method = getattr(self, \"_init_%s\" % engine)\n    except AttributeError:\n        raise ValueError(\"No engine: %s\" % engine)\n    try:\n        method(path, **engine_kwargs)\n    except _UnsupportedFileTypeError:\n        self._init_standard(path, **engine_kwargs)\n```\n\nand then the individual engines handle the rest of the setup. (like setting up the workbook, etc.).  If this seems too complicated, then we can always do it later after you've added in xlsxwriter and worked through the various issues with adding a new engine.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/23643944",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-23643944",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 23643944,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjQzOTQ0",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-02T07:12:20Z",
    "updated_at": "2013-09-02T07:12:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jreback \n\n> make sure to hook up Travis and you will need to update the ci/requirements file to make sure that the xlsxwriter is downloaded\n\n[Already done](https://travis-ci.org/jmcnamara/pandas) in both cases. :-)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/23659338",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-23659338",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 23659338,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjU5MzM4",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-02T13:09:45Z",
    "updated_at": "2013-09-02T13:09:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jmcnamara did you send this as a PR? (or its just on your branch atm?)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/23660056",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-23660056",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 23660056,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjYwMDU2",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-02T13:24:34Z",
    "updated_at": "2013-09-02T13:24:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jreback \n\nI haven't sent a PR. I am a few days work away from that as yet.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/23707856",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-23707856",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 23707856,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNzA3ODU2",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-03T12:09:58Z",
    "updated_at": "2013-09-03T13:12:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jtratner \n\n> one thing that would be nice would be to, instead of hard coding the engine, just create the format like\n\nThat is a good suggestion. It makes it more generic and easier to add other engines. I also made the same change in another place.\n\nI omitted the `_UnsupportedFileTypeError` part however since the `xlwt` and `openpyxl` called methods don't throw any exception.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/23708453",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-23708453",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 23708453,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNzA4NDUz",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-03T12:23:19Z",
    "updated_at": "2013-09-03T22:54:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jreback @jtratner \n\nThe code is getting close to a PR. I'll rebase/squash it onto another branch prior to that so that the merge is only one commit. I still have a bit more to add first but any comments on the existing code are welcome.\n\nI wrote 28 `xlsxwriter` specific tests and added `xlsxwriter` variations of all of the existing `openpyxl` tests.\n\nHere are some initial benchmark figures for the three supported writer modules:\n\n```\n$ python xltime.py 100\nEngine = openpyxl   Rows =    100 time =   0.12\nEngine = xlsxwriter Rows =    100 time =   0.02\nEngine = xlwt       Rows =    100 time =   0.03\n\n$ python xltime.py 1000\nEngine = openpyxl   Rows =   1000 time =   0.61\nEngine = xlsxwriter Rows =   1000 time =   0.14\nEngine = xlwt       Rows =   1000 time =   0.12\n\n$ python xltime.py 10000\nEngine = openpyxl   Rows =  10000 time =   5.60\nEngine = xlsxwriter Rows =  10000 time =   1.07\nEngine = xlwt       Rows =  10000 time =   0.94\n\n$ python xltime.py 50000\nEngine = openpyxl   Rows =  50000 time =  26.80\nEngine = xlsxwriter Rows =  50000 time =   4.89\nEngine = xlwt       Rows =  50000 time =   4.40\n\n$ python xltime.py 100000\nEngine = openpyxl   Rows = 100000 time =  54.53\nEngine = xlsxwriter Rows = 100000 time =  10.21\n\n# xlwt and the xls format only supports 64,000 rows.\n```\n\nHere is the simple-minded benchmark program:\n\n``` python\n\n# Simple Benchmark test for the Pandas Excel writer modules.\nimport sys\nfrom time import clock\nfrom pandas import DataFrame\nfrom pandas.core import config\nimport numpy as np\n\n\n# Get the number of rows to test.\nif len(sys.argv) > 1:\n    row_max = int(sys.argv[1])\nelse:\n    row_max = 1000\n\n\n# Time the Excel writer modules.\ndef time_excel_engine(df, engine):\n\n    filename = 'test_%s.xlsx' % engine\n    config.set_option('io.excel.writer_engine', engine)\n\n    start_time = clock()\n    df.to_excel(filename, sheet_name='Sheet1', index=False)\n    elapsed = clock() - start_time\n\n    print(\"Engine = %-10s Rows = %6d time = %6.2f\" % (engine, row_max, elapsed))\n\n\n# Create a dataframe to write out to Excel.\ndf = DataFrame(np.random.randn(row_max, 4), columns=['A', 'B', 'C', 'D'])\n\n# Time the modules.\ntime_excel_engine(df, 'openpyxl')\n\ntime_excel_engine(df, 'xlsxwriter')\n\nif row_max < 64000:\n    time_excel_engine(df, 'xlwt')\n\n```\n\nIf I can refactor the format.py code to use row order then we should be able to get a doubling of speed from `xlsxwriter`. \n\nAdding the [PyExcelerate](https://github.com/kz26/PyExcelerate) module as a writer would get another 50% on that and with the reworked `engine` architecture it should be easy to add that or other modules.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/23708876",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-23708876",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 23708876,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNzA4ODc2",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-03T12:31:51Z",
    "updated_at": "2013-09-03T12:31:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "you can put this in the form of a vbench\n\n I think you could try to create a vbench for this, nothing there now but create a file like  this: (named say excel): https://github.com/pydata/pandas/blob/master/vb_suite/ctors.py, and add it to the suite.py.\n\ntest using:\n\ntest_perf.sh -b <commit prior> -t <your last commit>\n\n(lots of options to test_perf, e.g. you might want to start all of the tests with excel_, then you can add the \n-r excel option to ONLY test thoses specific vbenches\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/280290806",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-280290806",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 280290806,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDI5MDgwNg==",
    "user": {
      "login": "aa3222119",
      "id": 17636366,
      "node_id": "MDQ6VXNlcjE3NjM2MzY2",
      "avatar_url": "https://avatars1.githubusercontent.com/u/17636366?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aa3222119",
      "html_url": "https://github.com/aa3222119",
      "followers_url": "https://api.github.com/users/aa3222119/followers",
      "following_url": "https://api.github.com/users/aa3222119/following{/other_user}",
      "gists_url": "https://api.github.com/users/aa3222119/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aa3222119/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aa3222119/subscriptions",
      "organizations_url": "https://api.github.com/users/aa3222119/orgs",
      "repos_url": "https://api.github.com/users/aa3222119/repos",
      "events_url": "https://api.github.com/users/aa3222119/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aa3222119/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-16T10:17:57Z",
    "updated_at": "2017-02-16T10:17:57Z",
    "author_association": "NONE",
    "body": "@jmcnamara  how to use pandas.to_excel(Write or maybe pandas.ExcelWriter) to add some data to an existed file , but not rewrite it??"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/465887716",
    "html_url": "https://github.com/pandas-dev/pandas/issues/4542#issuecomment-465887716",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4542",
    "id": 465887716,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NTg4NzcxNg==",
    "user": {
      "login": "ProsperousHeart",
      "id": 20706498,
      "node_id": "MDQ6VXNlcjIwNzA2NDk4",
      "avatar_url": "https://avatars3.githubusercontent.com/u/20706498?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ProsperousHeart",
      "html_url": "https://github.com/ProsperousHeart",
      "followers_url": "https://api.github.com/users/ProsperousHeart/followers",
      "following_url": "https://api.github.com/users/ProsperousHeart/following{/other_user}",
      "gists_url": "https://api.github.com/users/ProsperousHeart/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ProsperousHeart/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ProsperousHeart/subscriptions",
      "organizations_url": "https://api.github.com/users/ProsperousHeart/orgs",
      "repos_url": "https://api.github.com/users/ProsperousHeart/repos",
      "events_url": "https://api.github.com/users/ProsperousHeart/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ProsperousHeart/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-21T07:11:55Z",
    "updated_at": "2019-02-21T07:12:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "> @jmcnamara how to use pandas.to_excel(Write or maybe pandas.ExcelWriter) to add some data to an existed file , but not rewrite it??\r\n\r\nYou would have to [read it in](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_excel.html), make your changes, and print to the same filename."
  }
]
