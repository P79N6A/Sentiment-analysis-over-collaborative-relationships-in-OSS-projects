[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/56371656",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8349#issuecomment-56371656",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8349",
    "id": 56371656,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MzcxNjU2",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-22T13:24:17Z",
    "updated_at": "2014-09-22T13:24:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "The issue is that your aggregation function applied different to different columns,\n\nyour example will work if you do this:\n\n```\n(Pdb) p df.pivot_table(index=['JOB','NAME'],columns=['YEAR','MONTH'],values=['DAYS','SALARY'],aggfunc=sum,margins='mean')\n            DAYS              SALARY               \nYEAR        2013 2014     All   2013 2014       All\nMONTH         12    1   2         12    1    2     \nJOB    NAME                                        \nEmploy Mary    5   15   5  25     23  200  190  413\nWorker Bob     3   21   8  32     17  210   80  307\nAll            8   36  13  57     40  410  270  720\n(Pdb) p df.pivot_table(index=['JOB','NAME'],columns=['YEAR','MONTH'],values=['DAYS','SALARY'],aggfunc='mean',margins=True)\n            DAYS                      SALARY                             \nYEAR        2013  2014            All   2013        2014              All\nMONTH         12     1    2               12           1    2            \nJOB    NAME                                                              \nEmploy Mary    5  15.0  5.0  8.333333     23  200.000000  190  137.666667\nWorker Bob     3  10.5  8.0  8.000000     17  105.000000   80   76.750000\nAll            4  12.0  6.5  8.142857     20  136.666667  135  102.857143\n```\n\nSo right now this just silently bombs on the aggregation function (as its a dict) for the grand margins and then raises a later error.\n\nSo the choices are:\n- raise an earlier error that you can't use a multi-column aggregator (e.g. a dict)\n- allow margins per column (e.g. the row 'All'), but NOT the 'All' on the columns as that doesn't make sense since you have sum on one column and mean on another.\n\nSo calling this an error-reportng issue\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/56376251",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8349#issuecomment-56376251",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8349",
    "id": 56376251,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2Mzc2MjUx",
    "user": {
      "login": "RenzoBertocchi",
      "id": 8857606,
      "node_id": "MDQ6VXNlcjg4NTc2MDY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/8857606?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RenzoBertocchi",
      "html_url": "https://github.com/RenzoBertocchi",
      "followers_url": "https://api.github.com/users/RenzoBertocchi/followers",
      "following_url": "https://api.github.com/users/RenzoBertocchi/following{/other_user}",
      "gists_url": "https://api.github.com/users/RenzoBertocchi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RenzoBertocchi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RenzoBertocchi/subscriptions",
      "organizations_url": "https://api.github.com/users/RenzoBertocchi/orgs",
      "repos_url": "https://api.github.com/users/RenzoBertocchi/repos",
      "events_url": "https://api.github.com/users/RenzoBertocchi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RenzoBertocchi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-22T13:57:05Z",
    "updated_at": "2014-09-22T14:17:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "Ok but seems to works well if i change \"pandas/tools/pivot.py\"\n\nform:\n\n<pre>\n<code>\nif isinstance(aggfunc, compat.string_types):\n        grand_margin[k] = getattr(v, aggfunc)()\nelse: \n        grand_margin[k] = aggfunc(v)\n</code>\n</pre>\n\nto:\n\n<pre>\n<code>\nif isinstance(aggfunc, compat.string_types):\n     grand_margin[k] = getattr(v, aggfunc)()\nelif isinstance(aggfunc, compat.types.ObjectType):\n     if isinstance(aggfunc[k], compat.string_types):\n           grand_margin[k] = getattr(v, aggfunc[k])()\n     else:\n           grand_margin[k] = aggfunc[k](v)\nelse:\n     grand_margin[k] = aggfunc(v)\n</code>\n</pre>\n\nIs it not a solution?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/56379203",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8349#issuecomment-56379203",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8349",
    "id": 56379203,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2Mzc5MjAz",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-22T14:16:53Z",
    "updated_at": "2014-09-22T14:16:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think the grand margin is wrong no?\n\nWhy don't you show the output as you envision\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/56379814",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8349#issuecomment-56379814",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8349",
    "id": 56379814,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2Mzc5ODE0",
    "user": {
      "login": "RenzoBertocchi",
      "id": 8857606,
      "node_id": "MDQ6VXNlcjg4NTc2MDY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/8857606?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RenzoBertocchi",
      "html_url": "https://github.com/RenzoBertocchi",
      "followers_url": "https://api.github.com/users/RenzoBertocchi/followers",
      "following_url": "https://api.github.com/users/RenzoBertocchi/following{/other_user}",
      "gists_url": "https://api.github.com/users/RenzoBertocchi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RenzoBertocchi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RenzoBertocchi/subscriptions",
      "organizations_url": "https://api.github.com/users/RenzoBertocchi/orgs",
      "repos_url": "https://api.github.com/users/RenzoBertocchi/repos",
      "events_url": "https://api.github.com/users/RenzoBertocchi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RenzoBertocchi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-22T14:21:05Z",
    "updated_at": "2014-09-22T14:21:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "Seems good:\n\n<code>\n\ndf=df.pivot_table(index=['JOB','NAME'],columns=['YEAR','MONTH'],values=['DAYS','SALARY'],aggfunc={'DAYS':'mean','SALARY':'sum'},margins=True)\n\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr>\n      <th></th>\n      <th></th>\n      <th colspan=\"4\" halign=\"left\">SALARY</th>\n      <th colspan=\"4\" halign=\"left\">DAYS</th>\n    </tr>\n    <tr>\n      <th></th>\n      <th>YEAR</th>\n      <th>2013</th>\n      <th colspan=\"2\" halign=\"left\">2014</th>\n      <th>All</th>\n      <th>2013</th>\n      <th colspan=\"2\" halign=\"left\">2014</th>\n      <th>All</th>\n    </tr>\n    <tr>\n      <th></th>\n      <th>MONTH</th>\n      <th>12</th>\n      <th>1</th>\n      <th>2</th>\n      <th></th>\n      <th>12</th>\n      <th>1</th>\n      <th>2</th>\n      <th></th>\n    </tr>\n    <tr>\n      <th>JOB</th>\n      <th>NAME</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Employ</th>\n      <th>Mary</th>\n      <td> 23</td>\n      <td> 200</td>\n      <td> 190</td>\n      <td> 413</td>\n      <td> 5</td>\n      <td> 15.0</td>\n      <td> 5.0</td>\n      <td> 8.333333</td>\n    </tr>\n    <tr>\n      <th>Worker</th>\n      <th>Bob</th>\n      <td> 17</td>\n      <td> 210</td>\n      <td>  80</td>\n      <td> 307</td>\n      <td> 3</td>\n      <td> 10.5</td>\n      <td> 8.0</td>\n      <td> 8.000000</td>\n    </tr>\n    <tr>\n      <th>All</th>\n      <th></th>\n      <td> 40</td>\n      <td> 410</td>\n      <td> 270</td>\n      <td> 720</td>\n      <td> 4</td>\n      <td> 12.0</td>\n      <td> 6.5</td>\n      <td> 8.142857</td>\n    </tr>\n  </tbody>\n</table>\n\n</code>\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/56380571",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8349#issuecomment-56380571",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8349",
    "id": 56380571,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MzgwNTcx",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-22T14:25:52Z",
    "updated_at": "2014-09-22T14:25:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "hmm, yeh that looks ok.\n\npls submit a pull-request (with tests!)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/57151385",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8349#issuecomment-57151385",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8349",
    "id": 57151385,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTUxMzg1",
    "user": {
      "login": "RenzoBertocchi",
      "id": 8857606,
      "node_id": "MDQ6VXNlcjg4NTc2MDY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/8857606?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RenzoBertocchi",
      "html_url": "https://github.com/RenzoBertocchi",
      "followers_url": "https://api.github.com/users/RenzoBertocchi/followers",
      "following_url": "https://api.github.com/users/RenzoBertocchi/following{/other_user}",
      "gists_url": "https://api.github.com/users/RenzoBertocchi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RenzoBertocchi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RenzoBertocchi/subscriptions",
      "organizations_url": "https://api.github.com/users/RenzoBertocchi/orgs",
      "repos_url": "https://api.github.com/users/RenzoBertocchi/repos",
      "events_url": "https://api.github.com/users/RenzoBertocchi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RenzoBertocchi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-29T12:09:55Z",
    "updated_at": "2014-09-29T12:09:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "Pull-request done\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/57159897",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8349#issuecomment-57159897",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8349",
    "id": 57159897,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTU5ODk3",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-29T13:27:19Z",
    "updated_at": "2014-09-29T13:27:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "@RenzoBertocchi when the PR is merged this issue will be automatically closed.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/57337971",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8349#issuecomment-57337971",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8349",
    "id": 57337971,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MzM3OTcx",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-30T16:05:42Z",
    "updated_at": "2014-09-30T16:05:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "closed by #8354 \n"
  }
]
