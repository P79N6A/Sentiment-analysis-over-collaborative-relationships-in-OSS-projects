[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/259081251",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14613#issuecomment-259081251",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14613",
    "id": 259081251,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1OTA4MTI1MQ==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-08T08:59:32Z",
    "updated_at": "2016-11-08T08:59:32Z",
    "author_association": "MEMBER",
    "body": "What is exactly your question or the point you want to make? Do you want this not to fail?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/259088068",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14613#issuecomment-259088068",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14613",
    "id": 259088068,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1OTA4ODA2OA==",
    "user": {
      "login": "littlegreenbean33",
      "id": 18648417,
      "node_id": "MDQ6VXNlcjE4NjQ4NDE3",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18648417?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/littlegreenbean33",
      "html_url": "https://github.com/littlegreenbean33",
      "followers_url": "https://api.github.com/users/littlegreenbean33/followers",
      "following_url": "https://api.github.com/users/littlegreenbean33/following{/other_user}",
      "gists_url": "https://api.github.com/users/littlegreenbean33/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/littlegreenbean33/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/littlegreenbean33/subscriptions",
      "organizations_url": "https://api.github.com/users/littlegreenbean33/orgs",
      "repos_url": "https://api.github.com/users/littlegreenbean33/repos",
      "events_url": "https://api.github.com/users/littlegreenbean33/events{/privacy}",
      "received_events_url": "https://api.github.com/users/littlegreenbean33/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-08T09:31:11Z",
    "updated_at": "2016-11-08T09:31:11Z",
    "author_association": "NONE",
    "body": "Yes, I would expect HDF5 append to reflect the same behaviour as it has been implemented in pandas in 0.19. with regards to categories concat/append.\n\nThis should not fail. Maybe a feature for a future version.\n\nCheers\n\nJC\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/259115794",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14613#issuecomment-259115794",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14613",
    "id": 259115794,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1OTExNTc5NA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-08T11:43:36Z",
    "updated_at": "2016-11-08T11:43:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "this is not so easy to do and would require someone to step up and implement this\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/302641044",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14613#issuecomment-302641044",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14613",
    "id": 302641044,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjY0MTA0NA==",
    "user": {
      "login": "iipr",
      "id": 17690149,
      "node_id": "MDQ6VXNlcjE3NjkwMTQ5",
      "avatar_url": "https://avatars3.githubusercontent.com/u/17690149?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iipr",
      "html_url": "https://github.com/iipr",
      "followers_url": "https://api.github.com/users/iipr/followers",
      "following_url": "https://api.github.com/users/iipr/following{/other_user}",
      "gists_url": "https://api.github.com/users/iipr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iipr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iipr/subscriptions",
      "organizations_url": "https://api.github.com/users/iipr/orgs",
      "repos_url": "https://api.github.com/users/iipr/repos",
      "events_url": "https://api.github.com/users/iipr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iipr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-19T08:22:36Z",
    "updated_at": "2017-05-19T08:22:36Z",
    "author_association": "NONE",
    "body": "As of today, does anyone have any workaround or possible solution?\r\n\r\nI tried to create a dummy table that would contain all my categories, to later append the actual data, and finally drop the first _n_ rows that have the dummy data, but it didn't work. I get the same error:\r\n\r\n`ValueError: cannot append a categorical with different categories to the existing`"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/302678934",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14613#issuecomment-302678934",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14613",
    "id": 302678934,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjY3ODkzNA==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-19T11:29:59Z",
    "updated_at": "2017-05-19T11:29:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "@iipr issue is still open, if you're interested in submitting a fix. I don't believe anyone is working on this at the moment."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/302686983",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14613#issuecomment-302686983",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14613",
    "id": 302686983,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjY4Njk4Mw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-19T12:14:55Z",
    "updated_at": "2017-05-19T12:14:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "``union_categoricals`` does this, so its a matter of using this internally when appending. The key thing is that you cannot change existing code->label mappings as these are already written/coded."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/306810766",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14613#issuecomment-306810766",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14613",
    "id": 306810766,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNjgxMDc2Ng==",
    "user": {
      "login": "stoddardg",
      "id": 3533471,
      "node_id": "MDQ6VXNlcjM1MzM0NzE=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/3533471?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stoddardg",
      "html_url": "https://github.com/stoddardg",
      "followers_url": "https://api.github.com/users/stoddardg/followers",
      "following_url": "https://api.github.com/users/stoddardg/following{/other_user}",
      "gists_url": "https://api.github.com/users/stoddardg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stoddardg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stoddardg/subscriptions",
      "organizations_url": "https://api.github.com/users/stoddardg/orgs",
      "repos_url": "https://api.github.com/users/stoddardg/repos",
      "events_url": "https://api.github.com/users/stoddardg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stoddardg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-07T14:23:55Z",
    "updated_at": "2017-06-07T14:23:55Z",
    "author_association": "NONE",
    "body": "Hi all, \r\n\r\nI think I discovered a bug related to this but not exactly the same issue.\r\n\r\nThe issue is that using `set_categories` causes an issue when storing into HDF. Here's a minimal working example\r\n```\r\nimport pandas as pd\r\n\r\ndf = pd.DataFrame({'idx':[1,2],'val':['A','B']})\r\ndf['val'] = df['val'].astype('category')\r\n\r\ndf['val'].cat.set_categories(['C','B','A'],inplace=True)\r\ndf.to_hdf('test.h5','test',format='table',data_columns=True)\r\n\r\ntemp_cats = ['A','B']\r\nquery_string = \"val in %s\" % temp_cats\r\nstored_df = pd.read_hdf('test.h5','test',where=query_string)\r\n\r\nprint(len(stored_df)) # Prints 0, i.e. no rows in stored_df\r\n```\r\n\r\nI would expect stored_df to equal the original dataframe but it's empty. \r\n\r\nIf you remove this line `df['val'].cat.set_categories(['C','B','A'],inplace=True)`, then things work as intended. Similarly, if you change the line to `df['val'].cat.set_categories(['A','B','C'],inplace=True)`, it works as intended. \r\n\r\nInterestingly, it also works if I do `test_df['val'].cat.add_categories(['C'],inplace=True)`, which gives the same effect (I think) and is my current work around. \r\n\r\n\r\nMy versions: \r\n```\r\nINSTALLED VERSIONS\r\n------------------\r\ncommit: None\r\npython: 3.6.1.final.0\r\npython-bits: 64\r\nOS: Linux\r\nOS-release: 3.10.0-514.16.1.el7.x86_64\r\nmachine: x86_64\r\nprocessor: x86_64\r\nbyteorder: little\r\nLC_ALL: None\r\nLANG: en_US.UTF-8\r\nLOCALE: en_US.UTF-8\r\n\r\npandas: 0.20.2\r\npytest: None\r\npip: 9.0.1\r\nsetuptools: 27.2.0\r\nCython: None\r\nnumpy: 1.12.1\r\nscipy: 0.19.0\r\nxarray: None\r\nIPython: 5.3.0\r\nsphinx: None\r\npatsy: None\r\ndateutil: 2.6.0\r\npytz: 2016.10\r\nblosc: None\r\nbottleneck: None\r\ntables: 3.3.0\r\nnumexpr: 2.6.2\r\nfeather: None\r\nmatplotlib: 2.0.0\r\nopenpyxl: None\r\nxlrd: None\r\nxlwt: None\r\nxlsxwriter: None\r\nlxml: None\r\nbs4: None\r\nhtml5lib: 0.999\r\nsqlalchemy: None\r\npymysql: None\r\npsycopg2: None\r\njinja2: 2.9.5\r\ns3fs: None\r\npandas_gbq: None\r\npandas_datareader: None\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/307641009",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14613#issuecomment-307641009",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14613",
    "id": 307641009,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzY0MTAwOQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-11T16:41:00Z",
    "updated_at": "2017-06-11T16:41:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "@stoddardg can you create a new issue for your example. It is different that this one and *looks* like a bug."
  }
]
