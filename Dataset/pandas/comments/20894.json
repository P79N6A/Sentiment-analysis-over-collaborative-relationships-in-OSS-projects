[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/385620414",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20894#issuecomment-385620414",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20894",
    "id": 385620414,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTYyMDQxNA==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-01T08:00:12Z",
    "updated_at": "2018-05-01T08:00:12Z",
    "author_association": "MEMBER",
    "body": "Please provide a self-contained, reproducible example. Also your title indicates \"apply\", but I assume you are actually talking about \"assign\"?\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/385621002",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20894#issuecomment-385621002",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20894",
    "id": 385621002,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTYyMTAwMg==",
    "user": {
      "login": "arslanhashmi",
      "id": 17988601,
      "node_id": "MDQ6VXNlcjE3OTg4NjAx",
      "avatar_url": "https://avatars1.githubusercontent.com/u/17988601?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arslanhashmi",
      "html_url": "https://github.com/arslanhashmi",
      "followers_url": "https://api.github.com/users/arslanhashmi/followers",
      "following_url": "https://api.github.com/users/arslanhashmi/following{/other_user}",
      "gists_url": "https://api.github.com/users/arslanhashmi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arslanhashmi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arslanhashmi/subscriptions",
      "organizations_url": "https://api.github.com/users/arslanhashmi/orgs",
      "repos_url": "https://api.github.com/users/arslanhashmi/repos",
      "events_url": "https://api.github.com/users/arslanhashmi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arslanhashmi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-01T08:04:26Z",
    "updated_at": "2018-05-01T09:23:29Z",
    "author_association": "NONE",
    "body": "Thank you very much for replying, yes it is assign.\r\nI call it like this \r\nself.add_attribute(\r\n                new_attribute='ccs_p_01',\r\n                condition_column='diagnosis_main_01',\r\n                categories=categories_diagnosis,\r\n                category='Diagnoses',\r\n                code='icd10code'\r\n            )\r\n^^^ here categories_diagnosis is a dictionary of small data frames.\r\nThe problem is only with assign with time the memory usage increases drastically."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/385632562",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20894#issuecomment-385632562",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20894",
    "id": 385632562,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTYzMjU2Mg==",
    "user": {
      "login": "arslanhashmi",
      "id": 17988601,
      "node_id": "MDQ6VXNlcjE3OTg4NjAx",
      "avatar_url": "https://avatars1.githubusercontent.com/u/17988601?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arslanhashmi",
      "html_url": "https://github.com/arslanhashmi",
      "followers_url": "https://api.github.com/users/arslanhashmi/followers",
      "following_url": "https://api.github.com/users/arslanhashmi/following{/other_user}",
      "gists_url": "https://api.github.com/users/arslanhashmi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arslanhashmi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arslanhashmi/subscriptions",
      "organizations_url": "https://api.github.com/users/arslanhashmi/orgs",
      "repos_url": "https://api.github.com/users/arslanhashmi/repos",
      "events_url": "https://api.github.com/users/arslanhashmi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arslanhashmi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-01T09:22:16Z",
    "updated_at": "2018-05-01T09:22:16Z",
    "author_association": "NONE",
    "body": "@jorisvandenbossche kindly help me if you can do please.\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/385636461",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20894#issuecomment-385636461",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20894",
    "id": 385636461,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTYzNjQ2MQ==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-01T09:48:31Z",
    "updated_at": "2018-05-01T09:48:31Z",
    "author_association": "MEMBER",
    "body": "If you want us to help you, you will at least need to start with providing a minimal reproducible example (http://matthewrocklin.com/blog/work/2018/02/28/minimal-bug-reports): a code snippet that we can just run and shows your problem."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/385645803",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20894#issuecomment-385645803",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20894",
    "id": 385645803,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTY0NTgwMw==",
    "user": {
      "login": "arslanhashmi",
      "id": 17988601,
      "node_id": "MDQ6VXNlcjE3OTg4NjAx",
      "avatar_url": "https://avatars1.githubusercontent.com/u/17988601?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arslanhashmi",
      "html_url": "https://github.com/arslanhashmi",
      "followers_url": "https://api.github.com/users/arslanhashmi/followers",
      "following_url": "https://api.github.com/users/arslanhashmi/following{/other_user}",
      "gists_url": "https://api.github.com/users/arslanhashmi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arslanhashmi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arslanhashmi/subscriptions",
      "organizations_url": "https://api.github.com/users/arslanhashmi/orgs",
      "repos_url": "https://api.github.com/users/arslanhashmi/repos",
      "events_url": "https://api.github.com/users/arslanhashmi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arslanhashmi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-01T10:53:11Z",
    "updated_at": "2018-05-01T10:53:11Z",
    "author_association": "NONE",
    "body": "I see, you are right i know. But i can't share complete code and data sets i've used as the information is confidential. But i can explain as much as you want me to explain. \r\nI have a class which has a data_frame and this contains around 1-1.5 GB of data. I am using the above function .assign(**kwargs) to add a new row into the actual data frame. I am doing this more than 150 times, but with every new call the memory usage increases.(There are no intermediary processes/code)  \r\nA more easy version/example\r\nkwargs = {\r\n           new_attribute: lambda x: self.data_frame[condition_column].loc[self.data_frame[condition_column].isin(\r\n                [1,2,3,4,5...]\r\n            )]\r\n        }\r\n        self.data_frame = self.data_frame.assign(**kwargs)"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/385648111",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20894#issuecomment-385648111",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20894",
    "id": 385648111,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTY0ODExMQ==",
    "user": {
      "login": "arslanhashmi",
      "id": 17988601,
      "node_id": "MDQ6VXNlcjE3OTg4NjAx",
      "avatar_url": "https://avatars1.githubusercontent.com/u/17988601?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arslanhashmi",
      "html_url": "https://github.com/arslanhashmi",
      "followers_url": "https://api.github.com/users/arslanhashmi/followers",
      "following_url": "https://api.github.com/users/arslanhashmi/following{/other_user}",
      "gists_url": "https://api.github.com/users/arslanhashmi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arslanhashmi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arslanhashmi/subscriptions",
      "organizations_url": "https://api.github.com/users/arslanhashmi/orgs",
      "repos_url": "https://api.github.com/users/arslanhashmi/repos",
      "events_url": "https://api.github.com/users/arslanhashmi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arslanhashmi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-01T11:09:34Z",
    "updated_at": "2018-05-01T11:09:34Z",
    "author_association": "NONE",
    "body": "@jorisvandenbossche Here is a simple reproducible example.\r\n`import io\r\nimport requests\r\nimport pandas as pd\r\n\r\n\r\ndef add_attribute(data_frame, new_attribute, continent):\r\n    kwargs = {\r\n        new_attribute: lambda x: data_frame['Region'].loc[data_frame['Region']==continent].replace(continent, 1)\r\n    }\r\n    return data_frame.assign(**kwargs)\r\n\r\n\r\nurl=\"https://raw.githubusercontent.com/cs109/2014_data/master/countries.csv\"\r\ns=requests.get(url).content\r\ncontinents_info=pd.read_csv(io.StringIO(s.decode('utf-8'))).set_index('Country')\r\ncontinents_info = add_attribute(continents_info, 'AFRICAN_COUNTRIES', 'AFRICA')\r\ncontinents_info = add_attribute(continents_info, 'SOUTH_AMERICA_COUNTRIES', 'SOUTH AMERICA')\r\n\r\n`"
  }
]
