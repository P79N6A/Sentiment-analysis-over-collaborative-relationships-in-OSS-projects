[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/249205895",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14291#issuecomment-249205895",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14291",
    "id": 249205895,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0OTIwNTg5NQ==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-23T14:20:44Z",
    "updated_at": "2016-09-23T14:20:44Z",
    "author_association": "MEMBER",
    "body": "@mbochk That looks like a bug indeed. Thanks for reporting\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/251284080",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14291#issuecomment-251284080",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14291",
    "id": 251284080,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MTI4NDA4MA==",
    "user": {
      "login": "shawnheide",
      "id": 7305354,
      "node_id": "MDQ6VXNlcjczMDUzNTQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/7305354?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shawnheide",
      "html_url": "https://github.com/shawnheide",
      "followers_url": "https://api.github.com/users/shawnheide/followers",
      "following_url": "https://api.github.com/users/shawnheide/following{/other_user}",
      "gists_url": "https://api.github.com/users/shawnheide/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shawnheide/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shawnheide/subscriptions",
      "organizations_url": "https://api.github.com/users/shawnheide/orgs",
      "repos_url": "https://api.github.com/users/shawnheide/repos",
      "events_url": "https://api.github.com/users/shawnheide/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shawnheide/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-04T03:02:43Z",
    "updated_at": "2016-10-04T03:02:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "I looked into this and discovered that the problem is in frame.py, in the _sanitize_column method. Here's the relevant code:\n\n``` python\n# broadcast across multiple columns if necessary\nif key in self.columns and value.ndim == 1:\n    if (not self.columns.is_unique or\n            isinstance(self.columns, MultiIndex)):\n        existing_piece = self[key]\n        if isinstance(existing_piece, DataFrame):\n            value = np.tile(value, (len(existing_piece.columns), 1))\n```\n\nOn the third time `insert` is called, the `existing_piece` is a 2d array consisting of the previous values. I'm not sure how to fix this though as I don't understand why the values are being broadcast in the first place. Any thoughts?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/251399551",
    "html_url": "https://github.com/pandas-dev/pandas/issues/14291#issuecomment-251399551",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/14291",
    "id": 251399551,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MTM5OTU1MQ==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-04T14:12:34Z",
    "updated_at": "2016-10-04T14:12:34Z",
    "author_association": "MEMBER",
    "body": "What happens here is needed when you are setting a certain column (eg `df[key] = value`). If `key` then is a duplicate column name, the `value` has to be broadcasted to fit in those multiple columns. \nBut of course this part of `_sanitize_column` is not needed for an insert operation.\n"
  }
]
