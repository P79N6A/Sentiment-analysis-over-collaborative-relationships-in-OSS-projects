[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/337183976",
    "html_url": "https://github.com/pandas-dev/pandas/issues/17898#issuecomment-337183976",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/17898",
    "id": 337183976,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNzE4Mzk3Ng==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-17T10:08:18Z",
    "updated_at": "2017-10-17T10:08:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "looks like a fencepost problem. if you'd like to debug would be great\r\n\r\nfor M\r\n```\r\nIn [21]: import pandas as pd\r\n    ...: dts = pd.date_range(start='2016-09-01',end='2017-08-31')\r\n    ...: df = pd.DataFrame(\r\n    ...:     {\r\n    ...:         'day': dts, \r\n    ...:         \"val\": 1\r\n    ...:     }\r\n    ...: )\r\n    ...: \r\n    ...: \r\n\r\nIn [22]:  df.groupby(pd.Grouper(key='day',freq='4M', closed='left')).size()\r\nOut[22]: \r\nday\r\n2016-12-31    121\r\n2017-04-30    120\r\n2017-08-31    123\r\n2017-12-31      1\r\nFreq: 4M, dtype: int64\r\n\r\nIn [24]:  df.groupby(pd.Grouper(key='day',freq='4M', closed='right')).size()\r\nOut[24]: \r\nday\r\n2016-09-30     30\r\n2017-01-31    123\r\n2017-05-31    120\r\n2017-09-30     92\r\nFreq: 4M, dtype: int64\r\n\r\n```\r\n\r\nfor MS\r\n```\r\nIn [29]:  df.groupby(pd.Grouper(key='day',freq='4MS', closed='right')).size()\r\nOut[29]: \r\nday\r\n2016-05-01      1\r\n2016-09-01    122\r\n2017-01-01    120\r\n2017-05-01    122\r\nFreq: 4MS, dtype: int64\r\n\r\nIn [30]:  df.groupby(pd.Grouper(key='day',freq='4MS', closed='left')).size()\r\nOut[30]: \r\nday\r\n2016-09-01    122\r\n2017-01-01    120\r\n2017-05-01    123\r\nFreq: 4MS, dtype: int64\r\n\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/337324272",
    "html_url": "https://github.com/pandas-dev/pandas/issues/17898#issuecomment-337324272",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/17898",
    "id": 337324272,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNzMyNDI3Mg==",
    "user": {
      "login": "louispotok",
      "id": 5413548,
      "node_id": "MDQ6VXNlcjU0MTM1NDg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/5413548?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/louispotok",
      "html_url": "https://github.com/louispotok",
      "followers_url": "https://api.github.com/users/louispotok/followers",
      "following_url": "https://api.github.com/users/louispotok/following{/other_user}",
      "gists_url": "https://api.github.com/users/louispotok/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/louispotok/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/louispotok/subscriptions",
      "organizations_url": "https://api.github.com/users/louispotok/orgs",
      "repos_url": "https://api.github.com/users/louispotok/repos",
      "events_url": "https://api.github.com/users/louispotok/events{/privacy}",
      "received_events_url": "https://api.github.com/users/louispotok/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-17T18:27:29Z",
    "updated_at": "2017-10-17T18:27:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "Looking into \r\n`df.groupby(pd.Grouper(key='day',freq='4M', closed='right')).size()` and putting notes here in case they are helpful:\r\n\r\nIt looks like [here](https://github.com/pandas-dev/pandas/blob/master/pandas/core/resample.py#L1328) we do:\r\n```\r\n    if closed == 'left':\r\n        first = Timestamp(offset.rollback(first))\r\n    else:\r\n        first = Timestamp(first - offset)\r\n\r\n    last = Timestamp(last + offset)\r\n```\r\nSo in the `closed='right'` case, we:\r\n* change `first`: 9/1 -> 5/31\r\n* change `last`: 8/31 -> 12/31\r\n\r\n`first` and `last` are then used to create a DateTime Index which is the basis for the return index [here](https://github.com/pandas-dev/pandas/blob/master/pandas/core/resample.py#L1134):\r\n`DatetimeIndex(['2016-05-31', '2016-09-30', '2017-01-31', '2017-05-31', '2017-09-30'] , dtype='datetime64[ns]', name='day', freq='4M')`\r\nFinally we cut off the first value in that index because we are closed `right`.\r\n\r\nIn the debugger, if I manually overwrite that dt index with `pd.DatetimeIndex(freq=self.freq,end=last, periods=5)` the rest of the code seems to do the right thing:\r\n```Out[11]: \r\n2016-12-31    122\r\n2017-04-30    120\r\n2017-08-31    123\r\n```\r\n\r\nWill look into this more a little later."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/430357613",
    "html_url": "https://github.com/pandas-dev/pandas/issues/17898#issuecomment-430357613",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/17898",
    "id": 430357613,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDM1NzYxMw==",
    "user": {
      "login": "heydenberk",
      "id": 377479,
      "node_id": "MDQ6VXNlcjM3NzQ3OQ==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/377479?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/heydenberk",
      "html_url": "https://github.com/heydenberk",
      "followers_url": "https://api.github.com/users/heydenberk/followers",
      "following_url": "https://api.github.com/users/heydenberk/following{/other_user}",
      "gists_url": "https://api.github.com/users/heydenberk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/heydenberk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/heydenberk/subscriptions",
      "organizations_url": "https://api.github.com/users/heydenberk/orgs",
      "repos_url": "https://api.github.com/users/heydenberk/repos",
      "events_url": "https://api.github.com/users/heydenberk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/heydenberk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-16T18:59:07Z",
    "updated_at": "2018-10-16T18:59:07Z",
    "author_association": "NONE",
    "body": "Is this the same core issue as #13022â€”and hence, addressed by #22488 and due to land with 0.24?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/431442902",
    "html_url": "https://github.com/pandas-dev/pandas/issues/17898#issuecomment-431442902",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/17898",
    "id": 431442902,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTQ0MjkwMg==",
    "user": {
      "login": "louispotok",
      "id": 5413548,
      "node_id": "MDQ6VXNlcjU0MTM1NDg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/5413548?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/louispotok",
      "html_url": "https://github.com/louispotok",
      "followers_url": "https://api.github.com/users/louispotok/followers",
      "following_url": "https://api.github.com/users/louispotok/following{/other_user}",
      "gists_url": "https://api.github.com/users/louispotok/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/louispotok/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/louispotok/subscriptions",
      "organizations_url": "https://api.github.com/users/louispotok/orgs",
      "repos_url": "https://api.github.com/users/louispotok/repos",
      "events_url": "https://api.github.com/users/louispotok/events{/privacy}",
      "received_events_url": "https://api.github.com/users/louispotok/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-19T17:46:13Z",
    "updated_at": "2018-10-19T17:46:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "@heydenberk just retried my sample on master and the output is the same, so looks like it hasn't been fixed."
  }
]
