[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/148904681",
    "html_url": "https://github.com/pandas-dev/pandas/pull/11352#issuecomment-148904681",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11352",
    "id": 148904681,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0ODkwNDY4MQ==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-10-17T10:26:43Z",
    "updated_at": "2015-10-17T10:26:43Z",
    "author_association": "MEMBER",
    "body": "Looks good to me!\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/148919494",
    "html_url": "https://github.com/pandas-dev/pandas/pull/11352#issuecomment-148919494",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11352",
    "id": 148919494,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0ODkxOTQ5NA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-10-17T14:39:35Z",
    "updated_at": "2015-10-17T14:39:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'd rather make a bigger change to how the xls writing is done, to make it much more performant. The idea is to copy what is done for csv writing.\n\nYou chunk write, then convert the columns by blocks with `to_native_types()` (you would have to expand this to for example handle the `inf` conversions, it already handles the `nan` and `float_format` for `FloatBlock`). these already return `object` arrays.\n\nThen you simply iterate and yield the `ExcelCells`, but no conversion is done (as it was all done before), so should be faster/simpler.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/148921480",
    "html_url": "https://github.com/pandas-dev/pandas/pull/11352#issuecomment-148921480",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11352",
    "id": 148921480,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0ODkyMTQ4MA==",
    "user": {
      "login": "chris-b1",
      "id": 1924092,
      "node_id": "MDQ6VXNlcjE5MjQwOTI=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1924092?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chris-b1",
      "html_url": "https://github.com/chris-b1",
      "followers_url": "https://api.github.com/users/chris-b1/followers",
      "following_url": "https://api.github.com/users/chris-b1/following{/other_user}",
      "gists_url": "https://api.github.com/users/chris-b1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chris-b1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chris-b1/subscriptions",
      "organizations_url": "https://api.github.com/users/chris-b1/orgs",
      "repos_url": "https://api.github.com/users/chris-b1/repos",
      "events_url": "https://api.github.com/users/chris-b1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chris-b1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-10-17T14:52:21Z",
    "updated_at": "2015-10-17T14:52:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yeah, I had actually started looking into that - this particular change was low hanging fruit, so I thought it might make sense to do first.  \n\nThere probably is some performance to be picked up still, but an awful lot of the time is spent in the actual writing steps now.\n\n```\nIn [1]: df = pd.DataFrame({'b': np.linspace(0, 1000, 100000), 'c': np.linspace(0, 100, 100000)})\n\nIn [2]: %prun df.to_excel('temp.xlsx')\n\n\n   Ordered by: internal time\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.707    0.707    5.212    5.212 excel.py:1410(write_cells)\n   300000    0.699    0.000    1.773    0.000 xmlwriter.py:129(_xml_number_element)\n     1842    0.612    0.000    0.612    0.000 {built-in method compress}\n   300001    0.568    0.000    0.685    0.000 format.py:1817(_format_regular_rows)\n   300000    0.543    0.000    1.092    0.000 worksheet.py:482(write_number)\n   300002    0.542    0.000    2.490    0.000 worksheet.py:5085(_write_cell)\n        1    0.512    0.512    3.912    3.912 worksheet.py:4911(_write_rows)\n600004/300002    0.471    0.000    2.439    0.000 worksheet.py:51(cell_wrapper)\n   300002    0.430    0.000    2.175    0.000 worksheet.py:349(write)\n   300002    0.400    0.000    0.400    0.000 {pandas.json.dumps}\n  1500255    0.398    0.000    0.398    0.000 {isinstance}\n   502071    0.390    0.000    0.390    0.000 {method 'write' of 'file' objects}\n   500157    0.285    0.000    0.923    0.000 codecs.py:353(write)\n   300002    0.267    0.000    0.267    0.000 worksheet.py:3459(_check_dimensions)\n       11    0.267    0.024    0.267    0.024 {method 'close' of 'file' objects}\n   300002    0.265    0.000    0.388    0.000 format.py:1707(_format_value)\n   500157    0.252    0.000    0.252    0.000 {_codecs.utf_8_encode}\n   400143    0.238    0.000    0.365    0.000 xmlwriter.py:180(_escape_attributes)\n   300003    0.207    0.000    1.280    0.000 format.py:1931(get_formatted_cells)\n   500157    0.188    0.000    1.111    0.000 codecs.py:692(write)\n   300002    0.184    0.000    0.225    0.000 excel.py:494(_conv_value)\n   300002    0.157    0.000    0.302    0.000 utility.py:604(supported_datetime)\n   300002    0.136    0.000    0.136    0.000 utility.py:37(xl_rowcol_to_cell_fast)\n   100001    0.134    0.000    0.507    0.000 worksheet.py:5038(_write_row)\n   100001    0.132    0.000    0.354    0.000 xmlwriter.py:61(_xml_start_tag_unencoded)\n   400167    0.127    0.000    0.127    0.000 {method 'search' of '_sre.SRE_Pattern' objects}\n   300002    0.116    0.000    0.116    0.000 format.py:1644(__init__)\n        1    0.116    0.116    0.136    0.136 worksheet.py:4989(_calculate_spans)\n   300000    0.111    0.000    0.189    0.000 <string>:8(__new__)\n   300004    0.077    0.000    0.077    0.000 {built-in method __new__ of type object at 0x000000001E2A0670}\n   100037    0.059    0.000    0.238    0.000 xmlwriter.py:70(_xml_end_tag)\n   300000    0.054    0.000    0.054    0.000 worksheet.py:4515(_isinf)\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/148921570",
    "html_url": "https://github.com/pandas-dev/pandas/pull/11352#issuecomment-148921570",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11352",
    "id": 148921570,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0ODkyMTU3MA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-10-17T14:54:38Z",
    "updated_at": "2015-10-17T14:54:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "@chris-b1 agreed. Ok rebase this (prob a whatsnew conflict). The can look at other improvements if desired.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/148921739",
    "html_url": "https://github.com/pandas-dev/pandas/pull/11352#issuecomment-148921739",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11352",
    "id": 148921739,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0ODkyMTczOQ==",
    "user": {
      "login": "chris-b1",
      "id": 1924092,
      "node_id": "MDQ6VXNlcjE5MjQwOTI=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1924092?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chris-b1",
      "html_url": "https://github.com/chris-b1",
      "followers_url": "https://api.github.com/users/chris-b1/followers",
      "following_url": "https://api.github.com/users/chris-b1/following{/other_user}",
      "gists_url": "https://api.github.com/users/chris-b1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chris-b1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chris-b1/subscriptions",
      "organizations_url": "https://api.github.com/users/chris-b1/orgs",
      "repos_url": "https://api.github.com/users/chris-b1/repos",
      "events_url": "https://api.github.com/users/chris-b1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chris-b1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-10-17T14:58:22Z",
    "updated_at": "2015-10-17T14:58:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jreback  - rebased\n"
  }
]
