[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/226293524",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13453#issuecomment-226293524",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13453",
    "id": 226293524,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyNjI5MzUyNA==",
    "user": {
      "login": "jcrist",
      "id": 2783717,
      "node_id": "MDQ6VXNlcjI3ODM3MTc=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/2783717?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jcrist",
      "html_url": "https://github.com/jcrist",
      "followers_url": "https://api.github.com/users/jcrist/followers",
      "following_url": "https://api.github.com/users/jcrist/following{/other_user}",
      "gists_url": "https://api.github.com/users/jcrist/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jcrist/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jcrist/subscriptions",
      "organizations_url": "https://api.github.com/users/jcrist/orgs",
      "repos_url": "https://api.github.com/users/jcrist/repos",
      "events_url": "https://api.github.com/users/jcrist/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jcrist/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-06-15T19:26:09Z",
    "updated_at": "2016-06-15T19:26:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "May be related to https://github.com/pydata/pandas/issues/10914.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/226295096",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13453#issuecomment-226295096",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13453",
    "id": 226295096,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyNjI5NTA5Ng==",
    "user": {
      "login": "jcrist",
      "id": 2783717,
      "node_id": "MDQ6VXNlcjI3ODM3MTc=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/2783717?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jcrist",
      "html_url": "https://github.com/jcrist",
      "followers_url": "https://api.github.com/users/jcrist/followers",
      "following_url": "https://api.github.com/users/jcrist/following{/other_user}",
      "gists_url": "https://api.github.com/users/jcrist/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jcrist/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jcrist/subscriptions",
      "organizations_url": "https://api.github.com/users/jcrist/orgs",
      "repos_url": "https://api.github.com/users/jcrist/repos",
      "events_url": "https://api.github.com/users/jcrist/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jcrist/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-06-15T19:32:07Z",
    "updated_at": "2016-06-15T19:32:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "Interestingly everything seems to work fine if `agg` is used with `pd.Series.nunique` instead:\n\n```\nIn [11]: r = s.resample('M')\n\nIn [12]: r.agg(pd.Series.nunique)\nOut[12]:\n2000-01-31    744\n2000-02-29    337\n2000-03-31      0\n2000-04-30    384\n2000-05-31    337\nFreq: M, dtype: int64\n\nIn [13]: r.nunique()    # same result as r.agg('nunique')\nOut[13]:\n2000-01-31    337\n2000-02-29    744\n2000-03-31      0\n2000-04-30    744\n2000-05-31    337\nFreq: M, dtype: int64\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/226337713",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13453#issuecomment-226337713",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13453",
    "id": 226337713,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyNjMzNzcxMw==",
    "user": {
      "login": "sinhrks",
      "id": 1696302,
      "node_id": "MDQ6VXNlcjE2OTYzMDI=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1696302?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sinhrks",
      "html_url": "https://github.com/sinhrks",
      "followers_url": "https://api.github.com/users/sinhrks/followers",
      "following_url": "https://api.github.com/users/sinhrks/following{/other_user}",
      "gists_url": "https://api.github.com/users/sinhrks/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sinhrks/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sinhrks/subscriptions",
      "organizations_url": "https://api.github.com/users/sinhrks/orgs",
      "repos_url": "https://api.github.com/users/sinhrks/repos",
      "events_url": "https://api.github.com/users/sinhrks/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sinhrks/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-06-15T22:22:29Z",
    "updated_at": "2016-06-15T22:22:29Z",
    "author_association": "MEMBER",
    "body": "CC:  @behzadnouri \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/252435518",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13453#issuecomment-252435518",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13453",
    "id": 252435518,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MjQzNTUxOA==",
    "user": {
      "login": "mgalbright",
      "id": 13350377,
      "node_id": "MDQ6VXNlcjEzMzUwMzc3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/13350377?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mgalbright",
      "html_url": "https://github.com/mgalbright",
      "followers_url": "https://api.github.com/users/mgalbright/followers",
      "following_url": "https://api.github.com/users/mgalbright/following{/other_user}",
      "gists_url": "https://api.github.com/users/mgalbright/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mgalbright/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mgalbright/subscriptions",
      "organizations_url": "https://api.github.com/users/mgalbright/orgs",
      "repos_url": "https://api.github.com/users/mgalbright/repos",
      "events_url": "https://api.github.com/users/mgalbright/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mgalbright/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-08T16:54:35Z",
    "updated_at": "2016-10-08T16:54:35Z",
    "author_association": "NONE",
    "body": "I think the root cause of the problem is in groupby.nunique(), which I believe is eventually is called by resample.nunique().  Note that groupby.nunique() has the same bug:\n\n``` python\nimport pandas as pd\nfrom pandas import Timestamp\n\ndata = ['1', '2', '3']\ntime = time = [Timestamp('2016-06-28 09:35:35'), Timestamp('2016-06-28 16:09:30'), Timestamp('2016-06-28 16:46:28')]\ntest = pd.DataFrame({'time':time, 'data':data})\n\n#wrong counts\nprint test.set_index('time').groupby(pd.TimeGrouper(freq='h'))['data'].nunique(), \"\\n\"\n#correct counts\nprint test.set_index('time').groupby(pd.TimeGrouper(freq='h'))['data'].apply(pd.Series.nunique)\n```\n\nThis gives\n\n```\ntime  \n2016-06-28 09:00:00    1  \n2016-06-28 10:00:00    0  \n2016-06-28 11:00:00    0  \n2016-06-28 12:00:00    0  \n2016-06-28 13:00:00    0  \n2016-06-28 14:00:00    0  \n2016-06-28 15:00:00    0  \n2016-06-28 16:00:00    1  \nFreq: H, Name: data, dtype: int64   \n\ntime  \n2016-06-28 09:00:00    1  \n2016-06-28 10:00:00    0  \n2016-06-28 11:00:00    0  \n2016-06-28 12:00:00    0  \n2016-06-28 13:00:00    0  \n2016-06-28 14:00:00    0  \n2016-06-28 15:00:00    0  \n2016-06-28 16:00:00    2  \nFreq: H, Name: data, dtype: int64  \n```\n\nI believe the problem is in the second to last line of groupby.nunique(), \ni.e. line 2955 in [groupby.py](https://github.com/pydata/pandas/blob/master/pandas/core/groupby.py)\n\n``` python\nres[ids] = out\n```\n\nI suspect `ids` should not be used for the indexing--it has different dimensions than `out`.\n\n``` python\npd.show_versions()\n```\n\n```\nINSTALLED VERSIONS\n------------------\ncommit: None\npython: 2.7.12.final.0\npython-bits: 64\nOS: Darwin\nOS-release: 14.5.0\nmachine: x86_64\nprocessor: i386\nbyteorder: little\nLC_ALL: None\nLANG: en_US.UTF-8\nLOCALE: None.None\n\npandas: 0.19.0\nnose: 1.3.7\npip: 8.1.2\nsetuptools: 27.2.0\nCython: 0.24.1\nnumpy: 1.11.2\nscipy: 0.18.1\nstatsmodels: 0.6.1\nxarray: None\nIPython: 5.1.0\nsphinx: 1.4.6\npatsy: 0.4.1\ndateutil: 2.5.3\npytz: 2016.6.1\nblosc: None\nbottleneck: 1.1.0\ntables: 3.2.3.1\nnumexpr: 2.6.1\nmatplotlib: 1.5.3\nopenpyxl: 2.3.2\nxlrd: 1.0.0\nxlwt: 1.1.2\nxlsxwriter: 0.9.3\nlxml: 3.6.4\nbs4: 4.5.1\nhtml5lib: None\nhttplib2: None\napiclient: None\nsqlalchemy: 1.0.13\npymysql: None\npsycopg2: None\njinja2: 2.8\nboto: 2.42.0\npandas_datareader: 0.2.1\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/252499163",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13453#issuecomment-252499163",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13453",
    "id": 252499163,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MjQ5OTE2Mw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-09T17:18:02Z",
    "updated_at": "2016-10-09T17:18:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "@mgalbright why don't you submit a pull-request with your test examples (and those from the issue), and the proposed fix. See if that breaks anything else. Would be greatly appreciated!\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/260360877",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13453#issuecomment-260360877",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13453",
    "id": 260360877,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MDM2MDg3Nw==",
    "user": {
      "login": "aiguofer",
      "id": 780934,
      "node_id": "MDQ6VXNlcjc4MDkzNA==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/780934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aiguofer",
      "html_url": "https://github.com/aiguofer",
      "followers_url": "https://api.github.com/users/aiguofer/followers",
      "following_url": "https://api.github.com/users/aiguofer/following{/other_user}",
      "gists_url": "https://api.github.com/users/aiguofer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aiguofer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aiguofer/subscriptions",
      "organizations_url": "https://api.github.com/users/aiguofer/orgs",
      "repos_url": "https://api.github.com/users/aiguofer/repos",
      "events_url": "https://api.github.com/users/aiguofer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aiguofer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-14T15:11:25Z",
    "updated_at": "2016-11-14T15:13:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hey, is there any advancement on this? I just realized that a report that I've been building is giving the wrong results and I believe it's due to this. I can't share all the code but here's a comparison of `groupby.unique` and `groupby.nunique`:\n\n``` python\nIn [216]: ents.groupby(pd.Grouper(freq='1W-SAT', key='startdate'))['ent_id'].unique().tail(1)\nOut[216]: \n\nstartdate\n2016-11-12    [550A00000033DHUIA2]\nFreq: W-SAT, Name: ent_id, dtype: object\n\nIn [217]: ents.groupby(pd.Grouper(freq='1W-SAT', key='startdate'))['ent_id'].nunique().tail(1)\nOut[217]: \n\nstartdate\n2016-11-12    7\nFreq: W-SAT, Name: ent_id, dtype: int64\n\nIn [218]: ents.groupby(pd.Grouper(freq='1W-SAT', key='startdate'))['ent_id'].count().tail(1)\nOut[221]: \n\nstartdate\n2016-11-12    1\nFreq: W-SAT, Name: ent_id, dtype: int64\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/260467333",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13453#issuecomment-260467333",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13453",
    "id": 260467333,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MDQ2NzMzMw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-14T21:25:00Z",
    "updated_at": "2016-11-14T21:25:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "@aiguofer pull-requests are welcome to fix.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/277829586",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13453#issuecomment-277829586",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13453",
    "id": 277829586,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NzgyOTU4Ng==",
    "user": {
      "login": "hantusk",
      "id": 7280549,
      "node_id": "MDQ6VXNlcjcyODA1NDk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/7280549?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hantusk",
      "html_url": "https://github.com/hantusk",
      "followers_url": "https://api.github.com/users/hantusk/followers",
      "following_url": "https://api.github.com/users/hantusk/following{/other_user}",
      "gists_url": "https://api.github.com/users/hantusk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hantusk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hantusk/subscriptions",
      "organizations_url": "https://api.github.com/users/hantusk/orgs",
      "repos_url": "https://api.github.com/users/hantusk/repos",
      "events_url": "https://api.github.com/users/hantusk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hantusk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-06T22:07:01Z",
    "updated_at": "2017-02-06T22:08:02Z",
    "author_association": "NONE",
    "body": "Not really adding anything, but I just ran into this issue for a work report as well (pandas version 0.19.2). Passing to .agg(pd.Series.nunique) works great - thanks for the tip"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/280175509",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13453#issuecomment-280175509",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13453",
    "id": 280175509,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDE3NTUwOQ==",
    "user": {
      "login": "aiguofer",
      "id": 780934,
      "node_id": "MDQ6VXNlcjc4MDkzNA==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/780934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aiguofer",
      "html_url": "https://github.com/aiguofer",
      "followers_url": "https://api.github.com/users/aiguofer/followers",
      "following_url": "https://api.github.com/users/aiguofer/following{/other_user}",
      "gists_url": "https://api.github.com/users/aiguofer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aiguofer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aiguofer/subscriptions",
      "organizations_url": "https://api.github.com/users/aiguofer/orgs",
      "repos_url": "https://api.github.com/users/aiguofer/repos",
      "events_url": "https://api.github.com/users/aiguofer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aiguofer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-15T23:27:19Z",
    "updated_at": "2017-02-15T23:27:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "Took a look at @mgalbright coment and suggestion and if I'm understanding the code correctly, the above PR should fix it. I ran `nosetests pandas/tests/groupby` and only had one unrelated test fail (`test_series_groupby_value_counts() takes exactly 2 arguments (0 given)`)."
  }
]
