[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/24470962",
    "html_url": "https://github.com/pandas-dev/pandas/pull/4844#issuecomment-24470962",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4844",
    "id": 24470962,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDcwOTYy",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-15T12:56:49Z",
    "updated_at": "2013-09-15T12:56:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jmcnamara - this should make it _much_ easier for you to add and test xlsxwriter. Just follow the pattern for OpenpyxlTests and XlwtTests and you should be good.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/24471039",
    "html_url": "https://github.com/pandas-dev/pandas/pull/4844#issuecomment-24471039",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4844",
    "id": 24471039,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDcxMDM5",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-15T13:02:21Z",
    "updated_at": "2013-09-15T13:02:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "For those interested: this doesn't add or remove tests, just makes it _much_ easier to add new writers and new writer tests.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/24471083",
    "html_url": "https://github.com/pandas-dev/pandas/pull/4844#issuecomment-24471083",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4844",
    "id": 24471083,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDcxMDgz",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-15T13:04:37Z",
    "updated_at": "2013-09-15T13:04:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "and preserves skip output:\n\n```\n\n#16 pandas.io.tests.test_excel.OpenpyxlTests.test_bool: openpyxl not installed, skipping\n#17 pandas.io.tests.test_excel.OpenpyxlTests.test_colaliases: openpyxl not installed, skipping\n#18 pandas.io.tests.test_excel.OpenpyxlTests.test_excel_010_hemstring: openpyxl not installed, skipping\n#19 pandas.io.tests.test_excel.OpenpyxlTests.test_excel_roundtrip_datetime: openpyxl not installed, skipping\n#20 pandas.io.tests.test_excel.OpenpyxlTests.test_excel_roundtrip_indexname: openpyxl not installed, skipping\n#21 pandas.io.tests.test_excel.OpenpyxlTests.test_excel_sheet_by_name_raise: openpyxl not installed, skipping\n#22 pandas.io.tests.test_excel.OpenpyxlTests.test_int64: openpyxl not installed, skipping\n#23 pandas.io.tests.test_excel.OpenpyxlTests.test_mixed: openpyxl not installed, skipping\n#24 pandas.io.tests.test_excel.OpenpyxlTests.test_roundtrip: openpyxl not installed, skipping\n#25 pandas.io.tests.test_excel.OpenpyxlTests.test_roundtrip_indexlabels: openpyxl not installed, skipping\n#26 pandas.io.tests.test_excel.OpenpyxlTests.test_sheets: openpyxl not installed, skipping\n#27 pandas.io.tests.test_excel.OpenpyxlTests.test_to_excel_float_format: openpyxl not installed, skipping\n#28 pandas.io.tests.test_excel.OpenpyxlTests.test_to_excel_multiindex: openpyxl not installed, skipping\n#29 pandas.io.tests.test_excel.OpenpyxlTests.test_to_excel_multiindex_dates: openpyxl not installed, skipping\n#30 pandas.io.tests.test_excel.OpenpyxlTests.test_to_excel_periodindex: openpyxl not installed, skipping\n#31 pandas.io.tests.test_excel.OpenpyxlTests.test_to_excel_styleconverter: openpyxl not installed, skipping\n#32 pandas.io.tests.test_excel.OpenpyxlTests.test_to_excel_unicode_filename: openpyxl not installed, skipping\n#33 pandas.io.tests.test_excel.OpenpyxlTests.test_tsframe: openpyxl not installed, skipping\n--------------------------------------------------------------------------------\n#34 pandas.io.tests.test_excel.XlwtTests.test_bool: xlwt not installed, skipping\n#35 pandas.io.tests.test_excel.XlwtTests.test_colaliases: xlwt not installed, skipping\n#36 pandas.io.tests.test_excel.XlwtTests.test_excel_010_hemstring: xlwt not installed, skipping\n#37 pandas.io.tests.test_excel.XlwtTests.test_excel_roundtrip_datetime: xlwt not installed, skipping\n#38 pandas.io.tests.test_excel.XlwtTests.test_excel_roundtrip_indexname: xlwt not installed, skipping\n#39 pandas.io.tests.test_excel.XlwtTests.test_excel_sheet_by_name_raise: xlwt not installed, skipping\n#40 pandas.io.tests.test_excel.XlwtTests.test_int64: xlwt not installed, skipping\n#41 pandas.io.tests.test_excel.XlwtTests.test_mixed: xlwt not installed, skipping\n#42 pandas.io.tests.test_excel.XlwtTests.test_roundtrip: xlwt not installed, skipping\n#43 pandas.io.tests.test_excel.XlwtTests.test_roundtrip_indexlabels: xlwt not installed, skipping\n#44 pandas.io.tests.test_excel.XlwtTests.test_sheets: xlwt not installed, skipping\n#45 pandas.io.tests.test_excel.XlwtTests.test_to_excel_float_format: xlwt not installed, skipping\n#46 pandas.io.tests.test_excel.XlwtTests.test_to_excel_multiindex: xlwt not installed, skipping\n#47 pandas.io.tests.test_excel.XlwtTests.test_to_excel_multiindex_dates: xlwt not installed, skipping\n#48 pandas.io.tests.test_excel.XlwtTests.test_to_excel_periodindex: xlwt not installed, skipping\n#49 pandas.io.tests.test_excel.XlwtTests.test_to_excel_styleconverter: xlwt not installed, skipping\n#50 pandas.io.tests.test_excel.XlwtTests.test_to_excel_unicode_filename: xlwt not installed, skipping\n#51 pandas.io.tests.test_excel.XlwtTests.test_tsframe: xlwt not installed, skipping\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/24481797",
    "html_url": "https://github.com/pandas-dev/pandas/pull/4844#issuecomment-24481797",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4844",
    "id": 24481797,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDgxNzk3",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-15T22:19:44Z",
    "updated_at": "2013-09-15T22:19:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jtratner That looks good. It will make adding tests for new engines very clean and straightforward.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/24482791",
    "html_url": "https://github.com/pandas-dev/pandas/pull/4844#issuecomment-24482791",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4844",
    "id": 24482791,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDgyNzkx",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-15T23:16:43Z",
    "updated_at": "2013-09-15T23:16:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jtratner How do you set the writer engine from a subclass? Should it be set up via `set_option()` in a constructor and reset to the previous value in the destructor?\n\nOr am I missing something more direct.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/24483557",
    "html_url": "https://github.com/pandas-dev/pandas/pull/4844#issuecomment-24483557",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4844",
    "id": 24483557,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDgzNTU3",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-16T00:03:07Z",
    "updated_at": "2013-09-16T00:03:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jmcnamara oh...very good point. wasn't thinking, give me a second, I'll put in a patch for you so you can get it to work.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/24483566",
    "html_url": "https://github.com/pandas-dev/pandas/pull/4844#issuecomment-24483566",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4844",
    "id": 24483566,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDgzNTY2",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-16T00:03:37Z",
    "updated_at": "2013-09-16T00:03:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jmcnamara you can just add it to your PR...not going to do a separate pull request.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/24483705",
    "html_url": "https://github.com/pandas-dev/pandas/pull/4844#issuecomment-24483705",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4844",
    "id": 24483705,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDgzNzA1",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-16T00:10:35Z",
    "updated_at": "2013-09-16T00:10:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "You can run the following to get the patch below:\n\n``` git\ngit remote add jtratner https://www.github.com/jtratner/pandas.git\ngit fetch jtratner\ngit checkout <insert-your-branch>\ngit cherry-pick 37db6b58eecb742d98b507224c8390d3faa9a994\n```\n\nOr you can copy it in yourself by saving this to a file and using `git apply` (less likely to work though if you've made changes to the file)\n\n``` patch\ndiff --git a/pandas/io/tests/test_excel.py b/pandas/io/tests/test_excel.py\nindex 0053602..047f10c 100644\n--- a/pandas/io/tests/test_excel.py\n+++ b/pandas/io/tests/test_excel.py\n@@ -16,6 +16,7 @@ from pandas.io.excel import (\n     register_writer\n )\n from pandas.util.testing import ensure_clean\n+from pandas.core.config import set_option, get_option\n import pandas.util.testing as tm\n import pandas as pd\n\n@@ -277,6 +278,12 @@ class ExcelWriterBase(SharedItems):\n     def setUp(self):\n         self.check_skip()\n         super(ExcelWriterBase, self).setUp()\n+        self.option_name = 'io.excel.%s.writer' % self.ext\n+        self.prev_engine = get_option(self.option_name)\n+        set_option(self.option_name, self.engine_name)\n+\n+    def tearDown(self):\n+        set_option(self.option_name, self.prev_engine)\n\n     def test_excel_sheet_by_name_raise(self):\n         _skip_if_no_xlrd()\n@@ -790,6 +797,7 @@ class ExcelWriterBase(SharedItems):\n\n class OpenpyxlTests(ExcelWriterBase, unittest.TestCase):\n     ext = 'xlsx'\n+    engine_name = 'openpyxl'\n     check_skip = staticmethod(_skip_if_no_openpyxl)\n\n     def test_to_excel_styleconverter(self):\n@@ -820,6 +828,7 @@ class OpenpyxlTests(ExcelWriterBase, unittest.TestCase):\n\n class XlwtTests(ExcelWriterBase, unittest.TestCase):\n     ext = 'xls'\n+    engine_name = 'xlwt'\n     check_skip = staticmethod(_skip_if_no_xlwt)\n\n     def test_to_excel_styleconverter(self):\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/24483854",
    "html_url": "https://github.com/pandas-dev/pandas/pull/4844#issuecomment-24483854",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4844",
    "id": 24483854,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDgzODU0",
    "user": {
      "login": "jtratner",
      "id": 1598379,
      "node_id": "MDQ6VXNlcjE1OTgzNzk=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1598379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtratner",
      "html_url": "https://github.com/jtratner",
      "followers_url": "https://api.github.com/users/jtratner/followers",
      "following_url": "https://api.github.com/users/jtratner/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtratner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtratner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtratner/subscriptions",
      "organizations_url": "https://api.github.com/users/jtratner/orgs",
      "repos_url": "https://api.github.com/users/jtratner/repos",
      "events_url": "https://api.github.com/users/jtratner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtratner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-16T00:19:21Z",
    "updated_at": "2013-09-16T00:19:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jmcnamara so obviously, once you integrate, just set `engine_name = 'xlsxwriter'` and you should be good.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/24495069",
    "html_url": "https://github.com/pandas-dev/pandas/pull/4844#issuecomment-24495069",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/4844",
    "id": 24495069,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDk1MDY5",
    "user": {
      "login": "jmcnamara",
      "id": 94267,
      "node_id": "MDQ6VXNlcjk0MjY3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/94267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcnamara",
      "html_url": "https://github.com/jmcnamara",
      "followers_url": "https://api.github.com/users/jmcnamara/followers",
      "following_url": "https://api.github.com/users/jmcnamara/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcnamara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcnamara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcnamara/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcnamara/orgs",
      "repos_url": "https://api.github.com/users/jmcnamara/repos",
      "events_url": "https://api.github.com/users/jmcnamara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcnamara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-09-16T08:27:06Z",
    "updated_at": "2013-09-16T08:27:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jtratner Got it Jeff. Thanks. \n\nYour refactoring work on this and `excel.py` really make adding new engines very easy.  \n"
  }
]
