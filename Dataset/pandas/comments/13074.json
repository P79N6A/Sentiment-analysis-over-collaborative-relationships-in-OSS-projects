[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/216675364",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13074#issuecomment-216675364",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13074",
    "id": 216675364,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxNjY3NTM2NA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-05-03T21:49:38Z",
    "updated_at": "2016-05-03T21:49:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think you might have an old version of `dask`. If it goes to `partd` that means its doing a shuffle, which it should not be. \n\n```\nIn [1]: import dask.dataframe as dd\n\nIn [2]: df_test = pd.DataFrame({'id': ['a', 'a', 'a', 'b', 'b'],\n   ...:                                         'cat': ['t','h','t','h','t']})\n\nIn [3]: df_test['cat'] = df_test['cat'].astype('category')\n\nIn [4]: \n\nIn [4]: df_test = dd.from_pandas(df_test, npartitions=20)\n\nIn [5]: dd_result = df_test.groupby('id').apply(lambda x: (x['cat'] == 't').sum())\n\nIn [6]: pd_result = dd_result.compute()\n\nIn [7]: pd_result\nOut[7]: \nid\na    1\na    0\na    1\nb    0\nb    1\ndtype: int64\n\nIn [8]: import dask\n\nIn [9]: dask.__version__\nOut[9]: '0.8.0'\n\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/216675396",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13074#issuecomment-216675396",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13074",
    "id": 216675396,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxNjY3NTM5Ng==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-05-03T21:49:45Z",
    "updated_at": "2016-05-03T21:49:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "cc @mrocklin\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/216676096",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13074#issuecomment-216676096",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13074",
    "id": 216676096,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxNjY3NjA5Ng==",
    "user": {
      "login": "mrocklin",
      "id": 306380,
      "node_id": "MDQ6VXNlcjMwNjM4MA==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/306380?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mrocklin",
      "html_url": "https://github.com/mrocklin",
      "followers_url": "https://api.github.com/users/mrocklin/followers",
      "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
      "organizations_url": "https://api.github.com/users/mrocklin/orgs",
      "repos_url": "https://api.github.com/users/mrocklin/repos",
      "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mrocklin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-05-03T21:52:44Z",
    "updated_at": "2016-05-03T21:52:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "Anytime you do a `groupby(not_the_index).apply(arbitrary_function)` it will perform a shuffle, which uses a completely different (and much slower) set of code than normal.  If possible its best to avoid groupby-applys altogether\n\n``` python\nIn [1]: import pandas as pd\nim\nIn [2]: import dask.dataframe as dd\n\nIn [3]: df = pd.DataFrame({'id': ['a', 'a', 'a', 'b', 'b'],\n                           'cat': ['t','h','t','h','t']})\n\nIn [4]: df['cat'] = df['cat'].astype('category')\n\nIn [5]: df = dd.from_pandas(df, npartitions=20)\n\nIn [6]: df.assign(cat2 = df.cat == 't').groupby(df.id).cat2.sum().compute()\nOut[6]: \nid\na    2.0\nb    1.0\nName: cat2, dtype: float64\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/216676215",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13074#issuecomment-216676215",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13074",
    "id": 216676215,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxNjY3NjIxNQ==",
    "user": {
      "login": "mrocklin",
      "id": 306380,
      "node_id": "MDQ6VXNlcjMwNjM4MA==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/306380?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mrocklin",
      "html_url": "https://github.com/mrocklin",
      "followers_url": "https://api.github.com/users/mrocklin/followers",
      "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
      "organizations_url": "https://api.github.com/users/mrocklin/orgs",
      "repos_url": "https://api.github.com/users/mrocklin/repos",
      "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mrocklin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-05-03T21:53:11Z",
    "updated_at": "2016-05-03T21:53:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "Or even more concisely\n\n``` python\nIn [9]: (df.cat == 't').groupby(df.id).sum().compute()\nOut[9]: \nid\na    2.0\nb    1.0\nName: cat, dtype: float64\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/216676496",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13074#issuecomment-216676496",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13074",
    "id": 216676496,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxNjY3NjQ5Ng==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-05-03T21:54:31Z",
    "updated_at": "2016-05-03T21:54:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "closing as a usage question.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/216676505",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13074#issuecomment-216676505",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13074",
    "id": 216676505,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxNjY3NjUwNQ==",
    "user": {
      "login": "lminer",
      "id": 5126549,
      "node_id": "MDQ6VXNlcjUxMjY1NDk=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/5126549?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lminer",
      "html_url": "https://github.com/lminer",
      "followers_url": "https://api.github.com/users/lminer/followers",
      "following_url": "https://api.github.com/users/lminer/following{/other_user}",
      "gists_url": "https://api.github.com/users/lminer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lminer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lminer/subscriptions",
      "organizations_url": "https://api.github.com/users/lminer/orgs",
      "repos_url": "https://api.github.com/users/lminer/repos",
      "events_url": "https://api.github.com/users/lminer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lminer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-05-03T21:54:32Z",
    "updated_at": "2016-05-03T21:54:32Z",
    "author_association": "NONE",
    "body": "This was a toy example though. I have a fairly complicated function to apply over groups. Is there a work around apart from converting categorical to object?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/216676721",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13074#issuecomment-216676721",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13074",
    "id": 216676721,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxNjY3NjcyMQ==",
    "user": {
      "login": "mrocklin",
      "id": 306380,
      "node_id": "MDQ6VXNlcjMwNjM4MA==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/306380?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mrocklin",
      "html_url": "https://github.com/mrocklin",
      "followers_url": "https://api.github.com/users/mrocklin/followers",
      "following_url": "https://api.github.com/users/mrocklin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mrocklin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mrocklin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mrocklin/subscriptions",
      "organizations_url": "https://api.github.com/users/mrocklin/orgs",
      "repos_url": "https://api.github.com/users/mrocklin/repos",
      "events_url": "https://api.github.com/users/mrocklin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mrocklin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-05-03T21:55:30Z",
    "updated_at": "2016-05-03T21:55:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "It agree that it does correctly demonstrate what appears to be a bug in partd.  I'll take a look.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/216677078",
    "html_url": "https://github.com/pandas-dev/pandas/issues/13074#issuecomment-216677078",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/13074",
    "id": 216677078,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxNjY3NzA3OA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-05-03T21:57:04Z",
    "updated_at": "2016-05-03T21:57:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "@lminer why don't you post on dask. \n"
  }
]
