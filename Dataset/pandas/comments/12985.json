[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/214546107",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12985#issuecomment-214546107",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12985",
    "id": 214546107,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxNDU0NjEwNw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-04-25T22:10:19Z",
    "updated_at": "2016-04-25T22:10:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "hmm, thought we fixed all of the concat issues. \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/214556159",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12985#issuecomment-214556159",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12985",
    "id": 214556159,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxNDU1NjE1OQ==",
    "user": {
      "login": "ajenkins-cargometrics",
      "id": 11721361,
      "node_id": "MDQ6VXNlcjExNzIxMzYx",
      "avatar_url": "https://avatars2.githubusercontent.com/u/11721361?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajenkins-cargometrics",
      "html_url": "https://github.com/ajenkins-cargometrics",
      "followers_url": "https://api.github.com/users/ajenkins-cargometrics/followers",
      "following_url": "https://api.github.com/users/ajenkins-cargometrics/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajenkins-cargometrics/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajenkins-cargometrics/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajenkins-cargometrics/subscriptions",
      "organizations_url": "https://api.github.com/users/ajenkins-cargometrics/orgs",
      "repos_url": "https://api.github.com/users/ajenkins-cargometrics/repos",
      "events_url": "https://api.github.com/users/ajenkins-cargometrics/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajenkins-cargometrics/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-04-25T22:57:45Z",
    "updated_at": "2016-04-25T22:57:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm able to make this problem go away with this patch:\n\n```\ndiff --git a/pandas/core/internals.py b/pandas/core/internals.py\nindex abfc5c9..fa2f1e3 100644\n--- a/pandas/core/internals.py\n+++ b/pandas/core/internals.py\n@@ -4593,6 +4593,9 @@ def get_empty_dtype_and_na(join_units):\n         else:\n             upcast_cls = 'float'\n\n+        if com.is_extension_type(dtype):\n+            dtype = dtype.base\n+\n         # Null blocks should not influence upcast class selection, unless there\n         # are only null blocks, when same upcasting rules must be applied to\n         # null upcast classes.\n```\n\nI'd submit a PR but I'm not sure if that works the way the `get_empty_dtype_and_na` function is intended.  The only place way I see it being used is to compute a dtype to pass to numpy.empty.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/214559729",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12985#issuecomment-214559729",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12985",
    "id": 214559729,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxNDU1OTcyOQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-04-25T23:14:00Z",
    "updated_at": "2016-04-25T23:14:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "this patch may solve a couple of issues \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/241272037",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12985#issuecomment-241272037",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12985",
    "id": 241272037,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0MTI3MjAzNw==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-08-21T18:04:07Z",
    "updated_at": "2016-08-21T18:04:07Z",
    "author_association": "MEMBER",
    "body": "@ajenkins-cargometrics Do you want to do a PR for this patch?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/245564954",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12985#issuecomment-245564954",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12985",
    "id": 245564954,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NTU2NDk1NA==",
    "user": {
      "login": "grutts",
      "id": 8947004,
      "node_id": "MDQ6VXNlcjg5NDcwMDQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/8947004?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/grutts",
      "html_url": "https://github.com/grutts",
      "followers_url": "https://api.github.com/users/grutts/followers",
      "following_url": "https://api.github.com/users/grutts/following{/other_user}",
      "gists_url": "https://api.github.com/users/grutts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/grutts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/grutts/subscriptions",
      "organizations_url": "https://api.github.com/users/grutts/orgs",
      "repos_url": "https://api.github.com/users/grutts/repos",
      "events_url": "https://api.github.com/users/grutts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/grutts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-08T11:06:16Z",
    "updated_at": "2016-09-08T11:06:16Z",
    "author_association": "NONE",
    "body": "If you are happy with this patch I can make a PR with tests tonight? We're very keen to see this in 19 if it's not too late.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/245565457",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12985#issuecomment-245565457",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12985",
    "id": 245565457,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NTU2NTQ1Nw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-08T11:08:37Z",
    "updated_at": "2016-09-08T11:08:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "if u want to out up a PR with tests great \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/245595023",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12985#issuecomment-245595023",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12985",
    "id": 245595023,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NTU5NTAyMw==",
    "user": {
      "login": "ajenkins-cargometrics",
      "id": 11721361,
      "node_id": "MDQ6VXNlcjExNzIxMzYx",
      "avatar_url": "https://avatars2.githubusercontent.com/u/11721361?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajenkins-cargometrics",
      "html_url": "https://github.com/ajenkins-cargometrics",
      "followers_url": "https://api.github.com/users/ajenkins-cargometrics/followers",
      "following_url": "https://api.github.com/users/ajenkins-cargometrics/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajenkins-cargometrics/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajenkins-cargometrics/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajenkins-cargometrics/subscriptions",
      "organizations_url": "https://api.github.com/users/ajenkins-cargometrics/orgs",
      "repos_url": "https://api.github.com/users/ajenkins-cargometrics/repos",
      "events_url": "https://api.github.com/users/ajenkins-cargometrics/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajenkins-cargometrics/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-08T13:21:45Z",
    "updated_at": "2016-09-08T13:21:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi, sorry for ignoring this for a bit.  The reason I hadn't submitted a PR is because it turns out my simple fix doesn't really work correctly. I wrote a test for it, which you can see here:\n\nhttps://github.com/pydata/pandas/compare/master...ajenkins-cargometrics:GH12985?expand=1\n\nwhich fails because the dtypes of the columns end up changing when appending to an empty DataFrame.  I tried changing the test to pass `check_dtype=False` to `assert_frame_equal`, and then the test fails because the timezone gets stripped from the appended datetime column, resulting in a \"Cannot compare tz-naive and tz-aware timestamps\" error.\n\nIt seems that a more complicated fix is necessary to preserve custom dtypes when appending to an empty DataFrame.  It wasn't obvious to me where to make this fix, and unfortunately I don't have a lot of time right now to work on it.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/246713936",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12985#issuecomment-246713936",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12985",
    "id": 246713936,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NjcxMzkzNg==",
    "user": {
      "login": "grutts",
      "id": 8947004,
      "node_id": "MDQ6VXNlcjg5NDcwMDQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/8947004?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/grutts",
      "html_url": "https://github.com/grutts",
      "followers_url": "https://api.github.com/users/grutts/followers",
      "following_url": "https://api.github.com/users/grutts/following{/other_user}",
      "gists_url": "https://api.github.com/users/grutts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/grutts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/grutts/subscriptions",
      "organizations_url": "https://api.github.com/users/grutts/orgs",
      "repos_url": "https://api.github.com/users/grutts/repos",
      "events_url": "https://api.github.com/users/grutts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/grutts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-13T15:09:35Z",
    "updated_at": "2016-09-13T15:10:08Z",
    "author_association": "NONE",
    "body": "This wasn't obvious to me, but it doesn't just fail for empty dataframes. \n\n``` python\nimport pandas as pd\n\ndf1 = pd.DataFrame({'a': pd.Categorical(['a', 'b', 'c']), 'b': [pd.NaT]*3})\ndf2 = pd.DataFrame({'a': pd.Categorical(['a', 'b', 'a', 'c']), 'b': pd.date_range('2015', periods=4, tz='utc')})\ndf1.append(df2)\n```\n\nI've tried, but not found, ways to preserve the extended dtype on the empty columns; probably because these internals are quite new to me. Would it be unacceptable to introduce ajenkins-cargometrics' change, which might convert 'b' above to object but at least not break or reduce any information? IMO it would be an improvement.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/246714440",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12985#issuecomment-246714440",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12985",
    "id": 246714440,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NjcxNDQ0MA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-13T15:11:00Z",
    "updated_at": "2016-09-13T15:11:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "you can try to introduce that fix and see what happens (need several addtl tests)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/325799854",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12985#issuecomment-325799854",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12985",
    "id": 325799854,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTc5OTg1NA==",
    "user": {
      "login": "sidverm",
      "id": 29815672,
      "node_id": "MDQ6VXNlcjI5ODE1Njcy",
      "avatar_url": "https://avatars3.githubusercontent.com/u/29815672?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sidverm",
      "html_url": "https://github.com/sidverm",
      "followers_url": "https://api.github.com/users/sidverm/followers",
      "following_url": "https://api.github.com/users/sidverm/following{/other_user}",
      "gists_url": "https://api.github.com/users/sidverm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sidverm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sidverm/subscriptions",
      "organizations_url": "https://api.github.com/users/sidverm/orgs",
      "repos_url": "https://api.github.com/users/sidverm/repos",
      "events_url": "https://api.github.com/users/sidverm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sidverm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-29T20:50:13Z",
    "updated_at": "2017-08-29T20:50:13Z",
    "author_association": "NONE",
    "body": "I just faced this problem. Is this bug open for almost a year since reported?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/346948740",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12985#issuecomment-346948740",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12985",
    "id": 346948740,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0Njk0ODc0MA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-25T15:52:41Z",
    "updated_at": "2017-11-25T15:52:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "dupe of #12396 "
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/383870373",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12985#issuecomment-383870373",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12985",
    "id": 383870373,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4Mzg3MDM3Mw==",
    "user": {
      "login": "willgdjones",
      "id": 1719848,
      "node_id": "MDQ6VXNlcjE3MTk4NDg=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1719848?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/willgdjones",
      "html_url": "https://github.com/willgdjones",
      "followers_url": "https://api.github.com/users/willgdjones/followers",
      "following_url": "https://api.github.com/users/willgdjones/following{/other_user}",
      "gists_url": "https://api.github.com/users/willgdjones/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/willgdjones/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/willgdjones/subscriptions",
      "organizations_url": "https://api.github.com/users/willgdjones/orgs",
      "repos_url": "https://api.github.com/users/willgdjones/repos",
      "events_url": "https://api.github.com/users/willgdjones/events{/privacy}",
      "received_events_url": "https://api.github.com/users/willgdjones/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-24T09:42:28Z",
    "updated_at": "2018-04-24T09:42:28Z",
    "author_association": "NONE",
    "body": "I have also just encountered this bug."
  }
]
