[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/418547126",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22596#issuecomment-418547126",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22596",
    "id": 418547126,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxODU0NzEyNg==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-04T23:13:34Z",
    "updated_at": "2018-09-04T23:13:34Z",
    "author_association": "MEMBER",
    "body": "Can you please strip down your example to the bare minimum code that shows the issue? There is a decent amount of extraneous items here that make it more difficult to sift through"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/418560110",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22596#issuecomment-418560110",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22596",
    "id": 418560110,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxODU2MDExMA==",
    "user": {
      "login": "ededovic",
      "id": 9282127,
      "node_id": "MDQ6VXNlcjkyODIxMjc=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9282127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ededovic",
      "html_url": "https://github.com/ededovic",
      "followers_url": "https://api.github.com/users/ededovic/followers",
      "following_url": "https://api.github.com/users/ededovic/following{/other_user}",
      "gists_url": "https://api.github.com/users/ededovic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ededovic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ededovic/subscriptions",
      "organizations_url": "https://api.github.com/users/ededovic/orgs",
      "repos_url": "https://api.github.com/users/ededovic/repos",
      "events_url": "https://api.github.com/users/ededovic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ededovic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-05T00:29:30Z",
    "updated_at": "2018-09-05T00:29:30Z",
    "author_association": "NONE",
    "body": "Here are two examples  only . If we read the below table, row by row, like a standard excel sheet, and if we apply, df.pct_change(), current incorrect formula = new/old -1, we'll get values shown in column \"incorrect\", which is what pandas is doing at the moment. If we apply proposed changed (new - old)/abs(old), then we will get values shown in the correct column. \r\n\r\n     old  new     incorrect       correct\r\n     -1    -2          1.0          -1.0\r\n     -2     1         -1.5           1.5\r\n\r\nThe code that produces above table\r\n`data = [-1,-2,1]`\r\n`df = pd.DataFrame(data,range(len(data)))`\r\n`dfc = pd.concat([df.shift(), df, df.pct_change(), (df-df.shift())/df.shift().abs() ],1)`\r\n`dfc.columns = ['old','new','incorrect','correct']`\r\n`dfc.dropna()`\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/418784167",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22596#issuecomment-418784167",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22596",
    "id": 418784167,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxODc4NDE2Nw==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-05T15:56:45Z",
    "updated_at": "2018-09-05T15:56:45Z",
    "author_association": "MEMBER",
    "body": "Here is a simplified example. For future reference the code you've provided is too complex and brings in way too many things that are unrelated to the point you are trying to make, which is confusing for those trying to help\r\n\r\n```python\r\nIn [14]: data = [-1,-2,1]\r\n    ...: df = pd.DataFrame(data,range(len(data)))\r\n    ...: \r\n\r\nIn [15]: df\r\nOut[15]: \r\n   0\r\n0 -1\r\n1 -2\r\n2  1\r\n\r\nIn [16]: df.pct_change()\r\nOut[16]: \r\n     0\r\n0  NaN\r\n1  1.0\r\n2 -1.5\r\n```\r\n\r\nI believe your point is that the percent change values should be `NaN`, `-1.0` and `1.5`. I'm not sure that's the case however as -2 is in fact a doubling of -1 so a 100% increase there makes sense. Are you seeing a formal definition elsewhere that conflicts with this?\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/445554167",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22596#issuecomment-445554167",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22596",
    "id": 445554167,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NTU1NDE2Nw==",
    "user": {
      "login": "ededovic",
      "id": 9282127,
      "node_id": "MDQ6VXNlcjkyODIxMjc=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9282127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ededovic",
      "html_url": "https://github.com/ededovic",
      "followers_url": "https://api.github.com/users/ededovic/followers",
      "following_url": "https://api.github.com/users/ededovic/following{/other_user}",
      "gists_url": "https://api.github.com/users/ededovic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ededovic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ededovic/subscriptions",
      "organizations_url": "https://api.github.com/users/ededovic/orgs",
      "repos_url": "https://api.github.com/users/ededovic/repos",
      "events_url": "https://api.github.com/users/ededovic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ededovic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-09T17:06:36Z",
    "updated_at": "2018-12-09T17:06:36Z",
    "author_association": "NONE",
    "body": "In finance, when going from -1 to -2 one is going from less debt to more debt , hence one would expect negative -100% change not positive +100% change. Say you had -1$ debt, and now you have -2$ debt, your debt increased by -100%. In absolute terms, the value changed by 100%, but the direction is negative not positive.\r\n\r\nA more complex example is going from -2 (negative) to +1 (positive), one would think of that as a positive change, that is a person went from negative balance to positive balance. However, pandas produces negative -1.5 or -150%. That is completely counter intuitive.\r\n\r\nThe issue is that there is no universal approach for calculating pct_change when there are negative numbers in the series. For that reason, pandas should provide an optional parameter for dealing with negative numbers. \r\n\r\nTo give you more details of the issue, why pandas pct_change calculation produces nonsensical numbers, you can take a look at this article that goes in more details: \r\n\r\n(https://www.excelcampus.com/functions/percentage-change-formula-negative-numbers/)\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/445565092",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22596#issuecomment-445565092",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22596",
    "id": 445565092,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NTU2NTA5Mg==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-09T19:40:06Z",
    "updated_at": "2018-12-09T19:40:06Z",
    "author_association": "MEMBER",
    "body": "> The issue is that there is no universal approach for calculating pct_change when there are negative numbers in the series. For that reason, pandas should provide an optional parameter for dealing with negative numbers.\r\n\r\nAgreed on the first point but not on the second. I don't see a keyword providing much value here over a user using `abs` as desired to get the calculation they want. Closing as a result"
  }
]
