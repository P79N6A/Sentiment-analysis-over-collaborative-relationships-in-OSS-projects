[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/392737924",
    "html_url": "https://github.com/pandas-dev/pandas/issues/21240#issuecomment-392737924",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/21240",
    "id": 392737924,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MjczNzkyNA==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-29T11:04:20Z",
    "updated_at": "2018-05-29T11:04:20Z",
    "author_association": "MEMBER",
    "body": "Do you have any way to simplify this example?\r\n\r\nFWIW you could just sum your boolean columns to get the same result"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/392742322",
    "html_url": "https://github.com/pandas-dev/pandas/issues/21240#issuecomment-392742322",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/21240",
    "id": 392742322,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5Mjc0MjMyMg==",
    "user": {
      "login": "Khris777",
      "id": 7723080,
      "node_id": "MDQ6VXNlcjc3MjMwODA=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/7723080?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Khris777",
      "html_url": "https://github.com/Khris777",
      "followers_url": "https://api.github.com/users/Khris777/followers",
      "following_url": "https://api.github.com/users/Khris777/following{/other_user}",
      "gists_url": "https://api.github.com/users/Khris777/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Khris777/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Khris777/subscriptions",
      "organizations_url": "https://api.github.com/users/Khris777/orgs",
      "repos_url": "https://api.github.com/users/Khris777/repos",
      "events_url": "https://api.github.com/users/Khris777/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Khris777/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-29T11:23:08Z",
    "updated_at": "2018-05-29T11:23:55Z",
    "author_association": "NONE",
    "body": "This simplified example still shows the errorneous behaviour:\r\n\r\n\tdf = pd.DataFrame({\"C0\":['a','a'],'C1':['x','y'],'C3':[True,False]})\r\n\tprint(df.groupby([\"C0\",\"C1\"])[\"C3\"].agg(lambda x: len(x[x])))\r\n\r\nWhereas using `apply` shows the correct behaviour:\r\n\r\n    print(df.groupby([\"C0\",\"C1\"])[\"C3\"].apply(lambda x: len(x[x])))"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/392746680",
    "html_url": "https://github.com/pandas-dev/pandas/issues/21240#issuecomment-392746680",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/21240",
    "id": 392746680,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5Mjc0NjY4MA==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-29T11:42:02Z",
    "updated_at": "2018-05-29T11:43:07Z",
    "author_association": "MEMBER",
    "body": "OK thanks for the last example. I suppose the difference is that agg is casting the result of your anonymous function back to boolean when the result is zeros / ones and apply is not. This also explains why none of the other columns were cast back to boolean (they had more than just 0s and 1s) and also why having N != 1 would not cast back to boolean either.\r\n\r\nThere are a variety of ways to handle this from the end user perspective, whether it be through explicit typing or again using something like sum which would be more idiomatic and performant than what you are trying to do anyway. \r\n\r\nThat said, investigation and PRs to align the casting rules for apply and agg are always welcome!"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/392747894",
    "html_url": "https://github.com/pandas-dev/pandas/issues/21240#issuecomment-392747894",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/21240",
    "id": 392747894,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5Mjc0Nzg5NA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-29T11:47:07Z",
    "updated_at": "2018-05-29T11:47:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "xref #14873 is the root issue here."
  }
]
