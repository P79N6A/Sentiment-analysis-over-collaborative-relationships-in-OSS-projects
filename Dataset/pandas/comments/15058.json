[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/270476916",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15058#issuecomment-270476916",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15058",
    "id": 270476916,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDQ3NjkxNg==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-04T20:25:04Z",
    "updated_at": "2017-01-04T20:25:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "so you have a somewhat older version of pandas. so not really sure what you are expecting."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/270482139",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15058#issuecomment-270482139",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15058",
    "id": 270482139,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDQ4MjEzOQ==",
    "user": {
      "login": "thequackdaddy",
      "id": 8186432,
      "node_id": "MDQ6VXNlcjgxODY0MzI=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/8186432?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thequackdaddy",
      "html_url": "https://github.com/thequackdaddy",
      "followers_url": "https://api.github.com/users/thequackdaddy/followers",
      "following_url": "https://api.github.com/users/thequackdaddy/following{/other_user}",
      "gists_url": "https://api.github.com/users/thequackdaddy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thequackdaddy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thequackdaddy/subscriptions",
      "organizations_url": "https://api.github.com/users/thequackdaddy/orgs",
      "repos_url": "https://api.github.com/users/thequackdaddy/repos",
      "events_url": "https://api.github.com/users/thequackdaddy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thequackdaddy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-04T20:47:50Z",
    "updated_at": "2017-01-04T20:48:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "Sorry for confusion! This happens on newer pandas too... made a quick env to demonstrate... This might be a \"we don't do that intentionally\" question. \r\n\r\nI'm trying to sort a table by a categorical for things to be in a more intuitive sense. The data is stored in a few codes as strings, but I can essentially sort the table by the code (and not alphabetically) in a more intuitive order by setting up categorical. \r\n\r\nSo...\r\n\r\n```python\r\nIn [1]: import pandas as pd\r\n   ...:\r\n   ...: x = pd.Categorical(['apples', 'dairy', 'chicken', 'beef', 'apples', 'da\r\n   ...: iry', 'chicken'], categories=['apples', 'dairy', 'beef', 'chicken'])\r\n   ...: y = pd.Series([1, 2, 1, 2, 1, 2, 1])\r\n   ...: z = pd.Series([3, 4, 2, 1, 3, 2, 1])\r\n   ...:\r\n\r\nIn [2]: df = pd.DataFrame({'x': x, 'y':y, 'z': z})\r\n\r\nIn [3]: df.sort_values('x')\r\nOut[3]:\r\n         x  y  z\r\n0   apples  1  3\r\n4   apples  1  3\r\n1    dairy  2  4\r\n5    dairy  2  2\r\n3     beef  2  1\r\n2  chicken  1  2\r\n6  chicken  1  1\r\n```\r\n\r\nNotice here that when I sorted the table, the categoricals sorted as I wanted them to. apples, then dairy, then beef, then chicken. \r\n\r\n```python\r\nIn [4]: df =  df.set_index(['x', 'y'])\r\n\r\nIn [5]: df.sort_index()\r\nOut[5]:\r\n           z\r\nx       y\r\napples  1  3\r\n        1  3\r\nbeef    2  1\r\nchicken 1  2\r\n        1  1\r\ndairy   2  4\r\n        2  2\r\n```\r\nWhen I set the index, now it sorts alphabetically (apples, beef, chicken dairy)... its essentially forgot that I set it to categorical and had a special order. \r\n\r\nThe pandas version is\r\n```python\r\nIn [6]: pd.__version__\r\nOut[6]: '0.19.2+0.g825876c.dirty'\r\n```\r\n\r\n<details>\r\ncommit: None\r\npython: 3.6.0.final.0\r\npython-bits: 64\r\nOS: Windows\r\nOS-release: 7\r\nmachine: AMD64\r\nprocessor: Intel64 Family 6 Model 60 Stepping 3, GenuineIntel\r\nbyteorder: little\r\nLC_ALL: None\r\nLANG: None\r\nLOCALE: None.None\r\n\r\npandas: 0.19.2+0.g825876c.dirty\r\nnose: None\r\npip: 9.0.1\r\nsetuptools: 27.2.0\r\nCython: None\r\nnumpy: 1.11.2\r\nscipy: None\r\nstatsmodels: None\r\nxarray: None\r\nIPython: 5.1.0\r\nsphinx: None\r\npatsy: None\r\ndateutil: 2.6.0\r\npytz: 2016.10\r\nblosc: None\r\nbottleneck: None\r\ntables: None\r\nnumexpr: None\r\nmatplotlib: None\r\nopenpyxl: None\r\nxlrd: None\r\nxlwt: None\r\nxlsxwriter: None\r\nlxml: None\r\nbs4: None\r\nhtml5lib: None\r\nhttplib2: None\r\napiclient: None\r\nsqlalchemy: None\r\npymysql: None\r\npsycopg2: None\r\njinja2: None\r\nboto: None\r\npandas_datareader: None\r\n</details>"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/270485185",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15058#issuecomment-270485185",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15058",
    "id": 270485185,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDQ4NTE4NQ==",
    "user": {
      "login": "thequackdaddy",
      "id": 8186432,
      "node_id": "MDQ6VXNlcjgxODY0MzI=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/8186432?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thequackdaddy",
      "html_url": "https://github.com/thequackdaddy",
      "followers_url": "https://api.github.com/users/thequackdaddy/followers",
      "following_url": "https://api.github.com/users/thequackdaddy/following{/other_user}",
      "gists_url": "https://api.github.com/users/thequackdaddy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thequackdaddy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thequackdaddy/subscriptions",
      "organizations_url": "https://api.github.com/users/thequackdaddy/orgs",
      "repos_url": "https://api.github.com/users/thequackdaddy/repos",
      "events_url": "https://api.github.com/users/thequackdaddy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thequackdaddy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-04T21:00:59Z",
    "updated_at": "2017-01-04T21:02:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "A simpler example...\r\n```python\r\nIn [1]: import pandas as pd\r\n   ...: \r\n   ...: x = pd.Categorical(['apples', 'dairy', 'chicken', 'beef', 'apples', 'dairy', 'chicken'], categories=['apples', 'dairy', 'beef', 'chicken'])\r\n   ...: y = pd.Series([1, 2, 1, 2, 1, 2, 1])\r\n   ...: z = pd.Series([3, 4, 2, 1, 3, 2, 1])\r\n   ...: \r\n   ...: df = pd.DataFrame({'z': z, 'x': x, 'y': y})\r\n   ...: df.x.dtype\r\nOut[1]: category\r\n\r\nIn [2]: df = df.set_index(['x', 'y']).reset_index()\r\n\r\nIn [3]: df.x.dtype\r\nOut[3]: dtype('O')\r\n```\r\nSo `x` went from `categorical` to `O` because I put it in a MultiIndex. \r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/270486723",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15058#issuecomment-270486723",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15058",
    "id": 270486723,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDQ4NjcyMw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-04T21:07:49Z",
    "updated_at": "2017-01-04T21:07:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "lots of fixed in 0.19.x, encourage you to upgrade\r\n\r\n```\r\nIn [114]: x = pd.Categorical(['apples', 'dairy', 'chicken', 'beef', 'apples', 'dairy', 'chicken'], categories=['apples', 'dairy', 'beef', 'chicken'])\r\n     ...:    ...: y = pd.Series([1, 2, 1, 2, 1, 2, 1])\r\n     ...:    ...: z = pd.Series([3, 4, 2, 1, 3, 2, 1])\r\n     ...:    ...:\r\n     ...:    ...: df = pd.DataFrame({'z': z, 'x': x, 'y': y})\r\n     ...:    ...: df.x.dtype\r\n     ...:\r\nOut[114]: category\r\n\r\nIn [115]: df = df.set_index(['x', 'y']).reset_index()\r\n\r\nIn [116]: df.x.dtype\r\nOut[116]: category\r\n\r\nIn [117]: pd.__version__\r\nOut[117]: '0.19.0+307.g788b6ff.dirty'\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/270495702",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15058#issuecomment-270495702",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15058",
    "id": 270495702,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDQ5NTcwMg==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-04T21:44:38Z",
    "updated_at": "2017-01-04T21:44:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "http://pandas.pydata.org/pandas-docs/stable/categorical.html#sorting-and-order"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/270505469",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15058#issuecomment-270505469",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15058",
    "id": 270505469,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDUwNTQ2OQ==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-04T22:27:44Z",
    "updated_at": "2017-01-04T22:27:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "Is this incorrect?\r\n\r\n```python\r\nIn [30]: import pandas as pd\r\n    ...:\r\n    ...: x = pd.Categorical(['apples', 'dairy', 'chicken', 'beef', 'apples', 'dairy', 'chicken'], categories=['apples', 'dairy', 'beef', 'chicken'], ordered=True)\r\n    ...: y = pd.Series([1, 2, 1, 2, 1, 2, 1])\r\n    ...: z = pd.Series([3, 4, 2, 1, 3, 2, 1])\r\n    ...:\r\n    ...: df = pd.DataFrame({'z': z, 'x': x, 'y':y})\r\n    ...: df.set_index(['x', 'y']).sort_index()\r\n    ...:\r\nOut[30]:\r\n           z\r\nx       y\r\napples  1  3\r\n        1  3\r\nbeef    2  1\r\nchicken 1  2\r\n        1  1\r\ndairy   2  4\r\n        2  2\r\n```\r\n\r\nNotice the `ordered=True`, when creating the `Categorical`, which differs from the original post. The index is lex-sorted, when (maybe) it should follow the categorical ordering\r\n\r\n```python\r\n           z\r\nx       y\r\napples  1  3\r\n        1  3\r\ndairy   2  4\r\n        2  2\r\nbeef    2  1\r\nchicken 1  2\r\n        1  1\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/271311989",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15058#issuecomment-271311989",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15058",
    "id": 271311989,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTMxMTk4OQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-09T15:24:14Z",
    "updated_at": "2017-01-09T15:24:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "@TomAugspurger  I agree an ordered Cat should be respected in the ``.sort_index``. Note that this might do all kinds of odd things when you actually try to index into this (as a ``MultiIndex`` actually requires lexsorting), xref #14015 . So please open a separate issue for this. (as this one is not about an ``ordered`` categorical, but an unordered one."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/271399318",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15058#issuecomment-271399318",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15058",
    "id": 271399318,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTM5OTMxOA==",
    "user": {
      "login": "jorisvandenbossche",
      "id": 1020496,
      "node_id": "MDQ6VXNlcjEwMjA0OTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1020496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jorisvandenbossche",
      "html_url": "https://github.com/jorisvandenbossche",
      "followers_url": "https://api.github.com/users/jorisvandenbossche/followers",
      "following_url": "https://api.github.com/users/jorisvandenbossche/following{/other_user}",
      "gists_url": "https://api.github.com/users/jorisvandenbossche/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jorisvandenbossche/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jorisvandenbossche/subscriptions",
      "organizations_url": "https://api.github.com/users/jorisvandenbossche/orgs",
      "repos_url": "https://api.github.com/users/jorisvandenbossche/repos",
      "events_url": "https://api.github.com/users/jorisvandenbossche/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jorisvandenbossche/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-09T20:33:09Z",
    "updated_at": "2017-01-09T20:33:09Z",
    "author_association": "MEMBER",
    "body": "Ordered categorical or not, it should still respect the order of the categories when sorting, so that distinction does not really matter here:\r\n\r\n```\r\n\r\nIn [20]: c1 = pd.Series(list('adcb')).astype('category', categories=list('acbd'))\r\n\r\nIn [21]: c1.sort_values()\r\nOut[21]: \r\n0    a\r\n2    c\r\n3    b\r\n1    d\r\ndtype: category\r\nCategories (4, object): [a, c, b, d]\r\n\r\nIn [22]: c2 = pd.Series(list('adcb')).astype('category', categories=list('acbd'), ordered=True)\r\n\r\nIn [23]: c2.sort_values()\r\nOut[23]: \r\n0    a\r\n2    c\r\n3    b\r\n1    d\r\ndtype: category\r\nCategories (4, object): [a < c < b < d]\r\n```\r\n\r\nIn any case, the example Tom showed in his last post *is* incorrect AFAIK:\r\n\r\n```\r\nIn [30]: df2 = df.set_index(['x', 'y'])\r\n\r\nIn [31]: df2.index\r\nOut[31]: \r\nMultiIndex(levels=[['apples', 'dairy', 'beef', 'chicken'], [1, 2]],\r\n           labels=[[0, 1, 3, 2, 0, 1, 3], [0, 1, 0, 1, 0, 1, 0]],\r\n           names=['x', 'y'])\r\n\r\nIn [32]: df2.sort_index()\r\nOut[32]: \r\n           z\r\nx       y   \r\napples  1  3\r\n        1  3\r\nbeef    2  1\r\nchicken 1  2\r\n        1  1\r\ndairy   2  4\r\n        2  2\r\n\r\nIn [33]: df2.sort_index().index\r\nOut[33]: \r\nMultiIndex(levels=[['apples', 'dairy', 'beef', 'chicken'], [1, 2]],\r\n           labels=[[0, 0, 2, 3, 3, 1, 1], [0, 0, 1, 0, 0, 1, 1]],\r\n           names=['x', 'y'])\r\n```\r\n\r\nSo even after sorting, the labels of the index are not sorted? \r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/271456040",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15058#issuecomment-271456040",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15058",
    "id": 271456040,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTQ1NjA0MA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-10T00:59:34Z",
    "updated_at": "2017-01-10T00:59:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "so this patch fixes this (and it is *still* considered lexsorted), but will break a few tests.\r\nI think this 'conversion to lexsortedness' needs to happen *inside* the index via a method call, so that we are not willy-nilly just converting things.\r\n\r\n```\r\ndiff --git a/pandas/core/frame.py b/pandas/core/frame.py\r\nindex b9290c0..d0e8b8a 100644\r\n--- a/pandas/core/frame.py\r\n+++ b/pandas/core/frame.py\r\n@@ -3304,8 +3304,8 @@ class DataFrame(NDFrame):\r\n \r\n             # make sure that the axis is lexsorted to start\r\n             # if not we need to reconstruct to get the correct indexer\r\n-            if not labels.is_lexsorted():\r\n-                labels = MultiIndex.from_tuples(labels.values)\r\n+            #if not labels.is_lexsorted():\r\n+            #    labels = MultiIndex.from_tuples(labels.values)\r\n \r\n             indexer = _lexsort_indexer(labels.labels, orders=ascending,\r\n                                        na_position=na_position)\r\n```\r\n\r\n```\r\nIn [1]: x = pd.Categorical(['apples', 'dairy', 'chicken', 'beef', 'apples', 'dairy', 'chicken'], categories=['apples', 'dairy', 'beef', 'chicken'], ordered=True)\r\n   ...: y = pd.Series([1, 2, 1, 2, 1, 2, 1])\r\n   ...: z = pd.Series([3, 4, 2, 1, 3, 2, 1])\r\n   ...: df = pd.DataFrame({'z': z, 'x': x, 'y':y})\r\n   ...: \r\n\r\nIn [2]: df.set_index(['x','y']).sort_index()\r\nOut[2]: \r\n           z\r\nx       y   \r\napples  1  3\r\n        1  3\r\ndairy   2  4\r\n        2  2\r\nbeef    2  1\r\nchicken 1  2\r\n        1  1\r\n\r\nIn [3]: df.set_index(['x','y']).sort_index().index.is_lexsorted()\r\nOut[3]: True\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/271456344",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15058#issuecomment-271456344",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15058",
    "id": 271456344,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTQ1NjM0NA==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-10T01:01:24Z",
    "updated_at": "2017-01-10T01:01:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jreback writing a longer post, but did you notice that it's only broken for `DataFrame.sort_index`?\r\n\r\n```python\r\n\r\nIn [32]: df = pd.DataFrame({'a': np.arange(6), 'l1': pd.Categorical(['a', 'a', 'b', 'b', 'c', 'c'], categories=['c', 'a', 'b'], ordered=True), 'l2': [0, 1, 0, 1, 0, 1]})\r\n\r\nIn [30]: df.set_index(['l1', 'l2']).a.sort_index()  # Series, correct\r\nOut[30]:\r\nl1  l2\r\nc   0     4\r\n    1     5\r\na   0     0\r\n    1     1\r\nb   0     2\r\n    1     3\r\nName: a, dtype: int64\r\n\r\nIn [31]: df.set_index(['l1', 'l2']).sort_index()  # dataFrame, wrong\r\nOut[31]:\r\n       a\r\nl1 l2\r\na  0   0\r\n   1   1\r\nb  0   2\r\n   1   3\r\nc  0   4\r\n   1   5\r\n\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/271456489",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15058#issuecomment-271456489",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15058",
    "id": 271456489,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTQ1NjQ4OQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-10T01:02:22Z",
    "updated_at": "2017-01-10T01:02:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "yes, the sorting routines are somewhat *different* for dataframe & series. They should be *more* unified."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/271456824",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15058#issuecomment-271456824",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15058",
    "id": 271456824,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTQ1NjgyNA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-10T01:04:21Z",
    "updated_at": "2017-01-10T01:04:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "actually they are almost identical (except for that change I just made). I think we should simply combine them (this just for ``sort_index``)."
  }
]
