[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/27999561",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5463#issuecomment-27999561",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5463",
    "id": 27999561,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3OTk5NTYx",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-07T19:46:39Z",
    "updated_at": "2013-11-07T19:46:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "you are using 0.11? this was a bug fixed in 0.12. \n\nThe bug was tha order of the columns when you are appending rows would have not have been identical to the existing order.\n\nYou can work around by reading in your store, concating in memory and writing it again (sort of defeats the purpose of appending!). It was a very idiosyncratic error.\n\nhere is the test that I used:\n\n```\ndf = DataFrame(np.random.randn(10,2),columns=list('AB'), dtype='float64')\ndf['int64'] = Series([1]*len(df),dtype='int64')\ndf['int16'] = Series([1]*len(df),dtype='int16')\n\nstore = HDFStore('test.h5',mode='w')\nstore.append('df',df)\n\n# store additonal fields in different blocks\ndf['int16_2'] = Series([1]*len(df),dtype='int16')\n\n# this will raise\nstore.append('df', df)\n```\n\nanother way to get around is to make your data all floats (and not integers).\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/28000387",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5463#issuecomment-28000387",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5463",
    "id": 28000387,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDAwMzg3",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-07T19:56:18Z",
    "updated_at": "2013-11-07T19:56:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "see #4096, I forgot that you can just specify `data_columns=True` and this will fix it as well as that enforces a spcific ordering\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/28000935",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5463#issuecomment-28000935",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5463",
    "id": 28000935,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDAwOTM1",
    "user": {
      "login": "bluefir",
      "id": 1903683,
      "node_id": "MDQ6VXNlcjE5MDM2ODM=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1903683?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bluefir",
      "html_url": "https://github.com/bluefir",
      "followers_url": "https://api.github.com/users/bluefir/followers",
      "following_url": "https://api.github.com/users/bluefir/following{/other_user}",
      "gists_url": "https://api.github.com/users/bluefir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bluefir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bluefir/subscriptions",
      "organizations_url": "https://api.github.com/users/bluefir/orgs",
      "repos_url": "https://api.github.com/users/bluefir/repos",
      "events_url": "https://api.github.com/users/bluefir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bluefir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-07T20:02:35Z",
    "updated_at": "2013-11-07T20:02:35Z",
    "author_association": "NONE",
    "body": "Yes, I am using 0.11. There is nothing I can do about it - it's installed in our Linux environment and I do not control that. I already struggled with the column order and different dtypes, but I fixed that by enforcing the same order and dtypes. So, let me reiterate. If I read the DataFrame from the file, I have the same column order and the same dtypes as in the DataFrame I am trying to append. From the file:\n\n```\nalphas.dtypes\n```\n\n> RefIssuerID               int64\n> FundSecNo                 int64\n> SourceFundSecNo           int64\n> ModelId                   int64\n> Investable                int64\n> FinalThaForecast        float64\n> DemeanGroupId             int64\n> NormalizationGroupId      int64\n> Dev                       int64\n> IssueCapUSD             float64\n> ScaledThaForecast       float64\n> UnscaledThaForecast     float64\n> annc_earn_surp          float64\n> asset_qual              float64\n> cash_flow_qual          float64\n> cash_flow_value         float64\n> earn_announce           float64\n> earn_surp_pred          float64\n> earnings_trend          float64\n> fcf_to_value            float64\n> fund_earn_surp          float64\n> leadership              float64\n> mgmt_behavior           float64\n> news_flow               float64\n> nt_ret_momentum         float64\n> operating_qual          float64\n> peer_momentum           float64\n> prc_intr_value          float64\n> rec_change              float64\n> short_interest          float64\n> smart_srr               float64\n> volume                  float64\n> SIAdjustment            float64\n> scale_factor            float64\n> dtype: object\n\n```\n(lambda x: (type(x[0]), type(x[1])))(alphas.index.levels)\n```\n\n(pandas.tseries.index.DatetimeIndex, pandas.core.index.Int64Index)\n\nDataFrame to append:\n\n> DataFrame columns are Index([RefIssuerID, FundSecNo, SourceFundSecNo, ModelId, Investable, FinalThaForecast, DemeanGroupId, NormalizationGroupId, Dev, IssueCapUSD, ScaledThaForecast, UnscaledThaForecast, annc_earn_surp, asset_qual, cash_flow_qual, cash_flow_value, earn_announce, earn_surp_pred, earnings_trend, fcf_to_value, fund_earn_surp, leadership, mgmt_behavior, news_flow, nt_ret_momentum, operating_qual, peer_momentum, prc_intr_value, rec_change, short_interest, smart_srr, volume, SIAdjustment, scale_factor], dtype=object)\n> \n> DataFrame column types are ['int64', 'int64', 'int64', 'int64', 'int64', 'float64', 'int64', 'int64', 'int64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64', 'float64']\n> \n> DataFrame index types are (<class 'pandas.tseries.index.DatetimeIndex'>, <class 'pandas.core.index.Int64Index'>)\n\nI am lost. Reading the file from disk is a non-starter - I will run out of memory.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/28001549",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5463#issuecomment-28001549",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5463",
    "id": 28001549,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDAxNTQ5",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-07T20:09:51Z",
    "updated_at": "2013-11-07T20:09:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "you will have to recreate your file and append to a new one using `data_columns=True` (this will save differently in pytables).\n\nsince the hdf iterator doesn't exist in 0.11, do something like this:\n\n```\nexisting = pd.HDFStore('existing.h5')\nnew = pd.HDFStore('new.h5',mode='w')\n\nnrows = existing.get_storer('df').nrows\nchunksize = 100000\nchunks = int(nrows / chunksize) + 1\n\nfor i xrange(chunks):\n\n     start = i * chunksize\n     stop = min((i+1)*chunksize,nrows)\n     df = existing.select('df',start=start,stop=stop)\n     new.append('df',df,data_columns=True)\n\nnew.close()\nexisting.close()\n```\n\nthen you should be good to go and can just append after you have converted your existing data. \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/28003738",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5463#issuecomment-28003738",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5463",
    "id": 28003738,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDAzNzM4",
    "user": {
      "login": "bluefir",
      "id": 1903683,
      "node_id": "MDQ6VXNlcjE5MDM2ODM=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1903683?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bluefir",
      "html_url": "https://github.com/bluefir",
      "followers_url": "https://api.github.com/users/bluefir/followers",
      "following_url": "https://api.github.com/users/bluefir/following{/other_user}",
      "gists_url": "https://api.github.com/users/bluefir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bluefir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bluefir/subscriptions",
      "organizations_url": "https://api.github.com/users/bluefir/orgs",
      "repos_url": "https://api.github.com/users/bluefir/repos",
      "events_url": "https://api.github.com/users/bluefir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bluefir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-07T20:34:50Z",
    "updated_at": "2013-11-07T20:34:50Z",
    "author_association": "NONE",
    "body": "I have this function to do my saves:\n\n```\ndef save_data(data_frame, filename, output_name, append_to_file=True,\n              compression_level=Settings.HDF5_COMPRESSION_LEVEL,\n              compression_library=Settings.HDF5_COMPRESSION_LIBRARY):\n    \"\"\"\n    Saves DataFrame into an HDF5 file in a table format.\n\n    Parameters\n    ----------\n    data_frame: pandas DataFrame\n    filename: str\n        Full name of the HDF5 file.\n    output_name: str\n        Name of the corresponding table withing the HDF5 file.\n    append_to_file: bool, default True\n        Whether to append to an existing file. If False, the file is overwritten.\n    compression_level: int\n        Compression level passed to complevel parameter in DataFrame.to_hdf() method.\n    compression_library: str\n        Compression library passet to complib parameter in DataFrame.to_hdf() method.\n    \"\"\"\n    assert isinstance(data_frame, DataFrame)\n    assert isinstance(filename, str)\n    assert isinstance(output_name, str)\n    assert isinstance(append_to_file, bool)\n\n    mode = 'a' if append_to_file else 'w'\n    store = pd.HDFStore(filename, mode=mode, complevel=compression_level, complib=compression_library)\n    store.append(output_name, data_frame, data_columns=True)\n    store.close()\n```\n\nI added data_columns=True to it. This should work, right?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/28005161",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5463#issuecomment-28005161",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5463",
    "id": 28005161,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDA1MTYx",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-07T20:51:33Z",
    "updated_at": "2013-11-07T20:51:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "yes I belive that should work, but you need to start with a fresh node (IOW you need to rewrite your existing data). Its stored in a slightly different way in pytables\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/28005704",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5463#issuecomment-28005704",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5463",
    "id": 28005704,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDA1NzA0",
    "user": {
      "login": "bluefir",
      "id": 1903683,
      "node_id": "MDQ6VXNlcjE5MDM2ODM=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1903683?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bluefir",
      "html_url": "https://github.com/bluefir",
      "followers_url": "https://api.github.com/users/bluefir/followers",
      "following_url": "https://api.github.com/users/bluefir/following{/other_user}",
      "gists_url": "https://api.github.com/users/bluefir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bluefir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bluefir/subscriptions",
      "organizations_url": "https://api.github.com/users/bluefir/orgs",
      "repos_url": "https://api.github.com/users/bluefir/repos",
      "events_url": "https://api.github.com/users/bluefir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bluefir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-07T20:58:07Z",
    "updated_at": "2013-11-07T20:58:07Z",
    "author_association": "NONE",
    "body": "Given the overhead, can I get away with only designating int columns as data columns? \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/28005882",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5463#issuecomment-28005882",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5463",
    "id": 28005882,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDA1ODgy",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-07T21:00:28Z",
    "updated_at": "2013-11-07T21:00:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "you can give just a list if you want. I am not exactly sure what 'causes' this bug, as its somewhat idiosyncratic. another option is to store yourdata in multple tables.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/28021724",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5463#issuecomment-28021724",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5463",
    "id": 28021724,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDIxNzI0",
    "user": {
      "login": "bluefir",
      "id": 1903683,
      "node_id": "MDQ6VXNlcjE5MDM2ODM=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1903683?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bluefir",
      "html_url": "https://github.com/bluefir",
      "followers_url": "https://api.github.com/users/bluefir/followers",
      "following_url": "https://api.github.com/users/bluefir/following{/other_user}",
      "gists_url": "https://api.github.com/users/bluefir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bluefir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bluefir/subscriptions",
      "organizations_url": "https://api.github.com/users/bluefir/orgs",
      "repos_url": "https://api.github.com/users/bluefir/repos",
      "events_url": "https://api.github.com/users/bluefir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bluefir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-08T00:43:23Z",
    "updated_at": "2013-11-08T00:43:23Z",
    "author_association": "NONE",
    "body": "It worked! Thanks a lot for the tip. So, was it fixed in 0.12 or does this hezenbug still exist in the most recent stable version?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/28022660",
    "html_url": "https://github.com/pandas-dev/pandas/issues/5463#issuecomment-28022660",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/5463",
    "id": 28022660,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDIyNjYw",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-08T01:02:41Z",
    "updated_at": "2013-11-08T01:02:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "gr8\nfixed in 0.12 (and shortly to be released 0.13)\n"
  }
]
