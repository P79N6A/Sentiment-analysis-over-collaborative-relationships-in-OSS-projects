[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/65214878",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8962#issuecomment-65214878",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8962",
    "id": 65214878,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MjE0ODc4",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-02T11:08:41Z",
    "updated_at": "2014-12-02T11:08:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "can u post a small but complete copy-pastable example\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/65219802",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8962#issuecomment-65219802",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8962",
    "id": 65219802,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MjE5ODAy",
    "user": {
      "login": "cstotzer",
      "id": 3476592,
      "node_id": "MDQ6VXNlcjM0NzY1OTI=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/3476592?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cstotzer",
      "html_url": "https://github.com/cstotzer",
      "followers_url": "https://api.github.com/users/cstotzer/followers",
      "following_url": "https://api.github.com/users/cstotzer/following{/other_user}",
      "gists_url": "https://api.github.com/users/cstotzer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cstotzer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cstotzer/subscriptions",
      "organizations_url": "https://api.github.com/users/cstotzer/orgs",
      "repos_url": "https://api.github.com/users/cstotzer/repos",
      "events_url": "https://api.github.com/users/cstotzer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cstotzer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-02T11:51:13Z",
    "updated_at": "2014-12-02T11:53:33Z",
    "author_association": "NONE",
    "body": "Sure, here goes\n\n``` python\nimport pandas\nimport numpy\n\ndf_left = DataFrame([[1,3,4],[2,3,5],[NaN,2,8]], index=['a','b','c'], columns=['one', 'two', 'three'])\ndf_right = DataFrame([[4,2],[3,6]], index=['b','c'], columns=['one','two'])\n\n# What I do as of now:\n# ================\ndf_merged = merge(df_left, df_right, left_index = True, right_index = True, how='left')\n# Coalescing two columns (like SQLs NVL/COALESCE functions)\ndf_merged['one'] = df_merged.one_x.fillna(df_merged.one_y)\n# Setting a columns value depending on another (three might be the rowcount)\ndf_merged['two'] = df_merged.apply(lambda row: row.two_y if row.three <= 3 else row.two_x, axis=1)\n# possibly many more of these\ndf_final = df_merged.drop(['one_x','one_y','two_x','two_y'], axis=1)\n\n#what I would like to do:\n# =================\ndef my_join_func(left, right):\n    out = Series()\n    out['one'] = right.one if left.one == NaN else left.one\n    out['two'] = right.two if left.three <= 3 else left.two\n    return out\n\ndf_final = merge(df_left, df_right, join_func=my_join_func, left_index = True, right_index = True, how='left')\n# or\ndf_left.join(df_right, join_func=my_join_func, how='left')\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/65223520",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8962#issuecomment-65223520",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8962",
    "id": 65223520,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MjIzNTIw",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-02T12:24:35Z",
    "updated_at": "2014-12-02T12:24:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "this looks like https://github.com/pydata/pandas/issues/7480\n\nyes? (though I like your example a bit better).\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/65227278",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8962#issuecomment-65227278",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8962",
    "id": 65227278,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MjI3Mjc4",
    "user": {
      "login": "cstotzer",
      "id": 3476592,
      "node_id": "MDQ6VXNlcjM0NzY1OTI=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/3476592?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cstotzer",
      "html_url": "https://github.com/cstotzer",
      "followers_url": "https://api.github.com/users/cstotzer/followers",
      "following_url": "https://api.github.com/users/cstotzer/following{/other_user}",
      "gists_url": "https://api.github.com/users/cstotzer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cstotzer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cstotzer/subscriptions",
      "organizations_url": "https://api.github.com/users/cstotzer/orgs",
      "repos_url": "https://api.github.com/users/cstotzer/repos",
      "events_url": "https://api.github.com/users/cstotzer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cstotzer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-02T13:02:19Z",
    "updated_at": "2014-12-02T13:02:19Z",
    "author_association": "NONE",
    "body": "Not really, i'm looking for an easier way to specify what column to take from which dataset in the join operation like in the SELECT-Clause of a SQL join. \n\n``` sql\nSELECT COALESCE(l.one, r.one) AS one, \n       CASE WHEN r.three <= 3 THEN r.two ELSE l.two END AS two,\n       three\n  FROM df_left AS l\n  LEFT JOIN df_right AS r ON l.index = r.index\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/65227967",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8962#issuecomment-65227967",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8962",
    "id": 65227967,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MjI3OTY3",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-02T13:08:41Z",
    "updated_at": "2014-12-02T13:08:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "having a `joiner` function is not going to be efficient at all. Can you not prefilter?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/65228280",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8962#issuecomment-65228280",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8962",
    "id": 65228280,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MjI4Mjgw",
    "user": {
      "login": "cstotzer",
      "id": 3476592,
      "node_id": "MDQ6VXNlcjM0NzY1OTI=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/3476592?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cstotzer",
      "html_url": "https://github.com/cstotzer",
      "followers_url": "https://api.github.com/users/cstotzer/followers",
      "following_url": "https://api.github.com/users/cstotzer/following{/other_user}",
      "gists_url": "https://api.github.com/users/cstotzer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cstotzer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cstotzer/subscriptions",
      "organizations_url": "https://api.github.com/users/cstotzer/orgs",
      "repos_url": "https://api.github.com/users/cstotzer/repos",
      "events_url": "https://api.github.com/users/cstotzer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cstotzer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-02T13:11:35Z",
    "updated_at": "2014-12-02T13:11:35Z",
    "author_association": "NONE",
    "body": "You figure that \n\n```\npd.merge(left, right, ...).apply(func) \n```\n\nis more efficient?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/65229184",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8962#issuecomment-65229184",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8962",
    "id": 65229184,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MjI5MTg0",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-02T13:19:55Z",
    "updated_at": "2014-12-02T13:20:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "no, `.apply` is not efficient. I mean that using a python function in the middle of  a vectorized operation is not efficient\n\nI mean which will do an if-then-else\n\n`result = result.where(......)`\n\nor you can do `pd.merge(df_left.where(.....)....)` (e.g. pre-filter the unwanted values to `NaN`)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/387492943",
    "html_url": "https://github.com/pandas-dev/pandas/issues/8962#issuecomment-387492943",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/8962",
    "id": 387492943,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NzQ5Mjk0Mw==",
    "user": {
      "login": "bscheetz",
      "id": 8943045,
      "node_id": "MDQ6VXNlcjg5NDMwNDU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/8943045?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bscheetz",
      "html_url": "https://github.com/bscheetz",
      "followers_url": "https://api.github.com/users/bscheetz/followers",
      "following_url": "https://api.github.com/users/bscheetz/following{/other_user}",
      "gists_url": "https://api.github.com/users/bscheetz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bscheetz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bscheetz/subscriptions",
      "organizations_url": "https://api.github.com/users/bscheetz/orgs",
      "repos_url": "https://api.github.com/users/bscheetz/repos",
      "events_url": "https://api.github.com/users/bscheetz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bscheetz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-08T18:12:03Z",
    "updated_at": "2018-05-08T18:12:03Z",
    "author_association": "NONE",
    "body": "@jreback @cstotzer should this be closed?  Given that it's a goal of pandas to minimize complexity in function calls and this functionality exists (in a vectorized form) via DF/Series where functions, it seems like this is set."
  }
]
