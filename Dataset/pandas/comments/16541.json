[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/305054325",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16541#issuecomment-305054325",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16541",
    "id": 305054325,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNTA1NDMyNQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-31T01:18:03Z",
    "updated_at": "2017-05-31T01:18:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "this fixes if you can do a PR\r\n\r\n```\r\ndiff --git a/pandas/core/indexes/period.py b/pandas/core/indexes/period.py\r\nindex 15fd9b7..50d5958 100644\r\n--- a/pandas/core/indexes/period.py\r\n+++ b/pandas/core/indexes/period.py\r\n@@ -919,14 +919,16 @@ class PeriodIndex(DatelikeOps, DatetimeIndexOpsMixin, Int64Index):\r\n                               self[loc:].asi8))\r\n         return self._shallow_copy(idx)\r\n \r\n-    def join(self, other, how='left', level=None, return_indexers=False):\r\n+    def join(self, other, how='left', level=None, return_indexers=False,\r\n+             sort=False):\r\n         \"\"\"\r\n         See Index.join\r\n         \"\"\"\r\n         self._assert_can_do_setop(other)\r\n \r\n         result = Int64Index.join(self, other, how=how, level=level,\r\n-                                 return_indexers=return_indexers)\r\n+                                 return_indexers=return_indexers,\r\n+                                 sort=sort)\r\n \r\n         if return_indexers:\r\n             result, lidx, ridx = result\r\n```\r\n\r\nobviously need some more tests on the index join methods as well :>\r\n\r\nHere is the tests for datetimes in ``pandas/tests/indexes/datetimes/test_datetimes.py``\r\nneed to do something like this in periods/test_period.py\r\n```\r\n    def test_join_self(self):\r\n        index = date_range('1/1/2000', periods=10)\r\n        kinds = 'outer', 'inner', 'left', 'right'\r\n        for kind in kinds:\r\n            joined = index.join(index, how=kind)\r\n            assert index is joined\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/305054443",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16541#issuecomment-305054443",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16541",
    "id": 305054443,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNTA1NDQ0Mw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-31T01:18:50Z",
    "updated_at": "2017-05-31T01:18:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "if you can do this in next day or 2 can get into 0.20.2 (end of week)"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/306862653",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16541#issuecomment-306862653",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16541",
    "id": 306862653,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNjg2MjY1Mw==",
    "user": {
      "login": "rosygupta",
      "id": 6587993,
      "node_id": "MDQ6VXNlcjY1ODc5OTM=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/6587993?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rosygupta",
      "html_url": "https://github.com/rosygupta",
      "followers_url": "https://api.github.com/users/rosygupta/followers",
      "following_url": "https://api.github.com/users/rosygupta/following{/other_user}",
      "gists_url": "https://api.github.com/users/rosygupta/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rosygupta/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rosygupta/subscriptions",
      "organizations_url": "https://api.github.com/users/rosygupta/orgs",
      "repos_url": "https://api.github.com/users/rosygupta/repos",
      "events_url": "https://api.github.com/users/rosygupta/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rosygupta/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-07T17:13:23Z",
    "updated_at": "2017-06-07T17:13:23Z",
    "author_association": "NONE",
    "body": "@jreback Is this issue still open?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/306903313",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16541#issuecomment-306903313",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16541",
    "id": 306903313,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNjkwMzMxMw==",
    "user": {
      "login": "max-sixty",
      "id": 5635139,
      "node_id": "MDQ6VXNlcjU2MzUxMzk=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/5635139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/max-sixty",
      "html_url": "https://github.com/max-sixty",
      "followers_url": "https://api.github.com/users/max-sixty/followers",
      "following_url": "https://api.github.com/users/max-sixty/following{/other_user}",
      "gists_url": "https://api.github.com/users/max-sixty/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/max-sixty/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/max-sixty/subscriptions",
      "organizations_url": "https://api.github.com/users/max-sixty/orgs",
      "repos_url": "https://api.github.com/users/max-sixty/repos",
      "events_url": "https://api.github.com/users/max-sixty/events{/privacy}",
      "received_events_url": "https://api.github.com/users/max-sixty/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-07T19:42:12Z",
    "updated_at": "2017-06-07T19:42:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "PR waiting here: https://github.com/pandas-dev/pandas/pull/16586"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/307131496",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16541#issuecomment-307131496",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16541",
    "id": 307131496,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzEzMTQ5Ng==",
    "user": {
      "login": "Dr-Irv",
      "id": 15113894,
      "node_id": "MDQ6VXNlcjE1MTEzODk0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/15113894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Dr-Irv",
      "html_url": "https://github.com/Dr-Irv",
      "followers_url": "https://api.github.com/users/Dr-Irv/followers",
      "following_url": "https://api.github.com/users/Dr-Irv/following{/other_user}",
      "gists_url": "https://api.github.com/users/Dr-Irv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Dr-Irv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Dr-Irv/subscriptions",
      "organizations_url": "https://api.github.com/users/Dr-Irv/orgs",
      "repos_url": "https://api.github.com/users/Dr-Irv/repos",
      "events_url": "https://api.github.com/users/Dr-Irv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Dr-Irv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-08T15:03:44Z",
    "updated_at": "2017-06-08T15:03:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "So I used my version 0.20.1 to add the fix suggested above by @jreback , and that fixed the problem for me, but then a different one cropped up.  Not sure if I should just put this in a different issue. In my use case, I took dates and made them a monthly period, and there are duplicates.  Here is a way to make it happen:\r\n```\r\nperindex = pd.period_range('2016-01-01', periods=16, freq='M')\r\nperdf = pd.DataFrame([i for i in range(len(perindex))],\r\n                     index=perindex, columns=['pnum'])\r\ndf2 = pd.concat([perdf, perdf])\r\nperdf.merge(df2, left_index=True, right_index=True, how='outer')\r\n```\r\nThis gives this sequence of errors:\r\n```\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-45-a9a1ea5d6a78> in <module>()\r\n      1 df2 = pd.concat([perdf, perdf])\r\n----> 2 perdf.merge(df2, left_index=True, right_index=True, how='outer')\r\n\r\nC:\\Anaconda3\\envs\\py36\\lib\\site-packages\\pandas\\core\\frame.py in merge(self, right, how, on, left_on, right_on, left_index, right_index, sort, suffixes, copy, indicator)\r\n   4818                      right_on=right_on, left_index=left_index,\r\n   4819                      right_index=right_index, sort=sort, suffixes=suffixes,\r\n-> 4820                      copy=copy, indicator=indicator)\r\n   4821 \r\n   4822     def round(self, decimals=0, *args, **kwargs):\r\n\r\nC:\\Anaconda3\\envs\\py36\\lib\\site-packages\\pandas\\core\\reshape\\merge.py in merge(left, right, how, on, left_on, right_on, left_index, right_index, sort, suffixes, copy, indicator)\r\n     52                          right_index=right_index, sort=sort, suffixes=suffixes,\r\n     53                          copy=copy, indicator=indicator)\r\n---> 54     return op.get_result()\r\n     55 \r\n     56 \r\n\r\nC:\\Anaconda3\\envs\\py36\\lib\\site-packages\\pandas\\core\\reshape\\merge.py in get_result(self)\r\n    567                 self.left, self.right)\r\n    568 \r\n--> 569         join_index, left_indexer, right_indexer = self._get_join_info()\r\n    570 \r\n    571         ldata, rdata = self.left._data, self.right._data\r\n\r\nC:\\Anaconda3\\envs\\py36\\lib\\site-packages\\pandas\\core\\reshape\\merge.py in _get_join_info(self)\r\n    720             join_index, left_indexer, right_indexer = \\\r\n    721                 left_ax.join(right_ax, how=self.how, return_indexers=True,\r\n--> 722                              sort=self.sort)\r\n    723         elif self.right_index and self.how == 'left':\r\n    724             join_index, left_indexer, right_indexer = \\\r\n\r\nC:\\Anaconda3\\envs\\py36\\lib\\site-packages\\pandas\\core\\indexes\\period.py in join(self, other, how, level, return_indexers, sort)\r\n    927 \r\n    928         result = Int64Index.join(self, other, how=how, level=level,\r\n--> 929                                  return_indexers=return_indexers, sort=sort)\r\n    930 \r\n    931         if return_indexers:\r\n\r\nC:\\Anaconda3\\envs\\py36\\lib\\site-packages\\pandas\\core\\indexes\\base.py in join(self, other, how, level, return_indexers, sort)\r\n   2995             else:\r\n   2996                 return self._join_non_unique(other, how=how,\r\n-> 2997                                              return_indexers=return_indexers)\r\n   2998         elif self.is_monotonic and other.is_monotonic:\r\n   2999             try:\r\n\r\nC:\\Anaconda3\\envs\\py36\\lib\\site-packages\\pandas\\core\\indexes\\base.py in _join_non_unique(self, other, how, return_indexers)\r\n   3076         left_idx, right_idx = _get_join_indexers([self.values],\r\n   3077                                                  [other._values], how=how,\r\n-> 3078                                                  sort=True)\r\n   3079 \r\n   3080         left_idx = _ensure_platform_int(left_idx)\r\n\r\nC:\\Anaconda3\\envs\\py36\\lib\\site-packages\\pandas\\core\\reshape\\merge.py in _get_join_indexers(left_keys, right_keys, sort, how, **kwargs)\r\n    980 \r\n    981     # get left & right join labels and num. of levels at each location\r\n--> 982     llab, rlab, shape = map(list, zip(* map(fkeys, left_keys, right_keys)))\r\n    983 \r\n    984     # get flat i8 keys from label lists\r\n\r\nC:\\Anaconda3\\envs\\py36\\lib\\site-packages\\pandas\\core\\reshape\\merge.py in _factorize_keys(lk, rk, sort)\r\n   1409     if sort:\r\n   1410         uniques = rizer.uniques.to_array()\r\n-> 1411         llab, rlab = _sort_labels(uniques, llab, rlab)\r\n   1412 \r\n   1413     # NA group\r\n\r\nC:\\Anaconda3\\envs\\py36\\lib\\site-packages\\pandas\\core\\reshape\\merge.py in _sort_labels(uniques, left, right)\r\n   1435     labels = np.concatenate([left, right])\r\n   1436 \r\n-> 1437     _, new_labels = algos.safe_sort(uniques, labels, na_sentinel=-1)\r\n   1438     new_labels = _ensure_int64(new_labels)\r\n   1439     new_left, new_right = new_labels[:l], new_labels[l:]\r\n\r\nC:\\Anaconda3\\envs\\py36\\lib\\site-packages\\pandas\\core\\algorithms.py in safe_sort(values, labels, na_sentinel, assume_unique)\r\n    476     if compat.PY3 and lib.infer_dtype(values) == 'mixed-integer':\r\n    477         # unorderable in py3 if mixed str/int\r\n--> 478         ordered = sort_mixed(values)\r\n    479     else:\r\n    480         try:\r\n\r\nC:\\Anaconda3\\envs\\py36\\lib\\site-packages\\pandas\\core\\algorithms.py in sort_mixed(values)\r\n    469         str_pos = np.array([isinstance(x, string_types) for x in values],\r\n    470                            dtype=bool)\r\n--> 471         nums = np.sort(values[~str_pos])\r\n    472         strs = np.sort(values[str_pos])\r\n    473         return _ensure_object(np.concatenate([nums, strs]))\r\n\r\nC:\\Anaconda3\\envs\\py36\\lib\\site-packages\\numpy\\core\\fromnumeric.py in sort(a, axis, kind, order)\r\n    820     else:\r\n    821         a = asanyarray(a).copy(order=\"K\")\r\n--> 822     a.sort(axis=axis, kind=kind, order=order)\r\n    823     return a\r\n    824 \r\n\r\npandas\\_libs\\period.pyx in pandas._libs.period._Period.__richcmp__ (pandas\\_libs\\period.c:12067)()\r\n\r\nTypeError: Cannot compare type 'Period' with type 'int'\r\n```\r\n\r\nLet me know if I should open up a new issue, given that this bug happens when applying the above fix.\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/307155444",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16541#issuecomment-307155444",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16541",
    "id": 307155444,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzE1NTQ0NA==",
    "user": {
      "login": "max-sixty",
      "id": 5635139,
      "node_id": "MDQ6VXNlcjU2MzUxMzk=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/5635139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/max-sixty",
      "html_url": "https://github.com/max-sixty",
      "followers_url": "https://api.github.com/users/max-sixty/followers",
      "following_url": "https://api.github.com/users/max-sixty/following{/other_user}",
      "gists_url": "https://api.github.com/users/max-sixty/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/max-sixty/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/max-sixty/subscriptions",
      "organizations_url": "https://api.github.com/users/max-sixty/orgs",
      "repos_url": "https://api.github.com/users/max-sixty/repos",
      "events_url": "https://api.github.com/users/max-sixty/events{/privacy}",
      "received_events_url": "https://api.github.com/users/max-sixty/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-08T16:25:01Z",
    "updated_at": "2017-06-08T16:25:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "Do you get the error run on that PR?\r\n\r\nIf so, I would open a new issue?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/307170455",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16541#issuecomment-307170455",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16541",
    "id": 307170455,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzE3MDQ1NQ==",
    "user": {
      "login": "Dr-Irv",
      "id": 15113894,
      "node_id": "MDQ6VXNlcjE1MTEzODk0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/15113894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Dr-Irv",
      "html_url": "https://github.com/Dr-Irv",
      "followers_url": "https://api.github.com/users/Dr-Irv/followers",
      "following_url": "https://api.github.com/users/Dr-Irv/following{/other_user}",
      "gists_url": "https://api.github.com/users/Dr-Irv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Dr-Irv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Dr-Irv/subscriptions",
      "organizations_url": "https://api.github.com/users/Dr-Irv/orgs",
      "repos_url": "https://api.github.com/users/Dr-Irv/repos",
      "events_url": "https://api.github.com/users/Dr-Irv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Dr-Irv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-08T17:21:16Z",
    "updated_at": "2017-06-08T17:21:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "@MaximilianR I did a hand edit of pandas 0.20.1 to implement what is in the PR, and got the error.  To test it against all PR's, I think I'd need that PR to be merged into master and then I can pull master and test."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/307241509",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16541#issuecomment-307241509",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16541",
    "id": 307241509,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzI0MTUwOQ==",
    "user": {
      "login": "max-sixty",
      "id": 5635139,
      "node_id": "MDQ6VXNlcjU2MzUxMzk=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/5635139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/max-sixty",
      "html_url": "https://github.com/max-sixty",
      "followers_url": "https://api.github.com/users/max-sixty/followers",
      "following_url": "https://api.github.com/users/max-sixty/following{/other_user}",
      "gists_url": "https://api.github.com/users/max-sixty/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/max-sixty/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/max-sixty/subscriptions",
      "organizations_url": "https://api.github.com/users/max-sixty/orgs",
      "repos_url": "https://api.github.com/users/max-sixty/repos",
      "events_url": "https://api.github.com/users/max-sixty/events{/privacy}",
      "received_events_url": "https://api.github.com/users/max-sixty/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-08T22:10:50Z",
    "updated_at": "2017-06-08T22:10:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "Great!\r\n\r\nFYI you can pull someone's PR for convenience, rather than hand-editing"
  }
]
