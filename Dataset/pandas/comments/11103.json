[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/140416442",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11103#issuecomment-140416442",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11103",
    "id": 140416442,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MDQxNjQ0Mg==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-15T14:43:23Z",
    "updated_at": "2015-09-15T14:43:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "you need to post more code.\n\nis their a reason you are not doing:\n\n```\ndf['Bins'] = df.groupby(...).Pos.apply(lambda x: pd.cut(x, bins))\n```\n\n?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/140451064",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11103#issuecomment-140451064",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11103",
    "id": 140451064,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MDQ1MTA2NA==",
    "user": {
      "login": "alvinwt",
      "id": 3662163,
      "node_id": "MDQ6VXNlcjM2NjIxNjM=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/3662163?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alvinwt",
      "html_url": "https://github.com/alvinwt",
      "followers_url": "https://api.github.com/users/alvinwt/followers",
      "following_url": "https://api.github.com/users/alvinwt/following{/other_user}",
      "gists_url": "https://api.github.com/users/alvinwt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alvinwt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alvinwt/subscriptions",
      "organizations_url": "https://api.github.com/users/alvinwt/orgs",
      "repos_url": "https://api.github.com/users/alvinwt/repos",
      "events_url": "https://api.github.com/users/alvinwt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alvinwt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-15T16:24:30Z",
    "updated_at": "2015-09-15T16:24:30Z",
    "author_association": "NONE",
    "body": "@jreback I tried to clean it up a little by removing some of the variables.\nThe problem is that i need the Chr as a key for chromLen for bins, which I am wondering if can be done with the groupby(...).apply(lambda x: pd.cut(x,bins[Chr])) pattern. \n\n```\ngrouped = inputDf.groupby('Chr')\n\n    for chrom, df in grouped:\n\n        try:\n            chromLen =  chromDict[chrom]\n        except KeyError as e:\n            if 'chrY' in str(e):\n                pass\n\n        # make 1 Mbp bins\n        bins = np.arange(0, int(chromLen)+resolution, resolution)\n        df.ix[:,'Bins'] =  pd.cut(df.Pos,bins)\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/140453560",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11103#issuecomment-140453560",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11103",
    "id": 140453560,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MDQ1MzU2MA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-15T16:34:05Z",
    "updated_at": "2015-09-15T16:34:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "you need to show a complete example. e.g. generate a test frame and show each of the operatiosn that you intend.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/140462550",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11103#issuecomment-140462550",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11103",
    "id": 140462550,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MDQ2MjU1MA==",
    "user": {
      "login": "alvinwt",
      "id": 3662163,
      "node_id": "MDQ6VXNlcjM2NjIxNjM=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/3662163?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alvinwt",
      "html_url": "https://github.com/alvinwt",
      "followers_url": "https://api.github.com/users/alvinwt/followers",
      "following_url": "https://api.github.com/users/alvinwt/following{/other_user}",
      "gists_url": "https://api.github.com/users/alvinwt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alvinwt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alvinwt/subscriptions",
      "organizations_url": "https://api.github.com/users/alvinwt/orgs",
      "repos_url": "https://api.github.com/users/alvinwt/repos",
      "events_url": "https://api.github.com/users/alvinwt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alvinwt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-15T16:58:52Z",
    "updated_at": "2015-09-15T16:58:52Z",
    "author_association": "NONE",
    "body": "The operation that I intend is mainly the assignment of bins using the output of pd.cut. \n\n```\ndef count_per_bin(inputDf,resolution=1e4):\n    grouped = inputDf.groupby('Chr')\n    countsDict = {}\n    binnedList = []\n\n    chromDict = {'chr1':24925,'chr2':24319}\n\n    for chrom, df in grouped:\n\n        try: \n            chromLen =  chromDict[chrom]\n        except KeyError as e:\n            if 'chrY' in str(e):\n                pass\n\n        ## make 1 Mbp bins and use pd.cut to allocate bins\n        bins = np.arange(0, int(chromLen)+resolution, resolution)\n        df.ix[:,'Bins'] =  pd.cut(df.Pos,bins)\n\n        binCounts =  pd.DataFrame(df.groupby('Bins').Pos.count())\n        countsDict[chrom] = binCounts\n    return countsDict\n\n\ndata = pd.DataFrame({'Chr':['chr1','chr1','chr2','chr2'],'Pos':[10,100,200,550]})\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/140975429",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11103#issuecomment-140975429",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11103",
    "id": 140975429,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MDk3NTQyOQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-17T05:45:21Z",
    "updated_at": "2015-09-17T05:45:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "ok. not very clear to me what you are trying to accomplish. can you post what you actually want as output?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/414292328",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11103#issuecomment-414292328",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11103",
    "id": 414292328,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNDI5MjMyOA==",
    "user": {
      "login": "dejmail",
      "id": 1876487,
      "node_id": "MDQ6VXNlcjE4NzY0ODc=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1876487?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dejmail",
      "html_url": "https://github.com/dejmail",
      "followers_url": "https://api.github.com/users/dejmail/followers",
      "following_url": "https://api.github.com/users/dejmail/following{/other_user}",
      "gists_url": "https://api.github.com/users/dejmail/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dejmail/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dejmail/subscriptions",
      "organizations_url": "https://api.github.com/users/dejmail/orgs",
      "repos_url": "https://api.github.com/users/dejmail/repos",
      "events_url": "https://api.github.com/users/dejmail/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dejmail/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-20T12:01:36Z",
    "updated_at": "2018-08-20T12:38:40Z",
    "author_association": "NONE",
    "body": "@jreback \r\n\r\nHi there, I will try to explain what @alvinwt was/is seeing as I am getting the same message, and am also working with similar data.\r\n\r\nI have a dataframe that has the following test structure (4 columns):\r\n\r\n```\r\n\r\nchromosomes = (\"chrI\", \"chrII\", \"chrIII\", \"chrIV\", \"chrV\")\r\nchromosome_list = np.sort(np.random.choice(list(chromosomes), 100))\r\n\r\nbin_list = []\r\nfor i, x  in enumerate(chromosome_list):\r\n    if chromosome_list[i] == chromosome_list[i-1]:\r\n        bin_list.append(bin_list[i-1]+np.random.randint(0,200))\r\n    else:\r\n        bin_list.append(0)\r\n\r\ntest_dict = {'chromosome': chromosome_list,\r\n             'start': bin_list,\r\n             'stop': bin_list,\r\n             'value': [i for i in np.random.randint(0,25, 100)]}\r\n\r\ntest_df = pd.DataFrame(test_dict)\r\n```\r\n\r\n\r\n> chrI\t9\t9\t3\r\n> chrI\t10\t10\t16\r\n> chrI\t11\t11\t19\r\n> chrI\t12\t12\t29\r\n> chrI\t13\t13\t5\r\n> chrI\t14\t14\t17\r\n> chrI\t15\t15\t3\r\n> chrI\t16\t16\t11\r\n> chrI\t17\t17\t7\r\n\r\n\r\nThe first column is a list of values ranging from chrI to chrV (though it could be any length really), and what we want to do is place all the reads in the third column in a bin, in my case a bin of length 200 (0-200, 201-400, 401-600 etc) and then sum the values that fall into the bin. Fairly common use case.\r\n\r\nMy code that does the binning is as follows:\r\n\r\n```\r\nbinned_df = pd.DataFrame()\r\nfor chromosome, chrsize in chromosomes.items():\r\n\r\n        # each chromosome is a different length, so # bins will differ\r\n        chr_subset = test_df[(test_df.chromosome == chromosome)]\r\n        \r\n        chr_bins = np.arange(0, chrsize, int(200))\r\n        chr_subset.loc[:,'bins'] = pd.cut(x=chr_subset.loc[:,'start'],\r\n                                    bins=chr_bins,\r\n                                    labels=chr_bins[:-1],\r\n                                    include_lowest=True)\r\n\r\n        binned_df = pd.concat([binned_df,\r\n                               chr_subset.groupby(['chromosome','bins'],\r\n                                                                  axis=0,\r\n                                                                  as_index=False).value.sum()])\r\n        binned_df = binned_df.fillna(0)\r\n```\r\n\r\nWhich gives a dataframe output as below\r\n\r\n\r\n>chromosome | bin | value\r\n>\r\n> chrI | 0 | 43.0\r\n> chrI | 200 | 6.0\r\n> chrI | 400 | 20.0\r\n> chrI | 600 | 24.0\r\n> chrI | 800 | 10.0\r\n> chrI | 1000 | 52.0\r\n> chrI | 1200 | 34.0\r\n\r\nIncluding the warning which comes from the pd.cut command.\r\n\r\n> A value is trying to be set on a copy of a slice from a DataFrame.\r\n> Try using .loc[row_indexer,col_indexer] = value instead\r\n\r\n\r\npandas version: 0.20.3\r\nPython 3.6.2 \r\n\r\nAny comments or suggestions would be appreciated.\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/414301042",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11103#issuecomment-414301042",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11103",
    "id": 414301042,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNDMwMTA0Mg==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-20T12:33:55Z",
    "updated_at": "2018-08-20T12:33:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "@dejmail, ycan you check your example? `chromosomes`  is a tuple, so your example fails on `.items()`. You can also remove debug code like `set_trace`.\r\n\r\nAnyway, I suspect that changing\r\n\r\n```\r\nchr_subset = test_df[(test_df.chromosome == chromosome)]\r\n```\r\n\r\nto\r\n\r\n\r\n```\r\nchr_subset = test_df[(test_df.chromosome == chromosome)].copy()\r\n```\r\n\r\nwill fix the warning. It's unclear whether `test_df` can / should be updated when you update `chr_subset` in a couple lines."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/414303186",
    "html_url": "https://github.com/pandas-dev/pandas/issues/11103#issuecomment-414303186",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/11103",
    "id": 414303186,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNDMwMzE4Ng==",
    "user": {
      "login": "dejmail",
      "id": 1876487,
      "node_id": "MDQ6VXNlcjE4NzY0ODc=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1876487?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dejmail",
      "html_url": "https://github.com/dejmail",
      "followers_url": "https://api.github.com/users/dejmail/followers",
      "following_url": "https://api.github.com/users/dejmail/following{/other_user}",
      "gists_url": "https://api.github.com/users/dejmail/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dejmail/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dejmail/subscriptions",
      "organizations_url": "https://api.github.com/users/dejmail/orgs",
      "repos_url": "https://api.github.com/users/dejmail/repos",
      "events_url": "https://api.github.com/users/dejmail/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dejmail/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-20T12:42:05Z",
    "updated_at": "2018-08-20T12:42:16Z",
    "author_association": "NONE",
    "body": "@TomAugspurger Thanks for the reply. `chromosomes` is indeed a tuple, but it is unpacked into `chromosome` and `chrsize` and it gives no error on my side.\r\n\r\nIndeed including the `.copy()` as you suggested gets rid of the warning. Perhaps we can close this now.\r\n"
  }
]
