[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/466787693",
    "html_url": "https://github.com/pandas-dev/pandas/pull/25431#issuecomment-466787693",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25431",
    "id": 466787693,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2Njc4NzY5Mw==",
    "user": {
      "login": "codecov[bot]",
      "id": 22429695,
      "node_id": "MDM6Qm90MjI0Mjk2OTU=",
      "avatar_url": "https://avatars2.githubusercontent.com/in/254?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/codecov%5Bbot%5D",
      "html_url": "https://github.com/apps/codecov",
      "followers_url": "https://api.github.com/users/codecov%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/codecov%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/codecov%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/codecov%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/codecov%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/codecov%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/codecov%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/codecov%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/codecov%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2019-02-24T15:40:28Z",
    "updated_at": "2019-02-24T15:40:28Z",
    "author_association": "NONE",
    "body": "# [Codecov](https://codecov.io/gh/pandas-dev/pandas/pull/25431?src=pr&el=h1) Report\n> Merging [#25431](https://codecov.io/gh/pandas-dev/pandas/pull/25431?src=pr&el=desc) into [master](https://codecov.io/gh/pandas-dev/pandas/commit/85572de5e7bb188cfecc575ee56786406e79dc79?src=pr&el=desc) will **increase** coverage by `0.03%`.\n> The diff coverage is `100%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/pandas-dev/pandas/pull/25431/graphs/tree.svg?width=650&token=eZ4WkYLtcO&height=150&src=pr)](https://codecov.io/gh/pandas-dev/pandas/pull/25431?src=pr&el=tree)\n\n```diff\n@@            Coverage Diff             @@\n##           master   #25431      +/-   ##\n==========================================\n+ Coverage   91.74%   91.77%   +0.03%     \n==========================================\n  Files         173      173              \n  Lines       52923    52925       +2     \n==========================================\n+ Hits        48554    48572      +18     \n+ Misses       4369     4353      -16\n```\n\n| Flag | Coverage Δ | |\n|---|---|---|\n| #multiple | `90.33% <100%> (+0.02%)` | :arrow_up: |\n| #single | `41.72% <0%> (-0.01%)` | :arrow_down: |\n\n| [Impacted Files](https://codecov.io/gh/pandas-dev/pandas/pull/25431?src=pr&el=tree) | Coverage Δ | |\n|---|---|---|\n| [pandas/core/dtypes/cast.py](https://codecov.io/gh/pandas-dev/pandas/pull/25431/diff?src=pr&el=tree#diff-cGFuZGFzL2NvcmUvZHR5cGVzL2Nhc3QucHk=) | `90.69% <100%> (+2.53%)` | :arrow_up: |\n| [pandas/util/testing.py](https://codecov.io/gh/pandas-dev/pandas/pull/25431/diff?src=pr&el=tree#diff-cGFuZGFzL3V0aWwvdGVzdGluZy5weQ==) | `87.66% <0%> (+0.09%)` | :arrow_up: |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/pandas-dev/pandas/pull/25431?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/pandas-dev/pandas/pull/25431?src=pr&el=footer). Last update [85572de...bf23643](https://codecov.io/gh/pandas-dev/pandas/pull/25431?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/466787697",
    "html_url": "https://github.com/pandas-dev/pandas/pull/25431#issuecomment-466787697",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25431",
    "id": 466787697,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2Njc4NzY5Nw==",
    "user": {
      "login": "codecov[bot]",
      "id": 22429695,
      "node_id": "MDM6Qm90MjI0Mjk2OTU=",
      "avatar_url": "https://avatars2.githubusercontent.com/in/254?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/codecov%5Bbot%5D",
      "html_url": "https://github.com/apps/codecov",
      "followers_url": "https://api.github.com/users/codecov%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/codecov%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/codecov%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/codecov%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/codecov%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/codecov%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/codecov%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/codecov%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/codecov%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2019-02-24T15:40:29Z",
    "updated_at": "2019-03-21T06:00:01Z",
    "author_association": "NONE",
    "body": "# [Codecov](https://codecov.io/gh/pandas-dev/pandas/pull/25431?src=pr&el=h1) Report\n> Merging [#25431](https://codecov.io/gh/pandas-dev/pandas/pull/25431?src=pr&el=desc) into [master](https://codecov.io/gh/pandas-dev/pandas/commit/cdfdd77b65df350386ce27142ef3babd9e5186d2?src=pr&el=desc) will **increase** coverage by `0.03%`.\n> The diff coverage is `100%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/pandas-dev/pandas/pull/25431/graphs/tree.svg?width=650&token=eZ4WkYLtcO&height=150&src=pr)](https://codecov.io/gh/pandas-dev/pandas/pull/25431?src=pr&el=tree)\n\n```diff\n@@            Coverage Diff             @@\n##           master   #25431      +/-   ##\n==========================================\n+ Coverage   91.27%    91.3%   +0.03%     \n==========================================\n  Files         173      173              \n  Lines       53002    53004       +2     \n==========================================\n+ Hits        48375    48396      +21     \n+ Misses       4627     4608      -19\n```\n\n| Flag | Coverage Δ | |\n|---|---|---|\n| #multiple | `89.87% <100%> (+0.03%)` | :arrow_up: |\n| #single | `41.77% <33.33%> (ø)` | :arrow_up: |\n\n| [Impacted Files](https://codecov.io/gh/pandas-dev/pandas/pull/25431?src=pr&el=tree) | Coverage Δ | |\n|---|---|---|\n| [pandas/core/dtypes/cast.py](https://codecov.io/gh/pandas-dev/pandas/pull/25431/diff?src=pr&el=tree#diff-cGFuZGFzL2NvcmUvZHR5cGVzL2Nhc3QucHk=) | `91.36% <100%> (+3.19%)` | :arrow_up: |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/pandas-dev/pandas/pull/25431?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/pandas-dev/pandas/pull/25431?src=pr&el=footer). Last update [cdfdd77...6b7c02d](https://codecov.io/gh/pandas-dev/pandas/pull/25431?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/471176562",
    "html_url": "https://github.com/pandas-dev/pandas/pull/25431#issuecomment-471176562",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25431",
    "id": 471176562,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MTE3NjU2Mg==",
    "user": {
      "login": "makbigc",
      "id": 14367887,
      "node_id": "MDQ6VXNlcjE0MzY3ODg3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/14367887?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/makbigc",
      "html_url": "https://github.com/makbigc",
      "followers_url": "https://api.github.com/users/makbigc/followers",
      "following_url": "https://api.github.com/users/makbigc/following{/other_user}",
      "gists_url": "https://api.github.com/users/makbigc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/makbigc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/makbigc/subscriptions",
      "organizations_url": "https://api.github.com/users/makbigc/orgs",
      "repos_url": "https://api.github.com/users/makbigc/repos",
      "events_url": "https://api.github.com/users/makbigc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/makbigc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-09T13:22:54Z",
    "updated_at": "2019-03-09T13:28:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "I investigated further and found that I misunderstood the usage of `maybe_upcast_putmask`. \r\n\r\nThe result array should be replaced with the element of other array starting from the beginning, not in the position of mask. This behavior is due to np.place\r\n\r\n `changeit` isn't called. The 1st element is picked as expected.\r\n```\r\nIn [4]: arr1 = np.array([1,2,3])                                                \r\n\r\nIn [5]: other = np.array([61,62,63])                                            \r\n\r\nIn [6]: mask = np.array([False, True, False])                                   \r\n\r\nIn [7]: result, _ = maybe_upcast_putmask(arr1, mask, other)                     \r\n\r\nIn [8]: result                                                                  \r\nOut[8]: array([ 1, 61,  3])\r\n```\r\n\r\n`changeit` is called. The 1st element is picked as expected.\r\n```\r\nIn [24]: arr2 = np.array([1,2,3])                                                                                                           \r\n\r\nIn [25]: other2 = np.array([61.1, 62.2, 63.3])                                                                                              \r\n\r\nIn [26]: mask = np.array([False, True, False])                                                                                              \r\n\r\nIn [27]: result, _ = maybe_upcast_putmask(arr2, mask, other2)                                                                               \r\n\r\nIn [28]: result                                                                                                                             \r\nOut[28]: array([ 1. , 61.1,  3. ])\r\n```\r\n\r\n`changeit` isn't called. The 1st element is picked as expected.\r\n```\r\nIn [15]: arr2 = np.arange('2019-01-01', '2019-01-04', dtype='datetime64[D]')    \r\n\r\nIn [16]: other2 = np.arange('2018-01-01', '2018-01-04', dtype='datetime64[D]')  \r\n\r\nIn [17]: mask = np.array([False, True, False])                                  \r\n\r\nIn [18]: result, _ = maybe_upcast_putmask(arr2, mask, other2)                   \r\n\r\nIn [19]: result                                                                 \r\nOut[19]: array(['2019-01-01', '2018-01-01', '2019-01-03'], dtype='datetime64[D]')\r\n```\r\nSo the behavior for Series as an input is not correct. And `maybe_upcast_putmask` does not expect a series input.\r\n\r\n`changeit` is called. The second element is picked.\r\n```\r\n>>> s = pd.Series([10, 11, 12])\r\n>>> t = pd.Series([np.nan, 61, np.nan])\r\n>>> from pandas.core.dtypes.cast import maybe_upcast_putmask\r\n>>> result, _ = maybe_upcast_putmask(s, np.array([False, True, False]), t)\r\n>>> result  # correct\r\n0    10\r\n1    61\r\n2    12\r\ndtype: int64\r\n```\r\nExamples can be added into the function docstring to elucidate the usage. Should I do it in this PR?\r\n \r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/473622849",
    "html_url": "https://github.com/pandas-dev/pandas/pull/25431#issuecomment-473622849",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25431",
    "id": 473622849,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MzYyMjg0OQ==",
    "user": {
      "login": "makbigc",
      "id": 14367887,
      "node_id": "MDQ6VXNlcjE0MzY3ODg3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/14367887?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/makbigc",
      "html_url": "https://github.com/makbigc",
      "followers_url": "https://api.github.com/users/makbigc/followers",
      "following_url": "https://api.github.com/users/makbigc/following{/other_user}",
      "gists_url": "https://api.github.com/users/makbigc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/makbigc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/makbigc/subscriptions",
      "organizations_url": "https://api.github.com/users/makbigc/orgs",
      "repos_url": "https://api.github.com/users/makbigc/repos",
      "events_url": "https://api.github.com/users/makbigc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/makbigc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-17T07:07:10Z",
    "updated_at": "2019-03-17T07:07:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "When adding the tests, the following bug is found and fixed. \r\n\r\n```\r\nIn [4]: arr = np.arange(10, 15)                                                 \r\n\r\nIn [5]: other = np.array([61, 62])                                              \r\n\r\nIn [6]: mask = np.array([False, True, False, True, True])                       \r\n\r\nIn [7]: result, changed = maybe_upcast_putmask(arr, mask, other)                \r\n---------------------------------------------------------------------------\r\nIndexError                                Traceback (most recent call last)\r\n<ipython-input-7-3ec9bc405a70> in <module>\r\n----> 1 result, changed = maybe_upcast_putmask(arr, mask, other)\r\n\r\n~/Code/pandas/pandas/core/dtypes/cast.py in maybe_upcast_putmask(result, mask, other)\r\n    242             else:\r\n    243 \r\n--> 244                 if isna(other[mask]).any():\r\n    245                     return changeit()\r\n    246 \r\n\r\nIndexError: boolean index did not match indexed array along dimension 0; dimension is 2 but corresponding boolean dimension is 5\r\n```\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/475591932",
    "html_url": "https://github.com/pandas-dev/pandas/pull/25431#issuecomment-475591932",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/25431",
    "id": 475591932,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTU5MTkzMg==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-22T11:51:15Z",
    "updated_at": "2019-03-22T11:51:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "thanks @makbigc keep em coming!"
  }
]
