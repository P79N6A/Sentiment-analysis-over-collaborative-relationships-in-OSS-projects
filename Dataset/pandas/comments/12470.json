[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/189559963",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12470#issuecomment-189559963",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12470",
    "id": 189559963,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4OTU1OTk2Mw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-02-27T02:34:09Z",
    "updated_at": "2016-02-27T02:34:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "can you put a copy-pastable example up top. \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/189562608",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12470#issuecomment-189562608",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12470",
    "id": 189562608,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4OTU2MjYwOA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-02-27T02:51:06Z",
    "updated_at": "2016-02-27T02:51:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "```\nIn [67]: df = pd.DataFrame({                                          \n\"uuid\": [0,1,2,3,4,5],\n\"publication_timestamp\": [\n    \"2015-07-28 00:10:05.852\",\n    \"2015-10-03 00:17:43.000\",\n    \"2015-08-20 01:15:52.693\",\n    \"2015-09-09 00:02:03.083\",\n    \"2015-12-08 00:02:41.390\",\n    \"2015-12-08 00:13:32.243\",\n],\n\"timezone\": [\"US/Central\", \"US/Eastern\", \"US/Eastern\", \"US/Pacific\", \"US/Mountain\", 123.4]\n}).set_index('uuid')\n\nIn [68]: df['publication_timestamp'] = pd.to_datetime(df['publication_timestamp'])\n\nIn [70]: df\nOut[70]: \n       publication_timestamp     timezone\nuuid                                     \n0    2015-07-28 00:10:05.852   US/Central\n1    2015-10-03 00:17:43.000   US/Eastern\n2    2015-08-20 01:15:52.693   US/Eastern\n3    2015-09-09 00:02:03.083   US/Pacific\n4    2015-12-08 00:02:41.390  US/Mountain\n5    2015-12-08 00:13:32.243        123.4\n\nIn [71]: df.dtypes\nOut[71]: \npublication_timestamp    datetime64[ns]\ntimezone                         object\ndtype: object\n\nIn [72]: def f(x):\n    try:\n        return x.publication_timestamp.tz_localize(x.timezone)\n    except:\n        return pd.NaT\n   ....:     \n\nIn [73]: df.apply(f, axis=1)\nOut[73]: \nuuid\n0    2015-07-28 00:10:05.852000-05:00\n1           2015-10-03 00:17:43-04:00\n2    2015-08-20 01:15:52.693000-04:00\n3    2015-09-09 00:02:03.083000-07:00\n4    2015-12-08 00:02:41.390000-07:00\n5                                 NaT\ndtype: object\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/189582706",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12470#issuecomment-189582706",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12470",
    "id": 189582706,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4OTU4MjcwNg==",
    "user": {
      "login": "AlJohri",
      "id": 2790092,
      "node_id": "MDQ6VXNlcjI3OTAwOTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/2790092?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AlJohri",
      "html_url": "https://github.com/AlJohri",
      "followers_url": "https://api.github.com/users/AlJohri/followers",
      "following_url": "https://api.github.com/users/AlJohri/following{/other_user}",
      "gists_url": "https://api.github.com/users/AlJohri/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AlJohri/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AlJohri/subscriptions",
      "organizations_url": "https://api.github.com/users/AlJohri/orgs",
      "repos_url": "https://api.github.com/users/AlJohri/repos",
      "events_url": "https://api.github.com/users/AlJohri/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AlJohri/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-02-27T06:03:02Z",
    "updated_at": "2016-02-27T06:03:02Z",
    "author_association": "NONE",
    "body": "@jreback Thanks you! I realize now that I wasn't accounting for NaNs in my data and the `apply` code works just fine.\n\nIs there a vectorized operation I might be able to use for `tz_localize` or `tz_convert` so that I don't need to use `apply`? It's a bit slow for larger datasets\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/189649331",
    "html_url": "https://github.com/pandas-dev/pandas/issues/12470#issuecomment-189649331",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/12470",
    "id": 189649331,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4OTY0OTMzMQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-02-27T14:20:46Z",
    "updated_at": "2016-02-27T14:20:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "You need to use columnar dtypes.\n\n```\nIn [111]: df2 = df.reset_index().pivot(columns='timezone',index='uuid',values='publication_timestamp')\n\nIn [112]: df2\nOut[112]: \ntimezone                   123.4              US/Central              US/Eastern             US/Mountain              US/Pacific\nuuid                                                                                                                            \n0                            NaT 2015-07-28 00:10:05.852                     NaT                     NaT                     NaT\n1                            NaT                     NaT 2015-10-03 00:17:43.000                     NaT                     NaT\n2                            NaT                     NaT 2015-08-20 01:15:52.693                     NaT                     NaT\n3                            NaT                     NaT                     NaT                     NaT 2015-09-09 00:02:03.083\n4                            NaT                     NaT                     NaT 2015-12-08 00:02:41.390                     NaT\n5        2015-12-08 00:13:32.243                     NaT                     NaT                     NaT                     NaT\n\nIn [113]: def f(x):                                                                                   \n    try:\n        return x.dt.tz_localize(x.name)\n    except:\n        return x\n   .....:     \n\nIn [114]: df2.apply(f)                                                                                \nOut[114]: \ntimezone                   123.4                       US/Central                       US/Eastern                      US/Mountain                       US/Pacific\nuuid                                                                                                                                                                \n0                            NaT 2015-07-28 00:10:05.852000-05:00                              NaT                              NaT                              NaT\n1                            NaT                              NaT        2015-10-03 00:17:43-04:00                              NaT                              NaT\n2                            NaT                              NaT 2015-08-20 01:15:52.693000-04:00                              NaT                              NaT\n3                            NaT                              NaT                              NaT                              NaT 2015-09-09 00:02:03.083000-07:00\n4                            NaT                              NaT                              NaT 2015-12-08 00:02:41.390000-07:00                              NaT\n5        2015-12-08 00:13:32.243                              NaT                              NaT                              NaT                              NaT\n```\n"
  }
]
