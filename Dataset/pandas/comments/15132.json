[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/272656558",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15132#issuecomment-272656558",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15132",
    "id": 272656558,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjY1NjU1OA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-14T22:04:08Z",
    "updated_at": "2017-01-14T22:04:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "pd.show_versions() as the issue tracker indicates "
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/272657008",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15132#issuecomment-272657008",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15132",
    "id": 272657008,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjY1NzAwOA==",
    "user": {
      "login": "Bigbrd",
      "id": 6462411,
      "node_id": "MDQ6VXNlcjY0NjI0MTE=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/6462411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Bigbrd",
      "html_url": "https://github.com/Bigbrd",
      "followers_url": "https://api.github.com/users/Bigbrd/followers",
      "following_url": "https://api.github.com/users/Bigbrd/following{/other_user}",
      "gists_url": "https://api.github.com/users/Bigbrd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Bigbrd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Bigbrd/subscriptions",
      "organizations_url": "https://api.github.com/users/Bigbrd/orgs",
      "repos_url": "https://api.github.com/users/Bigbrd/repos",
      "events_url": "https://api.github.com/users/Bigbrd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Bigbrd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-14T22:12:09Z",
    "updated_at": "2017-01-14T22:12:09Z",
    "author_association": "NONE",
    "body": "updated."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/272706924",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15132#issuecomment-272706924",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15132",
    "id": 272706924,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjcwNjkyNA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-15T16:43:14Z",
    "updated_at": "2017-01-15T16:43:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "JSON validator says that isn't valid JSON."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/272749582",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15132#issuecomment-272749582",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15132",
    "id": 272749582,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3Mjc0OTU4Mg==",
    "user": {
      "login": "rouzazari",
      "id": 11428213,
      "node_id": "MDQ6VXNlcjExNDI4MjEz",
      "avatar_url": "https://avatars2.githubusercontent.com/u/11428213?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rouzazari",
      "html_url": "https://github.com/rouzazari",
      "followers_url": "https://api.github.com/users/rouzazari/followers",
      "following_url": "https://api.github.com/users/rouzazari/following{/other_user}",
      "gists_url": "https://api.github.com/users/rouzazari/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rouzazari/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rouzazari/subscriptions",
      "organizations_url": "https://api.github.com/users/rouzazari/orgs",
      "repos_url": "https://api.github.com/users/rouzazari/repos",
      "events_url": "https://api.github.com/users/rouzazari/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rouzazari/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-16T00:17:32Z",
    "updated_at": "2017-01-16T00:17:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "Agree on the JSON provided by @Bigbrd not being valid; however, I tried it with a simple valid JSON string and received the same results.\r\n\r\n### Potential UnicodeDecodeError for non-ascii strings in Python 2.7\r\n\r\nContents of ``/tmp/test.json`` (note the ``0xe2`` character after the first \"foo\"):\r\n```JSON\r\n{\"a\": \"foo‚Äù.\", \"b\": \"bar.\"}\r\n{\"a\": \"foo\", \"b\": \"bar\"}\r\n```\r\n\r\nResult:\r\n```python\r\nimport pandas as pd\r\npd.read_json('/tmp/test.json', lines=True)\r\n...\r\nUnicodeDecodeError: 'ascii' codec can't decode byte 0xe2 in position 10: ordinal not in range(128)\r\n```\r\n---\r\n### Why does this happen?\r\n\r\nThis can happen in Python 2.7 if the default encoding is  set to ``ascii`` (check ``sys.getdefaultencoding()``). ``StringIO`` will convert the input string to ``ascii`` when ``lines=True``, resulting in a ``UnicodeDecodeError`` because of mixing ``utf-8`` and ``ascii`` strings.\r\n\r\n```python\r\n    if lines:\r\n        lines = list(StringIO(json.strip()))  # <<- converts 'utf-8' to 'ascii'\r\n        json = u'[' + u','.join(lines) + u']'  # <<- mixes 'utf-8' and 'ascii'\r\n```\r\n\r\nNote that a user can set the default encoding using ``sys.setdefaultencoding('utf-8')`` but this is discouraged and is a no-op in Python 3 ([see SO article here](http://stackoverflow.com/questions/3828723/why-should-we-not-use-sys-setdefaultencodingutf-8-in-a-py-script/6742053))\r\n[](url)\r\n\r\n---\r\n\r\n### Next steps\r\n\r\nI would consider myself a novice on fixing this type of issue, but one (hack-y) solution could be to decode the string to ``utf-8`` before calling ``StringIO``:\r\n\r\n```python\r\n    if lines:\r\n        if compat.PY2:\r\n            json = json.decode(encoding or 'utf-8')\r\n        lines = list(StringIO(json.strip()))\r\n        json = u'[' + u','.join(lines) + u']'\r\n```\r\n\r\nInterestingly, ``nosetests`` has the default encoding set to ``utf-8`` (I checked ``sys.getdefaultencoding()`` while running ``nosetests pandas/io/tests/json/``), so I'm not sure how to write a test for this other than changing the default encoding to ``ascii``."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/272933340",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15132#issuecomment-272933340",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15132",
    "id": 272933340,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjkzMzM0MA==",
    "user": {
      "login": "Bigbrd",
      "id": 6462411,
      "node_id": "MDQ6VXNlcjY0NjI0MTE=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/6462411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Bigbrd",
      "html_url": "https://github.com/Bigbrd",
      "followers_url": "https://api.github.com/users/Bigbrd/followers",
      "following_url": "https://api.github.com/users/Bigbrd/following{/other_user}",
      "gists_url": "https://api.github.com/users/Bigbrd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Bigbrd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Bigbrd/subscriptions",
      "organizations_url": "https://api.github.com/users/Bigbrd/orgs",
      "repos_url": "https://api.github.com/users/Bigbrd/repos",
      "events_url": "https://api.github.com/users/Bigbrd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Bigbrd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-16T18:29:03Z",
    "updated_at": "2017-01-16T18:29:16Z",
    "author_association": "NONE",
    "body": "Yes please ignore my crappy fake json, @rouzazari covered my scenario perfectly. \r\n\r\nThe solution proposed with switching to utf-8 before StringIO does sound like an efficient solution for my scenario. +1 if we can implement that or something like it\r\n\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/273153578",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15132#issuecomment-273153578",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15132",
    "id": 273153578,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MzE1MzU3OA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-17T13:23:22Z",
    "updated_at": "2017-01-17T13:23:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "interesting. So py27 is broken again. ok @Bigbrd or @rouzazari a PR would be welcome.\r\n\r\nwe have a context manager ``pandas.util.testing.stdin_encoding`` which I think will allow you to check this in testing (or maybe need to create a similar one to save / change the system encoding / restore the original).\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/273390766",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15132#issuecomment-273390766",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15132",
    "id": 273390766,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MzM5MDc2Ng==",
    "user": {
      "login": "rouzazari",
      "id": 11428213,
      "node_id": "MDQ6VXNlcjExNDI4MjEz",
      "avatar_url": "https://avatars2.githubusercontent.com/u/11428213?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rouzazari",
      "html_url": "https://github.com/rouzazari",
      "followers_url": "https://api.github.com/users/rouzazari/followers",
      "following_url": "https://api.github.com/users/rouzazari/following{/other_user}",
      "gists_url": "https://api.github.com/users/rouzazari/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rouzazari/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rouzazari/subscriptions",
      "organizations_url": "https://api.github.com/users/rouzazari/orgs",
      "repos_url": "https://api.github.com/users/rouzazari/repos",
      "events_url": "https://api.github.com/users/rouzazari/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rouzazari/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-18T05:55:54Z",
    "updated_at": "2017-01-18T05:55:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "Seems like this has been a compatibility issue since ``lines=True`` was introduced with 6efd743c. \r\n\r\nI'm submitting a PR with my recommended change, which is simply to **remove the forced conversion to unicode**, as it seems like ``FrameParser`` and ``SeriesParser`` handle this just fine (and it is not an issue for non-lines JSON files)."
  }
]
