[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/17358481",
    "html_url": "https://github.com/pandas-dev/pandas/issues/3487#issuecomment-17358481",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3487",
    "id": 17358481,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3MzU4NDgx",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-05-02T19:15:40Z",
    "updated_at": "2013-05-02T19:15:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "@tavistmorph we just pushed updates for dup_columns. Can you try this wil latest master (I am not sure this is the issue, but let's see)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/17716442",
    "html_url": "https://github.com/pandas-dev/pandas/issues/3487#issuecomment-17716442",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3487",
    "id": 17716442,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3NzE2NDQy",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-05-10T11:55:42Z",
    "updated_at": "2013-05-10T11:55:42Z",
    "author_association": "NONE",
    "body": "Can't repro with  0.10.1 or 0.11.0 or master\n\n``` python\nIn [1]: import sqlite3\n   ...: \n   ...: import pandas.io.sql as psql\n   ...: con = sqlite3.connect(\"a2.db\") \n   ...: c = con.cursor()\n   ...: try:\n   ...:     c.execute('''CREATE TABLE tab (a,b,c);''')\n   ...: except Exception as e:\n   ...:     pass\n   ...: try:\n   ...:     c.execute(\"INSERT INTO tab VALUES (1,2,3);\")\n   ...:     c.execute(\"INSERT INTO tab VALUES (4,5,6);\")\n   ...:     c.commit()\n   ...: except Exception as e:\n   ...:     pass\n   ...: #    print e\n   ...: sql = \"select a,b as a from tab where a=1\"\n   ...: #c.execute(sql).fetchall()\n   ...: pandas.io.sql.read_frame(sql, con)\nOut[1]: \n   a  a\n0  1  2\n\nIn [3]: print pd.__version__\n0.10.1\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/17719531",
    "html_url": "https://github.com/pandas-dev/pandas/issues/3487#issuecomment-17719531",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3487",
    "id": 17719531,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3NzE5NTMx",
    "user": {
      "login": "darindillon",
      "id": 2766856,
      "node_id": "MDQ6VXNlcjI3NjY4NTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/2766856?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/darindillon",
      "html_url": "https://github.com/darindillon",
      "followers_url": "https://api.github.com/users/darindillon/followers",
      "following_url": "https://api.github.com/users/darindillon/following{/other_user}",
      "gists_url": "https://api.github.com/users/darindillon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/darindillon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/darindillon/subscriptions",
      "organizations_url": "https://api.github.com/users/darindillon/orgs",
      "repos_url": "https://api.github.com/users/darindillon/repos",
      "events_url": "https://api.github.com/users/darindillon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/darindillon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-05-10T13:19:22Z",
    "updated_at": "2013-05-10T13:19:22Z",
    "author_association": "NONE",
    "body": "Your code above works fine for me too. But I was running a different case than you. Try it this way and it gives an error for me on 0.11. (BTW -- not sure if it matters, but my database is sql server)\n\nimport pandas\nimport pyodbc\nimport pandas.io.sql\nconn = pyodbc.connect(\"your dsn here\")\nsql = \"select 1 as whatever, 2 as name, 3 as name where 1 = 0\"\npos = pandas.io.sql.read_frame(sql, conn)\n\nResult:\nTraceback (most recent call last):\n  File \"D:\\workspaces\\PythonOneOffs\\client.py\", line 7, in <module>\n    pos = pandas.io.sql.read_frame(sql, conn)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\io\\sql.py\", line 162, in read_frame\n    coerce_float=coerce_float)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\core\\frame.py\", line 1115, in from_records\n    columns)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\core\\frame.py\", line 5338, in _arrays_to_mgr\n    return create_block_manager_from_arrays(arrays, arr_names, axes)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\core\\internals.py\", line 1821, in create_block_manager_from_arrays\n    mgr = BlockManager(blocks, axes)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\core\\internals.py\", line 896, in __init__\n    self._verify_integrity()\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\core\\internals.py\", line 990, in _verify_integrity\n    raise AssertionError('Number of manager items must equal union of '\nAssertionError: Number of manager items must equal union of block items\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/17720944",
    "html_url": "https://github.com/pandas-dev/pandas/issues/3487#issuecomment-17720944",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3487",
    "id": 17720944,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3NzIwOTQ0",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-05-10T13:47:17Z",
    "updated_at": "2013-05-10T13:48:02Z",
    "author_association": "NONE",
    "body": "I can reproduce that error, but only when the select query returns 0 rows.\n\n``` python\nimport sqlite3\n\nimport pandas.io.sql as psql\ncon = sqlite3.connect(\"a9.db\") \nc = con.cursor()\ntry:\n    c.execute('''CREATE TABLE tab (a,b,c)''')\nexcept:\n    pass\ntry:\n    c.execute(\"INSERT INTO tab VALUES (1,2,3)\")\n    c.execute(\"INSERT INTO tab VALUES (4,5,6)\")\n    c.commit()\nexcept:\n    pass\n\nsql = 'select a as a2  , b , c as b from tab where a=\"meow\"'\npandas.io.sql.read_frame(sql, con)\n\n/home/user1/src/pandas/pandas/core/internals.py in _verify_integrity(self)\n   1126 \n   1127         if len(self.items) != tot_items:\n-> 1128             raise AssertionError('Number of manager items must equal union of '\n   1129                                  'block items')\n   1130 \n\nAssertionError: Number of manager items must equal union of block items\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/17721465",
    "html_url": "https://github.com/pandas-dev/pandas/issues/3487#issuecomment-17721465",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3487",
    "id": 17721465,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3NzIxNDY1",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-05-10T13:56:13Z",
    "updated_at": "2013-05-10T13:56:13Z",
    "author_association": "NONE",
    "body": "Works with pyodbc as well, unless the select query returns no rows.\n\n``` python\n\nIn [45]: import sqlite3\n    ...: import pyodbc\n    ...: \n    ...: import pandas.io.sql as psql\n    ...: con = sqlite3.connect(\"a.db\") \n    ...: c = con.cursor()\n    ...: try:\n    ...:     c.execute('''CREATE TABLE tab (a,b,c)''')\n    ...: except:\n    ...:     pass\n    ...: try:\n    ...:     c.execute(\"INSERT INTO tab VALUES (1,2,3)\")\n    ...:     c.execute(\"INSERT INTO tab VALUES (4,5,6)\")\n    ...:     c.commit()\n    ...: except:\n    ...:     pass\n    ...: con.close()\n    ...: \n    ...: con = pyodbc.connect('DRIVER={SQLite3};DATABASE=a.db;')\n    ...: sql = 'select a as a2  , b , c as b from tab'\n    ...: pandas.io.sql.read_frame(sql, con)\nOut[45]: \n   a2  b  b\n0   1  2  3\n1   4  5  6\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/17722277",
    "html_url": "https://github.com/pandas-dev/pandas/issues/3487#issuecomment-17722277",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3487",
    "id": 17722277,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3NzIyMjc3",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-05-10T14:11:29Z",
    "updated_at": "2013-05-10T14:11:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "@y-p what is actually passed in the 0-case (to `arrays_to_mgr`)?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/17723303",
    "html_url": "https://github.com/pandas-dev/pandas/issues/3487#issuecomment-17723303",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3487",
    "id": 17723303,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3NzIzMzAz",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-05-10T14:29:40Z",
    "updated_at": "2013-05-10T14:29:40Z",
    "author_association": "NONE",
    "body": "Interesting.\nThis works:\n\n```\nDataFrame.from_records([], columns=['a','b','c'])\n\nEmpty DataFrame\nColumns: [a, b, c]\nIndex: []\n```\n\nBut this fails with the obscure message:\n\n```\nDataFrame.from_records([], columns=['a','b','b'])\n\nAssertionError: Number of manager items must equal union of block items\n```\n\nThe main ctor doesn't let you construct an empty df with non-zero dims at all:\n\n```\nDataFrame([], columns=['a','b','c'])\n\nValueError: Shape of passed values is (0, 0), indices imply (3, 0)\n```\n\nbut allows it if there are no dims (I remember opening that issue, actually):\n\n```\nDataFrame([])\n\nEmpty DataFrame\nColumns: []\nIndex: []\n```\n\nIn any case, the original issue probably interpreted the behaviour on an empty queryset \nwith a bug in the duplicate column handling.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/17723509",
    "html_url": "https://github.com/pandas-dev/pandas/issues/3487#issuecomment-17723509",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3487",
    "id": 17723509,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3NzIzNTA5",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-05-10T14:33:03Z",
    "updated_at": "2013-05-10T14:33:03Z",
    "author_association": "NONE",
    "body": "I think we can close this in deference to #3562.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/17730747",
    "html_url": "https://github.com/pandas-dev/pandas/issues/3487#issuecomment-17730747",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/3487",
    "id": 17730747,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE3NzMwNzQ3",
    "user": {
      "login": "ghost",
      "id": 10137,
      "node_id": "MDQ6VXNlcjEwMTM3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghost",
      "html_url": "https://github.com/ghost",
      "followers_url": "https://api.github.com/users/ghost/followers",
      "following_url": "https://api.github.com/users/ghost/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
      "organizations_url": "https://api.github.com/users/ghost/orgs",
      "repos_url": "https://api.github.com/users/ghost/repos",
      "events_url": "https://api.github.com/users/ghost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghost/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-05-10T16:38:13Z",
    "updated_at": "2013-05-10T16:38:13Z",
    "author_association": "NONE",
    "body": "ok, #3564 closed #3562 and this as well.\n"
  }
]
