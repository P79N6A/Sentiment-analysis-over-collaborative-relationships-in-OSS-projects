[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/363388205",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19538#issuecomment-363388205",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19538",
    "id": 363388205,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MzM4ODIwNQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-06T11:01:18Z",
    "updated_at": "2018-02-06T11:01:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "see #6945 / #17903 this was just done in master, is this another case?\r\n\r\ncc @peterpanmj "
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/363504531",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19538#issuecomment-363504531",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19538",
    "id": 363504531,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MzUwNDUzMQ==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-06T17:43:08Z",
    "updated_at": "2018-02-06T17:44:04Z",
    "author_association": "MEMBER",
    "body": "Interesting...from glancing at it I think the problem is that PR only updated the `rank_1d_` methods in algos. This makes it so you get the desired functionality from a `Series` object but not from a `DataFrame` or `GroupBy` object. There's also a bug with how it handles values in descending order, all of which are highlighted below\r\n\r\n```python\r\nIn []: df[0].rank()  # this works\r\nOut[]: \r\n0    2.0\r\n1    NaN\r\n2    4.0\r\n3    1.0\r\n4    3.0\r\n\r\nIn []: df[0].rank(ascending=False)  # handles na appropriately, but incorrectly sets np.inf and -np.inf to equal\r\nOut[]: \r\n0    3.0\r\n1    NaN\r\n2    1.0\r\n3    1.0\r\n4    2.0\r\n\r\nIn []: df['key'] = ['foo'] * 5\r\nIn []: df.groupby('key').rank()  # doesn't handle missing values appropriately\r\nOut[]: \r\n     0\r\n0  2.0\r\n1  NaN\r\n2  NaN\r\n3  1.0\r\n4  3.0\r\n```\r\n\r\n<details>\r\n\r\nINSTALLED VERSIONS\r\n------------------\r\ncommit: 93c86aa13e1b7816c762b4ff372aef80a7830af8\r\npython: 3.6.2.final.0\r\npython-bits: 64\r\nOS: Darwin\r\nOS-release: 17.4.0\r\nmachine: x86_64\r\nprocessor: i386\r\nbyteorder: little\r\nLC_ALL: None\r\nLANG: en_US.UTF-8\r\nLOCALE: en_US.UTF-8\r\n\r\npandas: 0.23.0.dev0+238.g93c86aa13.dirty\r\npytest: 3.2.5\r\npip: 9.0.1\r\nsetuptools: 36.4.0\r\nCython: 0.26\r\nnumpy: 1.13.1\r\nscipy: None\r\npyarrow: None\r\nxarray: None\r\nIPython: 6.2.1\r\nsphinx: 1.6.3\r\npatsy: None\r\ndateutil: 2.6.1\r\npytz: 2017.2\r\nblosc: None\r\nbottleneck: None\r\ntables: None\r\nnumexpr: None\r\nfeather: None\r\nmatplotlib: None\r\nopenpyxl: None\r\nxlrd: None\r\nxlwt: None\r\nxlsxwriter: None\r\nlxml: None\r\nbs4: None\r\nhtml5lib: None\r\nsqlalchemy: None\r\npymysql: None\r\npsycopg2: None\r\njinja2: 2.9.6\r\ns3fs: None\r\nfastparquet: None\r\npandas_gbq: None\r\npandas_datareader: None\r\n\r\n</details>"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/364323150",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19538#issuecomment-364323150",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19538",
    "id": 364323150,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NDMyMzE1MA==",
    "user": {
      "login": "peterpanmj",
      "id": 13047435,
      "node_id": "MDQ6VXNlcjEzMDQ3NDM1",
      "avatar_url": "https://avatars2.githubusercontent.com/u/13047435?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/peterpanmj",
      "html_url": "https://github.com/peterpanmj",
      "followers_url": "https://api.github.com/users/peterpanmj/followers",
      "following_url": "https://api.github.com/users/peterpanmj/following{/other_user}",
      "gists_url": "https://api.github.com/users/peterpanmj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/peterpanmj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/peterpanmj/subscriptions",
      "organizations_url": "https://api.github.com/users/peterpanmj/orgs",
      "repos_url": "https://api.github.com/users/peterpanmj/repos",
      "events_url": "https://api.github.com/users/peterpanmj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/peterpanmj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-09T03:15:07Z",
    "updated_at": "2018-02-09T03:15:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "It is the same issue as #6945. And, it seems that #17903 does not completely fix it when ascending is False. I will have a look into it.\r\nGroup by nan values is another thing .\r\n```\r\nIn []: df['key'] = ['foo'] * 5\r\nIn []: df.groupby('key').rank()  # doesn't handle missing values appropriately\r\nOut[]: \r\n     0\r\n0  2.0\r\n1  NaN\r\n2  NaN\r\n3  1.0\r\n4  3.0\r\n```\r\nIt should related to #3729\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/364325463",
    "html_url": "https://github.com/pandas-dev/pandas/issues/19538#issuecomment-364325463",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/19538",
    "id": 364325463,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NDMyNTQ2Mw==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-09T03:33:31Z",
    "updated_at": "2018-02-09T03:33:31Z",
    "author_association": "MEMBER",
    "body": "@peterpanmj whatever solution you come up with in `algos` it shouldn't be that different to move to the `groupby_helper.pyx.in` file to support GroupBy nan handling as well (I'm touching the latter in #19481). Ideally these would be consistent"
  }
]
