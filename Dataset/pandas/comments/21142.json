[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/390486983",
    "html_url": "https://github.com/pandas-dev/pandas/issues/21142#issuecomment-390486983",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/21142",
    "id": 390486983,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MDQ4Njk4Mw==",
    "user": {
      "login": "chris-b1",
      "id": 1924092,
      "node_id": "MDQ6VXNlcjE5MjQwOTI=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1924092?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chris-b1",
      "html_url": "https://github.com/chris-b1",
      "followers_url": "https://api.github.com/users/chris-b1/followers",
      "following_url": "https://api.github.com/users/chris-b1/following{/other_user}",
      "gists_url": "https://api.github.com/users/chris-b1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chris-b1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chris-b1/subscriptions",
      "organizations_url": "https://api.github.com/users/chris-b1/orgs",
      "repos_url": "https://api.github.com/users/chris-b1/repos",
      "events_url": "https://api.github.com/users/chris-b1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chris-b1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-20T14:30:59Z",
    "updated_at": "2018-05-20T14:30:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "@TomAugspurger, @jbrockmendel - I'm not sure this coercion of datetime subclasses was ever explicitly supported, but assuming something in the EA/tslib refactoring hit this?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/390543533",
    "html_url": "https://github.com/pandas-dev/pandas/issues/21142#issuecomment-390543533",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/21142",
    "id": 390543533,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MDU0MzUzMw==",
    "user": {
      "login": "jbrockmendel",
      "id": 8078968,
      "node_id": "MDQ6VXNlcjgwNzg5Njg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/8078968?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jbrockmendel",
      "html_url": "https://github.com/jbrockmendel",
      "followers_url": "https://api.github.com/users/jbrockmendel/followers",
      "following_url": "https://api.github.com/users/jbrockmendel/following{/other_user}",
      "gists_url": "https://api.github.com/users/jbrockmendel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jbrockmendel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jbrockmendel/subscriptions",
      "organizations_url": "https://api.github.com/users/jbrockmendel/orgs",
      "repos_url": "https://api.github.com/users/jbrockmendel/repos",
      "events_url": "https://api.github.com/users/jbrockmendel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jbrockmendel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-21T03:27:13Z",
    "updated_at": "2018-05-21T03:27:13Z",
    "author_association": "MEMBER",
    "body": "@chris-b1 I'm pretty sure this is driven by a change in `tslib.array_to_datetime` that effectively assumes that whenever `isinstance(val, datetime) and not (val.__class__ is datetime)` then `val` is a `pd.Timestamp` object.  As a result, when it sees a `MyDatetime` object it ends up looking up `val.nanosecond`, raises `AttributeError`, and falls back to an object-dtype.\r\n\r\nPinning `nanosecond = 0` to `MyDatetime` \"fixes\" this for me:\r\n\r\n```\r\nimport pandas as pd\r\nfrom datetime import datetime\r\n\r\nclass MyDatetime(datetime):\r\n    nanosecond = 0\r\n    \r\ndf = pd.DataFrame({\"datetime\": [MyDatetime(2018, 1, 1, 1, 1)]})\r\n>>> df.dtypes\r\ndatetime    datetime64[ns]\r\ndtype: object\r\n```\r\n\r\nWe can probably edit `array_to_datetime` to do a `getattr(val, 'nanosecond', 0)` lookup to avoid this issue."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/390615438",
    "html_url": "https://github.com/pandas-dev/pandas/issues/21142#issuecomment-390615438",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/21142",
    "id": 390615438,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MDYxNTQzOA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-21T10:24:13Z",
    "updated_at": "2018-05-21T10:24:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "agree with @jbrockmendel here, though note that forced conversion defeats the purpose of a datetime subclass, if you actually need one (and not really sure *why*, can you elaborate?) then you would be better off with an ``ExtensionArray``."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/390627151",
    "html_url": "https://github.com/pandas-dev/pandas/issues/21142#issuecomment-390627151",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/21142",
    "id": 390627151,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MDYyNzE1MQ==",
    "user": {
      "login": "fjetter",
      "id": 8629629,
      "node_id": "MDQ6VXNlcjg2Mjk2Mjk=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8629629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjetter",
      "html_url": "https://github.com/fjetter",
      "followers_url": "https://api.github.com/users/fjetter/followers",
      "following_url": "https://api.github.com/users/fjetter/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjetter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjetter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjetter/subscriptions",
      "organizations_url": "https://api.github.com/users/fjetter/orgs",
      "repos_url": "https://api.github.com/users/fjetter/repos",
      "events_url": "https://api.github.com/users/fjetter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjetter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-21T11:22:13Z",
    "updated_at": "2018-05-21T11:22:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "I ran into this issue during unit testing where I do not necessarily use the proper datetime object but rather a fake of some sorts. `ExtensionArray` would not be a good fit for this I suppose.\r\n\r\nFor instance, I am using https://github.com/spulec/freezegun which creates a `FakeDatetime` object where the proper datetime class is registered as a metaclass."
  }
]
