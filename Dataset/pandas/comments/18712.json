[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/350555242",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18712#issuecomment-350555242",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18712",
    "id": 350555242,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MDU1NTI0Mg==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-10T15:16:30Z",
    "updated_at": "2017-12-10T15:16:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "I added an example that could be added to the doc-string (though prob want to reconcile with the existing example).\r\n\r\n@stefansimik a PR for this would be great!"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/350562797",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18712#issuecomment-350562797",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18712",
    "id": 350562797,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MDU2Mjc5Nw==",
    "user": {
      "login": "stefansimik",
      "id": 6208056,
      "node_id": "MDQ6VXNlcjYyMDgwNTY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/6208056?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stefansimik",
      "html_url": "https://github.com/stefansimik",
      "followers_url": "https://api.github.com/users/stefansimik/followers",
      "following_url": "https://api.github.com/users/stefansimik/following{/other_user}",
      "gists_url": "https://api.github.com/users/stefansimik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stefansimik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stefansimik/subscriptions",
      "organizations_url": "https://api.github.com/users/stefansimik/orgs",
      "repos_url": "https://api.github.com/users/stefansimik/repos",
      "events_url": "https://api.github.com/users/stefansimik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stefansimik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-10T17:09:06Z",
    "updated_at": "2017-12-10T17:21:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @jreback, I am happy to do it - please check my PR."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/354787151",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18712#issuecomment-354787151",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18712",
    "id": 354787151,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NDc4NzE1MQ==",
    "user": {
      "login": "fporcari",
      "id": 7373156,
      "node_id": "MDQ6VXNlcjczNzMxNTY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/7373156?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fporcari",
      "html_url": "https://github.com/fporcari",
      "followers_url": "https://api.github.com/users/fporcari/followers",
      "following_url": "https://api.github.com/users/fporcari/following{/other_user}",
      "gists_url": "https://api.github.com/users/fporcari/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fporcari/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fporcari/subscriptions",
      "organizations_url": "https://api.github.com/users/fporcari/orgs",
      "repos_url": "https://api.github.com/users/fporcari/repos",
      "events_url": "https://api.github.com/users/fporcari/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fporcari/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-02T15:11:10Z",
    "updated_at": "2018-01-02T15:14:47Z",
    "author_association": "NONE",
    "body": "I tried this syntax but it does not work using margins=True.\r\n\r\n```\r\nimport pandas as pd\r\nfrom pandas.api.types import CategoricalDtype\r\nimport numpy as np\r\n\r\n# Load data\r\ndf = pd.read_excel('http://pbpython.com/extras/sales-funnel.xlsx')\r\n# Make categories\r\ndf[\"Status\"] = pd.Categorical(df[\"Status\"], categories=[\"won\",\"pending\",\"presented\",\"declined\"], ordered=False)\r\n\r\n# Create pivot table\r\npd.pivot_table(df, index=['Manager', 'Status'], \r\n               values=['Quantity', 'Price'], \r\n               aggfunc={'Quantity': len, 'Price': [np.sum, np.mean]}, \r\n               fill_value=0,\r\n              margins=True) # <-- added margins parameter\r\n```\r\n\r\nI got this error\r\n```\r\n\r\n _get_level_number(self, level)\r\n    656         except ValueError:\r\n    657             if not isinstance(level, int):\r\n--> 658                 raise KeyError('Level %s not found' % str(level))\r\n    659             elif level < 0:\r\n    660                 level += self.nlevels\r\n\r\nKeyError: 'Level None not found'\r\n\r\n```\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/355015492",
    "html_url": "https://github.com/pandas-dev/pandas/issues/18712#issuecomment-355015492",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/18712",
    "id": 355015492,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTAxNTQ5Mg==",
    "user": {
      "login": "stefansimik",
      "id": 6208056,
      "node_id": "MDQ6VXNlcjYyMDgwNTY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/6208056?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stefansimik",
      "html_url": "https://github.com/stefansimik",
      "followers_url": "https://api.github.com/users/stefansimik/followers",
      "following_url": "https://api.github.com/users/stefansimik/following{/other_user}",
      "gists_url": "https://api.github.com/users/stefansimik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stefansimik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stefansimik/subscriptions",
      "organizations_url": "https://api.github.com/users/stefansimik/orgs",
      "repos_url": "https://api.github.com/users/stefansimik/repos",
      "events_url": "https://api.github.com/users/stefansimik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stefansimik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-03T13:47:37Z",
    "updated_at": "2018-01-03T13:47:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "I can confirm that issue. The KeyError really happens and it is some bug. But it is different issue.\r\nCould you please create new issue for this?\r\n\r\nI found, the error does not happen when:\r\n\r\n- margins=False\r\n- or only one function is used in aggfunc parameter (like aggfunc=len, for example)"
  }
]
