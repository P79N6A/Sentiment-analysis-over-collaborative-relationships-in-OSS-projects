[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/305643765",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16572#issuecomment-305643765",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16572",
    "id": 305643765,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNTY0Mzc2NQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-01T22:59:43Z",
    "updated_at": "2017-06-01T22:59:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "this does looks like a bug. I don't think we have this as a test. This is a fairly narrow case though, the floats have to be exactly equal to the integers. welcome to have a PR. I can point you to where the issue is."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/305704479",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16572#issuecomment-305704479",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16572",
    "id": 305704479,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNTcwNDQ3OQ==",
    "user": {
      "login": "gnebehay",
      "id": 756433,
      "node_id": "MDQ6VXNlcjc1NjQzMw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/756433?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnebehay",
      "html_url": "https://github.com/gnebehay",
      "followers_url": "https://api.github.com/users/gnebehay/followers",
      "following_url": "https://api.github.com/users/gnebehay/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnebehay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnebehay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnebehay/subscriptions",
      "organizations_url": "https://api.github.com/users/gnebehay/orgs",
      "repos_url": "https://api.github.com/users/gnebehay/repos",
      "events_url": "https://api.github.com/users/gnebehay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnebehay/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-02T06:48:02Z",
    "updated_at": "2017-06-02T06:48:02Z",
    "author_association": "NONE",
    "body": "I encountered this issue while getting data via `pd.read_sql()`. There, primary keys are returned as `int`s (since there are no missing values), but nullable foreign keys are upcast to `float` (so that nulls can be represented as `nan`). If you then do a merge on these columns, you get what is described above. If you point me to a code location, I will see what I can do."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/305746504",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16572#issuecomment-305746504",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16572",
    "id": 305746504,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNTc0NjUwNA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-02T10:08:48Z",
    "updated_at": "2017-06-02T10:09:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "Its right about here: https://github.com/pandas-dev/pandas/blob/master/pandas/core/reshape/merge.py#L911\r\n\r\nWe allow differing int types, e.g. int64 and int8 are ok. but int64 and float will fall thru. you can add a check like\r\n\r\n```\r\nIn [8]: lk = np.array([1.0, 2, 3])\r\n\r\nIn [9]: rk = np.array([2, 3, 4])\r\n\r\nIn [11]: if is_float_dtype(lk) and is_integer_dtype(rk):\r\n    ...:     if (lk == lk.astype('int64')).all():\r\n    ...:         continue\r\n             # check opposite way as well\r\n    \r\n```\r\n\r\n"
  }
]
