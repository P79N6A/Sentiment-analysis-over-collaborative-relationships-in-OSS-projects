[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/46921246",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7554#issuecomment-46921246",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7554",
    "id": 46921246,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2OTIxMjQ2",
    "user": {
      "login": "bluefir",
      "id": 1903683,
      "node_id": "MDQ6VXNlcjE5MDM2ODM=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1903683?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bluefir",
      "html_url": "https://github.com/bluefir",
      "followers_url": "https://api.github.com/users/bluefir/followers",
      "following_url": "https://api.github.com/users/bluefir/following{/other_user}",
      "gists_url": "https://api.github.com/users/bluefir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bluefir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bluefir/subscriptions",
      "organizations_url": "https://api.github.com/users/bluefir/orgs",
      "repos_url": "https://api.github.com/users/bluefir/repos",
      "events_url": "https://api.github.com/users/bluefir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bluefir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-06-24T01:05:28Z",
    "updated_at": "2014-06-24T01:05:28Z",
    "author_association": "NONE",
    "body": "Never mind: categories has some columns that are in data_frame. Sorry for the confusion.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/46921368",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7554#issuecomment-46921368",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7554",
    "id": 46921368,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2OTIxMzY4",
    "user": {
      "login": "bluefir",
      "id": 1903683,
      "node_id": "MDQ6VXNlcjE5MDM2ODM=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1903683?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bluefir",
      "html_url": "https://github.com/bluefir",
      "followers_url": "https://api.github.com/users/bluefir/followers",
      "following_url": "https://api.github.com/users/bluefir/following{/other_user}",
      "gists_url": "https://api.github.com/users/bluefir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bluefir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bluefir/subscriptions",
      "organizations_url": "https://api.github.com/users/bluefir/orgs",
      "repos_url": "https://api.github.com/users/bluefir/repos",
      "events_url": "https://api.github.com/users/bluefir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bluefir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-06-24T01:07:18Z",
    "updated_at": "2014-06-24T01:07:18Z",
    "author_association": "NONE",
    "body": "Nope! Wrong again :-) categories has no columns, by design. In that case join fails. It's Ok, but a better error message would help.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/46921632",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7554#issuecomment-46921632",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7554",
    "id": 46921632,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2OTIxNjMy",
    "user": {
      "login": "bluefir",
      "id": 1903683,
      "node_id": "MDQ6VXNlcjE5MDM2ODM=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1903683?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bluefir",
      "html_url": "https://github.com/bluefir",
      "followers_url": "https://api.github.com/users/bluefir/followers",
      "following_url": "https://api.github.com/users/bluefir/following{/other_user}",
      "gists_url": "https://api.github.com/users/bluefir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bluefir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bluefir/subscriptions",
      "organizations_url": "https://api.github.com/users/bluefir/orgs",
      "repos_url": "https://api.github.com/users/bluefir/repos",
      "events_url": "https://api.github.com/users/bluefir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bluefir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-06-24T01:11:58Z",
    "updated_at": "2014-06-24T01:11:58Z",
    "author_association": "NONE",
    "body": "Nope, it's still there. This thing is killing me!\n\n```\n    if categories.empty:\n        df_regression = data_frame[columns_regression]\n    else:\n        logger.debug('Indexes are identical: {}'.format(data_frame.index is categories.index))\n        logger.debug('Index is unique: {}'.format(data_frame.index.is_unique))\n        logger.debug('All columns are in data_frame: {}'.format(all(map(lambda x: x in data_frame, columns_regression))))\n        logger.debug('Categories: {}'.format(list(categories.columns)))\n        df_regression = data_frame[columns_regression].join(categories)\n```\n\n```\n2014-06-23 21:11:05,572 DEBUG    pmt.portfolio_analytics.attribution.AlphaData - Indexes are identical: True\n2014-06-23 21:11:05,588 DEBUG    pmt.portfolio_analytics.attribution.AlphaData - Index is unique: True\n2014-06-23 21:11:05,588 DEBUG    pmt.portfolio_analytics.attribution.AlphaData - All columns are in data_frame: True\n2014-06-23 21:11:05,588 DEBUG    pmt.portfolio_analytics.attribution.AlphaData - Categories: ['alpha_decile_top2']\nTraceback (most recent call last):\n  File \"C:/Users/BKovtunenko/Perforce/bos-perforce01_1666/bkovtunenko_BKOVTUNENKO-D7/aam/branches/boris/pmt/python/pmt/portfolio_analytics/attribution/AlphaData.py\", line 1786, in <module>\n    thresholds_mkt_cap=thresh_mkt_cap)\n  File \"C:/Users/BKovtunenko/Perforce/bos-perforce01_1666/bkovtunenko_BKOVTUNENKO-D7/aam/branches/boris/pmt/python/pmt/portfolio_analytics/attribution/AlphaData.py\", line 1644, in save_regression_results\n    regression_type=regresion_type)\n  File \"C:/Users/BKovtunenko/Perforce/bos-perforce01_1666/bkovtunenko_BKOVTUNENKO-D7/aam/branches/boris/pmt/python/pmt/portfolio_analytics/attribution/AlphaData.py\", line 1493, in save_regression_decomposition\n    df_regression = data_frame[columns_regression].join(categories)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\core\\frame.py\", line 3580, in join\n    rsuffix=rsuffix, sort=sort)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\core\\frame.py\", line 3594, in _join_compat\n    suffixes=(lsuffix, rsuffix), sort=sort)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\tools\\merge.py\", line 40, in merge\n    return op.get_result()\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\tools\\merge.py\", line 189, in get_result\n    ldata, rdata = self._get_merge_data()\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\tools\\merge.py\", line 284, in _get_merge_data\n    copydata=False)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\core\\internals.py\", line 3439, in _maybe_rename_join\n    to_rename = self.items.intersection(other.items)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\core\\index.py\", line 962, in intersection\n    indexer = self.get_indexer(other.values)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\core\\index.py\", line 1120, in get_indexer\n    raise InvalidIndexError('Reindexing only valid with uniquely'\npandas.core.index.InvalidIndexError: Reindexing only valid with uniquely valued Index objects\n\nProcess finished with exit code 1\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/46921782",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7554#issuecomment-46921782",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7554",
    "id": 46921782,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2OTIxNzgy",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-06-24T01:14:35Z",
    "updated_at": "2014-06-24T01:14:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "can u post a self contained example that can be copy pasted \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/46988792",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7554#issuecomment-46988792",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7554",
    "id": 46988792,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2OTg4Nzky",
    "user": {
      "login": "bluefir",
      "id": 1903683,
      "node_id": "MDQ6VXNlcjE5MDM2ODM=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1903683?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bluefir",
      "html_url": "https://github.com/bluefir",
      "followers_url": "https://api.github.com/users/bluefir/followers",
      "following_url": "https://api.github.com/users/bluefir/following{/other_user}",
      "gists_url": "https://api.github.com/users/bluefir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bluefir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bluefir/subscriptions",
      "organizations_url": "https://api.github.com/users/bluefir/orgs",
      "repos_url": "https://api.github.com/users/bluefir/repos",
      "events_url": "https://api.github.com/users/bluefir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bluefir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-06-24T15:44:10Z",
    "updated_at": "2014-06-24T15:44:10Z",
    "author_association": "NONE",
    "body": "I tried this and it worked:\n\n```\nimport numpy as np\nfrom pandas import DataFrame, MultiIndex\n\nindex_tuples = []\nfor i in xrange(100):\n    for j in xrange(100):\n        index_tuples.append((i, 'id{}'.format(j)))\nindex = MultiIndex.from_tuples(index_tuples)\n\nx = DataFrame(np.random.randn(10000, 3), columns=['col1', 'col2', 'col3'], index=index)\nx.info()\n\n<class 'pandas.core.frame.DataFrame'>\nMultiIndex: 10000 entries, (0, id0) to (99, id99)\nData columns (total 3 columns):\ncol1    10000 non-null float64\ncol2    10000 non-null float64\ncol3    10000 non-null float64\ndtypes: float64(3)\n\ny = DataFrame(index=x.index)\nfor i in xrange(4, 7):\n    y['col{}'.format(i)] = np.random.randn(10000)\ny.info()\n\n<class 'pandas.core.frame.DataFrame'>\nMultiIndex: 10000 entries, (0, id0) to (99, id99)\nData columns (total 3 columns):\ncol4    10000 non-null float64\ncol5    10000 non-null float64\ncol6    10000 non-null float64\ndtypes: float64(3)\n\ntest = x[['col1', 'col3']].join(y)\ntest.info()\n\n<class 'pandas.core.frame.DataFrame'>\nMultiIndex: 10000 entries, (0, id0) to (99, id99)\nData columns (total 5 columns):\ncol1    10000 non-null float64\ncol3    10000 non-null float64\ncol4    10000 non-null float64\ncol5    10000 non-null float64\ncol6    10000 non-null float64\ndtypes: float64(5)\n```\n\nI have this, and it doesn't work:\n\n```\n        logger.debug('Types {} and {}'.format(type(data_frame), type(categories)))\n        logger.debug('Index type {}'.format(type(data_frame.index)))\n        logger.debug('Indexes are identical: {}'.format(data_frame.index is categories.index))\n        logger.debug('Index is unique: {}'.format(data_frame.index.is_unique))\n        logger.debug('All columns are in data_frame: {}'.format(all(map(lambda x: x in data_frame, columns_regression))))\n        logger.debug('Categories: {}'.format(list(categories.columns)))\n        logger.debug('None of categories are in regression columns: {}'.format(all(map(lambda x: x not in columns_regression, categories.columns))))\n        df_regression = data_frame[columns_regression].join(categories)\n```\n\n```\n2014-06-24 11:38:55,487 DEBUG    pmt.portfolio_analytics.attribution.AlphaData - Types <class 'pandas.core.frame.DataFrame'> and <class 'pandas.core.frame.DataFrame'>\n2014-06-24 11:38:55,487 DEBUG    pmt.portfolio_analytics.attribution.AlphaData - Index type <class 'pandas.core.index.MultiIndex'>\n2014-06-24 11:38:55,487 DEBUG    pmt.portfolio_analytics.attribution.AlphaData - Indexes are identical: True\n2014-06-24 11:38:55,505 DEBUG    pmt.portfolio_analytics.attribution.AlphaData - Index is unique: True\n2014-06-24 11:38:55,505 DEBUG    pmt.portfolio_analytics.attribution.AlphaData - All columns are in data_frame: True\n2014-06-24 11:38:55,505 DEBUG    pmt.portfolio_analytics.attribution.AlphaData - Categories: ['alpha_decile_top2']\n2014-06-24 11:38:55,505 DEBUG    pmt.portfolio_analytics.attribution.AlphaData - None of categories are in regression columns: True\nTraceback (most recent call last):\n  File \"C:/Users/BKovtunenko/Perforce/bos-perforce01_1666/bkovtunenko_BKOVTUNENKO-D7/aam/branches/boris/pmt/python/pmt/portfolio_analytics/attribution/AlphaData.py\", line 1789, in <module>\n    thresholds_mkt_cap=thresh_mkt_cap)\n  File \"C:/Users/BKovtunenko/Perforce/bos-perforce01_1666/bkovtunenko_BKOVTUNENKO-D7/aam/branches/boris/pmt/python/pmt/portfolio_analytics/attribution/AlphaData.py\", line 1647, in save_regression_results\n    regression_type=regresion_type)\n  File \"C:/Users/BKovtunenko/Perforce/bos-perforce01_1666/bkovtunenko_BKOVTUNENKO-D7/aam/branches/boris/pmt/python/pmt/portfolio_analytics/attribution/AlphaData.py\", line 1496, in save_regression_decomposition\n    df_regression = data_frame[columns_regression].join(categories)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\core\\frame.py\", line 3580, in join\n    rsuffix=rsuffix, sort=sort)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\core\\frame.py\", line 3594, in _join_compat\n    suffixes=(lsuffix, rsuffix), sort=sort)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\tools\\merge.py\", line 40, in merge\n    return op.get_result()\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\tools\\merge.py\", line 189, in get_result\n    ldata, rdata = self._get_merge_data()\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\tools\\merge.py\", line 284, in _get_merge_data\n    copydata=False)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\core\\internals.py\", line 3439, in _maybe_rename_join\n    to_rename = self.items.intersection(other.items)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\core\\index.py\", line 962, in intersection\n    indexer = self.get_indexer(other.values)\n  File \"C:\\Python27\\lib\\site-packages\\pandas\\core\\index.py\", line 1120, in get_indexer\n    raise InvalidIndexError('Reindexing only valid with uniquely'\npandas.core.index.InvalidIndexError: Reindexing only valid with uniquely valued Index objects\n\nProcess finished with exit code 1\n```\n\nWTF? Anyway, I'll try to find a workaround.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/46989109",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7554#issuecomment-46989109",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7554",
    "id": 46989109,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2OTg5MTA5",
    "user": {
      "login": "bluefir",
      "id": 1903683,
      "node_id": "MDQ6VXNlcjE5MDM2ODM=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1903683?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bluefir",
      "html_url": "https://github.com/bluefir",
      "followers_url": "https://api.github.com/users/bluefir/followers",
      "following_url": "https://api.github.com/users/bluefir/following{/other_user}",
      "gists_url": "https://api.github.com/users/bluefir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bluefir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bluefir/subscriptions",
      "organizations_url": "https://api.github.com/users/bluefir/orgs",
      "repos_url": "https://api.github.com/users/bluefir/repos",
      "events_url": "https://api.github.com/users/bluefir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bluefir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-06-24T15:46:41Z",
    "updated_at": "2014-06-24T15:46:41Z",
    "author_association": "NONE",
    "body": "Never mind. columns_regression contained duplicate columns. Sorry!\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/46989480",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7554#issuecomment-46989480",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7554",
    "id": 46989480,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2OTg5NDgw",
    "user": {
      "login": "bluefir",
      "id": 1903683,
      "node_id": "MDQ6VXNlcjE5MDM2ODM=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/1903683?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bluefir",
      "html_url": "https://github.com/bluefir",
      "followers_url": "https://api.github.com/users/bluefir/followers",
      "following_url": "https://api.github.com/users/bluefir/following{/other_user}",
      "gists_url": "https://api.github.com/users/bluefir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bluefir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bluefir/subscriptions",
      "organizations_url": "https://api.github.com/users/bluefir/orgs",
      "repos_url": "https://api.github.com/users/bluefir/repos",
      "events_url": "https://api.github.com/users/bluefir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bluefir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-06-24T15:49:29Z",
    "updated_at": "2014-06-24T15:49:29Z",
    "author_association": "NONE",
    "body": "Ha! This works:\n\n```\ndf_regression = data_frame[columns_regression]\n```\n\nBut this doesn't:\n\n```\ndf_regression = data_frame[columns_regression].join(categories)\n```\n\nThat's what confused me.\n"
  }
]
