[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/270626721",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15068#issuecomment-270626721",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15068",
    "id": 270626721,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDYyNjcyMQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-05T11:47:36Z",
    "updated_at": "2017-01-05T11:47:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "we have a doc warning for this. https://github.com/pandas-dev/pandas/pull/14788/files\r\n\r\nI suppose this could be added, though you would have to recast the above to use internal functions. And would have to have this raise only in the case of a huge number (we don't directly sample memory)."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/272161254",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15068#issuecomment-272161254",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15068",
    "id": 272161254,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjE2MTI1NA==",
    "user": {
      "login": "IshankGulati",
      "id": 10078624,
      "node_id": "MDQ6VXNlcjEwMDc4NjI0",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10078624?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/IshankGulati",
      "html_url": "https://github.com/IshankGulati",
      "followers_url": "https://api.github.com/users/IshankGulati/followers",
      "following_url": "https://api.github.com/users/IshankGulati/following{/other_user}",
      "gists_url": "https://api.github.com/users/IshankGulati/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/IshankGulati/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/IshankGulati/subscriptions",
      "organizations_url": "https://api.github.com/users/IshankGulati/orgs",
      "repos_url": "https://api.github.com/users/IshankGulati/repos",
      "events_url": "https://api.github.com/users/IshankGulati/events{/privacy}",
      "received_events_url": "https://api.github.com/users/IshankGulati/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-12T13:20:33Z",
    "updated_at": "2017-01-12T13:20:33Z",
    "author_association": "NONE",
    "body": "@jreback @mproffitt Can I work on this issue?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/272183780",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15068#issuecomment-272183780",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15068",
    "id": 272183780,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjE4Mzc4MA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-12T14:55:54Z",
    "updated_at": "2017-01-12T14:55:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "sure"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/272190656",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15068#issuecomment-272190656",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15068",
    "id": 272190656,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjE5MDY1Ng==",
    "user": {
      "login": "mproffitt",
      "id": 1852919,
      "node_id": "MDQ6VXNlcjE4NTI5MTk=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1852919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mproffitt",
      "html_url": "https://github.com/mproffitt",
      "followers_url": "https://api.github.com/users/mproffitt/followers",
      "following_url": "https://api.github.com/users/mproffitt/following{/other_user}",
      "gists_url": "https://api.github.com/users/mproffitt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mproffitt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mproffitt/subscriptions",
      "organizations_url": "https://api.github.com/users/mproffitt/orgs",
      "repos_url": "https://api.github.com/users/mproffitt/repos",
      "events_url": "https://api.github.com/users/mproffitt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mproffitt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-12T15:21:06Z",
    "updated_at": "2017-01-12T15:21:06Z",
    "author_association": "NONE",
    "body": "@IshankGulati I too am happy for you to pick this up.\r\n\r\nFor information purposes I did put together a more complete version of the ``merge_size`` function which would calculate for inner / left / right merges as well which I posted on [stackoverflow](http://stackoverflow.com/questions/32750970/python-pandas-merge-causing-memory-overflow/41505031#41505031) last week.\r\n\r\nThe more complete version is:\r\n\r\n```python\r\ndef merge_size(left_frame, right_frame, group_by, how='inner'):\r\n    left_groups = left_frame.groupby(group_by).size()\r\n    right_groups = right_frame.groupby(group_by).size()\r\n    left_keys = set(left_groups.index)\r\n    right_keys = set(right_groups.index)\r\n    intersection = right_keys & left_keys\r\n    left_diff = left_keys - intersection\r\n    right_diff = right_keys - intersection\r\n\r\n    left_nan = len(left_frame[left_frame[group_by] != left_frame[group_by]])\r\n    right_nan = len(right_frame[right_frame[group_by] != right_frame[group_by]])\r\n    left_nan = 1 if left_nan == 0 and right_nan != 0 else left_nan\r\n    right_nan = 1 if right_nan == 0 and left_nan != 0 else right_nan\r\n\r\n    sizes = [(left_groups[group_name] * right_groups[group_name]) for group_name in intersection]\r\n    sizes += [left_nan * right_nan]\r\n\r\n    left_size = [left_groups[group_name] for group_name in left_diff]\r\n    right_size = [right_groups[group_name] for group_name in right_diff]\r\n    if how == 'inner':\r\n        return sum(sizes)\r\n    elif how == 'left':\r\n        return sum(sizes + left_size)\r\n    elif how == 'right':\r\n        return sum(sizes + right_size)\r\n    return sum(sizes + left_size + right_size)\r\n```\r\n\r\nAs mentioned in that issue, this function doesn't handle a multi-index for `group_by` very well, instead you would need to calculate this as:\r\n\r\n```python\r\nmin([merge_size(df1, df2, label, how) for label in group_by])\r\n```\r\n\r\nI am aware that this is a very inefficient way of calculating sizes for multi-index. If that can be solved, it would remove a headache.\r\n\r\nCheers"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/272399063",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15068#issuecomment-272399063",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15068",
    "id": 272399063,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjM5OTA2Mw==",
    "user": {
      "login": "IshankGulati",
      "id": 10078624,
      "node_id": "MDQ6VXNlcjEwMDc4NjI0",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10078624?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/IshankGulati",
      "html_url": "https://github.com/IshankGulati",
      "followers_url": "https://api.github.com/users/IshankGulati/followers",
      "following_url": "https://api.github.com/users/IshankGulati/following{/other_user}",
      "gists_url": "https://api.github.com/users/IshankGulati/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/IshankGulati/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/IshankGulati/subscriptions",
      "organizations_url": "https://api.github.com/users/IshankGulati/orgs",
      "repos_url": "https://api.github.com/users/IshankGulati/repos",
      "events_url": "https://api.github.com/users/IshankGulati/events{/privacy}",
      "received_events_url": "https://api.github.com/users/IshankGulati/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-13T09:30:31Z",
    "updated_at": "2017-01-13T09:30:31Z",
    "author_association": "NONE",
    "body": "@mproffitt \r\nIf I understand correctly, we can pass a list of columns to merge both the dataframes on as group_by in merge_size function and it should give the correct size of final dataframe instead of sum of merge_size of individual column."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/272439864",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15068#issuecomment-272439864",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15068",
    "id": 272439864,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjQzOTg2NA==",
    "user": {
      "login": "mproffitt",
      "id": 1852919,
      "node_id": "MDQ6VXNlcjE4NTI5MTk=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1852919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mproffitt",
      "html_url": "https://github.com/mproffitt",
      "followers_url": "https://api.github.com/users/mproffitt/followers",
      "following_url": "https://api.github.com/users/mproffitt/following{/other_user}",
      "gists_url": "https://api.github.com/users/mproffitt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mproffitt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mproffitt/subscriptions",
      "organizations_url": "https://api.github.com/users/mproffitt/orgs",
      "repos_url": "https://api.github.com/users/mproffitt/repos",
      "events_url": "https://api.github.com/users/mproffitt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mproffitt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-13T13:12:18Z",
    "updated_at": "2017-01-13T13:12:18Z",
    "author_association": "NONE",
    "body": "@IshankGulati  That is the desired behaviour yes but in practice passing a list of columns as `group_by` returns a sum of the calculated size of each column in the `group_by` as a unique merge.\r\n\r\nAs an example, if `group_by = a == 68 rows` and `group_by = b == 900 rows` then `group_by = [a, b]` currently returns 968 when in fact it should return 68. This is the reason for the `min([...])` reduction."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/273766841",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15068#issuecomment-273766841",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15068",
    "id": 273766841,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3Mzc2Njg0MQ==",
    "user": {
      "login": "IshankGulati",
      "id": 10078624,
      "node_id": "MDQ6VXNlcjEwMDc4NjI0",
      "avatar_url": "https://avatars2.githubusercontent.com/u/10078624?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/IshankGulati",
      "html_url": "https://github.com/IshankGulati",
      "followers_url": "https://api.github.com/users/IshankGulati/followers",
      "following_url": "https://api.github.com/users/IshankGulati/following{/other_user}",
      "gists_url": "https://api.github.com/users/IshankGulati/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/IshankGulati/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/IshankGulati/subscriptions",
      "organizations_url": "https://api.github.com/users/IshankGulati/orgs",
      "repos_url": "https://api.github.com/users/IshankGulati/repos",
      "events_url": "https://api.github.com/users/IshankGulati/events{/privacy}",
      "received_events_url": "https://api.github.com/users/IshankGulati/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-19T12:40:53Z",
    "updated_at": "2017-01-19T12:41:01Z",
    "author_association": "NONE",
    "body": "@jreback I was going through the code. From what I have understood columns on which merge is applied are stored in right_join_keys and left_join_keys. So should I use them for group_by in above merge_size method?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/273786902",
    "html_url": "https://github.com/pandas-dev/pandas/issues/15068#issuecomment-273786902",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/15068",
    "id": 273786902,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3Mzc4NjkwMg==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-19T14:16:28Z",
    "updated_at": "2017-01-19T14:16:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "yes this would be a computation that would occur late in the initialization phase (e.g. we know what keys we have already, then you can feed the 'magic function' and get an answer, we will then have an  option to merge of what to do ``errors='raise', 'ignore', 'warn'`` something like that.\r\n\r\n"
  }
]
