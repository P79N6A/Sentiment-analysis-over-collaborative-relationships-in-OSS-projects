[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/377909412",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20579#issuecomment-377909412",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20579",
    "id": 377909412,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NzkwOTQxMg==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-02T11:15:44Z",
    "updated_at": "2018-04-02T11:15:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "What kind of behavior do you want to achieve? For most things, raises an `AttributeError` in the accessors `__init__` achieves the same behavior as the accessor not being there at all. That's what we do for `.str`:\r\n\r\n```python\r\nIn [8]: 'str' in dir(pd.Series([1, 2]))\r\nOut[8]: False\r\n\r\nIn [9]: 'str' in dir(pd.Series(['a', 'b']))\r\nOut[9]: True\r\n\r\nIn [10]: pd.Series([1, 2]).str\r\n```\r\n\r\n```pytb\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-10-e5754c481fcd> in <module>()\r\n----> 1 pd.Series([1, 2]).str\r\n\r\n~/sandbox/pandas-ip/pandas/pandas/core/generic.py in __getattr__(self, name)\r\n   4372         if (name in self._internal_names_set or name in self._metadata or\r\n   4373                 name in self._accessors):\r\n-> 4374             return object.__getattribute__(self, name)\r\n   4375         else:\r\n   4376             if name in self._info_axis:\r\n\r\n~/sandbox/pandas-ip/pandas/pandas/core/accessor.py in __get__(self, obj, cls)\r\n    130             # we're accessing the attribute of the class, i.e., Dataset.geo\r\n    131             return self._accessor\r\n--> 132         accessor_obj = self._accessor(obj)\r\n    133         # Replace the property with the accessor object. Inspired by:\r\n    134         # http://www.pydanny.com/cached-property.html\r\n\r\n~/sandbox/pandas-ip/pandas/pandas/core/strings.py in __init__(self, data)\r\n   1775\r\n   1776     def __init__(self, data):\r\n-> 1777         self._validate(data)\r\n   1778         self._is_categorical = is_categorical_dtype(data)\r\n   1779         self._data = data.cat.categories if self._is_categorical else data\r\n\r\n~/sandbox/pandas-ip/pandas/pandas/core/strings.py in _validate(data)\r\n   1795             # (instead of test for object dtype), but that isn't practical for\r\n   1796             # performance reasons until we have a str dtype (GH 9343)\r\n-> 1797             raise AttributeError(\"Can only use .str accessor with string \"\r\n   1798                                  \"values, which use np.object_ dtype in \"\r\n   1799                                  \"pandas\")\r\n\r\nAttributeError: Can only use .str accessor with string values, which use np.object_ dtype in pandas\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/377909673",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20579#issuecomment-377909673",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20579",
    "id": 377909673,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NzkwOTY3Mw==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-02T11:17:46Z",
    "updated_at": "2018-04-02T11:17:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "We document this expectation in the API docs: http://pandas-docs.github.io/pandas-docs-travis/generated/pandas.api.extensions.register_dataframe_accessor.html though it isn't mentioned here: http://pandas-docs.github.io/pandas-docs-travis/extending.html. It'd be good to add a note saying that developers / users should expect an AttributeError to be raised if the types don't work out."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/377914556",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20579#issuecomment-377914556",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20579",
    "id": 377914556,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NzkxNDU1Ng==",
    "user": {
      "login": "achapkowski",
      "id": 5131271,
      "node_id": "MDQ6VXNlcjUxMzEyNzE=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/5131271?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achapkowski",
      "html_url": "https://github.com/achapkowski",
      "followers_url": "https://api.github.com/users/achapkowski/followers",
      "following_url": "https://api.github.com/users/achapkowski/following{/other_user}",
      "gists_url": "https://api.github.com/users/achapkowski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achapkowski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achapkowski/subscriptions",
      "organizations_url": "https://api.github.com/users/achapkowski/orgs",
      "repos_url": "https://api.github.com/users/achapkowski/repos",
      "events_url": "https://api.github.com/users/achapkowski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achapkowski/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-02T11:54:02Z",
    "updated_at": "2018-04-02T11:54:20Z",
    "author_association": "NONE",
    "body": "@TomAugspurger Thanks for the quick response.  I was looking at your cyberpandas project.  The project seems to do what I'm looking for but I was trying to figure out what is required and what was not.  Also, when you should you put functionality on the dtype vs on the accessor?\r\n\r\n```\r\n@staticmethod\r\n    def _validate(obj):\r\n        if not is_ipaddress_type(obj):\r\n            raise AttributeError(\"Cannot use 'ip' accessor on objects of \"\r\n                                 \"dtype '{}'.\".format(obj.dtype))\r\n```\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/377915284",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20579#issuecomment-377915284",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20579",
    "id": 377915284,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NzkxNTI4NA==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-02T11:59:27Z",
    "updated_at": "2018-04-02T11:59:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I was trying to figure out what is required and what was not.\r\n\r\nI don't think anything is really *required*. The accessor's `__init__` method get's the DataFrame / Series / Index, and is free to do whatever it wants at that point. It's really about doing the expected (i.e. what pandas does with its own accessors).\r\n\r\n> when you should you put functionality on the dtype vs on the accessor?\r\n\r\nCan you clarify that question? I don't quite follow. As far as this issue is concerned, the only important thing is that your accessor's `__init__` method does whatever type checking it needs. For whatever reason, in `cyberpandas`'s accessor I broke that out to a separate method (maybe it's called from somewhere else). But it's called from the `__init__` so things should work as expected."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/377917517",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20579#issuecomment-377917517",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20579",
    "id": 377917517,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NzkxNzUxNw==",
    "user": {
      "login": "achapkowski",
      "id": 5131271,
      "node_id": "MDQ6VXNlcjUxMzEyNzE=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/5131271?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achapkowski",
      "html_url": "https://github.com/achapkowski",
      "followers_url": "https://api.github.com/users/achapkowski/followers",
      "following_url": "https://api.github.com/users/achapkowski/following{/other_user}",
      "gists_url": "https://api.github.com/users/achapkowski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achapkowski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achapkowski/subscriptions",
      "organizations_url": "https://api.github.com/users/achapkowski/orgs",
      "repos_url": "https://api.github.com/users/achapkowski/repos",
      "events_url": "https://api.github.com/users/achapkowski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achapkowski/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-02T12:15:26Z",
    "updated_at": "2018-04-02T12:15:26Z",
    "author_association": "NONE",
    "body": "@TomAugspurger ok let me clarify.\r\n\r\nSo if I make a `geo` on a series accessor. Should  I put all geo operations on the accessor or should I put the `geo` operations on the custom dtype?\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/377919182",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20579#issuecomment-377919182",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20579",
    "id": 377919182,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NzkxOTE4Mg==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-02T12:27:22Z",
    "updated_at": "2018-04-02T12:27:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "Ah, I see. I'll use \"extension array\" instead of \"custom dtype\", since we have an `ExtensionDtype` class as well :)\r\n\r\nAccessors can be used with regular dtypes as well, not just extension ones. This is especially relevant for DataFrames, which won't have a single array type backing them. That's a caveat to my next recommendation.\r\n\r\nFor cyberpandas, I've only registered a Series accessor, and I've put all the complicated logic on the extension array itself. I think this has worked well. IMO, the accessor should be responsible only for\r\n\r\n1. providing the user an API for custom methods\r\n2. unboxing series / frame / index to your custom array\r\n3. boxing the result in a series / frame / index\r\n\r\nThis means the logic in https://github.com/ContinuumIO/cyberpandas/blob/master/cyberpandas/_accessor.py can be re-used for multiple accessors, since it's just being used for boxing / unboxing, nothing to do with IP addresses specifically."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/377922983",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20579#issuecomment-377922983",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20579",
    "id": 377922983,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NzkyMjk4Mw==",
    "user": {
      "login": "achapkowski",
      "id": 5131271,
      "node_id": "MDQ6VXNlcjUxMzEyNzE=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/5131271?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achapkowski",
      "html_url": "https://github.com/achapkowski",
      "followers_url": "https://api.github.com/users/achapkowski/followers",
      "following_url": "https://api.github.com/users/achapkowski/following{/other_user}",
      "gists_url": "https://api.github.com/users/achapkowski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achapkowski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achapkowski/subscriptions",
      "organizations_url": "https://api.github.com/users/achapkowski/orgs",
      "repos_url": "https://api.github.com/users/achapkowski/repos",
      "events_url": "https://api.github.com/users/achapkowski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achapkowski/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-02T12:52:37Z",
    "updated_at": "2018-04-02T12:52:37Z",
    "author_association": "NONE",
    "body": "ok great, i get it. 👍 "
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/378270337",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20579#issuecomment-378270337",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20579",
    "id": 378270337,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3ODI3MDMzNw==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-03T14:30:04Z",
    "updated_at": "2018-04-03T14:30:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "@achapkowski are you interested in updating the docs in http://pandas-docs.github.io/pandas-docs-travis/extending.html to say that the accessor should do type validation in its `__init__`, raising an AttributeError if it isn't valid?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/438287029",
    "html_url": "https://github.com/pandas-dev/pandas/issues/20579#issuecomment-438287029",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/20579",
    "id": 438287029,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzODI4NzAyOQ==",
    "user": {
      "login": "achapkowski",
      "id": 5131271,
      "node_id": "MDQ6VXNlcjUxMzEyNzE=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/5131271?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achapkowski",
      "html_url": "https://github.com/achapkowski",
      "followers_url": "https://api.github.com/users/achapkowski/followers",
      "following_url": "https://api.github.com/users/achapkowski/following{/other_user}",
      "gists_url": "https://api.github.com/users/achapkowski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achapkowski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achapkowski/subscriptions",
      "organizations_url": "https://api.github.com/users/achapkowski/orgs",
      "repos_url": "https://api.github.com/users/achapkowski/repos",
      "events_url": "https://api.github.com/users/achapkowski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achapkowski/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-13T14:34:04Z",
    "updated_at": "2018-11-13T14:34:04Z",
    "author_association": "NONE",
    "body": "@TomAugspurger Sure I'll add this code. "
  }
]
