[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/300780479",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16328#issuecomment-300780479",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16328",
    "id": 300780479,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMDc4MDQ3OQ==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-11T12:56:05Z",
    "updated_at": "2017-05-11T12:56:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "You are effectively doing this.\r\n```\r\nIn [11]: pd.qcut([0, 1, 2, 3, 4, 5], 5)\r\n \r\nOut[11]: \r\n[(-0.001, 1.0], (-0.001, 1.0], (1.0, 2.0], (2.0, 3.0], (3.0, 4.0], (4.0, 5.0]]\r\nCategories (5, interval[float64]): [(-0.001, 1.0] < (1.0, 2.0] < (2.0, 3.0] < (3.0, 4.0] < (4.0, 5.0]]\r\n```\r\n\r\nyou have to have 1 bin that has 2 values. ``drop`` does exactly what it sounds like, it uses the unique values. \r\n\r\nSo this looks like the right answer. If you don't want this, I would specify the bins yourself."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/300780590",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16328#issuecomment-300780590",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16328",
    "id": 300780590,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMDc4MDU5MA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-11T12:56:30Z",
    "updated_at": "2017-05-11T12:56:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "@TomAugspurger "
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/301071679",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16328#issuecomment-301071679",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16328",
    "id": 301071679,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTA3MTY3OQ==",
    "user": {
      "login": "artturib",
      "id": 6877757,
      "node_id": "MDQ6VXNlcjY4Nzc3NTc=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6877757?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/artturib",
      "html_url": "https://github.com/artturib",
      "followers_url": "https://api.github.com/users/artturib/followers",
      "following_url": "https://api.github.com/users/artturib/following{/other_user}",
      "gists_url": "https://api.github.com/users/artturib/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/artturib/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/artturib/subscriptions",
      "organizations_url": "https://api.github.com/users/artturib/orgs",
      "repos_url": "https://api.github.com/users/artturib/repos",
      "events_url": "https://api.github.com/users/artturib/events{/privacy}",
      "received_events_url": "https://api.github.com/users/artturib/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-12T13:08:26Z",
    "updated_at": "2017-05-12T13:08:36Z",
    "author_association": "NONE",
    "body": "@jreback \r\nI agree with you that the function does what is advertised i.e. drops duplicated bins. I think this has a surprising result in the my example.\r\n\r\nI think there is a slight difference between our examples. In my example I'd like the bins to be 20% and qcut makes the bin that would be 30% with only 0's 50% with {0,1} since all 0's don't completely fit in 20%.\r\nIn your example you would like the bins to be 20% and every single value would be less than 20% hence two values have to go to the same bin since 0's don't completely fill the first bin.\r\n\r\nYour suggestion of specifying the bins myself is not feasible since I don't know the distribution of the values before hand."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/301584807",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16328#issuecomment-301584807",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16328",
    "id": 301584807,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTU4NDgwNw==",
    "user": {
      "login": "TomAugspurger",
      "id": 1312546,
      "node_id": "MDQ6VXNlcjEzMTI1NDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1312546?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TomAugspurger",
      "html_url": "https://github.com/TomAugspurger",
      "followers_url": "https://api.github.com/users/TomAugspurger/followers",
      "following_url": "https://api.github.com/users/TomAugspurger/following{/other_user}",
      "gists_url": "https://api.github.com/users/TomAugspurger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TomAugspurger/subscriptions",
      "organizations_url": "https://api.github.com/users/TomAugspurger/orgs",
      "repos_url": "https://api.github.com/users/TomAugspurger/repos",
      "events_url": "https://api.github.com/users/TomAugspurger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TomAugspurger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-15T19:52:07Z",
    "updated_at": "2017-05-15T19:52:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Your suggestion of specifying the bins myself is not feasible since I don't know the distribution of the values before hand.\r\n\r\npandas has the same problem :) Doing `qcut(x, 5)` is just `qcut(x, [0, .2, .4, .6, .8, 1.])`, which can't give you your desired outcome since the 20th and 40th percentiles are the same.\r\n\r\nI did a brief skim of other packages, and it seems like they get around this by iteratively adjusting the quantiles until things work. @artturib would you mind writing up a function that does what you want, and we can see if we can integrate it into pandas?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/348361431",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16328#issuecomment-348361431",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16328",
    "id": 348361431,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODM2MTQzMQ==",
    "user": {
      "login": "wyegelwel",
      "id": 1468189,
      "node_id": "MDQ6VXNlcjE0NjgxODk=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1468189?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wyegelwel",
      "html_url": "https://github.com/wyegelwel",
      "followers_url": "https://api.github.com/users/wyegelwel/followers",
      "following_url": "https://api.github.com/users/wyegelwel/following{/other_user}",
      "gists_url": "https://api.github.com/users/wyegelwel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wyegelwel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wyegelwel/subscriptions",
      "organizations_url": "https://api.github.com/users/wyegelwel/orgs",
      "repos_url": "https://api.github.com/users/wyegelwel/repos",
      "events_url": "https://api.github.com/users/wyegelwel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wyegelwel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-01T00:06:25Z",
    "updated_at": "2017-12-01T00:06:25Z",
    "author_association": "NONE",
    "body": "I ran into this today. Consider the case:\r\n\r\n```python\r\nIn [3]: pd.qcut([1,1,1,1,2,3,4], 3, duplicates='drop')\r\nOut[3]: \r\n[(0.999, 2.0], (0.999, 2.0], (0.999, 2.0], (0.999, 2.0], (0.999, 2.0], (2.0, 4.0], (2.0, 4.0]]\r\nCategories (2, interval[float64]): [(0.999, 2.0] < (2.0, 4.0]]\r\n\r\nIn [9]: pd.Series([1,1,1,1,2,3,4]).quantile([ 0.        ,  0.33333333,  0.66666667,  1.        ])\r\nOut[9]: \r\n0.000000    1.0\r\n0.333333    1.0\r\n0.666667    2.0\r\n1.000000    4.0\r\n```\r\n\r\nGiven this data with these quantile values, I would expect the bins to be `[(0.9999,1] < [2,4)]`, however they are `[(0.999, 2.0] < (2.0, 4.0]]`\r\n\r\nI think this is a bug in the qcut logic with duplicates. \r\n\r\nSpecifically, qcut decides on the [quantiles using linspace](https://github.com/pandas-dev/pandas/blob/a6345c7cd8c41842d61902801e7bef9cacb0c2d5/pandas/core/reshape/tile.py#L202) if it isn't specified. The linspace is `np.linspace(0,1, num_quantiles+1)`. The bucket ranges are then constructed by taking consecutive pairs of the quantiles values. \r\n\r\nThe problem is if the min and first quantile values are duplicate, than we drop one and the first quantile is then treated as the min for the first bucket constructed. \r\n\r\nI think the fix is if the 0th and 1st bin values are equal, to update the 0th bin value by subtracting a small epsilon instead of filtering it"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/348373203",
    "html_url": "https://github.com/pandas-dev/pandas/issues/16328#issuecomment-348373203",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/16328",
    "id": 348373203,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODM3MzIwMw==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-01T01:18:03Z",
    "updated_at": "2017-12-01T01:18:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "@wyegelwel thanks for the report! a PR to fix would be welcome!"
  }
]
