[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50677995",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50677995",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50677995,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjc3OTk1",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T20:51:45Z",
    "updated_at": "2014-07-30T20:51:45Z",
    "author_association": "MEMBER",
    "body": "There's one thing you didn't try:\n\n```\nIn [37]: df\nOut[37]:\n                 C       D       E\nA    B\nbar  one   -0.9384  0.3450 -0.8715\n     three  1.1107  1.9896 -0.4797\nflux six    0.5059  0.0494  0.0993\n     three  0.3148 -0.7710  0.2409\nfoo  five   2.3012 -0.3600 -0.9216\n     one   -0.3965 -1.0410 -0.0600\n     two    1.2348  0.6059 -0.8019\n     two    0.0912  0.5812 -0.2724\n\nIn [38]: df.groupby(level='A').transform(lambda x: x.iloc[-1])\nOut[38]:\n                 C       D       E\nA    B\nbar  one    1.1107  1.9896 -0.4797\n     three  1.1107  1.9896 -0.4797\nflux six    0.3148 -0.7710  0.2409\n     three  0.3148 -0.7710  0.2409\nfoo  five   0.0912  0.5812 -0.2724\n     one    0.0912  0.5812 -0.2724\n     two    0.0912  0.5812 -0.2724\n     two    0.0912  0.5812 -0.2724\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50678587",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50678587",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50678587,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjc4NTg3",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T20:56:23Z",
    "updated_at": "2014-07-30T20:56:47Z",
    "author_association": "MEMBER",
    "body": "These lines from EdChum's answer\n\n``` python\nlast = lambda x: x.iloc[-1]\ndf.groupby(level='A').transform(last)\n```\n\nare **not** the same as doing\n\n``` python\ndf.groupby(level='A').transform(last = lambda x: x.iloc[-1])\n```\n\nIn the second one you're passing a _keyword argument_ to `transform` which will of course raise a `TypeError` because it expects at least two positional arguments and you're only passing a keyword argument and no positionals (except the implicit `self` that comes with every method)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50679249",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50679249",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50679249,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjc5MjQ5",
    "user": {
      "login": "amelio-vazquez-reina",
      "id": 1993919,
      "node_id": "MDQ6VXNlcjE5OTM5MTk=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1993919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amelio-vazquez-reina",
      "html_url": "https://github.com/amelio-vazquez-reina",
      "followers_url": "https://api.github.com/users/amelio-vazquez-reina/followers",
      "following_url": "https://api.github.com/users/amelio-vazquez-reina/following{/other_user}",
      "gists_url": "https://api.github.com/users/amelio-vazquez-reina/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amelio-vazquez-reina/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amelio-vazquez-reina/subscriptions",
      "organizations_url": "https://api.github.com/users/amelio-vazquez-reina/orgs",
      "repos_url": "https://api.github.com/users/amelio-vazquez-reina/repos",
      "events_url": "https://api.github.com/users/amelio-vazquez-reina/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amelio-vazquez-reina/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T21:01:16Z",
    "updated_at": "2014-07-30T21:03:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks @cpcloud  I actually mistyped it at the beginning of this issue. I did try (and just tried again):\n\n``` python\nlast = lambda x: x.iloc[-1]\ndf.groupby(level='A').transform(last)\n```\n\nbut I do **not** get the desired dataframe. I get the original frame.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50679461",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50679461",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50679461,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjc5NDYx",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T21:02:59Z",
    "updated_at": "2014-07-30T21:03:16Z",
    "author_association": "MEMBER",
    "body": "@ribonoous Can you show a reproducible example? Hard to debug without seeing the data. Can make random data too, if you can't show the data where it's failing, I just need to be able to reproduce it.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50679824",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50679824",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50679824,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjc5ODI0",
    "user": {
      "login": "amelio-vazquez-reina",
      "id": 1993919,
      "node_id": "MDQ6VXNlcjE5OTM5MTk=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1993919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amelio-vazquez-reina",
      "html_url": "https://github.com/amelio-vazquez-reina",
      "followers_url": "https://api.github.com/users/amelio-vazquez-reina/followers",
      "following_url": "https://api.github.com/users/amelio-vazquez-reina/following{/other_user}",
      "gists_url": "https://api.github.com/users/amelio-vazquez-reina/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amelio-vazquez-reina/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amelio-vazquez-reina/subscriptions",
      "organizations_url": "https://api.github.com/users/amelio-vazquez-reina/orgs",
      "repos_url": "https://api.github.com/users/amelio-vazquez-reina/repos",
      "events_url": "https://api.github.com/users/amelio-vazquez-reina/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amelio-vazquez-reina/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T21:05:31Z",
    "updated_at": "2014-07-30T21:05:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks @cpcloud . The example I included above is from my current session. I understand that your answer should work, but it's literally not working on my machine as I type it:\n\n``` python\nN.In <121>: df\nN.Out<121>: \n                   C         D  E\nA    B                           \nbar  one   -0.507507 -0.719877  0\n     three  0.735206  0.476516  0\nflux six    0.347799 -0.201347  2\n     three -0.271447 -0.936737  2\nfoo  five   0.930560 -0.237395  2\n     one   -1.759220 -0.564822  1\n     two    1.759313  0.277731  2\n     two   -0.506662  0.758981  1\n\nN.In <122>: df.groupby(level='A').transform(lambda x: x.iloc[-1])\nN.Out<122>: \n                   C         D  E\nA    B                           \nbar  one   -0.507507 -0.719877  0\n     three  0.735206  0.476516  0\nflux six    0.347799 -0.201347  2\n     three -0.271447 -0.936737  2\nfoo  five   0.930560 -0.237395  2\n     one   -1.759220 -0.564822  1\n     two    1.759313  0.277731  2\n     two   -0.506662  0.758981  1\n```\n\nI am on Python 3 in an embedded shell in IPython with the following packages:\n\n```\n$ pip freeze\nCython==0.20.1\nDataShape==0.2\nFlask==0.10.1\nJinja2==2.7.2\nMarkupSafe==0.18\nPillow==2.4.0\nPyYAML==3.11\nPygments==1.6\nSQLAlchemy==0.9.4\nSphinx==1.2.2\nWerkzeug==0.9.6\nXlsxWriter==0.5.5\nappnope==0.0.6\nargcomplete==0.6.7\nastropy==0.3.2\nbackports.ssl-match-hostname==3.4.0.2\nbeautifulsoup4==4.3.1\nbinstar==0.5.3\nbitarray==0.8.1\nblaze==0.5\nblz==0.6.2\nbokeh==0.4.4\ncdecimal==2.3\ncolorama==0.2.7\nconfigobj==5.0.5\ndocutils==0.11\nelpy==1.4.2\nflake8==2.2.2\nfuture==0.12.1\ngreenlet==0.4.2\nh5py==2.3.0\nipython==2.1.0\nitsdangerous==0.24\njdcal==1.0\nllvmpy==0.12.6\nlpsolve55==5.5.2.0\nlxml==3.3.5\nmatplotlib==1.3.1\nmccabe==0.2.1\nmock==1.0.1\nmultipledispatch==0.4.3\nnetworkx==1.8.1\nnose==1.3.3\nnumba==0.13.2\nnumexpr==2.3.1\nnumpy==1.8.1\nopenpyxl==1.8.5\npandas==0.14.1\npatsy==0.2.1\npep8==1.5.7\nply==3.4\npsutil==2.1.1\npsycopg2==2.5.3\npy==1.4.20\npy4j==0.8.1\npycosat==0.6.1\npycparser==2.10\npycrypto==2.6.1\npyflakes==0.8.1\npymc==2.3.4\npyparsing==2.0.1\npytest==2.5.2\npython-dateutil==2.1\npytz==2014.4\npyzmq==14.3.0\nredis==2.9.1\nrequests==2.3.0\nrope-py3k==0.9.4-1\nrunipy==0.1.0\nscikit-image==0.10.0\nscikit-learn==0.15.0\nscipy==0.14.0\nseaborn==0.4.dev\nsix==1.7.3\nstatsmodels==0.5.0\nsympy==0.7.5\ntables==3.1.1\ntornado==3.2.1\nujson==1.33\nxlrd==0.9.3\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50680277",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50680277",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50680277,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjgwMjc3",
    "user": {
      "login": "amelio-vazquez-reina",
      "id": 1993919,
      "node_id": "MDQ6VXNlcjE5OTM5MTk=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1993919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amelio-vazquez-reina",
      "html_url": "https://github.com/amelio-vazquez-reina",
      "followers_url": "https://api.github.com/users/amelio-vazquez-reina/followers",
      "following_url": "https://api.github.com/users/amelio-vazquez-reina/following{/other_user}",
      "gists_url": "https://api.github.com/users/amelio-vazquez-reina/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amelio-vazquez-reina/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amelio-vazquez-reina/subscriptions",
      "organizations_url": "https://api.github.com/users/amelio-vazquez-reina/orgs",
      "repos_url": "https://api.github.com/users/amelio-vazquez-reina/repos",
      "events_url": "https://api.github.com/users/amelio-vazquez-reina/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amelio-vazquez-reina/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T21:08:55Z",
    "updated_at": "2014-07-30T21:08:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "@cpcloud  I just tried it on a fresh IPython session (no terminal embedded):\n\n```\ndef create_random_multi_index():\n  df = pd.DataFrame({'A' : ['foo', 'bar', 'foo', 'bar',\n                            'foo', 'flux', 'foo', 'flux'],  \n                     'B' : ['one', 'one', 'two', 'three',\n                            'two', 'six', 'five', 'three'],\n                     'C' : randn(8), 'D' : randn(8), 'E': randint(0,3, size=(8,))})\n  df.set_index(['A', 'B'], inplace=True)\n  df.sort_index(inplace=True)\n  return df\n```\n\n```\nIn [8]: df = create_random_multi_index()\n\nIn [9]: df\nOut[9]: \n                   C         D  E\nA    B                           \nbar  one    0.113720  1.000103  1\n     three  0.778840 -0.546913  0\nflux six    1.688509  1.541020  2\n     three  2.973229 -0.063245  1\nfoo  five   0.208310  1.268056  0\n     one    0.404996 -1.332461  2\n     two   -1.038567  0.376829  1\n     two    1.528148  1.386106  0\n\nIn [10]: df.groupby(level='A').transform(lambda x: x.iloc[-1])\nOut[10]: \n                   C         D  E\nA    B                           \nbar  one    0.113720  1.000103  1\n     three  0.778840 -0.546913  0\nflux six    1.688509  1.541020  2\n     three  2.973229 -0.063245  1\nfoo  five   0.208310  1.268056  0\n     one    0.404996 -1.332461  2\n     two   -1.038567  0.376829  1\n     two    1.528148  1.386106  0\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50680345",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50680345",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50680345,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjgwMzQ1",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T21:09:29Z",
    "updated_at": "2014-07-30T21:09:29Z",
    "author_association": "MEMBER",
    "body": "ok let me try \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50680619",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50680619",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50680619,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjgwNjE5",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T21:11:48Z",
    "updated_at": "2014-07-30T21:11:48Z",
    "author_association": "MEMBER",
    "body": "ok _now_ i can repro\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50680642",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50680642",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50680642,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjgwNjQy",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T21:12:02Z",
    "updated_at": "2014-07-30T21:12:02Z",
    "author_association": "MEMBER",
    "body": "@ribonoous thx for the example!\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50680716",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50680716",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50680716,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjgwNzE2",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T21:12:43Z",
    "updated_at": "2014-07-30T21:12:43Z",
    "author_association": "MEMBER",
    "body": "interesting seems to be related to types\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50680883",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50680883",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50680883,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjgwODgz",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T21:14:07Z",
    "updated_at": "2014-07-30T21:14:07Z",
    "author_association": "MEMBER",
    "body": "```\nIn [12]: df\nOut[12]:\n                 C       D  E\nA    B\nbar  one   -0.4580  0.1261  2\n     three  0.9299 -1.4628  0\nflux six   -0.4497  0.2510  1\n     three  0.6542 -0.7250  0\nfoo  five  -0.2595  1.5363  2\n     one    0.3749 -0.3560  0\n     two    0.1009  1.5566  1\n     two   -0.9102 -1.2865  0\n\nIn [13]: df[['C', 'D']].groupby(level='A').transform(lambda x: x.iloc[-1])\nOut[13]:\n                 C       D\nA    B\nbar  one    0.9299 -1.4628\n     three  0.9299 -1.4628\nflux six    0.6542 -0.7250\n     three  0.6542 -0.7250\nfoo  five  -0.9102 -1.2865\n     one   -0.9102 -1.2865\n     two   -0.9102 -1.2865\n     two   -0.9102 -1.2865\n\nIn [14]: df[['E']].groupby(level='A').transform(lambda x: x.iloc[-1])\nOut[14]:\n            E\nA    B\nbar  one    0\n     three  0\nflux six    0\n     three  0\nfoo  five   0\n     one    0\n     two    0\n     two    0\n\nIn [15]: df[['D', 'E']].groupby(level='A').transform(lambda x: x.iloc[-1])\nOut[15]:\n                 D  E\nA    B\nbar  one    0.1261  2\n     three -1.4628  0\nflux six    0.2510  1\n     three -0.7250  0\nfoo  five   1.5363  2\n     one   -0.3560  0\n     two    1.5566  1\n     two   -1.2865  0\n\nIn [16]: df[['C', 'E']].groupby(level='A').transform(lambda x: x.iloc[-1])\nOut[16]:\n                 C  E\nA    B\nbar  one   -0.4580  2\n     three  0.9299  0\nflux six   -0.4497  1\n     three  0.6542  0\nfoo  five  -0.2595  2\n     one    0.3749  0\n     two    0.1009  1\n     two   -0.9102  0\n```\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50681153",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50681153",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50681153,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjgxMTUz",
    "user": {
      "login": "amelio-vazquez-reina",
      "id": 1993919,
      "node_id": "MDQ6VXNlcjE5OTM5MTk=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1993919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amelio-vazquez-reina",
      "html_url": "https://github.com/amelio-vazquez-reina",
      "followers_url": "https://api.github.com/users/amelio-vazquez-reina/followers",
      "following_url": "https://api.github.com/users/amelio-vazquez-reina/following{/other_user}",
      "gists_url": "https://api.github.com/users/amelio-vazquez-reina/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amelio-vazquez-reina/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amelio-vazquez-reina/subscriptions",
      "organizations_url": "https://api.github.com/users/amelio-vazquez-reina/orgs",
      "repos_url": "https://api.github.com/users/amelio-vazquez-reina/repos",
      "events_url": "https://api.github.com/users/amelio-vazquez-reina/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amelio-vazquez-reina/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T21:16:29Z",
    "updated_at": "2014-07-30T21:16:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks @cpcloud More than happy to help. Hopefully I will be able to contribute fixing the code and not just reporting examples soon.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50681216",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50681216",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50681216,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjgxMjE2",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T21:16:53Z",
    "updated_at": "2014-07-30T21:16:53Z",
    "author_association": "MEMBER",
    "body": "let us know if you need any help!\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50681834",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50681834",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50681834,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjgxODM0",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T21:22:04Z",
    "updated_at": "2014-07-30T21:22:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "issue is here: https://github.com/pydata/pandas/blob/master/pandas/core/groupby.py#L2799\n\ncompletely unsafe to do this with multiple dtypes (well it 'works', but no effect).\n\nneed to do this block by block and will work\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50681966",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50681966",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50681966,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjgxOTY2",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T21:23:14Z",
    "updated_at": "2014-07-30T21:23:14Z",
    "author_association": "MEMBER",
    "body": "hm darn, well gladd you asved me from that rabbit hole\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50691459",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50691459",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50691459,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjkxNDU5",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T22:53:43Z",
    "updated_at": "2014-07-30T22:53:43Z",
    "author_association": "MEMBER",
    "body": "this should at least raise on mixed dtypes\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50691498",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50691498",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50691498,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjkxNDk4",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T22:54:06Z",
    "updated_at": "2014-07-30T22:54:06Z",
    "author_association": "MEMBER",
    "body": "@ribonoous care to make a pull request, this is pretty straightforward\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50691838",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50691838",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50691838,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjkxODM4",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T22:57:58Z",
    "updated_at": "2014-07-30T22:57:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "well....not that hard to fix ....\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50691922",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50691922",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50691922,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjkxOTIy",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-30T22:58:56Z",
    "updated_at": "2014-07-30T22:58:56Z",
    "author_association": "MEMBER",
    "body": "ok ... in that case @ribonoous offer still stands!\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50751340",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50751340",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50751340,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNzUxMzQw",
    "user": {
      "login": "amelio-vazquez-reina",
      "id": 1993919,
      "node_id": "MDQ6VXNlcjE5OTM5MTk=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1993919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amelio-vazquez-reina",
      "html_url": "https://github.com/amelio-vazquez-reina",
      "followers_url": "https://api.github.com/users/amelio-vazquez-reina/followers",
      "following_url": "https://api.github.com/users/amelio-vazquez-reina/following{/other_user}",
      "gists_url": "https://api.github.com/users/amelio-vazquez-reina/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amelio-vazquez-reina/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amelio-vazquez-reina/subscriptions",
      "organizations_url": "https://api.github.com/users/amelio-vazquez-reina/orgs",
      "repos_url": "https://api.github.com/users/amelio-vazquez-reina/repos",
      "events_url": "https://api.github.com/users/amelio-vazquez-reina/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amelio-vazquez-reina/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-31T12:27:31Z",
    "updated_at": "2014-07-31T12:27:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks @cpcloud I am looking at the [line](https://github.com/pydata/pandas/blob/master/pandas/core/groupby.py#L2799) that jreback mentioned. This is my first time looking inside of pandas, as well as my first time contributing to an open source project on GitHub. Would you mind giving me a hint of where to look into? \n\nFrom the discussion I inferred that the problem occurs when the dataframe has mixed `dtypes`. What is the problem with the existing block?:\n\n``` python\n            if isinstance(res, Series):\n                if res.index.is_(obj.index):\n                    group.T.values[:] = res\n                else:\n                    group.values[:] = res\n\n                applied.append(group)\n            else:\n```\n\n?\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50752446",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50752446",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50752446,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNzUyNDQ2",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-31T12:40:01Z",
    "updated_at": "2014-07-31T12:40:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ribonoous \n\nthe `.values` takes the pandas object and returns the underlying ndarray and works fine if its a snigle dtype. if its multiple, the this is an upcast COPY, e.g. mxiing floats/object gets you an object dtype. numpy does do welll with this either as assignment is broken for object dtype.\n\nSomething like\n\n`group.loc[:] = res` WILL work, but this is slow, so need to do something like this\n\n```\n# mixed dtypes\nif group._is_mixed_type:\n    for b in group._data.blocks:\n           b.setitem(slice(None),res.iloc[b.mgr_locs.as_array])\nelse:\n    # do what it was doing above (as this is faster)\n```\n\nmaybe need to add some timings for this as well. (and maybe a doc warning)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50752653",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50752653",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50752653,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNzUyNjUz",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-31T12:42:20Z",
    "updated_at": "2014-07-31T12:43:57Z",
    "author_association": "MEMBER",
    "body": "Sure. I'll outline what I think could be the start of a solution and we can iterate from there.\n\nLet's say you have `df`\n\n```\nIn [21]: A, B = ['bar'] * 2 + ['flux'] * 2 + ['foo'] * 4, ['one', 'three', 'six', 'three', 'five', 'one', 'two', 'two']\n\nIn [22]: mi = MultiIndex.from_tuples(list(zip(A, B)), names=['A', 'B'])\n\nIn [23]: n = len(mi.values)\n\nIn [24]: df = DataFrame({'C': np.random.randn(n), 'D': np.random.randn(n), 'E': np.random.randint(5, size=n)}, index=mi)\n\nIn [25]: df\nOut[25]:\n                 C       D  E\nA    B\nbar  one    0.4615 -0.7685  2\n     three  0.2533  0.3017  3\nflux six   -0.1020 -1.3196  0\n     three  0.2417  0.3707  2\nfoo  five   1.8301 -0.1334  1\n     one    1.1182  1.2973  0\n     two   -0.3256  3.0025  0\n     two   -1.2568  1.7894  3\n\nIn [26]: df.dtypes\nOut[26]:\nC    float64\nD    float64\nE      int64\ndtype: object\n```\n\nAnd you want to execute\n\n``` python\ndf.groupby(level='A').transform(lambda x: x.iloc[-1])\n```\n\nEventually you'll get to `_transform_general` and this line:\n\n``` python\n        for name, group in gen:\n```\n\nis iterating over each group generated by the call to `groupby(column)`.\n\nIgnoring the fast path/slow path stuff (not relevant ATM since the issue lies with the dtype of group), `res` for the first application of `iloc[-1]` will be:\n\n```\nIn [28]: df.loc[np.s_['bar', :], :].iloc[-1]\nOut[28]:\nC    0.2533\nD    0.3017\nE    3.0000\nName: (bar, three), dtype: float64\n```\n\nNotice that the `dtype` is `float64` even for `E`, which is not the original type. As @jreback says this because of an upcast and said upcast will make a copy. When you assign to that, it isn't reflected in the original frame, so you need to essentially do the operation over blocks (blocks are the blocks of the different dtypes: this is how the underlying data in pandas objects are represented).\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50752943",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50752943",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50752943,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNzUyOTQz",
    "user": {
      "login": "cpcloud",
      "id": 417981,
      "node_id": "MDQ6VXNlcjQxNzk4MQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/417981?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cpcloud",
      "html_url": "https://github.com/cpcloud",
      "followers_url": "https://api.github.com/users/cpcloud/followers",
      "following_url": "https://api.github.com/users/cpcloud/following{/other_user}",
      "gists_url": "https://api.github.com/users/cpcloud/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cpcloud/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cpcloud/subscriptions",
      "organizations_url": "https://api.github.com/users/cpcloud/orgs",
      "repos_url": "https://api.github.com/users/cpcloud/repos",
      "events_url": "https://api.github.com/users/cpcloud/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cpcloud/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-31T12:44:26Z",
    "updated_at": "2014-07-31T12:44:26Z",
    "author_association": "MEMBER",
    "body": "This is actually a simple enough problem that you can gain some understanding about how everything works :)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/50754734",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-50754734",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 50754734,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNzU0NzM0",
    "user": {
      "login": "amelio-vazquez-reina",
      "id": 1993919,
      "node_id": "MDQ6VXNlcjE5OTM5MTk=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1993919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amelio-vazquez-reina",
      "html_url": "https://github.com/amelio-vazquez-reina",
      "followers_url": "https://api.github.com/users/amelio-vazquez-reina/followers",
      "following_url": "https://api.github.com/users/amelio-vazquez-reina/following{/other_user}",
      "gists_url": "https://api.github.com/users/amelio-vazquez-reina/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amelio-vazquez-reina/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amelio-vazquez-reina/subscriptions",
      "organizations_url": "https://api.github.com/users/amelio-vazquez-reina/orgs",
      "repos_url": "https://api.github.com/users/amelio-vazquez-reina/repos",
      "events_url": "https://api.github.com/users/amelio-vazquez-reina/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amelio-vazquez-reina/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-07-31T12:57:28Z",
    "updated_at": "2014-07-31T12:57:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks @cpcloud and @jreback I greatly appreciate the help! Today my schedule is tight, but I should have time tomorrow afternoon/evening to look into this.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/53881914",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-53881914",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 53881914,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzODgxOTE0",
    "user": {
      "login": "amelio-vazquez-reina",
      "id": 1993919,
      "node_id": "MDQ6VXNlcjE5OTM5MTk=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1993919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amelio-vazquez-reina",
      "html_url": "https://github.com/amelio-vazquez-reina",
      "followers_url": "https://api.github.com/users/amelio-vazquez-reina/followers",
      "following_url": "https://api.github.com/users/amelio-vazquez-reina/following{/other_user}",
      "gists_url": "https://api.github.com/users/amelio-vazquez-reina/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amelio-vazquez-reina/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amelio-vazquez-reina/subscriptions",
      "organizations_url": "https://api.github.com/users/amelio-vazquez-reina/orgs",
      "repos_url": "https://api.github.com/users/amelio-vazquez-reina/repos",
      "events_url": "https://api.github.com/users/amelio-vazquez-reina/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amelio-vazquez-reina/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-08-29T14:21:10Z",
    "updated_at": "2014-08-29T14:21:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think I understand the problem. I presume I need to iterate through `dtypes` (blocks of columns) solving the problem for one `dtype` at a time, correct? \n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/53882769",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-53882769",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 53882769,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzODgyNzY5",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-08-29T14:27:30Z",
    "updated_at": "2014-08-29T14:27:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "yep u need to do this block by block (which by definition are a single dtype)\nuse the blocks as this is internal (so u avoid lots of creation overhead - blocks are thin wrappers in ndarrays)\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/57172091",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-57172091",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 57172091,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTcyMDkx",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-09-29T14:49:32Z",
    "updated_at": "2014-09-29T14:49:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ribonoous lmk if you have made progress on this. I think have to address (for 0.15.1 for sure). to include Categorical (so by definition need to do it block-by-block), see #8065 .\n\nOne possibility is to have a fast-path where you can do integer-like as the current path (e.g. float/int data). And have a 2nd path for multi-dtypes (which basically accumulates the results in a list then concats at the end). which is slower, but more robust.\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/65286405",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-65286405",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 65286405,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1Mjg2NDA1",
    "user": {
      "login": "amelio-vazquez-reina",
      "id": 1993919,
      "node_id": "MDQ6VXNlcjE5OTM5MTk=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1993919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amelio-vazquez-reina",
      "html_url": "https://github.com/amelio-vazquez-reina",
      "followers_url": "https://api.github.com/users/amelio-vazquez-reina/followers",
      "following_url": "https://api.github.com/users/amelio-vazquez-reina/following{/other_user}",
      "gists_url": "https://api.github.com/users/amelio-vazquez-reina/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amelio-vazquez-reina/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amelio-vazquez-reina/subscriptions",
      "organizations_url": "https://api.github.com/users/amelio-vazquez-reina/orgs",
      "repos_url": "https://api.github.com/users/amelio-vazquez-reina/repos",
      "events_url": "https://api.github.com/users/amelio-vazquez-reina/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amelio-vazquez-reina/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2014-12-02T19:13:14Z",
    "updated_at": "2018-07-06T21:22:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks @jreback I apologize for not having responded earlier. Work has become hectic in recent weeks and haven't had a chance to look into it. Everyone was very helpful in the thread and am very sorry I haven't had a chance to pick it up from where @cpcloud left it. I certainly want to learn to contribute, but can't promise anything at this point :((. \r\n\r\nIf any of you decides to fix it, I will make sure to see how how do it, since at a minimum it will definitely be  educative.\r\n"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/403149870",
    "html_url": "https://github.com/pandas-dev/pandas/issues/7883#issuecomment-403149870",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/7883",
    "id": 403149870,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMzE0OTg3MA==",
    "user": {
      "login": "jreback",
      "id": 953992,
      "node_id": "MDQ6VXNlcjk1Mzk5Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/953992?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jreback",
      "html_url": "https://github.com/jreback",
      "followers_url": "https://api.github.com/users/jreback/followers",
      "following_url": "https://api.github.com/users/jreback/following{/other_user}",
      "gists_url": "https://api.github.com/users/jreback/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jreback/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jreback/subscriptions",
      "organizations_url": "https://api.github.com/users/jreback/orgs",
      "repos_url": "https://api.github.com/users/jreback/repos",
      "events_url": "https://api.github.com/users/jreback/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jreback/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-06T21:20:47Z",
    "updated_at": "2018-07-06T21:20:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "looks good in master, needs tests"
  }
]
