[
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/418786197",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22610#issuecomment-418786197",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22610",
    "id": 418786197,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxODc4NjE5Nw==",
    "user": {
      "login": "obilodeau",
      "id": 546325,
      "node_id": "MDQ6VXNlcjU0NjMyNQ==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/546325?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/obilodeau",
      "html_url": "https://github.com/obilodeau",
      "followers_url": "https://api.github.com/users/obilodeau/followers",
      "following_url": "https://api.github.com/users/obilodeau/following{/other_user}",
      "gists_url": "https://api.github.com/users/obilodeau/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/obilodeau/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/obilodeau/subscriptions",
      "organizations_url": "https://api.github.com/users/obilodeau/orgs",
      "repos_url": "https://api.github.com/users/obilodeau/repos",
      "events_url": "https://api.github.com/users/obilodeau/events{/privacy}",
      "received_events_url": "https://api.github.com/users/obilodeau/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-05T16:02:30Z",
    "updated_at": "2018-09-05T16:02:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "Forgot to say that the workaround is to make sure you have no UTF-8 surrogates in your data. In my case this meant that I needed to decode / reencode a field that came from another library.\r\n\r\nFor example:\r\n\r\n```python\r\nfield = field.encode('utf-8', errors='surrogatepass')\r\n```"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/418801270",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22610#issuecomment-418801270",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22610",
    "id": 418801270,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxODgwMTI3MA==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-05T16:49:16Z",
    "updated_at": "2018-09-05T16:49:16Z",
    "author_association": "MEMBER",
    "body": "Is this possible to do with the stdlib csv writer?"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/418866151",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22610#issuecomment-418866151",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22610",
    "id": 418866151,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxODg2NjE1MQ==",
    "user": {
      "login": "obilodeau",
      "id": 546325,
      "node_id": "MDQ6VXNlcjU0NjMyNQ==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/546325?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/obilodeau",
      "html_url": "https://github.com/obilodeau",
      "followers_url": "https://api.github.com/users/obilodeau/followers",
      "following_url": "https://api.github.com/users/obilodeau/following{/other_user}",
      "gists_url": "https://api.github.com/users/obilodeau/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/obilodeau/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/obilodeau/subscriptions",
      "organizations_url": "https://api.github.com/users/obilodeau/orgs",
      "repos_url": "https://api.github.com/users/obilodeau/repos",
      "events_url": "https://api.github.com/users/obilodeau/events{/privacy}",
      "received_events_url": "https://api.github.com/users/obilodeau/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-05T20:14:13Z",
    "updated_at": "2018-09-05T20:14:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "This (plain open):\r\n```python\r\nimport csv\r\nrow = '\\ud800'\r\nwith open(\"test-you-can-delete.csv\", \"w\") as _file:\r\n   writer = csv.writer(_file)\r\n   writer.writerow(row)\r\n```\r\n\r\nwill yield the error below:\r\n```\r\n---------------------------------------------------------------------------\r\nUnicodeEncodeError                        Traceback (most recent call last)\r\n<ipython-input-12-c276abf97bef> in <module>()\r\n      3 with open(\"test-you-can-delete.csv\", \"w\") as _file:\r\n      4    writer = csv.writer(_file)\r\n----> 5    writer.writerow(row)\r\n\r\nUnicodeEncodeError: 'utf-8' codec can't encode character '\\ud800' in position 0: surrogates not allowed\r\n```\r\n\r\nBut `open()` supports passing a codec error handler with the `errors=` named argument:\r\n```python\r\nimport csv\r\nrow = '\\ud800'\r\nwith open(\"test-you-can-delete.csv\", \"w\", errors='surrogatepass') as _file:\r\n   writer = csv.writer(_file)\r\n   writer.writerow(row)\r\n```\r\n\r\nThis doesn't generate an error.\r\n\r\nImplementing the named argument `errors=` in `to_csv()` satisfies the principle of least surprise. To me, this is the way to go. Having to explain why all fields should be re-encoded with `encode()` before using `to_csv()` while everything else worked without it (and used to work without it before) was a painful moment for young data scientists."
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/418870299",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22610#issuecomment-418870299",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22610",
    "id": 418870299,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxODg3MDI5OQ==",
    "user": {
      "login": "WillAyd",
      "id": 609873,
      "node_id": "MDQ6VXNlcjYwOTg3Mw==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/609873?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WillAyd",
      "html_url": "https://github.com/WillAyd",
      "followers_url": "https://api.github.com/users/WillAyd/followers",
      "following_url": "https://api.github.com/users/WillAyd/following{/other_user}",
      "gists_url": "https://api.github.com/users/WillAyd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WillAyd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WillAyd/subscriptions",
      "organizations_url": "https://api.github.com/users/WillAyd/orgs",
      "repos_url": "https://api.github.com/users/WillAyd/repos",
      "events_url": "https://api.github.com/users/WillAyd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WillAyd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-05T20:28:34Z",
    "updated_at": "2018-09-05T20:28:34Z",
    "author_association": "MEMBER",
    "body": "Makes sense - would accept a PR if you are up for it"
  },
  {
    "url": "https://api.github.com/repos/pandas-dev/pandas/issues/comments/418873372",
    "html_url": "https://github.com/pandas-dev/pandas/issues/22610#issuecomment-418873372",
    "issue_url": "https://api.github.com/repos/pandas-dev/pandas/issues/22610",
    "id": 418873372,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxODg3MzM3Mg==",
    "user": {
      "login": "obilodeau",
      "id": 546325,
      "node_id": "MDQ6VXNlcjU0NjMyNQ==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/546325?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/obilodeau",
      "html_url": "https://github.com/obilodeau",
      "followers_url": "https://api.github.com/users/obilodeau/followers",
      "following_url": "https://api.github.com/users/obilodeau/following{/other_user}",
      "gists_url": "https://api.github.com/users/obilodeau/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/obilodeau/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/obilodeau/subscriptions",
      "organizations_url": "https://api.github.com/users/obilodeau/orgs",
      "repos_url": "https://api.github.com/users/obilodeau/repos",
      "events_url": "https://api.github.com/users/obilodeau/events{/privacy}",
      "received_events_url": "https://api.github.com/users/obilodeau/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-05T20:38:45Z",
    "updated_at": "2018-09-05T20:38:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "It's a busy time of year but I might get back at it later.\r\n\r\nIn the meantime, if anyone else is interested at the problem, it is documented with a workaround and a link to a similar fix in `to_hdf()` for inspiration."
  }
]
