{"schema": {"fields":[{"type":"integer","name":"index"},{"type":"string","name":"author_association"},{"type":"string","name":"body"},{"type":"datetime","name":"created_at"},{"type":"string","name":"html_url"},{"type":"integer","name":"id"},{"type":"string","name":"issue_url"},{"type":"string","name":"node_id"},{"type":"datetime","name":"updated_at"},{"type":"string","name":"url"},{"type":"string","name":"user"}],"pandas_version":"0.20.0","primaryKey":["index"]}, "data": [{"index":0,"author_association":"CONTRIBUTOR","body":"@donmccurdy one thing I noticed when implementing pooled worker loaders is that there's actually a big benefit to loading the files in a separate queue, and then passing the binary data to the worker when it's ready to be processed.  Fetching in the worker means that your workers are bound by network IO most of the time, so if you have a pool of 4 asset loaders, you'll end up blocking much longer overall as you work your way through the queue.\r\n\r\nIf you have a separate download queue, your browser can also take better advantage of http pipelining.","created_at":"2017-10-21T06:34:16.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-338368192","id":338368192,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDMzODM2ODE5Mg==","updated_at":"2017-10-21T06:34:16.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/338368192","user":{"following_url":"https:\/\/api.github.com\/users\/jbaicoianu\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/jbaicoianu\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/251610?v=4","url":"https:\/\/api.github.com\/users\/jbaicoianu","gists_url":"https:\/\/api.github.com\/users\/jbaicoianu\/gists{\/gist_id}","html_url":"https:\/\/github.com\/jbaicoianu","subscriptions_url":"https:\/\/api.github.com\/users\/jbaicoianu\/subscriptions","node_id":"MDQ6VXNlcjI1MTYxMA==","repos_url":"https:\/\/api.github.com\/users\/jbaicoianu\/repos","received_events_url":"https:\/\/api.github.com\/users\/jbaicoianu\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/jbaicoianu\/starred{\/owner}{\/repo}","site_admin":false,"login":"jbaicoianu","type":"User","id":251610,"followers_url":"https:\/\/api.github.com\/users\/jbaicoianu\/followers","organizations_url":"https:\/\/api.github.com\/users\/jbaicoianu\/orgs"}},{"index":1,"author_association":"COLLABORATOR","body":"@jbaicoianu Thanks \u2014 I didn't do it here, but with a pool of 4 workers couldn't you keep sending requests for ImageBitmaps to the same workers, even before they've finished the last task? Or is there some particular advantage to all of the network IO happening on the main thread?\r\n\r\nMaybe I should be using `THREE.LoaderSupport.WorkerSupport` to deal with this sort of thing. \ud83d\ude01","created_at":"2017-10-21T06:39:17.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-338368407","id":338368407,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDMzODM2ODQwNw==","updated_at":"2017-10-21T06:39:28.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/338368407","user":{"following_url":"https:\/\/api.github.com\/users\/donmccurdy\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/donmccurdy\/events{\/privacy}","avatar_url":"https:\/\/avatars3.githubusercontent.com\/u\/1848368?v=4","url":"https:\/\/api.github.com\/users\/donmccurdy","gists_url":"https:\/\/api.github.com\/users\/donmccurdy\/gists{\/gist_id}","html_url":"https:\/\/github.com\/donmccurdy","subscriptions_url":"https:\/\/api.github.com\/users\/donmccurdy\/subscriptions","node_id":"MDQ6VXNlcjE4NDgzNjg=","repos_url":"https:\/\/api.github.com\/users\/donmccurdy\/repos","received_events_url":"https:\/\/api.github.com\/users\/donmccurdy\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/donmccurdy\/starred{\/owner}{\/repo}","site_admin":false,"login":"donmccurdy","type":"User","id":1848368,"followers_url":"https:\/\/api.github.com\/users\/donmccurdy\/followers","organizations_url":"https:\/\/api.github.com\/users\/donmccurdy\/orgs"}},{"index":2,"author_association":"CONTRIBUTOR","body":"@donmccurdy Need to look at your code in detail, but `THREE.LoaderSupport.WorkerSupport` should \r\nbe usable here (or with minor adjustments). @jbaicoianu `THREE.LoaderSupport.WorkerDirector` with some enhancements could delegate the loaded data to the pool of workers it spawned, I think. I will provide more detailed feedback latest tomorrow. Easiest example to see it all working with a \"faked\" loader\/parser ist the `MeshSpray` example.","created_at":"2017-10-21T10:18:05.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-338381088","id":338381088,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDMzODM4MTA4OA==","updated_at":"2017-10-21T10:18:05.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/338381088","user":{"following_url":"https:\/\/api.github.com\/users\/kaisalmen\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/kaisalmen\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/21079138?v=4","url":"https:\/\/api.github.com\/users\/kaisalmen","gists_url":"https:\/\/api.github.com\/users\/kaisalmen\/gists{\/gist_id}","html_url":"https:\/\/github.com\/kaisalmen","subscriptions_url":"https:\/\/api.github.com\/users\/kaisalmen\/subscriptions","node_id":"MDQ6VXNlcjIxMDc5MTM4","repos_url":"https:\/\/api.github.com\/users\/kaisalmen\/repos","received_events_url":"https:\/\/api.github.com\/users\/kaisalmen\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/kaisalmen\/starred{\/owner}{\/repo}","site_admin":false,"login":"kaisalmen","type":"User","id":21079138,"followers_url":"https:\/\/api.github.com\/users\/kaisalmen\/followers","organizations_url":"https:\/\/api.github.com\/users\/kaisalmen\/orgs"}},{"index":3,"author_association":"CONTRIBUTOR","body":"WIP: This is not fully working, yet, but almost all pieces are there. You can already get the idea:\r\nhttps:\/\/github.com\/kaisalmen\/three.js\/tree\/feat-imagebitmaploader-worker\r\n\r\n","created_at":"2017-10-22T22:00:08.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-338512578","id":338512578,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDMzODUxMjU3OA==","updated_at":"2017-10-22T22:00:08.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/338512578","user":{"following_url":"https:\/\/api.github.com\/users\/kaisalmen\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/kaisalmen\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/21079138?v=4","url":"https:\/\/api.github.com\/users\/kaisalmen","gists_url":"https:\/\/api.github.com\/users\/kaisalmen\/gists{\/gist_id}","html_url":"https:\/\/github.com\/kaisalmen","subscriptions_url":"https:\/\/api.github.com\/users\/kaisalmen\/subscriptions","node_id":"MDQ6VXNlcjIxMDc5MTM4","repos_url":"https:\/\/api.github.com\/users\/kaisalmen\/repos","received_events_url":"https:\/\/api.github.com\/users\/kaisalmen\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/kaisalmen\/starred{\/owner}{\/repo}","site_admin":false,"login":"kaisalmen","type":"User","id":21079138,"followers_url":"https:\/\/api.github.com\/users\/kaisalmen\/followers","organizations_url":"https:\/\/api.github.com\/users\/kaisalmen\/orgs"}},{"index":4,"author_association":"COLLABORATOR","body":"@kaisalmen thanks! Are the fixes to LoaderSupport changes that make sense from your perspective? Hopefully loading images isn't too much a one-off... Does LoaderSupport handle worker pooling this way?","created_at":"2017-10-23T05:04:50.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-338548796","id":338548796,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDMzODU0ODc5Ng==","updated_at":"2017-10-23T05:04:50.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/338548796","user":{"following_url":"https:\/\/api.github.com\/users\/donmccurdy\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/donmccurdy\/events{\/privacy}","avatar_url":"https:\/\/avatars3.githubusercontent.com\/u\/1848368?v=4","url":"https:\/\/api.github.com\/users\/donmccurdy","gists_url":"https:\/\/api.github.com\/users\/donmccurdy\/gists{\/gist_id}","html_url":"https:\/\/github.com\/donmccurdy","subscriptions_url":"https:\/\/api.github.com\/users\/donmccurdy\/subscriptions","node_id":"MDQ6VXNlcjE4NDgzNjg=","repos_url":"https:\/\/api.github.com\/users\/donmccurdy\/repos","received_events_url":"https:\/\/api.github.com\/users\/donmccurdy\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/donmccurdy\/starred{\/owner}{\/repo}","site_admin":false,"login":"donmccurdy","type":"User","id":1848368,"followers_url":"https:\/\/api.github.com\/users\/donmccurdy\/followers","organizations_url":"https:\/\/api.github.com\/users\/donmccurdy\/orgs"}},{"index":5,"author_association":"CONTRIBUTOR","body":"@donmccurdy I will likely revert the split of run into prepare and run as it not needed. I realized this morning. The `run` (=load in `ImageBitmapLoader` case) method called by `THREE.LoaderSupport.WorkerDirector` could deal with the async file loading and then message the data to the worker once available and block execution for the time being. A list of image load instructions needs to be fed to the `WorkerDirector`. This is still missing on my branch.","created_at":"2017-10-23T05:57:39.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-338555193","id":338555193,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDMzODU1NTE5Mw==","updated_at":"2017-10-23T06:57:52.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/338555193","user":{"following_url":"https:\/\/api.github.com\/users\/kaisalmen\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/kaisalmen\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/21079138?v=4","url":"https:\/\/api.github.com\/users\/kaisalmen","gists_url":"https:\/\/api.github.com\/users\/kaisalmen\/gists{\/gist_id}","html_url":"https:\/\/github.com\/kaisalmen","subscriptions_url":"https:\/\/api.github.com\/users\/kaisalmen\/subscriptions","node_id":"MDQ6VXNlcjIxMDc5MTM4","repos_url":"https:\/\/api.github.com\/users\/kaisalmen\/repos","received_events_url":"https:\/\/api.github.com\/users\/kaisalmen\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/kaisalmen\/starred{\/owner}{\/repo}","site_admin":false,"login":"kaisalmen","type":"User","id":21079138,"followers_url":"https:\/\/api.github.com\/users\/kaisalmen\/followers","organizations_url":"https:\/\/api.github.com\/users\/kaisalmen\/orgs"}},{"index":6,"author_association":"CONTRIBUTOR","body":"@donmccurdy `ImageBitmapLoader` now uses `WorkerSupport`. Changes to `LoaderSupport` classes ok as there are no public interfaces changed now. Contract between worker and user of worker  is expanded, but that is fine.\r\n**Verdict:** Code is not shorter due to the shortness\/low complexity of your original worker and `WorkerSupport` comes with some overhead (utility functions and communication contract), but usage in this context is now easily possible. \r\n\r\nI would like to expand the example with a button to load n cubes (e.g. 256) with `WorkerDirector` orchestrating 4 parallel workers (ideally without any caching) to see how this performs.\r\n\r\nLet me know what you think?\r\n\r\n**Edit:** Do you know if a Blob is a transferable? Otherwise the postMessage is inefficient and an ArrayBuffer must be used. It can be returned by the fetch, but not feed to `createImageBitmap`, correct?","created_at":"2017-10-23T13:03:04.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-338651668","id":338651668,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDMzODY1MTY2OA==","updated_at":"2017-10-23T21:09:11.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/338651668","user":{"following_url":"https:\/\/api.github.com\/users\/kaisalmen\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/kaisalmen\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/21079138?v=4","url":"https:\/\/api.github.com\/users\/kaisalmen","gists_url":"https:\/\/api.github.com\/users\/kaisalmen\/gists{\/gist_id}","html_url":"https:\/\/github.com\/kaisalmen","subscriptions_url":"https:\/\/api.github.com\/users\/kaisalmen\/subscriptions","node_id":"MDQ6VXNlcjIxMDc5MTM4","repos_url":"https:\/\/api.github.com\/users\/kaisalmen\/repos","received_events_url":"https:\/\/api.github.com\/users\/kaisalmen\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/kaisalmen\/starred{\/owner}{\/repo}","site_admin":false,"login":"kaisalmen","type":"User","id":21079138,"followers_url":"https:\/\/api.github.com\/users\/kaisalmen\/followers","organizations_url":"https:\/\/api.github.com\/users\/kaisalmen\/orgs"}},{"index":7,"author_association":"OWNER","body":"@spite looks good?","created_at":"2017-10-23T21:14:50.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-338798837","id":338798837,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDMzODc5ODgzNw==","updated_at":"2017-10-23T21:14:50.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/338798837","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}},{"index":8,"author_association":"CONTRIBUTOR","body":"> Fetch and create the ImageBitmap in a worker by default\r\n\r\nI had a version that offloaded to a worker. I didn\u00b4t see a lot of difference, and I think the idea for most APIs dealing with downloads and image decoding the be moved outside of the main thread by the browser itself. So I didn't want to complicate the code with a Web Worker dependency, mostly because I usually ship an ES5 and an ES6 version of the code, which makes worker loading syntax a bit more verbose. But if it\u00b4s working fine, awesome! \ud83e\udd18\ud83c\udffd\r\n\r\nLGTM","created_at":"2017-10-23T23:08:55.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-338822561","id":338822561,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDMzODgyMjU2MQ==","updated_at":"2017-10-23T23:08:55.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/338822561","user":{"following_url":"https:\/\/api.github.com\/users\/spite\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/spite\/events{\/privacy}","avatar_url":"https:\/\/avatars3.githubusercontent.com\/u\/731885?v=4","url":"https:\/\/api.github.com\/users\/spite","gists_url":"https:\/\/api.github.com\/users\/spite\/gists{\/gist_id}","html_url":"https:\/\/github.com\/spite","subscriptions_url":"https:\/\/api.github.com\/users\/spite\/subscriptions","node_id":"MDQ6VXNlcjczMTg4NQ==","repos_url":"https:\/\/api.github.com\/users\/spite\/repos","received_events_url":"https:\/\/api.github.com\/users\/spite\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/spite\/starred{\/owner}{\/repo}","site_admin":false,"login":"spite","type":"User","id":731885,"followers_url":"https:\/\/api.github.com\/users\/spite\/followers","organizations_url":"https:\/\/api.github.com\/users\/spite\/orgs"}},{"index":9,"author_association":"COLLABORATOR","body":"> I had a version that offloaded to a worker. I didn\u00b4t see a lot of difference, and I think the idea for most APIs dealing with downloads and image decoding the be moved outside of the main thread by the browser itself.\r\n\r\nOh! That would be great if the browser goes off-thread already... Will try this in Chrome and Firefox and report back...","created_at":"2017-10-23T23:36:26.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-338827065","id":338827065,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDMzODgyNzA2NQ==","updated_at":"2017-10-23T23:36:26.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/338827065","user":{"following_url":"https:\/\/api.github.com\/users\/donmccurdy\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/donmccurdy\/events{\/privacy}","avatar_url":"https:\/\/avatars3.githubusercontent.com\/u\/1848368?v=4","url":"https:\/\/api.github.com\/users\/donmccurdy","gists_url":"https:\/\/api.github.com\/users\/donmccurdy\/gists{\/gist_id}","html_url":"https:\/\/github.com\/donmccurdy","subscriptions_url":"https:\/\/api.github.com\/users\/donmccurdy\/subscriptions","node_id":"MDQ6VXNlcjE4NDgzNjg=","repos_url":"https:\/\/api.github.com\/users\/donmccurdy\/repos","received_events_url":"https:\/\/api.github.com\/users\/donmccurdy\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/donmccurdy\/starred{\/owner}{\/repo}","site_admin":false,"login":"donmccurdy","type":"User","id":1848368,"followers_url":"https:\/\/api.github.com\/users\/donmccurdy\/followers","organizations_url":"https:\/\/api.github.com\/users\/donmccurdy\/orgs"}},{"index":10,"author_association":"CONTRIBUTOR","body":"@donmccurdy Finally had time to create the `WorkerDirector` proof of concept. The adjusted example requires 1.5GB of spare graphics memory otherwise the browser will crash. Even with enough graphics memory available Chrome crashes now and then. Workers are destroyed properly, though. Let me know what you think.\r\n\r\n**Edit:** Workers are created once and are then re-used. If the worker usage makes sense in this particular use case needs to be decided. Anyway a useful result of this experiment is that the overall concept of a common, instruction-based and repeatable worker usage can be applied to this class of problem. \r\n**Edit2:** Amended commit with latest updates from main branch and fixed with spaces","created_at":"2017-10-29T22:29:16.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-340308382","id":340308382,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDM0MDMwODM4Mg==","updated_at":"2017-10-30T13:14:33.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/340308382","user":{"following_url":"https:\/\/api.github.com\/users\/kaisalmen\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/kaisalmen\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/21079138?v=4","url":"https:\/\/api.github.com\/users\/kaisalmen","gists_url":"https:\/\/api.github.com\/users\/kaisalmen\/gists{\/gist_id}","html_url":"https:\/\/github.com\/kaisalmen","subscriptions_url":"https:\/\/api.github.com\/users\/kaisalmen\/subscriptions","node_id":"MDQ6VXNlcjIxMDc5MTM4","repos_url":"https:\/\/api.github.com\/users\/kaisalmen\/repos","received_events_url":"https:\/\/api.github.com\/users\/kaisalmen\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/kaisalmen\/starred{\/owner}{\/repo}","site_admin":false,"login":"kaisalmen","type":"User","id":21079138,"followers_url":"https:\/\/api.github.com\/users\/kaisalmen\/followers","organizations_url":"https:\/\/api.github.com\/users\/kaisalmen\/orgs"}},{"index":11,"author_association":"NONE","body":"I agree completely with Juame - any XHR style request by default is already\nlargely non-blocking to the main thread - so before you all get bogged down\nin the gritty of how to do it can we answer 'why' specifically?\n\nSure there's some stats but that's not really indicative of much..\n\n- Michael\n\nOn Mon, Oct 30, 2017 at 6:29 AM, Kai Salmen <notifications@github.com>\nwrote:\n\n> @donmccurdy <https:\/\/github.com\/donmccurdy> Finally had time to create\n> the WorkerDirector proof of concept. The adjusted example requires 1.5GB\n> of spare graphics memory otherwise the browser will crash. Even with enough\n> graphics memory available Chrome crashes now and then. Workers are\n> destroyed properly, though. Let me know what you think?\n>\n> \u2014\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-340308382>,\n> or mute the thread\n> <https:\/\/github.com\/notifications\/unsubscribe-auth\/AE3lcX1oT82ytab2Z3mz1dkMOlu2qpgYks5sxPxOgaJpZM4QBc-q>\n> .\n>\n","created_at":"2017-10-30T02:41:46.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-340329371","id":340329371,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDM0MDMyOTM3MQ==","updated_at":"2017-10-30T02:41:46.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/340329371","user":{"following_url":"https:\/\/api.github.com\/users\/MJCD\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/MJCD\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/5105009?v=4","url":"https:\/\/api.github.com\/users\/MJCD","gists_url":"https:\/\/api.github.com\/users\/MJCD\/gists{\/gist_id}","html_url":"https:\/\/github.com\/MJCD","subscriptions_url":"https:\/\/api.github.com\/users\/MJCD\/subscriptions","node_id":"MDQ6VXNlcjUxMDUwMDk=","repos_url":"https:\/\/api.github.com\/users\/MJCD\/repos","received_events_url":"https:\/\/api.github.com\/users\/MJCD\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/MJCD\/starred{\/owner}{\/repo}","site_admin":false,"login":"MJCD","type":"User","id":5105009,"followers_url":"https:\/\/api.github.com\/users\/MJCD\/followers","organizations_url":"https:\/\/api.github.com\/users\/MJCD\/orgs"}},{"index":12,"author_association":"NONE","body":"Also consider that a webworker cant even make XHR\/fetch requests where a\nresponse body is required as these will always be null so the main worker\nis still going to be doing a lot more work as a transaction that is largely\nsimply offloaded to a fetch worker thread and then the handler called on\nreturn becomes a much larger operation that will still largely all go\nthrough the main thread.\n\nThe only time I can see this being advantageous is when there was an\nextreme amount of immediate processing that is required on the resource\nbefore it is usable by the main thread.\n\n- Michael\n\nOn Mon, Oct 30, 2017 at 10:41 AM, Michael DeByl <michael.debyl@gmail.com>\n wrote:\n\n> I agree completely with Juame - any XHR style request by default is\n> already largely non-blocking to the main thread - so before you all get\n> bogged down in the gritty of how to do it can we answer 'why' specifically?\n>\n> Sure there's some stats but that's not really indicative of much..\n>\n> - Michael\n>\n> On Mon, Oct 30, 2017 at 6:29 AM, Kai Salmen <notifications@github.com>\n>  wrote:\n>\n>> @donmccurdy <https:\/\/github.com\/donmccurdy> Finally had time to create\n>> the WorkerDirector proof of concept. The adjusted example requires 1.5GB\n>> of spare graphics memory otherwise the browser will crash. Even with enough\n>> graphics memory available Chrome crashes now and then. Workers are\n>> destroyed properly, though. Let me know what you think?\n>>\n>> \u2014\n>> You are receiving this because you are subscribed to this thread.\n>> Reply to this email directly, view it on GitHub\n>> <https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-340308382>,\n>> or mute the thread\n>> <https:\/\/github.com\/notifications\/unsubscribe-auth\/AE3lcX1oT82ytab2Z3mz1dkMOlu2qpgYks5sxPxOgaJpZM4QBc-q>\n>> .\n>>\n>\n>\n","created_at":"2017-10-30T02:46:06.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-340329867","id":340329867,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDM0MDMyOTg2Nw==","updated_at":"2017-10-30T02:46:06.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/340329867","user":{"following_url":"https:\/\/api.github.com\/users\/MJCD\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/MJCD\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/5105009?v=4","url":"https:\/\/api.github.com\/users\/MJCD","gists_url":"https:\/\/api.github.com\/users\/MJCD\/gists{\/gist_id}","html_url":"https:\/\/github.com\/MJCD","subscriptions_url":"https:\/\/api.github.com\/users\/MJCD\/subscriptions","node_id":"MDQ6VXNlcjUxMDUwMDk=","repos_url":"https:\/\/api.github.com\/users\/MJCD\/repos","received_events_url":"https:\/\/api.github.com\/users\/MJCD\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/MJCD\/starred{\/owner}{\/repo}","site_admin":false,"login":"MJCD","type":"User","id":5105009,"followers_url":"https:\/\/api.github.com\/users\/MJCD\/followers","organizations_url":"https:\/\/api.github.com\/users\/MJCD\/orgs"}},{"index":13,"author_association":"COLLABORATOR","body":"> I agree completely with Juame - any XHR style request by default is already\r\nlargely non-blocking to the main thread - so before you all get bogged down\r\nin the gritty of how to do it can we answer 'why' specifically?\r\n\r\nIt is not the request I am trying to offload from the main thread, but the image decoding triggered by the `createImageBitmap()` call. I still haven't had the chance to verify whether that is actually blocking in Chrome and Firefox, but I'd assumed it was based on this [blog post from Chrome devrel](https:\/\/aerotwist.com\/blog\/the-hack-is-back\/). If so, that would cause an unacceptable number of dropped frames for WebVR applications and should be done by a worker.\r\n\r\nWill report results when I've verified this. It would certainly be more convenient if the worker is not needed.","created_at":"2017-10-30T15:45:20.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-340486384","id":340486384,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDM0MDQ4NjM4NA==","updated_at":"2017-10-30T15:45:20.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/340486384","user":{"following_url":"https:\/\/api.github.com\/users\/donmccurdy\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/donmccurdy\/events{\/privacy}","avatar_url":"https:\/\/avatars3.githubusercontent.com\/u\/1848368?v=4","url":"https:\/\/api.github.com\/users\/donmccurdy","gists_url":"https:\/\/api.github.com\/users\/donmccurdy\/gists{\/gist_id}","html_url":"https:\/\/github.com\/donmccurdy","subscriptions_url":"https:\/\/api.github.com\/users\/donmccurdy\/subscriptions","node_id":"MDQ6VXNlcjE4NDgzNjg=","repos_url":"https:\/\/api.github.com\/users\/donmccurdy\/repos","received_events_url":"https:\/\/api.github.com\/users\/donmccurdy\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/donmccurdy\/starred{\/owner}{\/repo}","site_admin":false,"login":"donmccurdy","type":"User","id":1848368,"followers_url":"https:\/\/api.github.com\/users\/donmccurdy\/followers","organizations_url":"https:\/\/api.github.com\/users\/donmccurdy\/orgs"}},{"index":14,"author_association":"COLLABORATOR","body":"> Sure there's some stats but that's not really indicative of much..\r\n\r\n60-70% fewer dropped frames during texture upload is quite noticeable when the screen is strapped to your face. \ud83d\ude09\r\n\r\n","created_at":"2017-10-30T15:47:11.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-340487028","id":340487028,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDM0MDQ4NzAyOA==","updated_at":"2017-10-30T15:47:11.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/340487028","user":{"following_url":"https:\/\/api.github.com\/users\/donmccurdy\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/donmccurdy\/events{\/privacy}","avatar_url":"https:\/\/avatars3.githubusercontent.com\/u\/1848368?v=4","url":"https:\/\/api.github.com\/users\/donmccurdy","gists_url":"https:\/\/api.github.com\/users\/donmccurdy\/gists{\/gist_id}","html_url":"https:\/\/github.com\/donmccurdy","subscriptions_url":"https:\/\/api.github.com\/users\/donmccurdy\/subscriptions","node_id":"MDQ6VXNlcjE4NDgzNjg=","repos_url":"https:\/\/api.github.com\/users\/donmccurdy\/repos","received_events_url":"https:\/\/api.github.com\/users\/donmccurdy\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/donmccurdy\/starred{\/owner}{\/repo}","site_admin":false,"login":"donmccurdy","type":"User","id":1848368,"followers_url":"https:\/\/api.github.com\/users\/donmccurdy\/followers","organizations_url":"https:\/\/api.github.com\/users\/donmccurdy\/orgs"}},{"index":15,"author_association":"CONTRIBUTOR","body":"I've been talking to @paullewis about the relevance of the article, since it's from Jan 2016 and my experience from a few months ago showed that it might not be necessary any more. So in the time of the article, createImageBitmap would still occur in the main thread, but it's moved off it since then. The best way to show it, some profiling when clicking \"Add ImageBitmap\":\r\n\r\n![screenshot from 2017-10-30 16 18 08](https:\/\/user-images.githubusercontent.com\/731885\/32182570-f096a0e8-bd8e-11e7-92c4-65633cb4e4a1.png)\r\n\r\nYou can see that Image Decode happens in a thread. If you profile with \"Add Image\", you'll see it happens in the main thread.\r\n\r\nSo this is almost as good as it gets, no need for workers on Chrome. Can't say about other browsers -haven't tested- but I'm certain they'll all end up implementing async image decoding.","created_at":"2017-10-30T16:27:48.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-340501247","id":340501247,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDM0MDUwMTI0Nw==","updated_at":"2017-10-30T16:27:48.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/340501247","user":{"following_url":"https:\/\/api.github.com\/users\/spite\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/spite\/events{\/privacy}","avatar_url":"https:\/\/avatars3.githubusercontent.com\/u\/731885?v=4","url":"https:\/\/api.github.com\/users\/spite","gists_url":"https:\/\/api.github.com\/users\/spite\/gists{\/gist_id}","html_url":"https:\/\/github.com\/spite","subscriptions_url":"https:\/\/api.github.com\/users\/spite\/subscriptions","node_id":"MDQ6VXNlcjczMTg4NQ==","repos_url":"https:\/\/api.github.com\/users\/spite\/repos","received_events_url":"https:\/\/api.github.com\/users\/spite\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/spite\/starred{\/owner}{\/repo}","site_admin":false,"login":"spite","type":"User","id":731885,"followers_url":"https:\/\/api.github.com\/users\/spite\/followers","organizations_url":"https:\/\/api.github.com\/users\/spite\/orgs"}},{"index":16,"author_association":"COLLABORATOR","body":"Thanks @spite and all! Measuring here I get the same result: `createImageBitmap` is asynchronous. Bit hard to read Firefox's performance measurements but it looks asynchronous there too. So, I've removed the Web Worker part of this PR, leaving only the support for Firefox's (partial) `createImageBitmap` implementation. Whether that is worth merging, or whether we require those options for this to be useful, I'm not sure.\r\n\r\n@kaisalmen thanks for your help and pointers! I will be wanting to use WorkerSupport soon for decoding DRACO-compressed assets in GLTFLoader, which definitely will benefit from a Web Worker.","created_at":"2017-10-31T04:32:27.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-340657174","id":340657174,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDM0MDY1NzE3NA==","updated_at":"2017-10-31T04:33:11.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/340657174","user":{"following_url":"https:\/\/api.github.com\/users\/donmccurdy\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/donmccurdy\/events{\/privacy}","avatar_url":"https:\/\/avatars3.githubusercontent.com\/u\/1848368?v=4","url":"https:\/\/api.github.com\/users\/donmccurdy","gists_url":"https:\/\/api.github.com\/users\/donmccurdy\/gists{\/gist_id}","html_url":"https:\/\/github.com\/donmccurdy","subscriptions_url":"https:\/\/api.github.com\/users\/donmccurdy\/subscriptions","node_id":"MDQ6VXNlcjE4NDgzNjg=","repos_url":"https:\/\/api.github.com\/users\/donmccurdy\/repos","received_events_url":"https:\/\/api.github.com\/users\/donmccurdy\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/donmccurdy\/starred{\/owner}{\/repo}","site_admin":false,"login":"donmccurdy","type":"User","id":1848368,"followers_url":"https:\/\/api.github.com\/users\/donmccurdy\/followers","organizations_url":"https:\/\/api.github.com\/users\/donmccurdy\/orgs"}},{"index":17,"author_association":"CONTRIBUTOR","body":"For now Chrome's createImageBitmap does image decoding off the main thread when the source is a blob, and it doesn't when it's an ImageElement or SVGElement. For the use case we have, i think it's fine with blobs.\r\n\r\nThis is more or less what I hope we'll see in the future: https:\/\/www.chromestatus.com\/features\/5637156160667648","created_at":"2017-10-31T10:38:22.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-340723671","id":340723671,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDM0MDcyMzY3MQ==","updated_at":"2017-10-31T10:38:22.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/340723671","user":{"following_url":"https:\/\/api.github.com\/users\/spite\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/spite\/events{\/privacy}","avatar_url":"https:\/\/avatars3.githubusercontent.com\/u\/731885?v=4","url":"https:\/\/api.github.com\/users\/spite","gists_url":"https:\/\/api.github.com\/users\/spite\/gists{\/gist_id}","html_url":"https:\/\/github.com\/spite","subscriptions_url":"https:\/\/api.github.com\/users\/spite\/subscriptions","node_id":"MDQ6VXNlcjczMTg4NQ==","repos_url":"https:\/\/api.github.com\/users\/spite\/repos","received_events_url":"https:\/\/api.github.com\/users\/spite\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/spite\/starred{\/owner}{\/repo}","site_admin":false,"login":"spite","type":"User","id":731885,"followers_url":"https:\/\/api.github.com\/users\/spite\/followers","organizations_url":"https:\/\/api.github.com\/users\/spite\/orgs"}},{"index":18,"author_association":"COLLABORATOR","body":"ImageBitmap just landed on Safari Technical Preview: https:\/\/webkit.org\/blog\/8016\/release-notes-for-safari-technology-preview-43\/\r\n\r\nIt appears to support options, but is currently failing on https:\/\/threejs.org\/examples\/?q=imagebitmap#webgl_loader_imagebitmap.","created_at":"2017-11-01T19:10:12.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-341208732","id":341208732,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDM0MTIwODczMg==","updated_at":"2017-11-01T19:10:12.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/341208732","user":{"following_url":"https:\/\/api.github.com\/users\/donmccurdy\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/donmccurdy\/events{\/privacy}","avatar_url":"https:\/\/avatars3.githubusercontent.com\/u\/1848368?v=4","url":"https:\/\/api.github.com\/users\/donmccurdy","gists_url":"https:\/\/api.github.com\/users\/donmccurdy\/gists{\/gist_id}","html_url":"https:\/\/github.com\/donmccurdy","subscriptions_url":"https:\/\/api.github.com\/users\/donmccurdy\/subscriptions","node_id":"MDQ6VXNlcjE4NDgzNjg=","repos_url":"https:\/\/api.github.com\/users\/donmccurdy\/repos","received_events_url":"https:\/\/api.github.com\/users\/donmccurdy\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/donmccurdy\/starred{\/owner}{\/repo}","site_admin":false,"login":"donmccurdy","type":"User","id":1848368,"followers_url":"https:\/\/api.github.com\/users\/donmccurdy\/followers","organizations_url":"https:\/\/api.github.com\/users\/donmccurdy\/orgs"}},{"index":19,"author_association":"OWNER","body":"Thanks!","created_at":"2017-11-01T22:01:15.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/12456#issuecomment-341256426","id":341256426,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/12456","node_id":"MDEyOklzc3VlQ29tbWVudDM0MTI1NjQyNg==","updated_at":"2017-11-01T22:01:15.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/341256426","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}}]}