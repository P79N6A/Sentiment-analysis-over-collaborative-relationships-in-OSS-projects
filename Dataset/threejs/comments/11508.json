{"schema": {"fields":[{"type":"integer","name":"index"},{"type":"string","name":"author_association"},{"type":"string","name":"body"},{"type":"datetime","name":"created_at"},{"type":"string","name":"html_url"},{"type":"integer","name":"id"},{"type":"string","name":"issue_url"},{"type":"string","name":"node_id"},{"type":"datetime","name":"updated_at"},{"type":"string","name":"url"},{"type":"string","name":"user"}],"pandas_version":"0.20.0","primaryKey":["index"]}, "data": [{"index":0,"author_association":"COLLABORATOR","body":"The current code may be incorrect, but we have to use a formula to decode the map that is consistent with the formula used to encode the map. Do you have a reference and justification for this change?\r\n\r\n\/ping @MiiBond (original author)\r\n\/ping @bhouston \r\n\/ping @Mugen87 \r\n\r\nAlso, if this change is correct, you have to at least do this:\r\n```glsl\r\nsampleUV.y = asin( clamp( flipNormal * reflectVec.y, - 1, 1 ) ) * RECIPROCAL_PI + 0.5;\r\n```\r\nYou can't take the arc-sin of a quantity whose absolute value may exceed 1.\r\n\r\n","created_at":"2017-06-14T15:45:42.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11508#issuecomment-308473269","id":308473269,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11508","node_id":"MDEyOklzc3VlQ29tbWVudDMwODQ3MzI2OQ==","updated_at":"2017-07-06T02:53:42.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/308473269","user":{"following_url":"https:\/\/api.github.com\/users\/WestLangley\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/WestLangley\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/1000017?v=4","url":"https:\/\/api.github.com\/users\/WestLangley","gists_url":"https:\/\/api.github.com\/users\/WestLangley\/gists{\/gist_id}","html_url":"https:\/\/github.com\/WestLangley","subscriptions_url":"https:\/\/api.github.com\/users\/WestLangley\/subscriptions","node_id":"MDQ6VXNlcjEwMDAwMTc=","repos_url":"https:\/\/api.github.com\/users\/WestLangley\/repos","received_events_url":"https:\/\/api.github.com\/users\/WestLangley\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/WestLangley\/starred{\/owner}{\/repo}","site_admin":false,"login":"WestLangley","type":"User","id":1000017,"followers_url":"https:\/\/api.github.com\/users\/WestLangley\/followers","organizations_url":"https:\/\/api.github.com\/users\/WestLangley\/orgs"}},{"index":1,"author_association":"CONTRIBUTOR","body":"> The current code may be incorrect, but we have to use a formula to decode the map that is consistent with the formula used to encode the map.\r\n\r\nAgreed.  \r\n\r\n> Do you have a reference and justification for this change?\r\n\r\nI asked the question on the thread cited; @mrdoob asked for a pull request with the change proposal.  I do not have any further reference that it is consistent with the intent of the existing codebase, hence the original question.\r\n\r\n> You can't take the arc-sin of a quantity whose absolute value may exceed 1.\r\n\r\nGood catch, although I believe the reflectVec is already normalized, and flipNormal is explicitly defined to +\/-1.  If protocol is not to assume prior input sanitization may change at a future date, then adding saturate would be appropriate.","created_at":"2017-06-14T15:56:11.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11508#issuecomment-308476419","id":308476419,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11508","node_id":"MDEyOklzc3VlQ29tbWVudDMwODQ3NjQxOQ==","updated_at":"2017-06-14T15:56:11.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/308476419","user":{"following_url":"https:\/\/api.github.com\/users\/NNskelly\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/NNskelly\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/28572171?v=4","url":"https:\/\/api.github.com\/users\/NNskelly","gists_url":"https:\/\/api.github.com\/users\/NNskelly\/gists{\/gist_id}","html_url":"https:\/\/github.com\/NNskelly","subscriptions_url":"https:\/\/api.github.com\/users\/NNskelly\/subscriptions","node_id":"MDQ6VXNlcjI4NTcyMTcx","repos_url":"https:\/\/api.github.com\/users\/NNskelly\/repos","received_events_url":"https:\/\/api.github.com\/users\/NNskelly\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/NNskelly\/starred{\/owner}{\/repo}","site_admin":false,"login":"NNskelly","type":"User","id":28572171,"followers_url":"https:\/\/api.github.com\/users\/NNskelly\/followers","organizations_url":"https:\/\/api.github.com\/users\/NNskelly\/orgs"}},{"index":2,"author_association":"COLLABORATOR","body":">I believe the reflectVec is already normalized\r\n\r\nCan you show where that is happening?\r\n\r\nRoundoff can produce values greater than 1. That is why we clamp prior to calling `asin`.","created_at":"2017-06-14T16:29:10.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11508#issuecomment-308485834","id":308485834,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11508","node_id":"MDEyOklzc3VlQ29tbWVudDMwODQ4NTgzNA==","updated_at":"2017-06-14T16:29:10.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/308485834","user":{"following_url":"https:\/\/api.github.com\/users\/WestLangley\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/WestLangley\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/1000017?v=4","url":"https:\/\/api.github.com\/users\/WestLangley","gists_url":"https:\/\/api.github.com\/users\/WestLangley\/gists{\/gist_id}","html_url":"https:\/\/github.com\/WestLangley","subscriptions_url":"https:\/\/api.github.com\/users\/WestLangley\/subscriptions","node_id":"MDQ6VXNlcjEwMDAwMTc=","repos_url":"https:\/\/api.github.com\/users\/WestLangley\/repos","received_events_url":"https:\/\/api.github.com\/users\/WestLangley\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/WestLangley\/starred{\/owner}{\/repo}","site_admin":false,"login":"WestLangley","type":"User","id":1000017,"followers_url":"https:\/\/api.github.com\/users\/WestLangley\/followers","organizations_url":"https:\/\/api.github.com\/users\/WestLangley\/orgs"}},{"index":3,"author_association":"CONTRIBUTOR","body":"Line 5\r\n\r\n```\r\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\r\n```\r\n\r\nexplicitly normalizes cameraToVertex, which is then reflected\/refracted about additional vectors to get reflectVec.  I'm not working in an IDE that gives me a quick way to call up reflect() or refract(), but I would not expect those to change a vector's length other than, as you note, perhaps through fp rounding error.\r\nThat said, on closer inspection, there is an else fallthrough where reflectVec is simply set to vReflect, and I cannot in fact cite that vReflect is explicitly arriving normalized.\r\n\r\nThe only place a quick find-in search of the shaders directory is showing vReflect being assigned _to_ is envmap_vertex.glsl, where all paths likewise generate vReflect by reflecting\/refracting the normalized cameraToVertex from line 9\r\n\r\n```\r\nvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\r\n```\r\n\r\nbut I suppose that doesn't cover all possible places where the envmap chunk may be subsequently included.\r\n\r\nI'm not against adding the saturate if the line is otherwise correct; or it may still be a moot point if the original design intent was for images that were angular-sampled on x but linear-sampled on y.\r\n\r\nWolfram looks like it has less information than Wikipedia on what constitutes a \"proper\" equirectangular projection, but if Wikipedia is right in that the y sampling is literally (phi - phi_1) where phi is an angular degrees latitude, I would _think_ that each raster of the map would correspond to an angular wedge of the vertical arc, and thus be more accurately sampled based on the vertical angle of the reflection vector rather than simply the vertical component of the vector (which, at least by my intuition, would vertically squish data near the poles and stretch data near the equator).\r\nhttps:\/\/en.wikipedia.org\/wiki\/Equirectangular_projection","created_at":"2017-06-14T17:19:46.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11508#issuecomment-308499858","id":308499858,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11508","node_id":"MDEyOklzc3VlQ29tbWVudDMwODQ5OTg1OA==","updated_at":"2017-06-14T17:19:46.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/308499858","user":{"following_url":"https:\/\/api.github.com\/users\/NNskelly\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/NNskelly\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/28572171?v=4","url":"https:\/\/api.github.com\/users\/NNskelly","gists_url":"https:\/\/api.github.com\/users\/NNskelly\/gists{\/gist_id}","html_url":"https:\/\/github.com\/NNskelly","subscriptions_url":"https:\/\/api.github.com\/users\/NNskelly\/subscriptions","node_id":"MDQ6VXNlcjI4NTcyMTcx","repos_url":"https:\/\/api.github.com\/users\/NNskelly\/repos","received_events_url":"https:\/\/api.github.com\/users\/NNskelly\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/NNskelly\/starred{\/owner}{\/repo}","site_admin":false,"login":"NNskelly","type":"User","id":28572171,"followers_url":"https:\/\/api.github.com\/users\/NNskelly\/followers","organizations_url":"https:\/\/api.github.com\/users\/NNskelly\/orgs"}},{"index":4,"author_association":"COLLABORATOR","body":">which, at least by my intuition, would vertically squish data near the poles and stretch data near the equator\r\n\r\nThat is exactly why I think the current code is incorrect and your proposal makes sense.","created_at":"2017-06-14T17:35:57.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11508#issuecomment-308504188","id":308504188,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11508","node_id":"MDEyOklzc3VlQ29tbWVudDMwODUwNDE4OA==","updated_at":"2017-06-14T17:35:57.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/308504188","user":{"following_url":"https:\/\/api.github.com\/users\/WestLangley\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/WestLangley\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/1000017?v=4","url":"https:\/\/api.github.com\/users\/WestLangley","gists_url":"https:\/\/api.github.com\/users\/WestLangley\/gists{\/gist_id}","html_url":"https:\/\/github.com\/WestLangley","subscriptions_url":"https:\/\/api.github.com\/users\/WestLangley\/subscriptions","node_id":"MDQ6VXNlcjEwMDAwMTc=","repos_url":"https:\/\/api.github.com\/users\/WestLangley\/repos","received_events_url":"https:\/\/api.github.com\/users\/WestLangley\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/WestLangley\/starred{\/owner}{\/repo}","site_admin":false,"login":"WestLangley","type":"User","id":1000017,"followers_url":"https:\/\/api.github.com\/users\/WestLangley\/followers","organizations_url":"https:\/\/api.github.com\/users\/WestLangley\/orgs"}},{"index":5,"author_association":"OWNER","body":"Yep. I confirm the previous code was incorrect.\r\n\r\nBefore:\r\n<img width=\"1240\" alt=\"screen shot 2017-06-14 at 11 13 31 am\" src=\"https:\/\/user-images.githubusercontent.com\/97088\/27147724-b0a3c078-50f2-11e7-8f86-a9c1e7894ab9.png\">\r\n\r\nAfter:\r\n<img width=\"1240\" alt=\"screen shot 2017-06-14 at 11 13 48 am\" src=\"https:\/\/user-images.githubusercontent.com\/97088\/27147742-b803500e-50f2-11e7-985e-452becf72aa5.png\">\r\n","created_at":"2017-06-14T18:15:27.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11508#issuecomment-308515063","id":308515063,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11508","node_id":"MDEyOklzc3VlQ29tbWVudDMwODUxNTA2Mw==","updated_at":"2017-06-14T18:15:27.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/308515063","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}},{"index":6,"author_association":"OWNER","body":"Thanks!","created_at":"2017-06-14T18:21:16.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11508#issuecomment-308516551","id":308516551,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11508","node_id":"MDEyOklzc3VlQ29tbWVudDMwODUxNjU1MQ==","updated_at":"2017-06-14T18:21:16.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/308516551","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}}]}