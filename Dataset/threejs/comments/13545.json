{"schema": {"fields":[{"type":"integer","name":"index"},{"type":"string","name":"author_association"},{"type":"string","name":"body"},{"type":"datetime","name":"created_at"},{"type":"string","name":"html_url"},{"type":"integer","name":"id"},{"type":"string","name":"issue_url"},{"type":"string","name":"node_id"},{"type":"datetime","name":"updated_at"},{"type":"string","name":"url"},{"type":"string","name":"user"}],"pandas_version":"0.20.0","primaryKey":["index"]}, "data": [{"index":0,"author_association":"COLLABORATOR","body":"Related: #7071","created_at":"2018-03-09T10:41:31.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13545#issuecomment-371777811","id":371777811,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13545","node_id":"MDEyOklzc3VlQ29tbWVudDM3MTc3NzgxMQ==","updated_at":"2018-03-09T10:41:31.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/371777811","user":{"following_url":"https:\/\/api.github.com\/users\/Mugen87\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/Mugen87\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/12612165?v=4","url":"https:\/\/api.github.com\/users\/Mugen87","gists_url":"https:\/\/api.github.com\/users\/Mugen87\/gists{\/gist_id}","html_url":"https:\/\/github.com\/Mugen87","subscriptions_url":"https:\/\/api.github.com\/users\/Mugen87\/subscriptions","node_id":"MDQ6VXNlcjEyNjEyMTY1","repos_url":"https:\/\/api.github.com\/users\/Mugen87\/repos","received_events_url":"https:\/\/api.github.com\/users\/Mugen87\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/Mugen87\/starred{\/owner}{\/repo}","site_admin":false,"login":"Mugen87","type":"User","id":12612165,"followers_url":"https:\/\/api.github.com\/users\/Mugen87\/followers","organizations_url":"https:\/\/api.github.com\/users\/Mugen87\/orgs"}},{"index":1,"author_association":"NONE","body":"Here's my workaround. I had tested it with huge scene in Chrome 65. It\u2018s\u2019 performance still good even though toggling material's visibility per rendering brings extra consumption. Native support will have even better performance.\r\n\r\n    \/* tslint:disable no-invalid-this *\/\r\n    import * as THREE from '.\/buffergeometry.type';\r\n    \r\n    THREE.BufferGeometry.prototype.computeBoundingSphereByGroup = function() {\r\n    \r\n      if (!Array.isArray(this.boundingSphereGroup)) {\r\n        this.boundingSphereGroup = [];\r\n      } else {\r\n        return; \/\/ \u5df2\u7ecf\u8ba1\u7b97\u8fc7\u4e86\r\n      }\r\n    \r\n      const position: THREE.BufferAttribute = this.attributes.position;\r\n      const indices: THREE.BufferAttribute = this.index;\r\n      const groups: { start: number; count: number; materialIndex?: number }[] = this.groups;\r\n      const box = new THREE.Box3();\r\n      const vector = new THREE.Vector3();\r\n    \r\n      if (position && groups) {    \r\n\r\n        for (let j = 0, len = groups.length; j < len; ++j) {\r\n\r\n          const group = groups[j];    \r\n          const idx: number[] = [];\r\n\r\n          if (indices) {\r\n            const array = indices.array;\r\n            for (let i = 0; i < group.count; ++i) {\r\n              idx.push(array[group.start + i]);\r\n            }\r\n          } else {\r\n            for (let i = 0; i < group.count; ++i) {\r\n              idx.push(i);\r\n            }\r\n          }\r\n    \r\n          const pos: number[] = [];\r\n          let index;\r\n          for (let i = 0, count = idx.length; i < count; ++i) {\r\n            index = idx[i];\r\n            pos.push(position.getX(index));\r\n            pos.push(position.getY(index));\r\n            pos.push(position.getZ(index));\r\n          }\r\n    \r\n          box.setFromArray(pos);\r\n    \r\n          const sphere = new THREE.Sphere(box.getCenter());\r\n          const center = sphere.center;\r\n          let maxRadiusSq = 0;\r\n    \r\n          for (let i = 0, il = pos.length; i < il;) {\r\n            vector.x = pos[i++];\r\n            vector.y = pos[i++];\r\n            vector.z = pos[i++];\r\n            maxRadiusSq = Math.max(maxRadiusSq, center.distanceToSquared(vector));\r\n          }\r\n    \r\n          sphere.radius = Math.sqrt(maxRadiusSq);\r\n          if (isNaN(sphere.radius)) {\r\n            console.error('THREE.BufferGeometry.computeBoundingSphere(): ' + \/\/ tslint:disable-line\r\n              'Computed radius is NaN. The \"position\" attribute is likely to have NaN values.', this);\r\n          }\r\n    \r\n          this.boundingSphereGroup.push(sphere);\r\n        }\r\n      }\r\n    \r\n    };\r\n\r\n\r\n\r\n      private onBeforeRender(renderer: THREE.WebGLRenderer,\r\n                             scene: THREE.Scene,\r\n                             camera: THREE.OrthographicCamera | THREE.PerspectiveCamera,\r\n                             target) {\r\n        const objects: THREE.Mesh[] = [];\r\n        scene.traverse((object) => {\r\n          if (ESFilter.isESObject(object)) {\r\n            objects.push(object as THREE.Mesh);\r\n          }\r\n        });\r\n    \r\n        const frustum = new THREE.Frustum();\r\n        const projectMatrix = new THREE.Matrix4();\r\n        const sphere = new THREE.Sphere();\r\n        projectMatrix.multiplyMatrices(camera.projectionMatrix, camera.matrixWorldInverse);\r\n        frustum.setFromMatrix(projectMatrix);\r\n    \r\n        for (let i = objects.length; i--;) {\r\n          const mesh = objects[i];\r\n          const matrix = mesh.matrixWorld;\r\n          const materials = mesh.material as THREE.Material[];\r\n          const geometry = mesh.geometry as THREE.BufferGeometry;\r\n          geometry.computeBoundingSphereByGroup();\r\n    \r\n          for (let j = materials.length; j--;) {\r\n            const mat = materials[j] as THREE.MeshStandardMaterial;\r\n            mat.originVisible = mat.visible;\r\n            sphere.copy(geometry.boundingSphereGroup[j]).applyMatrix4(matrix);\r\n            mat.visible = frustum.intersectsSphere(sphere);\r\n          }\r\n        }\r\n      }\r\n    \r\n      private onAfterRender(renderer: THREE.WebGLRenderer,\r\n                            scene: THREE.Scene,\r\n                            camera: THREE.OrthographicCamera | THREE.PerspectiveCamera,\r\n                            target) {\r\n        const objects: THREE.Mesh[] = [];\r\n        scene.traverse((object) => {\r\n          if (ESFilter.isESObject(object)) {\r\n            objects.push(object as THREE.Mesh);\r\n          }\r\n        });\r\n    \r\n        for (let i = objects.length; i--;) {\r\n          const materials = objects[i].material as THREE.Material[];\r\n          for (let j = materials.length; j--;) {\r\n            const mat = materials[j] as THREE.MeshStandardMaterial;\r\n            mat.visible = mat.originVisible;\r\n          }\r\n        }\r\n      }","created_at":"2018-03-10T01:40:17.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13545#issuecomment-371991798","id":371991798,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13545","node_id":"MDEyOklzc3VlQ29tbWVudDM3MTk5MTc5OA==","updated_at":"2018-03-10T01:40:17.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/371991798","user":{"following_url":"https:\/\/api.github.com\/users\/vinstics\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/vinstics\/events{\/privacy}","avatar_url":"https:\/\/avatars3.githubusercontent.com\/u\/16721670?v=4","url":"https:\/\/api.github.com\/users\/vinstics","gists_url":"https:\/\/api.github.com\/users\/vinstics\/gists{\/gist_id}","html_url":"https:\/\/github.com\/vinstics","subscriptions_url":"https:\/\/api.github.com\/users\/vinstics\/subscriptions","node_id":"MDQ6VXNlcjE2NzIxNjcw","repos_url":"https:\/\/api.github.com\/users\/vinstics\/repos","received_events_url":"https:\/\/api.github.com\/users\/vinstics\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/vinstics\/starred{\/owner}{\/repo}","site_admin":false,"login":"vinstics","type":"User","id":16721670,"followers_url":"https:\/\/api.github.com\/users\/vinstics\/followers","organizations_url":"https:\/\/api.github.com\/users\/vinstics\/orgs"}},{"index":2,"author_association":"COLLABORATOR","body":"Are you okay with marking the issue as a duplicate and focus on #7071, instead?","created_at":"2018-03-11T15:42:38.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13545#issuecomment-372124846","id":372124846,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13545","node_id":"MDEyOklzc3VlQ29tbWVudDM3MjEyNDg0Ng==","updated_at":"2018-03-11T15:42:38.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/372124846","user":{"following_url":"https:\/\/api.github.com\/users\/Mugen87\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/Mugen87\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/12612165?v=4","url":"https:\/\/api.github.com\/users\/Mugen87","gists_url":"https:\/\/api.github.com\/users\/Mugen87\/gists{\/gist_id}","html_url":"https:\/\/github.com\/Mugen87","subscriptions_url":"https:\/\/api.github.com\/users\/Mugen87\/subscriptions","node_id":"MDQ6VXNlcjEyNjEyMTY1","repos_url":"https:\/\/api.github.com\/users\/Mugen87\/repos","received_events_url":"https:\/\/api.github.com\/users\/Mugen87\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/Mugen87\/starred{\/owner}{\/repo}","site_admin":false,"login":"Mugen87","type":"User","id":12612165,"followers_url":"https:\/\/api.github.com\/users\/Mugen87\/followers","organizations_url":"https:\/\/api.github.com\/users\/Mugen87\/orgs"}},{"index":3,"author_association":"NONE","body":"@Mugen87 yeah, that's all right. It's just one use case you may consider to make this library better.","created_at":"2018-03-11T15:56:24.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13545#issuecomment-372125839","id":372125839,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13545","node_id":"MDEyOklzc3VlQ29tbWVudDM3MjEyNTgzOQ==","updated_at":"2018-03-11T15:56:24.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/372125839","user":{"following_url":"https:\/\/api.github.com\/users\/vinstics\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/vinstics\/events{\/privacy}","avatar_url":"https:\/\/avatars3.githubusercontent.com\/u\/16721670?v=4","url":"https:\/\/api.github.com\/users\/vinstics","gists_url":"https:\/\/api.github.com\/users\/vinstics\/gists{\/gist_id}","html_url":"https:\/\/github.com\/vinstics","subscriptions_url":"https:\/\/api.github.com\/users\/vinstics\/subscriptions","node_id":"MDQ6VXNlcjE2NzIxNjcw","repos_url":"https:\/\/api.github.com\/users\/vinstics\/repos","received_events_url":"https:\/\/api.github.com\/users\/vinstics\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/vinstics\/starred{\/owner}{\/repo}","site_admin":false,"login":"vinstics","type":"User","id":16721670,"followers_url":"https:\/\/api.github.com\/users\/vinstics\/followers","organizations_url":"https:\/\/api.github.com\/users\/vinstics\/orgs"}}]}