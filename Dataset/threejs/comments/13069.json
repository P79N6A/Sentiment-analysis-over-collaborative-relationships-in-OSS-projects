{"schema": {"fields":[{"type":"integer","name":"index"},{"type":"string","name":"author_association"},{"type":"string","name":"body"},{"type":"datetime","name":"created_at"},{"type":"string","name":"html_url"},{"type":"integer","name":"id"},{"type":"string","name":"issue_url"},{"type":"string","name":"node_id"},{"type":"datetime","name":"updated_at"},{"type":"string","name":"url"},{"type":"string","name":"user"}],"pandas_version":"0.20.0","primaryKey":["index"]}, "data": [{"index":0,"author_association":"OWNER","body":"Pull Request? \ud83d\ude0a","created_at":"2018-01-08T23:13:50.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-356126852","id":356126852,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1NjEyNjg1Mg==","updated_at":"2018-01-08T23:13:50.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/356126852","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}},{"index":1,"author_association":"CONTRIBUTOR","body":"If there isn't a nasty performance hit, considering that uuid generation has been tuned for speed... I'll take a look.","created_at":"2018-01-08T23:26:30.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-356129358","id":356129358,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1NjEyOTM1OA==","updated_at":"2018-01-08T23:26:30.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/356129358","user":{"following_url":"https:\/\/api.github.com\/users\/aardgoose\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/aardgoose\/events{\/privacy}","avatar_url":"https:\/\/avatars1.githubusercontent.com\/u\/17364910?v=4","url":"https:\/\/api.github.com\/users\/aardgoose","gists_url":"https:\/\/api.github.com\/users\/aardgoose\/gists{\/gist_id}","html_url":"https:\/\/github.com\/aardgoose","subscriptions_url":"https:\/\/api.github.com\/users\/aardgoose\/subscriptions","node_id":"MDQ6VXNlcjE3MzY0OTEw","repos_url":"https:\/\/api.github.com\/users\/aardgoose\/repos","received_events_url":"https:\/\/api.github.com\/users\/aardgoose\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/aardgoose\/starred{\/owner}{\/repo}","site_admin":false,"login":"aardgoose","type":"User","id":17364910,"followers_url":"https:\/\/api.github.com\/users\/aardgoose\/followers","organizations_url":"https:\/\/api.github.com\/users\/aardgoose\/orgs"}},{"index":2,"author_association":"COLLABORATOR","body":"Can lazy UUID generation solve your app case?","created_at":"2018-01-08T23:27:02.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-356129462","id":356129462,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1NjEyOTQ2Mg==","updated_at":"2018-01-08T23:27:02.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/356129462","user":{"following_url":"https:\/\/api.github.com\/users\/takahirox\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/takahirox\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/7637832?v=4","url":"https:\/\/api.github.com\/users\/takahirox","gists_url":"https:\/\/api.github.com\/users\/takahirox\/gists{\/gist_id}","html_url":"https:\/\/github.com\/takahirox","subscriptions_url":"https:\/\/api.github.com\/users\/takahirox\/subscriptions","node_id":"MDQ6VXNlcjc2Mzc4MzI=","repos_url":"https:\/\/api.github.com\/users\/takahirox\/repos","received_events_url":"https:\/\/api.github.com\/users\/takahirox\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/takahirox\/starred{\/owner}{\/repo}","site_admin":false,"login":"takahirox","type":"User","id":7637832,"followers_url":"https:\/\/api.github.com\/users\/takahirox\/followers","organizations_url":"https:\/\/api.github.com\/users\/takahirox\/orgs"}},{"index":3,"author_association":"CONTRIBUTOR","body":"@takahirox  lazy generation would help to some extent, but as more of a scene is explored the memory consumption would still increase. I presume using a getter function to generate uuid's on request.\r\n\r\nTo test I have replaced the Objects in WebGLAttributes and WebGLProperties with WeakMaps* keyed on the scene objects\/attributes directly rather than the uuids., and for testing stubbed out uuid generation.\r\nThis works well with no obvious performance hits and the expected reduction in heap use with  large object counts.\r\n \r\nIt may be worthwhile to combine this approach with lazy generation where exporters\/editors require uuids?\r\n\r\n@mrdoob your thoughts, worthwhile pursuing?\r\n\r\n   \\* to preserve the current behaviour.\r\n","created_at":"2018-01-09T10:20:23.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-356242098","id":356242098,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1NjI0MjA5OA==","updated_at":"2018-01-09T10:20:23.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/356242098","user":{"following_url":"https:\/\/api.github.com\/users\/aardgoose\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/aardgoose\/events{\/privacy}","avatar_url":"https:\/\/avatars1.githubusercontent.com\/u\/17364910?v=4","url":"https:\/\/api.github.com\/users\/aardgoose","gists_url":"https:\/\/api.github.com\/users\/aardgoose\/gists{\/gist_id}","html_url":"https:\/\/github.com\/aardgoose","subscriptions_url":"https:\/\/api.github.com\/users\/aardgoose\/subscriptions","node_id":"MDQ6VXNlcjE3MzY0OTEw","repos_url":"https:\/\/api.github.com\/users\/aardgoose\/repos","received_events_url":"https:\/\/api.github.com\/users\/aardgoose\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/aardgoose\/starred{\/owner}{\/repo}","site_admin":false,"login":"aardgoose","type":"User","id":17364910,"followers_url":"https:\/\/api.github.com\/users\/aardgoose\/followers","organizations_url":"https:\/\/api.github.com\/users\/aardgoose\/orgs"}},{"index":4,"author_association":"OWNER","body":"How many objects are you dealing with? I mean, at what scene graph size this becomes an issue?","created_at":"2018-01-09T22:48:26.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-356439817","id":356439817,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1NjQzOTgxNw==","updated_at":"2018-01-09T22:48:26.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/356439817","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}},{"index":5,"author_association":"OWNER","body":"> r89 as is: 95MB\r\nr89 with uuid flattened with String().toUpper(): 66MB.\r\n\r\nI missed that, what is `String().toUpper()`?","created_at":"2018-01-10T00:55:33.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-356463902","id":356463902,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1NjQ2MzkwMg==","updated_at":"2018-01-10T00:55:33.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/356463902","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}},{"index":6,"author_association":"COLLABORATOR","body":"I'd like to know the total memory consumption on your app and the percentage of memory consumption for `uuid`. Feeling like 40bytes\/object isn't too huge...","created_at":"2018-01-10T11:38:20.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-356577830","id":356577830,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1NjU3NzgzMA==","updated_at":"2018-01-10T11:38:20.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/356577830","user":{"following_url":"https:\/\/api.github.com\/users\/takahirox\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/takahirox\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/7637832?v=4","url":"https:\/\/api.github.com\/users\/takahirox","gists_url":"https:\/\/api.github.com\/users\/takahirox\/gists{\/gist_id}","html_url":"https:\/\/github.com\/takahirox","subscriptions_url":"https:\/\/api.github.com\/users\/takahirox\/subscriptions","node_id":"MDQ6VXNlcjc2Mzc4MzI=","repos_url":"https:\/\/api.github.com\/users\/takahirox\/repos","received_events_url":"https:\/\/api.github.com\/users\/takahirox\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/takahirox\/starred{\/owner}{\/repo}","site_admin":false,"login":"takahirox","type":"User","id":7637832,"followers_url":"https:\/\/api.github.com\/users\/takahirox\/followers","organizations_url":"https:\/\/api.github.com\/users\/takahirox\/orgs"}},{"index":7,"author_association":"CONTRIBUTOR","body":"@mrdoob I meant String().toUpperCase().  It is a bit of a hack to force the VM to translate from effectively a linked list of string fragments to a small linear array - Chrome\/V8 seems to hit concat mode after adding the first 11 characters, after that every pair of HEX characters or '-' are added incrementally.  The fact it is hackish is why I looked at avoiding it altogether.\r\n\r\n@takahirox \r\n\r\nUnfortunately it is not 40 bytes per object but actually 72 bytes per concatenated string segment. (Chrome 63 - similar results from Firefox 57). From the heap dump i get 904 bytes per uuid.\r\nCoinsidering each Object3D, Geometry, Material and multiple bufferAttributes per Geometry this adds up quickly.  With 20000 objects with unique geometries it gets big quickly. \r\n\r\nEg 1 Object3D + 1 Geometry with two attributes (position and color) (assuming shared materials) it is 3616  bytes per scene object. Hope that makes sense. I'll put some performance stats on the PR thread when I have sorted some out but object creation is obviously quicker without generating uuid's.\r\n\r\nIn absolute percentages it very much depends on the models I am displaying (cave systems).","created_at":"2018-01-10T12:00:13.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-356582334","id":356582334,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1NjU4MjMzNA==","updated_at":"2018-01-10T12:00:13.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/356582334","user":{"following_url":"https:\/\/api.github.com\/users\/aardgoose\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/aardgoose\/events{\/privacy}","avatar_url":"https:\/\/avatars1.githubusercontent.com\/u\/17364910?v=4","url":"https:\/\/api.github.com\/users\/aardgoose","gists_url":"https:\/\/api.github.com\/users\/aardgoose\/gists{\/gist_id}","html_url":"https:\/\/github.com\/aardgoose","subscriptions_url":"https:\/\/api.github.com\/users\/aardgoose\/subscriptions","node_id":"MDQ6VXNlcjE3MzY0OTEw","repos_url":"https:\/\/api.github.com\/users\/aardgoose\/repos","received_events_url":"https:\/\/api.github.com\/users\/aardgoose\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/aardgoose\/starred{\/owner}{\/repo}","site_admin":false,"login":"aardgoose","type":"User","id":17364910,"followers_url":"https:\/\/api.github.com\/users\/aardgoose\/followers","organizations_url":"https:\/\/api.github.com\/users\/aardgoose\/orgs"}},{"index":8,"author_association":"COLLABORATOR","body":"904 bytes per uuid(36chars)? That's surprising...","created_at":"2018-01-10T12:15:42.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-356585790","id":356585790,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1NjU4NTc5MA==","updated_at":"2018-01-10T12:19:14.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/356585790","user":{"following_url":"https:\/\/api.github.com\/users\/takahirox\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/takahirox\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/7637832?v=4","url":"https:\/\/api.github.com\/users\/takahirox","gists_url":"https:\/\/api.github.com\/users\/takahirox\/gists{\/gist_id}","html_url":"https:\/\/github.com\/takahirox","subscriptions_url":"https:\/\/api.github.com\/users\/takahirox\/subscriptions","node_id":"MDQ6VXNlcjc2Mzc4MzI=","repos_url":"https:\/\/api.github.com\/users\/takahirox\/repos","received_events_url":"https:\/\/api.github.com\/users\/takahirox\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/takahirox\/starred{\/owner}{\/repo}","site_admin":false,"login":"takahirox","type":"User","id":7637832,"followers_url":"https:\/\/api.github.com\/users\/takahirox\/followers","organizations_url":"https:\/\/api.github.com\/users\/takahirox\/orgs"}},{"index":9,"author_association":"COLLABORATOR","body":"`.toUpperCase()` technique seems very interesting.\r\n\r\nI evaluated memory consumption with the following code.\r\n\r\n    <html>\r\n    <head>\r\n    <\/head>\r\n    <body>\r\n    <script src=\"https:\/\/rawgit.com\/mrdoob\/three.js\/r89\/build\/three.js\"><\/script>\r\n    <script>\r\n    var num = 0x10000;\r\n\r\n    var array = Array( num );\r\n\r\n    for ( var i = 0; i < num; i ++ ) {\r\n\r\n        \/\/array[ i ] = THREE.Math.generateUUID().toUpperCase();\r\n        array[ i ] = THREE.Math.generateUUID();\r\n\r\n    }\r\n    <\/script>\r\n    <\/body>\r\n    <\/html>\r\n\r\n`600 Bytes` per uuid with `THREE.Math.generateUUID()` while `64 Bytes` per uuid with `THREE.Math.generateUUID().toUpperCase()` on my Windows10 + Chrome.\r\n\r\nThis tech reduces the uuid memory consumption 8x. `64 Bytes` per 36 chars sounds very reasonable.\r\n\r\n--------\r\n\r\ndetail:\r\n\r\n5.1MB for Three.js itself + Array on heap. (heap where I comment out the loop)\r\n42.6MB with `THREE.Math.generateUUID()` on heap, 600B (= (42.6MB - 5.1MB) \/ 0x10000) per uuid\r\n9.1MB with `THREE.Math.generateUUID().toUpperCase()` on heap, 64B (= (9.1MB - 5.1MB) \/ 0x10000) per uuid\r\n\r\n","created_at":"2018-01-10T13:29:59.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-356602348","id":356602348,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1NjYwMjM0OA==","updated_at":"2018-01-12T08:05:22.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/356602348","user":{"following_url":"https:\/\/api.github.com\/users\/takahirox\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/takahirox\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/7637832?v=4","url":"https:\/\/api.github.com\/users\/takahirox","gists_url":"https:\/\/api.github.com\/users\/takahirox\/gists{\/gist_id}","html_url":"https:\/\/github.com\/takahirox","subscriptions_url":"https:\/\/api.github.com\/users\/takahirox\/subscriptions","node_id":"MDQ6VXNlcjc2Mzc4MzI=","repos_url":"https:\/\/api.github.com\/users\/takahirox\/repos","received_events_url":"https:\/\/api.github.com\/users\/takahirox\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/takahirox\/starred{\/owner}{\/repo}","site_admin":false,"login":"takahirox","type":"User","id":7637832,"followers_url":"https:\/\/api.github.com\/users\/takahirox\/followers","organizations_url":"https:\/\/api.github.com\/users\/takahirox\/orgs"}},{"index":10,"author_association":"CONTRIBUTOR","body":"Hi, nice.\r\n\r\nI got 904 from looking at heap info and counting counting the shallow size allocations in the chain.  May have mis-counted (also Chrome  on Win10 ) Chrome 63 rather than bleeding edge, \r\n\r\nYou see similar effects though. 74 sounds OK, looking at heap dumps looks like there is a fixed overhead and then the final allocation is in multiples of fixed sized buckets ( multiples of 8) which 74 isn't but there is probably other overheads\/noise in the stats.\r\n\r\n\r\n\r\n ","created_at":"2018-01-10T13:51:23.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-356607664","id":356607664,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1NjYwNzY2NA==","updated_at":"2018-01-10T13:51:23.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/356607664","user":{"following_url":"https:\/\/api.github.com\/users\/aardgoose\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/aardgoose\/events{\/privacy}","avatar_url":"https:\/\/avatars1.githubusercontent.com\/u\/17364910?v=4","url":"https:\/\/api.github.com\/users\/aardgoose","gists_url":"https:\/\/api.github.com\/users\/aardgoose\/gists{\/gist_id}","html_url":"https:\/\/github.com\/aardgoose","subscriptions_url":"https:\/\/api.github.com\/users\/aardgoose\/subscriptions","node_id":"MDQ6VXNlcjE3MzY0OTEw","repos_url":"https:\/\/api.github.com\/users\/aardgoose\/repos","received_events_url":"https:\/\/api.github.com\/users\/aardgoose\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/aardgoose\/starred{\/owner}{\/repo}","site_admin":false,"login":"aardgoose","type":"User","id":17364910,"followers_url":"https:\/\/api.github.com\/users\/aardgoose\/followers","organizations_url":"https:\/\/api.github.com\/users\/aardgoose\/orgs"}},{"index":11,"author_association":"OWNER","body":"Hmm... I don't understand how `toUpperCase()` would make trigger less memory consumption. Do you see the same effect with Firefox?","created_at":"2018-01-10T20:20:53.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-356724527","id":356724527,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1NjcyNDUyNw==","updated_at":"2018-01-10T20:20:53.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/356724527","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}},{"index":12,"author_association":"CONTRIBUTOR","body":"I did see similar issues in firefox of similar size though I didn't dig as deep.\r\n\r\nthe original uuid strings are stored as a linked list arrangements of pointers to the original strings in the LUT rather than a new memory allocation for the complete string.  However the list arrangement structures take up a lot more space, as the string is build up in small segments there are about 12 of these linking objects.  The toUpperCase() code ensures that String() assumes the original string is being modifed so a new copy is created rather than another ref to the original string (that's my assumption anyway and the heap captures show this change in storage (concat strings show up as a separate class of objects).","created_at":"2018-01-10T21:42:24.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-356746257","id":356746257,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1Njc0NjI1Nw==","updated_at":"2018-01-11T11:31:17.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/356746257","user":{"following_url":"https:\/\/api.github.com\/users\/aardgoose\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/aardgoose\/events{\/privacy}","avatar_url":"https:\/\/avatars1.githubusercontent.com\/u\/17364910?v=4","url":"https:\/\/api.github.com\/users\/aardgoose","gists_url":"https:\/\/api.github.com\/users\/aardgoose\/gists{\/gist_id}","html_url":"https:\/\/github.com\/aardgoose","subscriptions_url":"https:\/\/api.github.com\/users\/aardgoose\/subscriptions","node_id":"MDQ6VXNlcjE3MzY0OTEw","repos_url":"https:\/\/api.github.com\/users\/aardgoose\/repos","received_events_url":"https:\/\/api.github.com\/users\/aardgoose\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/aardgoose\/starred{\/owner}{\/repo}","site_admin":false,"login":"aardgoose","type":"User","id":17364910,"followers_url":"https:\/\/api.github.com\/users\/aardgoose\/followers","organizations_url":"https:\/\/api.github.com\/users\/aardgoose\/orgs"}},{"index":13,"author_association":"COLLABORATOR","body":"As @aardgoose this's JavaScript strings memory layout topic.\r\n\r\nI'm not so familiar with that, but the following is my rough understanding.\r\n\r\nFor example, uuid \"D30D4BC2-4BAE-49FF-8A3F-3F9A4467A0FA\" layout in low-layer is represented as linked list, like\r\n\r\n    \/\/ more precisely, not the raw string but pointer to LUT element of generateUUID()?\r\n    'D3' -> '0D' -> '4B' -> ...\r\n\r\nbecause of `generateUUID()` logic, concatenating strings of LUT elements.\r\n\r\nhttps:\/\/github.com\/mrdoob\/three.js\/blob\/dev\/src\/math\/Math.js#L11\r\n\r\nAnd seems like `.toUpper\/LowerCase()` allocates new consecutive memory space \"D30D4BC2-4BAE-49FF-8A3F-3F9A4467A0FA\". Therefore, memory consumption will be reduced by removing overheads.\r\n\r\nEven if the two strings looks the same in the JS code layer, the memory layout can be different in low-layer. `.toUpper\/LowerCase()` tech optimizes it.\r\n\r\nI hope JS engine optimizes well and we won't need this hacky tech in the future.","created_at":"2018-01-11T11:47:11.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-356911384","id":356911384,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1NjkxMTM4NA==","updated_at":"2018-01-11T23:24:51.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/356911384","user":{"following_url":"https:\/\/api.github.com\/users\/takahirox\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/takahirox\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/7637832?v=4","url":"https:\/\/api.github.com\/users\/takahirox","gists_url":"https:\/\/api.github.com\/users\/takahirox\/gists{\/gist_id}","html_url":"https:\/\/github.com\/takahirox","subscriptions_url":"https:\/\/api.github.com\/users\/takahirox\/subscriptions","node_id":"MDQ6VXNlcjc2Mzc4MzI=","repos_url":"https:\/\/api.github.com\/users\/takahirox\/repos","received_events_url":"https:\/\/api.github.com\/users\/takahirox\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/takahirox\/starred{\/owner}{\/repo}","site_admin":false,"login":"takahirox","type":"User","id":7637832,"followers_url":"https:\/\/api.github.com\/users\/takahirox\/followers","organizations_url":"https:\/\/api.github.com\/users\/takahirox\/orgs"}},{"index":14,"author_association":"OWNER","body":"So a solution would be to remove the `toUpperCase()`?","created_at":"2018-01-11T17:13:13.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-356996350","id":356996350,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1Njk5NjM1MA==","updated_at":"2018-01-11T17:13:13.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/356996350","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}},{"index":15,"author_association":"CONTRIBUTOR","body":"@mrdoob I think they want one more toUpperCase on generateUUID return expression","created_at":"2018-01-11T18:27:43.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-357017864","id":357017864,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1NzAxNzg2NA==","updated_at":"2018-01-11T18:27:43.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/357017864","user":{"following_url":"https:\/\/api.github.com\/users\/makc\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/makc\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/242577?v=4","url":"https:\/\/api.github.com\/users\/makc","gists_url":"https:\/\/api.github.com\/users\/makc\/gists{\/gist_id}","html_url":"https:\/\/github.com\/makc","subscriptions_url":"https:\/\/api.github.com\/users\/makc\/subscriptions","node_id":"MDQ6VXNlcjI0MjU3Nw==","repos_url":"https:\/\/api.github.com\/users\/makc\/repos","received_events_url":"https:\/\/api.github.com\/users\/makc\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/makc\/starred{\/owner}{\/repo}","site_admin":false,"login":"makc","type":"User","id":242577,"followers_url":"https:\/\/api.github.com\/users\/makc\/followers","organizations_url":"https:\/\/api.github.com\/users\/makc\/orgs"}},{"index":16,"author_association":"OWNER","body":"Moving it then?","created_at":"2018-01-11T19:41:08.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-357038652","id":357038652,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1NzAzODY1Mg==","updated_at":"2018-01-11T19:41:08.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/357038652","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}},{"index":17,"author_association":"CONTRIBUTOR","body":"Yes, sorry if that wasn't clear,\r\n\r\nreturn String(   \\<uuid expression\\>  ).toUpperCase();\r\n\r\nYou can remove the toUpperCase() when setting up the lut, it doesn't change the end result, The conversion on the returned expression happens with it there or not.\r\n\r\nThe rather hacky nature is why I proposed the WeakMap solution as well, avoids the costs of uuid generation unless they are required, and removes the need for uuid's in a lot of situations all together. \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","created_at":"2018-01-11T19:45:59.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-357040025","id":357040025,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM1NzA0MDAyNQ==","updated_at":"2018-01-11T19:47:09.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/357040025","user":{"following_url":"https:\/\/api.github.com\/users\/aardgoose\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/aardgoose\/events{\/privacy}","avatar_url":"https:\/\/avatars1.githubusercontent.com\/u\/17364910?v=4","url":"https:\/\/api.github.com\/users\/aardgoose","gists_url":"https:\/\/api.github.com\/users\/aardgoose\/gists{\/gist_id}","html_url":"https:\/\/github.com\/aardgoose","subscriptions_url":"https:\/\/api.github.com\/users\/aardgoose\/subscriptions","node_id":"MDQ6VXNlcjE3MzY0OTEw","repos_url":"https:\/\/api.github.com\/users\/aardgoose\/repos","received_events_url":"https:\/\/api.github.com\/users\/aardgoose\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/aardgoose\/starred{\/owner}{\/repo}","site_admin":false,"login":"aardgoose","type":"User","id":17364910,"followers_url":"https:\/\/api.github.com\/users\/aardgoose\/followers","organizations_url":"https:\/\/api.github.com\/users\/aardgoose\/orgs"}},{"index":18,"author_association":"CONTRIBUTOR","body":"It might be worth mentioning that 16 bytes are required to represent UUID. It might also be of interest to note that new Uint8Array(16) would provide just that, without any necessity for resizing, reallocating or indeed, even string manipulation.","created_at":"2018-01-29T07:24:19.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-361160012","id":361160012,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM2MTE2MDAxMg==","updated_at":"2018-01-29T07:24:19.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/361160012","user":{"following_url":"https:\/\/api.github.com\/users\/Usnul\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/Usnul\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/5939063?v=4","url":"https:\/\/api.github.com\/users\/Usnul","gists_url":"https:\/\/api.github.com\/users\/Usnul\/gists{\/gist_id}","html_url":"https:\/\/github.com\/Usnul","subscriptions_url":"https:\/\/api.github.com\/users\/Usnul\/subscriptions","node_id":"MDQ6VXNlcjU5MzkwNjM=","repos_url":"https:\/\/api.github.com\/users\/Usnul\/repos","received_events_url":"https:\/\/api.github.com\/users\/Usnul\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/Usnul\/starred{\/owner}{\/repo}","site_admin":false,"login":"Usnul","type":"User","id":5939063,"followers_url":"https:\/\/api.github.com\/users\/Usnul\/followers","organizations_url":"https:\/\/api.github.com\/users\/Usnul\/orgs"}},{"index":19,"author_association":"CONTRIBUTOR","body":"@Usnul I tried that [here](https:\/\/github.com\/mrdoob\/three.js\/pull\/13094#issuecomment-357077546), it was 15 times slower.","created_at":"2018-01-29T12:05:37.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-361225614","id":361225614,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM2MTIyNTYxNA==","updated_at":"2018-01-29T12:05:37.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/361225614","user":{"following_url":"https:\/\/api.github.com\/users\/makc\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/makc\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/242577?v=4","url":"https:\/\/api.github.com\/users\/makc","gists_url":"https:\/\/api.github.com\/users\/makc\/gists{\/gist_id}","html_url":"https:\/\/github.com\/makc","subscriptions_url":"https:\/\/api.github.com\/users\/makc\/subscriptions","node_id":"MDQ6VXNlcjI0MjU3Nw==","repos_url":"https:\/\/api.github.com\/users\/makc\/repos","received_events_url":"https:\/\/api.github.com\/users\/makc\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/makc\/starred{\/owner}{\/repo}","site_admin":false,"login":"makc","type":"User","id":242577,"followers_url":"https:\/\/api.github.com\/users\/makc\/followers","organizations_url":"https:\/\/api.github.com\/users\/makc\/orgs"}},{"index":20,"author_association":"COLLABORATOR","body":"@mrdoob I think we should add this to the r91 milestone, we should quickly solve this issue.","created_at":"2018-02-21T20:12:36.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-367456188","id":367456188,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM2NzQ1NjE4OA==","updated_at":"2018-02-21T20:12:36.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/367456188","user":{"following_url":"https:\/\/api.github.com\/users\/takahirox\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/takahirox\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/7637832?v=4","url":"https:\/\/api.github.com\/users\/takahirox","gists_url":"https:\/\/api.github.com\/users\/takahirox\/gists{\/gist_id}","html_url":"https:\/\/github.com\/takahirox","subscriptions_url":"https:\/\/api.github.com\/users\/takahirox\/subscriptions","node_id":"MDQ6VXNlcjc2Mzc4MzI=","repos_url":"https:\/\/api.github.com\/users\/takahirox\/repos","received_events_url":"https:\/\/api.github.com\/users\/takahirox\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/takahirox\/starred{\/owner}{\/repo}","site_admin":false,"login":"takahirox","type":"User","id":7637832,"followers_url":"https:\/\/api.github.com\/users\/takahirox\/followers","organizations_url":"https:\/\/api.github.com\/users\/takahirox\/orgs"}},{"index":21,"author_association":"OWNER","body":"@takahirox I didn't think there was a solution...? Seemed like a V8 thing...?","created_at":"2018-02-21T22:30:35.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-367498955","id":367498955,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM2NzQ5ODk1NQ==","updated_at":"2018-02-21T22:30:35.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/367498955","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}},{"index":22,"author_association":"CONTRIBUTOR","body":"@makc I have a bit of a counter to what you have written:\r\nhttps:\/\/jsfiddle.net\/Travnik\/3guqr5va\/21\/\r\n\r\nnumbers:\r\ngenerateUUID: 347.219970703125ms <- base\r\ngenerateUUID2: 1697.90185546875ms <- your version\r\ngenerateUUID3: 158.04296875ms <- my version, using 16 byte array instead of your 36\r\n\r\nThe main problem is in materializing the string. Actual generation is pretty quick and compact.\r\n\r\n[update]\r\nfor purists, I added example without UUID object wrapper, just using Uint8Array:\r\ngenerateUUID4: 141.053955078125ms","created_at":"2018-02-21T23:10:04.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-367509849","id":367509849,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM2NzUwOTg0OQ==","updated_at":"2018-02-21T23:21:38.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/367509849","user":{"following_url":"https:\/\/api.github.com\/users\/Usnul\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/Usnul\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/5939063?v=4","url":"https:\/\/api.github.com\/users\/Usnul","gists_url":"https:\/\/api.github.com\/users\/Usnul\/gists{\/gist_id}","html_url":"https:\/\/github.com\/Usnul","subscriptions_url":"https:\/\/api.github.com\/users\/Usnul\/subscriptions","node_id":"MDQ6VXNlcjU5MzkwNjM=","repos_url":"https:\/\/api.github.com\/users\/Usnul\/repos","received_events_url":"https:\/\/api.github.com\/users\/Usnul\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/Usnul\/starred{\/owner}{\/repo}","site_admin":false,"login":"Usnul","type":"User","id":5939063,"followers_url":"https:\/\/api.github.com\/users\/Usnul\/followers","organizations_url":"https:\/\/api.github.com\/users\/Usnul\/orgs"}},{"index":23,"author_association":"COLLABORATOR","body":"@mrdoob Probably no *perfect* solution but there may be better situation. I'm gonna follow up the discussion and try some ideas soon. In my mind, there're two options now. Using \"Number tech\" mentioned in #13094 or reverting generateUUID. (#13077 would also work?)\r\n\r\nIMO huge memory consumption can lead slow performance, we should fix.","created_at":"2018-02-21T23:31:36.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-367514593","id":367514593,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM2NzUxNDU5Mw==","updated_at":"2018-02-21T23:33:47.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/367514593","user":{"following_url":"https:\/\/api.github.com\/users\/takahirox\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/takahirox\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/7637832?v=4","url":"https:\/\/api.github.com\/users\/takahirox","gists_url":"https:\/\/api.github.com\/users\/takahirox\/gists{\/gist_id}","html_url":"https:\/\/github.com\/takahirox","subscriptions_url":"https:\/\/api.github.com\/users\/takahirox\/subscriptions","node_id":"MDQ6VXNlcjc2Mzc4MzI=","repos_url":"https:\/\/api.github.com\/users\/takahirox\/repos","received_events_url":"https:\/\/api.github.com\/users\/takahirox\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/takahirox\/starred{\/owner}{\/repo}","site_admin":false,"login":"takahirox","type":"User","id":7637832,"followers_url":"https:\/\/api.github.com\/users\/takahirox\/followers","organizations_url":"https:\/\/api.github.com\/users\/takahirox\/orgs"}},{"index":24,"author_association":"CONTRIBUTOR","body":"@Usnul nice try, however your UUID3's toString() is again a bunch of strings +ed together. This whole issue exists because doing so wastes lots of memory.","created_at":"2018-02-22T13:16:38.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-367677410","id":367677410,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM2NzY3NzQxMA==","updated_at":"2018-02-22T13:16:38.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/367677410","user":{"following_url":"https:\/\/api.github.com\/users\/makc\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/makc\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/242577?v=4","url":"https:\/\/api.github.com\/users\/makc","gists_url":"https:\/\/api.github.com\/users\/makc\/gists{\/gist_id}","html_url":"https:\/\/github.com\/makc","subscriptions_url":"https:\/\/api.github.com\/users\/makc\/subscriptions","node_id":"MDQ6VXNlcjI0MjU3Nw==","repos_url":"https:\/\/api.github.com\/users\/makc\/repos","received_events_url":"https:\/\/api.github.com\/users\/makc\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/makc\/starred{\/owner}{\/repo}","site_admin":false,"login":"makc","type":"User","id":242577,"followers_url":"https:\/\/api.github.com\/users\/makc\/followers","organizations_url":"https:\/\/api.github.com\/users\/makc\/orgs"}},{"index":25,"author_association":"CONTRIBUTOR","body":"@makc \r\nI didn't make myself clear.\r\n\r\nThere are 2 things I propose which are separate which I believe this solution achieves:\r\n - use minimal amount of memory to *represent* UUID\r\n - avoid materializing strings, as that is not relevant for the purposes of UUID, except maybe debug and serialization.","created_at":"2018-02-22T14:19:16.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-367694508","id":367694508,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM2NzY5NDUwOA==","updated_at":"2018-02-22T14:19:16.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/367694508","user":{"following_url":"https:\/\/api.github.com\/users\/Usnul\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/Usnul\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/5939063?v=4","url":"https:\/\/api.github.com\/users\/Usnul","gists_url":"https:\/\/api.github.com\/users\/Usnul\/gists{\/gist_id}","html_url":"https:\/\/github.com\/Usnul","subscriptions_url":"https:\/\/api.github.com\/users\/Usnul\/subscriptions","node_id":"MDQ6VXNlcjU5MzkwNjM=","repos_url":"https:\/\/api.github.com\/users\/Usnul\/repos","received_events_url":"https:\/\/api.github.com\/users\/Usnul\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/Usnul\/starred{\/owner}{\/repo}","site_admin":false,"login":"Usnul","type":"User","id":5939063,"followers_url":"https:\/\/api.github.com\/users\/Usnul\/followers","organizations_url":"https:\/\/api.github.com\/users\/Usnul\/orgs"}},{"index":26,"author_association":"CONTRIBUTOR","body":"ah well, of course, if you modify 3js to never call toString unless actually needed (as in during the serialization), this issue will go away","created_at":"2018-02-22T15:44:14.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-367722108","id":367722108,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM2NzcyMjEwOA==","updated_at":"2018-02-22T15:44:14.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/367722108","user":{"following_url":"https:\/\/api.github.com\/users\/makc\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/makc\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/242577?v=4","url":"https:\/\/api.github.com\/users\/makc","gists_url":"https:\/\/api.github.com\/users\/makc\/gists{\/gist_id}","html_url":"https:\/\/github.com\/makc","subscriptions_url":"https:\/\/api.github.com\/users\/makc\/subscriptions","node_id":"MDQ6VXNlcjI0MjU3Nw==","repos_url":"https:\/\/api.github.com\/users\/makc\/repos","received_events_url":"https:\/\/api.github.com\/users\/makc\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/makc\/starred{\/owner}{\/repo}","site_admin":false,"login":"makc","type":"User","id":242577,"followers_url":"https:\/\/api.github.com\/users\/makc\/followers","organizations_url":"https:\/\/api.github.com\/users\/makc\/orgs"}},{"index":27,"author_association":"CONTRIBUTOR","body":"There is a pending PR #13102 that removes the need for UUID in the core rendering process and is faster on Chrome and FF. \r\n\r\nI observed the heap bloat in FF as well as Chrome\/V8, I didn't check for Edge.\r\n\r\nI think UUIDs could then be removed from BufferAttributes after this change which would give a significant saving in UUID memory when a lot of geometries are in use. (Unless UUIDs for BufferAttributes are used in any of the export formats, but I don't believe they are).  Also UUID's could be removed from WebGLRenderTarget, but obviously not a big win.\r\n\r\nI posted a previous PR that used lazy UUID generation which could apply on top of this (the current implementation would require a simple polyfill for IE).  The lazy approach moves the cost of UUID creation to when UUID's are used so export operations will be slightly slower.\r\n\r\n\r\n\r\n\r\n","created_at":"2018-02-22T16:11:40.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-367731548","id":367731548,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM2NzczMTU0OA==","updated_at":"2018-02-22T16:11:40.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/367731548","user":{"following_url":"https:\/\/api.github.com\/users\/aardgoose\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/aardgoose\/events{\/privacy}","avatar_url":"https:\/\/avatars1.githubusercontent.com\/u\/17364910?v=4","url":"https:\/\/api.github.com\/users\/aardgoose","gists_url":"https:\/\/api.github.com\/users\/aardgoose\/gists{\/gist_id}","html_url":"https:\/\/github.com\/aardgoose","subscriptions_url":"https:\/\/api.github.com\/users\/aardgoose\/subscriptions","node_id":"MDQ6VXNlcjE3MzY0OTEw","repos_url":"https:\/\/api.github.com\/users\/aardgoose\/repos","received_events_url":"https:\/\/api.github.com\/users\/aardgoose\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/aardgoose\/starred{\/owner}{\/repo}","site_admin":false,"login":"aardgoose","type":"User","id":17364910,"followers_url":"https:\/\/api.github.com\/users\/aardgoose\/followers","organizations_url":"https:\/\/api.github.com\/users\/aardgoose\/orgs"}},{"index":28,"author_association":"COLLABORATOR","body":"I evaluated some flattening techniques mentioned in https:\/\/github.com\/davidmarkclements\/flatstr but they're as slow as `String.toUpperCase()`. `String.toUpperCase()` seems a bit faster than them. I speculate `String::Flatten` in JS engine isn't fast regardless how we trigger. Seems like we can't avoid tradeoff between performance and memory consumption.\r\n\r\nIn short term (r91, r92), we need to determine which one should take priority. Personally I prefer lower memory consumption because uuid generation performance affects only initialization while memory consumption has an impact all running time.\r\n\r\nIn long term, I agree with @aardgoose. I wanna encourage lazy UUID generation and uuid reference removal except for serialization.\r\n\r\n(In further longer term, we could expect JS engines optimization will improve.)","created_at":"2018-03-13T22:44:35.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-372844166","id":372844166,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM3Mjg0NDE2Ng==","updated_at":"2018-03-14T20:57:39.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/372844166","user":{"following_url":"https:\/\/api.github.com\/users\/takahirox\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/takahirox\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/7637832?v=4","url":"https:\/\/api.github.com\/users\/takahirox","gists_url":"https:\/\/api.github.com\/users\/takahirox\/gists{\/gist_id}","html_url":"https:\/\/github.com\/takahirox","subscriptions_url":"https:\/\/api.github.com\/users\/takahirox\/subscriptions","node_id":"MDQ6VXNlcjc2Mzc4MzI=","repos_url":"https:\/\/api.github.com\/users\/takahirox\/repos","received_events_url":"https:\/\/api.github.com\/users\/takahirox\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/takahirox\/starred{\/owner}{\/repo}","site_admin":false,"login":"takahirox","type":"User","id":7637832,"followers_url":"https:\/\/api.github.com\/users\/takahirox\/followers","organizations_url":"https:\/\/api.github.com\/users\/takahirox\/orgs"}},{"index":29,"author_association":"COLLABORATOR","body":"Micro benchmark performance numbers + memory consumption \/ uuid on my Windows. 1048576 times generation.\r\n\r\n| generateUUID | Chrome | FireFox Nightly | memory consumption (Chrome) |\r\n| ---- | ---- | ---- | ---- |\r\n| r87 | 1300ms | 800ms | 64B \/ uuid |\r\n| dev | 300ms | 400ms | 600B \/ uuid |\r\n| dev + .toUpperCase() | 600ms | 800ms | 64B \/ uuid |\r\n\r\nRefer to https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-356602348 for the memory consumption \/ uuid.","created_at":"2018-03-13T22:54:13.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/issues\/13069#issuecomment-372846187","id":372846187,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/13069","node_id":"MDEyOklzc3VlQ29tbWVudDM3Mjg0NjE4Nw==","updated_at":"2018-03-14T08:34:02.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/372846187","user":{"following_url":"https:\/\/api.github.com\/users\/takahirox\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/takahirox\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/7637832?v=4","url":"https:\/\/api.github.com\/users\/takahirox","gists_url":"https:\/\/api.github.com\/users\/takahirox\/gists{\/gist_id}","html_url":"https:\/\/github.com\/takahirox","subscriptions_url":"https:\/\/api.github.com\/users\/takahirox\/subscriptions","node_id":"MDQ6VXNlcjc2Mzc4MzI=","repos_url":"https:\/\/api.github.com\/users\/takahirox\/repos","received_events_url":"https:\/\/api.github.com\/users\/takahirox\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/takahirox\/starred{\/owner}{\/repo}","site_admin":false,"login":"takahirox","type":"User","id":7637832,"followers_url":"https:\/\/api.github.com\/users\/takahirox\/followers","organizations_url":"https:\/\/api.github.com\/users\/takahirox\/orgs"}}]}