{"schema": {"fields":[{"type":"integer","name":"index"},{"type":"string","name":"author_association"},{"type":"string","name":"body"},{"type":"datetime","name":"created_at"},{"type":"string","name":"html_url"},{"type":"integer","name":"id"},{"type":"string","name":"issue_url"},{"type":"string","name":"node_id"},{"type":"datetime","name":"updated_at"},{"type":"string","name":"url"},{"type":"string","name":"user"}],"pandas_version":"0.20.0","primaryKey":["index"]}, "data": [{"index":0,"author_association":"COLLABORATOR","body":"This has been discussed [previously](https:\/\/github.com\/mrdoob\/three.js\/pull\/7107#issuecomment-137994800).\r\n\r\nDisplacement mapping and morph targets? Is there a modeling tool that generates such models?","created_at":"2017-05-03T00:48:35.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-298800163","id":298800163,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5ODgwMDE2Mw==","updated_at":"2017-05-03T16:46:48.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/298800163","user":{"following_url":"https:\/\/api.github.com\/users\/WestLangley\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/WestLangley\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/1000017?v=4","url":"https:\/\/api.github.com\/users\/WestLangley","gists_url":"https:\/\/api.github.com\/users\/WestLangley\/gists{\/gist_id}","html_url":"https:\/\/github.com\/WestLangley","subscriptions_url":"https:\/\/api.github.com\/users\/WestLangley\/subscriptions","node_id":"MDQ6VXNlcjEwMDAwMTc=","repos_url":"https:\/\/api.github.com\/users\/WestLangley\/repos","received_events_url":"https:\/\/api.github.com\/users\/WestLangley\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/WestLangley\/starred{\/owner}{\/repo}","site_admin":false,"login":"WestLangley","type":"User","id":1000017,"followers_url":"https:\/\/api.github.com\/users\/WestLangley\/followers","organizations_url":"https:\/\/api.github.com\/users\/WestLangley\/orgs"}},{"index":1,"author_association":"CONTRIBUTOR","body":"@WestLangley \r\nI'm confused by what you're asking. As far as I understand it, displacement mapping and morph targets are entirely unrelated things and are compatible with one another.\r\n\r\nDisplacement mapping is typically used to add detail to an object, and it accomplishes the same thing as normal mapping or bump mapping, just by a different means. In regards to the previous pull request you linked, I agree with @bhouston that displacement maps usually share the same UV set with normal\/bump maps (thus sharing the offset\/repeat), since as he says, they're all varying degrees of sub-face surface detail.\r\n\r\nAs for a use case for displacement mapping and morph normals, here's a dumb example: Suppose you're modeling a highly detailed sheet of bubble wrap. You could represent the sheet as a smoothly flowing surface and add the details of the individual bubbles via a displacement map. Then you could animate the sheet to different positions by morphing.","created_at":"2017-05-03T03:58:06.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-298818372","id":298818372,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5ODgxODM3Mg==","updated_at":"2017-05-03T06:10:50.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/298818372","user":{"following_url":"https:\/\/api.github.com\/users\/jaxry\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/jaxry\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/4411068?v=4","url":"https:\/\/api.github.com\/users\/jaxry","gists_url":"https:\/\/api.github.com\/users\/jaxry\/gists{\/gist_id}","html_url":"https:\/\/github.com\/jaxry","subscriptions_url":"https:\/\/api.github.com\/users\/jaxry\/subscriptions","node_id":"MDQ6VXNlcjQ0MTEwNjg=","repos_url":"https:\/\/api.github.com\/users\/jaxry\/repos","received_events_url":"https:\/\/api.github.com\/users\/jaxry\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/jaxry\/starred{\/owner}{\/repo}","site_admin":false,"login":"jaxry","type":"User","id":4411068,"followers_url":"https:\/\/api.github.com\/users\/jaxry\/followers","organizations_url":"https:\/\/api.github.com\/users\/jaxry\/orgs"}},{"index":2,"author_association":"CONTRIBUTOR","body":"The main issues with displacement mapping in WebGL is that WebGL doesn't support tessellation shaders, thus you can only deform the original vertex positions, thus any details in the displacement map that are between vertices are not represented.  It greatly limits the usefulness of displacement maps in Three.JS.\r\n\r\nDetails: https:\/\/www.khronos.org\/opengl\/wiki\/Tessellation","created_at":"2017-05-03T13:45:45.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-298915128","id":298915128,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5ODkxNTEyOA==","updated_at":"2017-05-03T13:45:45.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/298915128","user":{"following_url":"https:\/\/api.github.com\/users\/bhouston\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/bhouston\/events{\/privacy}","avatar_url":"https:\/\/avatars3.githubusercontent.com\/u\/588541?v=4","url":"https:\/\/api.github.com\/users\/bhouston","gists_url":"https:\/\/api.github.com\/users\/bhouston\/gists{\/gist_id}","html_url":"https:\/\/github.com\/bhouston","subscriptions_url":"https:\/\/api.github.com\/users\/bhouston\/subscriptions","node_id":"MDQ6VXNlcjU4ODU0MQ==","repos_url":"https:\/\/api.github.com\/users\/bhouston\/repos","received_events_url":"https:\/\/api.github.com\/users\/bhouston\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/bhouston\/starred{\/owner}{\/repo}","site_admin":false,"login":"bhouston","type":"User","id":588541,"followers_url":"https:\/\/api.github.com\/users\/bhouston\/followers","organizations_url":"https:\/\/api.github.com\/users\/bhouston\/orgs"}},{"index":3,"author_association":"COLLABORATOR","body":"\r\n@jaxry wrote\r\n\r\n>Currently displacement mapping uses the pre-transformed normal attribute to calculate the displacement vector. If morph normals are enabled, then the actual surface normal points in a different direction than the normal attribute, meaning the surface is displaced in the wrong direction.\r\n\r\nYou appear to be making the assumption that morphs would precede displacement. Maybe so. That is the order that makes the most sense to me, too.\r\n\r\nI have not seen a use case in which morph targets and displacement maps (or skeletal animation and displacement maps) were used concurrently. This is why I asked my question above.\r\n\r\nCan you identify a modeling tool that does this?\r\n\r\nIf you cannot, my assumption would remain that they are not used together, so the order of include files is irrelevant.\r\n\r\nRegardless, the order we apply operations must be consistent with that of the modeling software.","created_at":"2017-05-03T17:01:25.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-298972474","id":298972474,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5ODk3MjQ3NA==","updated_at":"2017-05-03T17:01:25.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/298972474","user":{"following_url":"https:\/\/api.github.com\/users\/WestLangley\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/WestLangley\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/1000017?v=4","url":"https:\/\/api.github.com\/users\/WestLangley","gists_url":"https:\/\/api.github.com\/users\/WestLangley\/gists{\/gist_id}","html_url":"https:\/\/github.com\/WestLangley","subscriptions_url":"https:\/\/api.github.com\/users\/WestLangley\/subscriptions","node_id":"MDQ6VXNlcjEwMDAwMTc=","repos_url":"https:\/\/api.github.com\/users\/WestLangley\/repos","received_events_url":"https:\/\/api.github.com\/users\/WestLangley\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/WestLangley\/starred{\/owner}{\/repo}","site_admin":false,"login":"WestLangley","type":"User","id":1000017,"followers_url":"https:\/\/api.github.com\/users\/WestLangley\/followers","organizations_url":"https:\/\/api.github.com\/users\/WestLangley\/orgs"}},{"index":4,"author_association":"CONTRIBUTOR","body":"> I have not seen a use case in which morph targets and displacement maps (or skeletal animation and displacement maps) were used concurrently. This is why I asked my question above.\r\n\r\nDisplacement maps are part of high-end game characters in CryEngine and I believe UE4.  Here is an old NVIDIA demo combining tessellation, skinning and displacement maps: https:\/\/www.youtube.com\/watch?v=1c_PVtMIz-A    But again it doens't work well in WebGL because we are restricted to displacing non-tessellated geometry.","created_at":"2017-05-03T17:17:18.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-298976637","id":298976637,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5ODk3NjYzNw==","updated_at":"2017-05-03T17:17:18.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/298976637","user":{"following_url":"https:\/\/api.github.com\/users\/bhouston\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/bhouston\/events{\/privacy}","avatar_url":"https:\/\/avatars3.githubusercontent.com\/u\/588541?v=4","url":"https:\/\/api.github.com\/users\/bhouston","gists_url":"https:\/\/api.github.com\/users\/bhouston\/gists{\/gist_id}","html_url":"https:\/\/github.com\/bhouston","subscriptions_url":"https:\/\/api.github.com\/users\/bhouston\/subscriptions","node_id":"MDQ6VXNlcjU4ODU0MQ==","repos_url":"https:\/\/api.github.com\/users\/bhouston\/repos","received_events_url":"https:\/\/api.github.com\/users\/bhouston\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/bhouston\/starred{\/owner}{\/repo}","site_admin":false,"login":"bhouston","type":"User","id":588541,"followers_url":"https:\/\/api.github.com\/users\/bhouston\/followers","organizations_url":"https:\/\/api.github.com\/users\/bhouston\/orgs"}},{"index":5,"author_association":"CONTRIBUTOR","body":"@bhouston  wrote\r\n>But again it doens't work well in WebGL because we are restricted to displacing non-tessellated geometry.\r\n\r\nI agree, however that doesn't make displacement mapping totally worthless. If you're working with a very fine mesh, then displacement mapping is a viable way to add extra detail to an object. That happens to be my use case for example. \r\n\r\n@WestLangley \r\nI'm writing an implicit surface plotter that uses a mesh detailed with [PBR textures](https:\/\/www.textures.com\/download\/substance0043\/127911) including albedo, normals,  and displacement. I'm also making use of morphing to animate between surfaces, so to suggest displacement mapping and morphing don't go together sounds absurd to me. \r\n[A clip of displacement maps and morphing in action.](https:\/\/my.mixtape.moe\/avsnja.mp4)\r\n>Can you identify a modeling tool that does this?\r\n\r\nBlender. You can apply a displacement modifier to a surface and morph it via shape keys concurrently.\r\n\r\nAs for when displacement mapping should be applied, here's what I know:\r\n* Displacement mapping via a heightfield is most often done along a surface's normal. This is how every source I've studied defines it. Morphing doesn't change that. A intermediate surface created via morphing is still a surface, and displacement should still take place along the surface normal, exactly how it's done with normal maps.\r\n* Because morphing only [translates position vectors](https:\/\/github.com\/mrdoob\/three.js\/blob\/r85\/src\/renderers\/shaders\/ShaderChunk\/morphtarget_vertex.glsl), displacement mapping can be applied before or after morphing for the same exact results.\r\n* If bones simply rotate or translate position vectors (which is usually the case), then displacement mapping can also be applied either before or after for the same exact results. The exception is if the bones scale vertices. If positions are scaled, then we have to decide whether displacing should take place before or after the scaling.\r\n\r\nI don't have much experience with any modeling programs in particular. Would anyone be willing to check how a modeling tool handles the scale of displacement maps when the bones are scaled differently relative to one another?","created_at":"2017-05-04T05:46:36.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-299101257","id":299101257,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5OTEwMTI1Nw==","updated_at":"2017-05-04T09:38:29.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/299101257","user":{"following_url":"https:\/\/api.github.com\/users\/jaxry\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/jaxry\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/4411068?v=4","url":"https:\/\/api.github.com\/users\/jaxry","gists_url":"https:\/\/api.github.com\/users\/jaxry\/gists{\/gist_id}","html_url":"https:\/\/github.com\/jaxry","subscriptions_url":"https:\/\/api.github.com\/users\/jaxry\/subscriptions","node_id":"MDQ6VXNlcjQ0MTEwNjg=","repos_url":"https:\/\/api.github.com\/users\/jaxry\/repos","received_events_url":"https:\/\/api.github.com\/users\/jaxry\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/jaxry\/starred{\/owner}{\/repo}","site_admin":false,"login":"jaxry","type":"User","id":4411068,"followers_url":"https:\/\/api.github.com\/users\/jaxry\/followers","organizations_url":"https:\/\/api.github.com\/users\/jaxry\/orgs"}},{"index":6,"author_association":"CONTRIBUTOR","body":"I redesigned the code to make as few assumptions as possible. Displacement once again takes place before morphing and skinning. If morph normals are provided, displace in the direction of the morph normals. Otherwise displace in the direction of the pre-morphed normal. Does the code look okay?\r\n\r\nFrom my tests, I can verify that displacement looks correct with both skinning and morphing, and the displacement direction always appears to be perpendicular to the surface.\r\n\r\nShould I also revert the changes made to skinning?\r\n\r\n","created_at":"2017-05-04T22:59:28.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-299332207","id":299332207,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5OTMzMjIwNw==","updated_at":"2017-05-04T23:00:58.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/299332207","user":{"following_url":"https:\/\/api.github.com\/users\/jaxry\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/jaxry\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/4411068?v=4","url":"https:\/\/api.github.com\/users\/jaxry","gists_url":"https:\/\/api.github.com\/users\/jaxry\/gists{\/gist_id}","html_url":"https:\/\/github.com\/jaxry","subscriptions_url":"https:\/\/api.github.com\/users\/jaxry\/subscriptions","node_id":"MDQ6VXNlcjQ0MTEwNjg=","repos_url":"https:\/\/api.github.com\/users\/jaxry\/repos","received_events_url":"https:\/\/api.github.com\/users\/jaxry\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/jaxry\/starred{\/owner}{\/repo}","site_admin":false,"login":"jaxry","type":"User","id":4411068,"followers_url":"https:\/\/api.github.com\/users\/jaxry\/followers","organizations_url":"https:\/\/api.github.com\/users\/jaxry\/orgs"}},{"index":7,"author_association":"COLLABORATOR","body":"I would recommend the following for now. See how you feel about it. I know this is somewhat subjective.\r\n\r\ndefaultnormal_vertex.glsl\r\n```glsl\r\nvec3 transformedNormal = normalMatrix * objectNormal;\r\n\r\n#ifdef FLIP_SIDED\r\n\r\n\ttransformedNormal = - transformedNormal;\r\n\r\n#endif\r\n```\r\ndisplacementmap_vertex.glsl\r\n```glsl\r\ntransformed += objectNormal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\r\n```\r\nmorphnormal_vertex.glsl - do not change\r\nproject_vertex.glsl - your change is OK\r\nskinning_vertex.glsl - your change is OK\r\nworldpos_vertex.glsl - your change is OK\r\ndepth_vert.glsl - do not change\r\nmeshphong_vert.glsl - do not change\r\nmeshphysical_vert.glsl - do not change\r\nnormal_vert.glsl - do not change","created_at":"2017-05-04T23:47:00.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-299339242","id":299339242,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5OTMzOTI0Mg==","updated_at":"2017-05-04T23:47:00.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/299339242","user":{"following_url":"https:\/\/api.github.com\/users\/WestLangley\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/WestLangley\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/1000017?v=4","url":"https:\/\/api.github.com\/users\/WestLangley","gists_url":"https:\/\/api.github.com\/users\/WestLangley\/gists{\/gist_id}","html_url":"https:\/\/github.com\/WestLangley","subscriptions_url":"https:\/\/api.github.com\/users\/WestLangley\/subscriptions","node_id":"MDQ6VXNlcjEwMDAwMTc=","repos_url":"https:\/\/api.github.com\/users\/WestLangley\/repos","received_events_url":"https:\/\/api.github.com\/users\/WestLangley\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/WestLangley\/starred{\/owner}{\/repo}","site_admin":false,"login":"WestLangley","type":"User","id":1000017,"followers_url":"https:\/\/api.github.com\/users\/WestLangley\/followers","organizations_url":"https:\/\/api.github.com\/users\/WestLangley\/orgs"}},{"index":8,"author_association":"CONTRIBUTOR","body":"Unfortunately, `objectNormal` is a skin transformed normal so it won't work for displacement mapping if we do it before skinning. That's why I was forced to create an intermediate `morphNormal` vector. I agree the added complexity doesn't look nice, but is there another way to do it?","created_at":"2017-05-05T00:24:20.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-299344271","id":299344271,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5OTM0NDI3MQ==","updated_at":"2017-05-05T00:24:20.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/299344271","user":{"following_url":"https:\/\/api.github.com\/users\/jaxry\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/jaxry\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/4411068?v=4","url":"https:\/\/api.github.com\/users\/jaxry","gists_url":"https:\/\/api.github.com\/users\/jaxry\/gists{\/gist_id}","html_url":"https:\/\/github.com\/jaxry","subscriptions_url":"https:\/\/api.github.com\/users\/jaxry\/subscriptions","node_id":"MDQ6VXNlcjQ0MTEwNjg=","repos_url":"https:\/\/api.github.com\/users\/jaxry\/repos","received_events_url":"https:\/\/api.github.com\/users\/jaxry\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/jaxry\/starred{\/owner}{\/repo}","site_admin":false,"login":"jaxry","type":"User","id":4411068,"followers_url":"https:\/\/api.github.com\/users\/jaxry\/followers","organizations_url":"https:\/\/api.github.com\/users\/jaxry\/orgs"}},{"index":9,"author_association":"COLLABORATOR","body":"So are we concluding that `objectNormal` is OK to use for displacement if displacement is applied last? The exception would be if morph normals are not specified?\r\n\r\nVery nice demo, BTW. :)","created_at":"2017-05-05T00:42:23.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-299346133","id":299346133,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5OTM0NjEzMw==","updated_at":"2017-05-05T00:42:23.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/299346133","user":{"following_url":"https:\/\/api.github.com\/users\/WestLangley\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/WestLangley\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/1000017?v=4","url":"https:\/\/api.github.com\/users\/WestLangley","gists_url":"https:\/\/api.github.com\/users\/WestLangley\/gists{\/gist_id}","html_url":"https:\/\/github.com\/WestLangley","subscriptions_url":"https:\/\/api.github.com\/users\/WestLangley\/subscriptions","node_id":"MDQ6VXNlcjEwMDAwMTc=","repos_url":"https:\/\/api.github.com\/users\/WestLangley\/repos","received_events_url":"https:\/\/api.github.com\/users\/WestLangley\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/WestLangley\/starred{\/owner}{\/repo}","site_admin":false,"login":"WestLangley","type":"User","id":1000017,"followers_url":"https:\/\/api.github.com\/users\/WestLangley\/followers","organizations_url":"https:\/\/api.github.com\/users\/WestLangley\/orgs"}},{"index":10,"author_association":"CONTRIBUTOR","body":">So are we concluding that objectNormal is OK to use for displacement if displacement is applied last? \r\n\r\nYes. \r\n\r\n>The exception would be if morph normals are not specified?\r\n\r\nNo. Displacement applied last will still work as intended if morph normals are not specified. `objectNormal` will simply be the normal attribute transformed by bones in that case.\r\n\r\nBut it's important to note that using `objectNormal` last has a slightly different effect than using `morphNormal` first. Specifically, if displacement is done before skinning, then any scaling of positions done by the bones will also scale the displacement. That's how three.js currently does it and I don't think we should change that without a good reason.","created_at":"2017-05-05T01:01:18.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-299348096","id":299348096,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5OTM0ODA5Ng==","updated_at":"2017-05-05T01:01:18.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/299348096","user":{"following_url":"https:\/\/api.github.com\/users\/jaxry\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/jaxry\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/4411068?v=4","url":"https:\/\/api.github.com\/users\/jaxry","gists_url":"https:\/\/api.github.com\/users\/jaxry\/gists{\/gist_id}","html_url":"https:\/\/github.com\/jaxry","subscriptions_url":"https:\/\/api.github.com\/users\/jaxry\/subscriptions","node_id":"MDQ6VXNlcjQ0MTEwNjg=","repos_url":"https:\/\/api.github.com\/users\/jaxry\/repos","received_events_url":"https:\/\/api.github.com\/users\/jaxry\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/jaxry\/starred{\/owner}{\/repo}","site_admin":false,"login":"jaxry","type":"User","id":4411068,"followers_url":"https:\/\/api.github.com\/users\/jaxry\/followers","organizations_url":"https:\/\/api.github.com\/users\/jaxry\/orgs"}},{"index":11,"author_association":"COLLABORATOR","body":"Well then, let's see how it looks with displacement last. Sorry for the back-and-forth.","created_at":"2017-05-05T01:36:03.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-299351720","id":299351720,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5OTM1MTcyMA==","updated_at":"2017-05-05T01:36:03.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/299351720","user":{"following_url":"https:\/\/api.github.com\/users\/WestLangley\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/WestLangley\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/1000017?v=4","url":"https:\/\/api.github.com\/users\/WestLangley","gists_url":"https:\/\/api.github.com\/users\/WestLangley\/gists{\/gist_id}","html_url":"https:\/\/github.com\/WestLangley","subscriptions_url":"https:\/\/api.github.com\/users\/WestLangley\/subscriptions","node_id":"MDQ6VXNlcjEwMDAwMTc=","repos_url":"https:\/\/api.github.com\/users\/WestLangley\/repos","received_events_url":"https:\/\/api.github.com\/users\/WestLangley\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/WestLangley\/starred{\/owner}{\/repo}","site_admin":false,"login":"WestLangley","type":"User","id":1000017,"followers_url":"https:\/\/api.github.com\/users\/WestLangley\/followers","organizations_url":"https:\/\/api.github.com\/users\/WestLangley\/orgs"}},{"index":12,"author_association":"CONTRIBUTOR","body":"I already implemented displacement last with the original commit. Are you asking me to revert the most recent changes back to what we had before?\r\n\r\nEither order works so it's up to you at this point. I'm testing the code with a [mesh](https:\/\/my.mixtape.moe\/uwpxds.mp4) that combines displacement, skinning, and morphing. Aside from the scaling caveat I mentioned, the results are identical. \r\n\r\nBy the way, thanks a lot for being so patient and working through this with me. Who knew this small change would have been such a big can of worms.","created_at":"2017-05-05T08:32:46.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-299410881","id":299410881,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5OTQxMDg4MQ==","updated_at":"2017-05-05T09:29:50.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/299410881","user":{"following_url":"https:\/\/api.github.com\/users\/jaxry\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/jaxry\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/4411068?v=4","url":"https:\/\/api.github.com\/users\/jaxry","gists_url":"https:\/\/api.github.com\/users\/jaxry\/gists{\/gist_id}","html_url":"https:\/\/github.com\/jaxry","subscriptions_url":"https:\/\/api.github.com\/users\/jaxry\/subscriptions","node_id":"MDQ6VXNlcjQ0MTEwNjg=","repos_url":"https:\/\/api.github.com\/users\/jaxry\/repos","received_events_url":"https:\/\/api.github.com\/users\/jaxry\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/jaxry\/starred{\/owner}{\/repo}","site_admin":false,"login":"jaxry","type":"User","id":4411068,"followers_url":"https:\/\/api.github.com\/users\/jaxry\/followers","organizations_url":"https:\/\/api.github.com\/users\/jaxry\/orgs"}},{"index":13,"author_association":"COLLABORATOR","body":">I already implemented displacement last with the original commit.\r\n\r\nI know. Sorry...\r\n\r\n>Unfortunately, objectNormal is a skin transformed normal so it won't work for displacement mapping if we do it before skinning.\r\n\r\nThat means that displacement is best if performed last. Do you agree? (I am hoping so, because it is the only order that made sense to me from the beginning. I just was not sure if that order was correct if all three methods are used simultaneously -- or if they ever would be used simultaneously.)\r\n\r\nAlso, if displacement is last, then proper normals must be used for displacement. So if a user uses both morphs and displacements, then a failure to specify correct morph normals is a user error.\r\n\r\n> Thanks a lot for being so patient and working through this with me.\r\n\r\nditto. :)","created_at":"2017-05-05T18:19:16.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-299538558","id":299538558,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5OTUzODU1OA==","updated_at":"2017-05-05T18:19:16.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/299538558","user":{"following_url":"https:\/\/api.github.com\/users\/WestLangley\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/WestLangley\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/1000017?v=4","url":"https:\/\/api.github.com\/users\/WestLangley","gists_url":"https:\/\/api.github.com\/users\/WestLangley\/gists{\/gist_id}","html_url":"https:\/\/github.com\/WestLangley","subscriptions_url":"https:\/\/api.github.com\/users\/WestLangley\/subscriptions","node_id":"MDQ6VXNlcjEwMDAwMTc=","repos_url":"https:\/\/api.github.com\/users\/WestLangley\/repos","received_events_url":"https:\/\/api.github.com\/users\/WestLangley\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/WestLangley\/starred{\/owner}{\/repo}","site_admin":false,"login":"WestLangley","type":"User","id":1000017,"followers_url":"https:\/\/api.github.com\/users\/WestLangley\/followers","organizations_url":"https:\/\/api.github.com\/users\/WestLangley\/orgs"}},{"index":14,"author_association":"CONTRIBUTOR","body":"I am confused, I always thought that displacement is sort of the very last thing in the vertex deformation pipeline -- after skinning, after morphing.","created_at":"2017-05-05T19:33:37.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-299556064","id":299556064,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5OTU1NjA2NA==","updated_at":"2017-05-05T19:33:37.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/299556064","user":{"following_url":"https:\/\/api.github.com\/users\/bhouston\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/bhouston\/events{\/privacy}","avatar_url":"https:\/\/avatars3.githubusercontent.com\/u\/588541?v=4","url":"https:\/\/api.github.com\/users\/bhouston","gists_url":"https:\/\/api.github.com\/users\/bhouston\/gists{\/gist_id}","html_url":"https:\/\/github.com\/bhouston","subscriptions_url":"https:\/\/api.github.com\/users\/bhouston\/subscriptions","node_id":"MDQ6VXNlcjU4ODU0MQ==","repos_url":"https:\/\/api.github.com\/users\/bhouston\/repos","received_events_url":"https:\/\/api.github.com\/users\/bhouston\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/bhouston\/starred{\/owner}{\/repo}","site_admin":false,"login":"bhouston","type":"User","id":588541,"followers_url":"https:\/\/api.github.com\/users\/bhouston\/followers","organizations_url":"https:\/\/api.github.com\/users\/bhouston\/orgs"}},{"index":15,"author_association":"CONTRIBUTOR","body":"The order should be based on the degree of transformation - largest first to smallest.  Skinning is the largest scale transformation, then morphing (which if used with skinning should be minor, like facial expressions) and then displacement. \r\n I believe that is the correct order and how everyone else does it.","created_at":"2017-05-05T19:35:30.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-299556457","id":299556457,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5OTU1NjQ1Nw==","updated_at":"2017-05-05T19:35:30.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/299556457","user":{"following_url":"https:\/\/api.github.com\/users\/bhouston\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/bhouston\/events{\/privacy}","avatar_url":"https:\/\/avatars3.githubusercontent.com\/u\/588541?v=4","url":"https:\/\/api.github.com\/users\/bhouston","gists_url":"https:\/\/api.github.com\/users\/bhouston\/gists{\/gist_id}","html_url":"https:\/\/github.com\/bhouston","subscriptions_url":"https:\/\/api.github.com\/users\/bhouston\/subscriptions","node_id":"MDQ6VXNlcjU4ODU0MQ==","repos_url":"https:\/\/api.github.com\/users\/bhouston\/repos","received_events_url":"https:\/\/api.github.com\/users\/bhouston\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/bhouston\/starred{\/owner}{\/repo}","site_admin":false,"login":"bhouston","type":"User","id":588541,"followers_url":"https:\/\/api.github.com\/users\/bhouston\/followers","organizations_url":"https:\/\/api.github.com\/users\/bhouston\/orgs"}},{"index":16,"author_association":"COLLABORATOR","body":"@bhouston \r\n\r\n(1) You are correct. Displacements last is best. The confusion here was we were trying to get the order right for all possible combinations. The combination that is problematic is if displacements and morph targets are specified, but morph normals are not. I think the consensus is to put displacements last and consider the problematic case a user error. Sorry for all the confusion here. I am glad this PR was filed, however.\r\n\r\n(2) Right now, we have morphing before skinning. We could switch those in a separate PR.","created_at":"2017-05-05T19:45:02.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-299558474","id":299558474,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5OTU1ODQ3NA==","updated_at":"2017-05-05T19:46:51.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/299558474","user":{"following_url":"https:\/\/api.github.com\/users\/WestLangley\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/WestLangley\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/1000017?v=4","url":"https:\/\/api.github.com\/users\/WestLangley","gists_url":"https:\/\/api.github.com\/users\/WestLangley\/gists{\/gist_id}","html_url":"https:\/\/github.com\/WestLangley","subscriptions_url":"https:\/\/api.github.com\/users\/WestLangley\/subscriptions","node_id":"MDQ6VXNlcjEwMDAwMTc=","repos_url":"https:\/\/api.github.com\/users\/WestLangley\/repos","received_events_url":"https:\/\/api.github.com\/users\/WestLangley\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/WestLangley\/starred{\/owner}{\/repo}","site_admin":false,"login":"WestLangley","type":"User","id":1000017,"followers_url":"https:\/\/api.github.com\/users\/WestLangley\/followers","organizations_url":"https:\/\/api.github.com\/users\/WestLangley\/orgs"}},{"index":17,"author_association":"CONTRIBUTOR","body":"How does this look? \r\n\r\nCurrently [depth_vert.glsl](https:\/\/github.com\/jaxry\/three.js\/blob\/13b6a37621058807bed99e6e1a410de6f4587c90\/src\/renderers\/shaders\/ShaderLib\/depth_vert.glsl) does not compile. No `objectNormal` is ever defined in that shader. How might we resolve this? We can't displace along a post-skin post-morph normal if it's never been computed.","created_at":"2017-05-06T02:16:31.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-299609599","id":299609599,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5OTYwOTU5OQ==","updated_at":"2017-05-06T02:26:39.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/299609599","user":{"following_url":"https:\/\/api.github.com\/users\/jaxry\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/jaxry\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/4411068?v=4","url":"https:\/\/api.github.com\/users\/jaxry","gists_url":"https:\/\/api.github.com\/users\/jaxry\/gists{\/gist_id}","html_url":"https:\/\/github.com\/jaxry","subscriptions_url":"https:\/\/api.github.com\/users\/jaxry\/subscriptions","node_id":"MDQ6VXNlcjQ0MTEwNjg=","repos_url":"https:\/\/api.github.com\/users\/jaxry\/repos","received_events_url":"https:\/\/api.github.com\/users\/jaxry\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/jaxry\/starred{\/owner}{\/repo}","site_admin":false,"login":"jaxry","type":"User","id":4411068,"followers_url":"https:\/\/api.github.com\/users\/jaxry\/followers","organizations_url":"https:\/\/api.github.com\/users\/jaxry\/orgs"}},{"index":18,"author_association":"COLLABORATOR","body":"Just edit `depth_vert.glsl` like so:\r\n```glsl\r\n#include <common>\r\n#include <uv_pars_vertex>\r\n#include <displacementmap_pars_vertex>\r\n#include <morphtarget_pars_vertex>\r\n#include <skinning_pars_vertex>\r\n#include <logdepthbuf_pars_vertex>\r\n#include <clipping_planes_pars_vertex>\r\n\r\nvoid main() {\r\n\r\n\t#include <uv_vertex>\r\n\r\n\t#include <skinbase_vertex>\r\n\r\n\t#include <beginnormal_vertex>\r\n\t#include <morphnormal_vertex>\r\n\t#include <skinbase_vertex>\r\n\t#include <skinnormal_vertex>\r\n\t#include <defaultnormal_vertex>\r\n\r\n\t#include <begin_vertex>\r\n\t#include <morphtarget_vertex>\r\n\t#include <skinning_vertex>\r\n\t#include <displacementmap_vertex>\r\n\t#include <project_vertex>\r\n\t#include <logdepthbuf_vertex>\r\n\t#include <clipping_planes_vertex>\r\n\r\n}\r\n```","created_at":"2017-05-06T03:15:23.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-299612014","id":299612014,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5OTYxMjAxNA==","updated_at":"2017-05-06T03:32:04.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/299612014","user":{"following_url":"https:\/\/api.github.com\/users\/WestLangley\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/WestLangley\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/1000017?v=4","url":"https:\/\/api.github.com\/users\/WestLangley","gists_url":"https:\/\/api.github.com\/users\/WestLangley\/gists{\/gist_id}","html_url":"https:\/\/github.com\/WestLangley","subscriptions_url":"https:\/\/api.github.com\/users\/WestLangley\/subscriptions","node_id":"MDQ6VXNlcjEwMDAwMTc=","repos_url":"https:\/\/api.github.com\/users\/WestLangley\/repos","received_events_url":"https:\/\/api.github.com\/users\/WestLangley\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/WestLangley\/starred{\/owner}{\/repo}","site_admin":false,"login":"WestLangley","type":"User","id":1000017,"followers_url":"https:\/\/api.github.com\/users\/WestLangley\/followers","organizations_url":"https:\/\/api.github.com\/users\/WestLangley\/orgs"}},{"index":19,"author_association":"COLLABORATOR","body":">The order should be based on the degree of transformation - largest first to smallest. Skinning is the largest scale transformation, then morphing (which if used with skinning should be minor, like facial expressions) and then displacement.\r\n\r\nI thought so too, but after studying our implementation more carefully, I see that our morphing calculation must precede our skinning calculation. [Here](https:\/\/cseweb.ucsd.edu\/classes\/sp16\/cse169-a\/slides\/CSE169_05.pdf) are some course slides that develop this idea further. Our current implementation in that regard seems correct to me.\r\n\r\n@mrdoob To summarize, this PR makes a few minor code improvements, and one significant change -- applying displacements after morphing and skinning, rather than before.\r\n\r\nThis change allows the displacement to be in the direction of the morph\/skinned normal, which is the correct thing to do. Shadows for morph\/skinned models utilizing displacement maps should also be correct.\r\n\r\nIn my opinion, this change is a good one and can be merged.\r\n\r\nMany thanks @jaxry and @bhouston.\r\n","created_at":"2017-05-07T23:32:47.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-299743606","id":299743606,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDI5OTc0MzYwNg==","updated_at":"2017-05-07T23:32:47.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/299743606","user":{"following_url":"https:\/\/api.github.com\/users\/WestLangley\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/WestLangley\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/1000017?v=4","url":"https:\/\/api.github.com\/users\/WestLangley","gists_url":"https:\/\/api.github.com\/users\/WestLangley\/gists{\/gist_id}","html_url":"https:\/\/github.com\/WestLangley","subscriptions_url":"https:\/\/api.github.com\/users\/WestLangley\/subscriptions","node_id":"MDQ6VXNlcjEwMDAwMTc=","repos_url":"https:\/\/api.github.com\/users\/WestLangley\/repos","received_events_url":"https:\/\/api.github.com\/users\/WestLangley\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/WestLangley\/starred{\/owner}{\/repo}","site_admin":false,"login":"WestLangley","type":"User","id":1000017,"followers_url":"https:\/\/api.github.com\/users\/WestLangley\/followers","organizations_url":"https:\/\/api.github.com\/users\/WestLangley\/orgs"}},{"index":20,"author_association":"OWNER","body":"Oops, seems like I forgot about this PR. Glad that it's still mergeable \ud83d\ude05","created_at":"2017-06-19T19:33:37.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-309545878","id":309545878,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDMwOTU0NTg3OA==","updated_at":"2017-06-19T19:33:37.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/309545878","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}},{"index":21,"author_association":"OWNER","body":"Thanks guys!","created_at":"2017-06-19T19:33:45.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-309545920","id":309545920,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDMwOTU0NTkyMA==","updated_at":"2017-06-19T19:33:45.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/309545920","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}},{"index":22,"author_association":"OWNER","body":"I suspect `NodeMaterial`, `NormalNode`, `OutlineEffect` and `WebGLDeferredRenderer`  are affected by this PR.\r\n\r\n\/cc @takahirox @sunag ","created_at":"2017-06-20T01:30:02.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-309618507","id":309618507,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDMwOTYxODUwNw==","updated_at":"2017-06-20T01:30:02.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/309618507","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}},{"index":23,"author_association":"COLLABORATOR","body":"OK, let me check later.\r\nBTW, in general I don't think we should merge any PRs which can break some modules right before releasing a new revision (unless they're super important).\r\nHow about reverting once, and then merging again after releasing r86?","created_at":"2017-06-20T04:30:00.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-309641751","id":309641751,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDMwOTY0MTc1MQ==","updated_at":"2017-06-20T04:33:43.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/309641751","user":{"following_url":"https:\/\/api.github.com\/users\/takahirox\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/takahirox\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/7637832?v=4","url":"https:\/\/api.github.com\/users\/takahirox","gists_url":"https:\/\/api.github.com\/users\/takahirox\/gists{\/gist_id}","html_url":"https:\/\/github.com\/takahirox","subscriptions_url":"https:\/\/api.github.com\/users\/takahirox\/subscriptions","node_id":"MDQ6VXNlcjc2Mzc4MzI=","repos_url":"https:\/\/api.github.com\/users\/takahirox\/repos","received_events_url":"https:\/\/api.github.com\/users\/takahirox\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/takahirox\/starred{\/owner}{\/repo}","site_admin":false,"login":"takahirox","type":"User","id":7637832,"followers_url":"https:\/\/api.github.com\/users\/takahirox\/followers","organizations_url":"https:\/\/api.github.com\/users\/takahirox\/orgs"}},{"index":24,"author_association":"OWNER","body":"> BTW, in general I don't think we should merge any PRs which can break some modules right before releasing a new revision (unless they're super important).\r\n\r\nI agree. I should have merged this one after releasing. But I was still working on WebVR efficiency (which I think I've solved) so there was still more time.\r\n\r\nSorry about that.","created_at":"2017-06-20T04:59:48.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-309645128","id":309645128,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDMwOTY0NTEyOA==","updated_at":"2017-06-20T05:05:06.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/309645128","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}},{"index":25,"author_association":"OWNER","body":"@takahirox \r\n\r\nI think `vertexShaderChunk2` can now be simplified to this:\r\n\r\n```js\r\nvar vertexShaderChunk2 = [\r\n\r\n\t\"gl_Position = calculateOutline( gl_Position, transformedNormal, vec4( transformed, 1.0 ) );\",\r\n\r\n\t\"#include <fog_vertex>\"\r\n\r\n].join( \"\\n\" );\r\n```","created_at":"2017-06-20T06:08:42.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-309654185","id":309654185,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDMwOTY1NDE4NQ==","updated_at":"2017-06-20T06:08:42.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/309654185","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}},{"index":26,"author_association":"OWNER","body":"Ignore my previous comment. I think this is the right fix:\r\n\r\n```js\r\nvar vertexShaderChunk2 = [\r\n\r\n\t\"#if ! defined( LAMBERT ) && ! defined( PHONG ) && ! defined( TOON ) && ! defined( PHYSICAL )\",\r\n\r\n\t\"\t#ifndef USE_ENVMAP\",\r\n\t\"\t\tvec3 transformedNormal = normalize( normal );\",\r\n\r\n\t\"\t\t#ifdef FLIP_SIDED\",\r\n\t\"\t\t\ttransformedNormal = -transformedNormal;\",\r\n\t\"\t\t#endif\",\r\n\r\n\t\"\t#endif\",\r\n\r\n\t\"#endif\",\r\n\r\n\t\"#ifdef DECLARE_TRANSFORMED\",\r\n\t\"\tvec3 transformed = vec3( position );\",\r\n\t\"#endif\",\r\n\r\n\t\"gl_Position = calculateOutline( gl_Position, transformedNormal, vec4( transformed, 1.0 ) );\",\r\n\r\n\t\"#include <fog_vertex>\"\r\n\r\n].join( \"\\n\" );\r\n```\r\n\r\nI think `OutlineEffect` would benefit a lot of #11475.","created_at":"2017-06-20T19:21:21.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-309861262","id":309861262,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDMwOTg2MTI2Mg==","updated_at":"2017-06-20T19:27:43.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/309861262","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}},{"index":27,"author_association":"COLLABORATOR","body":"I'll check the detail later (maybe tomorrow) but `OutlineEffect` seems like still broken.\r\n(Sorry I've been busy lately!)","created_at":"2017-06-21T14:15:44.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-310092174","id":310092174,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDMxMDA5MjE3NA==","updated_at":"2017-06-21T14:15:44.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/310092174","user":{"following_url":"https:\/\/api.github.com\/users\/takahirox\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/takahirox\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/7637832?v=4","url":"https:\/\/api.github.com\/users\/takahirox","gists_url":"https:\/\/api.github.com\/users\/takahirox\/gists{\/gist_id}","html_url":"https:\/\/github.com\/takahirox","subscriptions_url":"https:\/\/api.github.com\/users\/takahirox\/subscriptions","node_id":"MDQ6VXNlcjc2Mzc4MzI=","repos_url":"https:\/\/api.github.com\/users\/takahirox\/repos","received_events_url":"https:\/\/api.github.com\/users\/takahirox\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/takahirox\/starred{\/owner}{\/repo}","site_admin":false,"login":"takahirox","type":"User","id":7637832,"followers_url":"https:\/\/api.github.com\/users\/takahirox\/followers","organizations_url":"https:\/\/api.github.com\/users\/takahirox\/orgs"}},{"index":28,"author_association":"OWNER","body":"> I'll check the detail later (maybe tomorrow) but `OutlineEffect` seems like still broken.\r\n\r\nHow so? All the examples seem to look correct?","created_at":"2017-06-21T14:44:42.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-310101399","id":310101399,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDMxMDEwMTM5OQ==","updated_at":"2017-06-21T14:44:42.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/310101399","user":{"following_url":"https:\/\/api.github.com\/users\/mrdoob\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/mrdoob\/events{\/privacy}","avatar_url":"https:\/\/avatars0.githubusercontent.com\/u\/97088?v=4","url":"https:\/\/api.github.com\/users\/mrdoob","gists_url":"https:\/\/api.github.com\/users\/mrdoob\/gists{\/gist_id}","html_url":"https:\/\/github.com\/mrdoob","subscriptions_url":"https:\/\/api.github.com\/users\/mrdoob\/subscriptions","node_id":"MDQ6VXNlcjk3MDg4","repos_url":"https:\/\/api.github.com\/users\/mrdoob\/repos","received_events_url":"https:\/\/api.github.com\/users\/mrdoob\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/mrdoob\/starred{\/owner}{\/repo}","site_admin":false,"login":"mrdoob","type":"User","id":97088,"followers_url":"https:\/\/api.github.com\/users\/mrdoob\/followers","organizations_url":"https:\/\/api.github.com\/users\/mrdoob\/orgs"}},{"index":29,"author_association":"COLLABORATOR","body":"In `webgl_loader_mmd` example.\r\n\r\n![image](https:\/\/user-images.githubusercontent.com\/7637832\/27390855-525912de-56dd-11e7-8b91-c83bc4e14b39.png)\r\n\r\nRotate and see from back.","created_at":"2017-06-21T14:58:11.000Z","html_url":"https:\/\/github.com\/mrdoob\/three.js\/pull\/11271#issuecomment-310105852","id":310105852,"issue_url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/11271","node_id":"MDEyOklzc3VlQ29tbWVudDMxMDEwNTg1Mg==","updated_at":"2017-06-21T14:58:11.000Z","url":"https:\/\/api.github.com\/repos\/mrdoob\/three.js\/issues\/comments\/310105852","user":{"following_url":"https:\/\/api.github.com\/users\/takahirox\/following{\/other_user}","events_url":"https:\/\/api.github.com\/users\/takahirox\/events{\/privacy}","avatar_url":"https:\/\/avatars2.githubusercontent.com\/u\/7637832?v=4","url":"https:\/\/api.github.com\/users\/takahirox","gists_url":"https:\/\/api.github.com\/users\/takahirox\/gists{\/gist_id}","html_url":"https:\/\/github.com\/takahirox","subscriptions_url":"https:\/\/api.github.com\/users\/takahirox\/subscriptions","node_id":"MDQ6VXNlcjc2Mzc4MzI=","repos_url":"https:\/\/api.github.com\/users\/takahirox\/repos","received_events_url":"https:\/\/api.github.com\/users\/takahirox\/received_events","gravatar_id":"","starred_url":"https:\/\/api.github.com\/users\/takahirox\/starred{\/owner}{\/repo}","site_admin":false,"login":"takahirox","type":"User","id":7637832,"followers_url":"https:\/\/api.github.com\/users\/takahirox\/followers","organizations_url":"https:\/\/api.github.com\/users\/takahirox\/orgs"}}]}