[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/328660853",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-328660853",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 328660853,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyODY2MDg1Mw==",
    "user": {
      "login": "dnarc",
      "id": 4582828,
      "node_id": "MDQ6VXNlcjQ1ODI4Mjg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/4582828?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dnarc",
      "html_url": "https://github.com/dnarc",
      "followers_url": "https://api.github.com/users/dnarc/followers",
      "following_url": "https://api.github.com/users/dnarc/following{/other_user}",
      "gists_url": "https://api.github.com/users/dnarc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dnarc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dnarc/subscriptions",
      "organizations_url": "https://api.github.com/users/dnarc/orgs",
      "repos_url": "https://api.github.com/users/dnarc/repos",
      "events_url": "https://api.github.com/users/dnarc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dnarc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-11T21:15:35Z",
    "updated_at": "2017-09-11T21:15:35Z",
    "author_association": "NONE",
    "body": "I have a very similar problem that cropped up in the last few weeks on a Ubuntu 14.04 under python3 that was upgraded to grpcio 1.6 from grpcio 1.4 by pip3. The grpc server is still binding to the assigned port but client calls seem to never get accept()ed and the client hangs. I downgraded to the grpcio 1.4 package in python3 and my code resumed working. "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/329052913",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-329052913",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 329052913,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyOTA1MjkxMw==",
    "user": {
      "login": "akashgangil",
      "id": 2284560,
      "node_id": "MDQ6VXNlcjIyODQ1NjA=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/2284560?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/akashgangil",
      "html_url": "https://github.com/akashgangil",
      "followers_url": "https://api.github.com/users/akashgangil/followers",
      "following_url": "https://api.github.com/users/akashgangil/following{/other_user}",
      "gists_url": "https://api.github.com/users/akashgangil/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/akashgangil/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/akashgangil/subscriptions",
      "organizations_url": "https://api.github.com/users/akashgangil/orgs",
      "repos_url": "https://api.github.com/users/akashgangil/repos",
      "events_url": "https://api.github.com/users/akashgangil/events{/privacy}",
      "received_events_url": "https://api.github.com/users/akashgangil/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-13T04:04:21Z",
    "updated_at": "2017-09-13T04:04:21Z",
    "author_association": "NONE",
    "body": "@nathanielmanistaatgoogle Could you please look at this one? It seems to be a P0 blocker for the release."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/329053588",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-329053588",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 329053588,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyOTA1MzU4OA==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-13T04:10:48Z",
    "updated_at": "2017-09-13T04:18:45Z",
    "author_association": "MEMBER",
    "body": "This is very weird and concerning. Are you able to run with the `GRPC_TRACE=all` and `GRPC_VERBOSITY=DEBUG` environment variables set? Do you see possibly-significant differences between what they print when you run with each version?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/329055230",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-329055230",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 329055230,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyOTA1NTIzMA==",
    "user": {
      "login": "dnarc",
      "id": 4582828,
      "node_id": "MDQ6VXNlcjQ1ODI4Mjg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/4582828?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dnarc",
      "html_url": "https://github.com/dnarc",
      "followers_url": "https://api.github.com/users/dnarc/followers",
      "following_url": "https://api.github.com/users/dnarc/following{/other_user}",
      "gists_url": "https://api.github.com/users/dnarc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dnarc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dnarc/subscriptions",
      "organizations_url": "https://api.github.com/users/dnarc/orgs",
      "repos_url": "https://api.github.com/users/dnarc/repos",
      "events_url": "https://api.github.com/users/dnarc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dnarc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-13T04:25:17Z",
    "updated_at": "2017-09-13T04:25:17Z",
    "author_association": "NONE",
    "body": "Nathan, I'm just about to go to bed but I will do this tomorrow. I did run\nwith those two vars set when trying to debug my code with the 1.6 release\nand it was just fast cycling through the event loop.\n\nOn Tue, Sep 12, 2017 at 10:11 PM, Nathaniel Manista <\nnotifications@github.com> wrote:\n\n> This is very weird and concerning. Are you able to run with the\n> GRPC_TRACE=all and GRPC_VERBOSITY=DEBUG environment variables set? Do you\n> see possibly-significant differences between what they print when you run\n> with each version?\n>\n> —\n> You are receiving this because you commented.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/grpc/grpc/issues/12455#issuecomment-329053588>, or mute\n> the thread\n> <https://github.com/notifications/unsubscribe-auth/AEXtrJzbCl9qfyPAvL2puKSPA8_ezir-ks5sh1X3gaJpZM4PRltp>\n> .\n>\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/329055318",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-329055318",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 329055318,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyOTA1NTMxOA==",
    "user": {
      "login": "dnarc",
      "id": 4582828,
      "node_id": "MDQ6VXNlcjQ1ODI4Mjg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/4582828?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dnarc",
      "html_url": "https://github.com/dnarc",
      "followers_url": "https://api.github.com/users/dnarc/followers",
      "following_url": "https://api.github.com/users/dnarc/following{/other_user}",
      "gists_url": "https://api.github.com/users/dnarc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dnarc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dnarc/subscriptions",
      "organizations_url": "https://api.github.com/users/dnarc/orgs",
      "repos_url": "https://api.github.com/users/dnarc/repos",
      "events_url": "https://api.github.com/users/dnarc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dnarc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-13T04:26:18Z",
    "updated_at": "2017-09-13T04:26:18Z",
    "author_association": "NONE",
    "body": "BTW, I think this is the same bug:\n\nhttps://github.com/grpc/grpc/issues/12489\n\nOn Tue, Sep 12, 2017 at 10:11 PM, Nathaniel Manista <\nnotifications@github.com> wrote:\n\n> This is very weird and concerning. Are you able to run with the\n> GRPC_TRACE=all and GRPC_VERBOSITY=DEBUG environment variables set? Do you\n> see possibly-significant differences between what they print when you run\n> with each version?\n>\n> —\n> You are receiving this because you commented.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/grpc/grpc/issues/12455#issuecomment-329053588>, or mute\n> the thread\n> <https://github.com/notifications/unsubscribe-auth/AEXtrJzbCl9qfyPAvL2puKSPA8_ezir-ks5sh1X3gaJpZM4PRltp>\n> .\n>\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/329056881",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-329056881",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 329056881,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyOTA1Njg4MQ==",
    "user": {
      "login": "akashgangil",
      "id": 2284560,
      "node_id": "MDQ6VXNlcjIyODQ1NjA=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/2284560?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/akashgangil",
      "html_url": "https://github.com/akashgangil",
      "followers_url": "https://api.github.com/users/akashgangil/followers",
      "following_url": "https://api.github.com/users/akashgangil/following{/other_user}",
      "gists_url": "https://api.github.com/users/akashgangil/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/akashgangil/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/akashgangil/subscriptions",
      "organizations_url": "https://api.github.com/users/akashgangil/orgs",
      "repos_url": "https://api.github.com/users/akashgangil/repos",
      "events_url": "https://api.github.com/users/akashgangil/events{/privacy}",
      "received_events_url": "https://api.github.com/users/akashgangil/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-13T04:40:21Z",
    "updated_at": "2017-09-13T04:40:21Z",
    "author_association": "NONE",
    "body": "I can confirm what @dnarc  said as I was running my grpc server in a different process too using the multiprocessing module."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/329212960",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-329212960",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 329212960,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyOTIxMjk2MA==",
    "user": {
      "login": "speedplane",
      "id": 671052,
      "node_id": "MDQ6VXNlcjY3MTA1Mg==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/671052?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/speedplane",
      "html_url": "https://github.com/speedplane",
      "followers_url": "https://api.github.com/users/speedplane/followers",
      "following_url": "https://api.github.com/users/speedplane/following{/other_user}",
      "gists_url": "https://api.github.com/users/speedplane/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/speedplane/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/speedplane/subscriptions",
      "organizations_url": "https://api.github.com/users/speedplane/orgs",
      "repos_url": "https://api.github.com/users/speedplane/repos",
      "events_url": "https://api.github.com/users/speedplane/events{/privacy}",
      "received_events_url": "https://api.github.com/users/speedplane/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-13T15:54:02Z",
    "updated_at": "2017-09-13T15:54:02Z",
    "author_association": "NONE",
    "body": "Another bug report that is likely related: https://github.com/GoogleCloudPlatform/google-cloud-python/issues/3946"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/329567235",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-329567235",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 329567235,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyOTU2NzIzNQ==",
    "user": {
      "login": "dnarc",
      "id": 4582828,
      "node_id": "MDQ6VXNlcjQ1ODI4Mjg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/4582828?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dnarc",
      "html_url": "https://github.com/dnarc",
      "followers_url": "https://api.github.com/users/dnarc/followers",
      "following_url": "https://api.github.com/users/dnarc/following{/other_user}",
      "gists_url": "https://api.github.com/users/dnarc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dnarc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dnarc/subscriptions",
      "organizations_url": "https://api.github.com/users/dnarc/orgs",
      "repos_url": "https://api.github.com/users/dnarc/repos",
      "events_url": "https://api.github.com/users/dnarc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dnarc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-14T18:20:40Z",
    "updated_at": "2017-09-14T18:20:40Z",
    "author_association": "NONE",
    "body": "I'm pretty sure the issue is on the client/stub side when being called within a Future context. That's when I can most consistently reproduce the bug (Python 3.4, Ubuntu 14.04). \r\n\r\nI've added logs from a run from a non-working call using v1.6 versus a working call using v1.4.\r\n\r\nI cut if from the logs but your libevent/libev selected epoll() as the eventing library if it matters.\r\n\r\n\r\n[log.1-4-client.txt](https://github.com/grpc/grpc/files/1304048/log.1-4-client.txt)\r\n[log.1-6-grpc-client.txt](https://github.com/grpc/grpc/files/1304007/log.1-6-grpc-client.txt)\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/329639706",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-329639706",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 329639706,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyOTYzOTcwNg==",
    "user": {
      "login": "dnarc",
      "id": 4582828,
      "node_id": "MDQ6VXNlcjQ1ODI4Mjg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/4582828?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dnarc",
      "html_url": "https://github.com/dnarc",
      "followers_url": "https://api.github.com/users/dnarc/followers",
      "following_url": "https://api.github.com/users/dnarc/following{/other_user}",
      "gists_url": "https://api.github.com/users/dnarc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dnarc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dnarc/subscriptions",
      "organizations_url": "https://api.github.com/users/dnarc/orgs",
      "repos_url": "https://api.github.com/users/dnarc/repos",
      "events_url": "https://api.github.com/users/dnarc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dnarc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-14T23:54:33Z",
    "updated_at": "2017-09-14T23:54:33Z",
    "author_association": "NONE",
    "body": "Tried running with current 1.7.x, same behaviour. Also tried running with poll() instead of epoll() and saw no difference."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/329742297",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-329742297",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 329742297,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyOTc0MjI5Nw==",
    "user": {
      "login": "dnarc",
      "id": 4582828,
      "node_id": "MDQ6VXNlcjQ1ODI4Mjg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/4582828?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dnarc",
      "html_url": "https://github.com/dnarc",
      "followers_url": "https://api.github.com/users/dnarc/followers",
      "following_url": "https://api.github.com/users/dnarc/following{/other_user}",
      "gists_url": "https://api.github.com/users/dnarc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dnarc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dnarc/subscriptions",
      "organizations_url": "https://api.github.com/users/dnarc/orgs",
      "repos_url": "https://api.github.com/users/dnarc/repos",
      "events_url": "https://api.github.com/users/dnarc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dnarc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-15T10:17:06Z",
    "updated_at": "2017-09-15T10:17:06Z",
    "author_association": "NONE",
    "body": "'git bisect' puts the blame on this commit:\r\n\r\nee4b14521380f8c387c27f4cd351565d0afa3d61"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/329827078",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-329827078",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 329827078,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyOTgyNzA3OA==",
    "user": {
      "login": "kpayson64",
      "id": 18316330,
      "node_id": "MDQ6VXNlcjE4MzE2MzMw",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18316330?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kpayson64",
      "html_url": "https://github.com/kpayson64",
      "followers_url": "https://api.github.com/users/kpayson64/followers",
      "following_url": "https://api.github.com/users/kpayson64/following{/other_user}",
      "gists_url": "https://api.github.com/users/kpayson64/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kpayson64/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kpayson64/subscriptions",
      "organizations_url": "https://api.github.com/users/kpayson64/orgs",
      "repos_url": "https://api.github.com/users/kpayson64/repos",
      "events_url": "https://api.github.com/users/kpayson64/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kpayson64/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-15T16:08:01Z",
    "updated_at": "2017-09-15T16:08:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "The multiprocessing module uses fork() under the hood.  gRPC was not designed to work with fork, and if it was working before it was purely coincidental.\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/329840506",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-329840506",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 329840506,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyOTg0MDUwNg==",
    "user": {
      "login": "dnarc",
      "id": 4582828,
      "node_id": "MDQ6VXNlcjQ1ODI4Mjg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/4582828?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dnarc",
      "html_url": "https://github.com/dnarc",
      "followers_url": "https://api.github.com/users/dnarc/followers",
      "following_url": "https://api.github.com/users/dnarc/following{/other_user}",
      "gists_url": "https://api.github.com/users/dnarc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dnarc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dnarc/subscriptions",
      "organizations_url": "https://api.github.com/users/dnarc/orgs",
      "repos_url": "https://api.github.com/users/dnarc/repos",
      "events_url": "https://api.github.com/users/dnarc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dnarc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-15T17:02:25Z",
    "updated_at": "2017-09-15T17:02:25Z",
    "author_association": "NONE",
    "body": "I can't speak for the other error cases linked in this bug report, but I am\nusing concurrent.futures rather than multiprocessing (although c.f forks as\nwell) and the grpc call entirely happens within the spawned process. This\nis not a supported use case?\n\nOn Fri, Sep 15, 2017 at 10:08 AM, kpayson64 <notifications@github.com>\nwrote:\n\n> The multiprocessing module uses fork() under the hood. gRPC was not\n> designed to work with fork, and if it was working before it was purely\n> coincidental.\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/grpc/grpc/issues/12455#issuecomment-329827078>, or mute\n> the thread\n> <https://github.com/notifications/unsubscribe-auth/AEXtrPBVAewO_FWKxc5ScIwzMeAQFriCks5siqD7gaJpZM4PRltp>\n> .\n>\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/329870901",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-329870901",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 329870901,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyOTg3MDkwMQ==",
    "user": {
      "login": "burcarpat",
      "id": 7352567,
      "node_id": "MDQ6VXNlcjczNTI1Njc=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7352567?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/burcarpat",
      "html_url": "https://github.com/burcarpat",
      "followers_url": "https://api.github.com/users/burcarpat/followers",
      "following_url": "https://api.github.com/users/burcarpat/following{/other_user}",
      "gists_url": "https://api.github.com/users/burcarpat/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/burcarpat/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/burcarpat/subscriptions",
      "organizations_url": "https://api.github.com/users/burcarpat/orgs",
      "repos_url": "https://api.github.com/users/burcarpat/repos",
      "events_url": "https://api.github.com/users/burcarpat/events{/privacy}",
      "received_events_url": "https://api.github.com/users/burcarpat/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-15T18:58:02Z",
    "updated_at": "2017-09-15T18:58:02Z",
    "author_association": "NONE",
    "body": "Seems like we are observing the same issue.\r\n\r\nWe encountered this issue while trying to use `google-cloud-spanner==0.27.0`.  I have a short snippet (~50 lines) that reproduces the issue in a clean virtualenv on macOS Sierra 10.12.6 and Python 3.6.2 if there is interest (Though, it will require having a Spanner instance to run).  **The snippet in question also uses Python's standard multiprocessing module.**  I verified that if I pin the grpcio version to `grpcio==1.4.0` in the same clean virtualenv, things work fine.\r\n\r\nIndependently, I also reproduced the issue in our core codebase which is running Python 3.6.0 on both Google Compute Engine and Google Container Engine using standard Ubuntu images.\r\n\r\nThis is breaking a lot of stuff for us so I am more than happy to do whatever is needed to help solve the issue.\r\n\r\n_Note: I am also very interested in understanding whether grpc, and thus all google-cloud libraries using grpc, are supposed to work with Python's standard multiprocessing or not._"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/330292402",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-330292402",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 330292402,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMDI5MjQwMg==",
    "user": {
      "login": "kpayson64",
      "id": 18316330,
      "node_id": "MDQ6VXNlcjE4MzE2MzMw",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18316330?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kpayson64",
      "html_url": "https://github.com/kpayson64",
      "followers_url": "https://api.github.com/users/kpayson64/followers",
      "following_url": "https://api.github.com/users/kpayson64/following{/other_user}",
      "gists_url": "https://api.github.com/users/kpayson64/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kpayson64/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kpayson64/subscriptions",
      "organizations_url": "https://api.github.com/users/kpayson64/orgs",
      "repos_url": "https://api.github.com/users/kpayson64/repos",
      "events_url": "https://api.github.com/users/kpayson64/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kpayson64/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-18T17:20:09Z",
    "updated_at": "2017-09-18T17:20:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "We intend to support ```fork()``` going forward for the 1.7 release.\r\n\r\nThe 1.6 release introduced more background threads at the c-level, which are not carried over to child processes after the fork() call.\r\n\r\nIn the interim,  pinning ```grpcio==1.4.0``` is the best workaround."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/330369646",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-330369646",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 330369646,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMDM2OTY0Ng==",
    "user": {
      "login": "lukesneeringer",
      "id": 4346,
      "node_id": "MDQ6VXNlcjQzNDY=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/4346?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lukesneeringer",
      "html_url": "https://github.com/lukesneeringer",
      "followers_url": "https://api.github.com/users/lukesneeringer/followers",
      "following_url": "https://api.github.com/users/lukesneeringer/following{/other_user}",
      "gists_url": "https://api.github.com/users/lukesneeringer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lukesneeringer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lukesneeringer/subscriptions",
      "organizations_url": "https://api.github.com/users/lukesneeringer/orgs",
      "repos_url": "https://api.github.com/users/lukesneeringer/repos",
      "events_url": "https://api.github.com/users/lukesneeringer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lukesneeringer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-18T22:04:59Z",
    "updated_at": "2017-09-18T22:04:59Z",
    "author_association": "NONE",
    "body": "Note: I am updating all libraries to pin to `< 1.6dev` for now."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/330613654",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-330613654",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 330613654,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMDYxMzY1NA==",
    "user": {
      "login": "dnarc",
      "id": 4582828,
      "node_id": "MDQ6VXNlcjQ1ODI4Mjg=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/4582828?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dnarc",
      "html_url": "https://github.com/dnarc",
      "followers_url": "https://api.github.com/users/dnarc/followers",
      "following_url": "https://api.github.com/users/dnarc/following{/other_user}",
      "gists_url": "https://api.github.com/users/dnarc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dnarc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dnarc/subscriptions",
      "organizations_url": "https://api.github.com/users/dnarc/orgs",
      "repos_url": "https://api.github.com/users/dnarc/repos",
      "events_url": "https://api.github.com/users/dnarc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dnarc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-19T17:31:33Z",
    "updated_at": "2017-09-19T17:31:33Z",
    "author_association": "NONE",
    "body": "OK, the current grpcio package in PyPi is still 1.6."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/330685385",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-330685385",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 330685385,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMDY4NTM4NQ==",
    "user": {
      "login": "lukesneeringer",
      "id": 4346,
      "node_id": "MDQ6VXNlcjQzNDY=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/4346?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lukesneeringer",
      "html_url": "https://github.com/lukesneeringer",
      "followers_url": "https://api.github.com/users/lukesneeringer/followers",
      "following_url": "https://api.github.com/users/lukesneeringer/following{/other_user}",
      "gists_url": "https://api.github.com/users/lukesneeringer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lukesneeringer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lukesneeringer/subscriptions",
      "organizations_url": "https://api.github.com/users/lukesneeringer/orgs",
      "repos_url": "https://api.github.com/users/lukesneeringer/repos",
      "events_url": "https://api.github.com/users/lukesneeringer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lukesneeringer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-19T21:56:20Z",
    "updated_at": "2017-09-19T21:56:20Z",
    "author_association": "NONE",
    "body": "Correct; I updated [google-gax](https://github.com/googleapis/gax-python) to require < 1.6, though."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341183863",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-341183863",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 341183863,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTE4Mzg2Mw==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-01T17:45:37Z",
    "updated_at": "2017-11-01T17:45:37Z",
    "author_association": "MEMBER",
    "body": "@kpayson64: are we sufficiently satisfied with the improvements in 1.7.0-and-later that we should close this issue with the resolution \"1.6.x was what it was\"?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341184618",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-341184618",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 341184618,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTE4NDYxOA==",
    "user": {
      "login": "kpayson64",
      "id": 18316330,
      "node_id": "MDQ6VXNlcjE4MzE2MzMw",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18316330?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kpayson64",
      "html_url": "https://github.com/kpayson64",
      "followers_url": "https://api.github.com/users/kpayson64/followers",
      "following_url": "https://api.github.com/users/kpayson64/following{/other_user}",
      "gists_url": "https://api.github.com/users/kpayson64/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kpayson64/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kpayson64/subscriptions",
      "organizations_url": "https://api.github.com/users/kpayson64/orgs",
      "repos_url": "https://api.github.com/users/kpayson64/repos",
      "events_url": "https://api.github.com/users/kpayson64/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kpayson64/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-01T17:47:57Z",
    "updated_at": "2017-11-01T17:47:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yes, lets close this.  Client libraries should have been updated to 1.7 as well."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341244702",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-341244702",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 341244702,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTI0NDcwMg==",
    "user": {
      "login": "katbusch",
      "id": 1623602,
      "node_id": "MDQ6VXNlcjE2MjM2MDI=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1623602?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/katbusch",
      "html_url": "https://github.com/katbusch",
      "followers_url": "https://api.github.com/users/katbusch/followers",
      "following_url": "https://api.github.com/users/katbusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/katbusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/katbusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/katbusch/subscriptions",
      "organizations_url": "https://api.github.com/users/katbusch/orgs",
      "repos_url": "https://api.github.com/users/katbusch/repos",
      "events_url": "https://api.github.com/users/katbusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/katbusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-01T21:14:25Z",
    "updated_at": "2017-11-01T21:14:25Z",
    "author_association": "NONE",
    "body": "I just upgraded to 1.7 and am still seeing an issue with multiprocessing.  It works on 1.4"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341245879",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-341245879",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 341245879,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTI0NTg3OQ==",
    "user": {
      "login": "kpayson64",
      "id": 18316330,
      "node_id": "MDQ6VXNlcjE4MzE2MzMw",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18316330?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kpayson64",
      "html_url": "https://github.com/kpayson64",
      "followers_url": "https://api.github.com/users/kpayson64/followers",
      "following_url": "https://api.github.com/users/kpayson64/following{/other_user}",
      "gists_url": "https://api.github.com/users/kpayson64/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kpayson64/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kpayson64/subscriptions",
      "organizations_url": "https://api.github.com/users/kpayson64/orgs",
      "repos_url": "https://api.github.com/users/kpayson64/repos",
      "events_url": "https://api.github.com/users/kpayson64/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kpayson64/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-01T21:18:13Z",
    "updated_at": "2017-11-01T21:18:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "@katbusch \r\nCan you share a broken example?  Arbitrary forking behavior isn't supported, and maybe there is a way to restructure things to get around the issue."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341247094",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-341247094",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 341247094,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTI0NzA5NA==",
    "user": {
      "login": "katbusch",
      "id": 1623602,
      "node_id": "MDQ6VXNlcjE2MjM2MDI=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1623602?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/katbusch",
      "html_url": "https://github.com/katbusch",
      "followers_url": "https://api.github.com/users/katbusch/followers",
      "following_url": "https://api.github.com/users/katbusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/katbusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/katbusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/katbusch/subscriptions",
      "organizations_url": "https://api.github.com/users/katbusch/orgs",
      "repos_url": "https://api.github.com/users/katbusch/repos",
      "events_url": "https://api.github.com/users/katbusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/katbusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-01T21:22:42Z",
    "updated_at": "2017-11-01T21:22:42Z",
    "author_association": "NONE",
    "body": "Will take me a moment to test an example minimal enough to post but the general idea is\r\n\r\n```\r\npool = multiprocessing.Pool(initializer={initializer calls grpc.insecure_channel}).\r\npool.map(fn that sends messages over channel)\r\n```"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341250847",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-341250847",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 341250847,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTI1MDg0Nw==",
    "user": {
      "login": "kpayson64",
      "id": 18316330,
      "node_id": "MDQ6VXNlcjE4MzE2MzMw",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18316330?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kpayson64",
      "html_url": "https://github.com/kpayson64",
      "followers_url": "https://api.github.com/users/kpayson64/followers",
      "following_url": "https://api.github.com/users/kpayson64/following{/other_user}",
      "gists_url": "https://api.github.com/users/kpayson64/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kpayson64/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kpayson64/subscriptions",
      "organizations_url": "https://api.github.com/users/kpayson64/orgs",
      "repos_url": "https://api.github.com/users/kpayson64/repos",
      "events_url": "https://api.github.com/users/kpayson64/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kpayson64/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-01T21:37:41Z",
    "updated_at": "2017-11-01T21:37:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "I just quickly created the following modification on 1.7 helloworld example:\r\n\r\n```\r\nimport grpc\r\nimport multiprocessing\r\n\r\nimport helloworld_pb2\r\nimport helloworld_pb2_grpc\r\n\r\nstub = None\r\n\r\ndef init_stub():\r\n  global stub\r\n  channel = grpc.insecure_channel('localhost:50051')\r\n  stub = helloworld_pb2_grpc.GreeterStub(channel)\r\n\r\ndef run(unused_var):\r\n  response = stub.SayHello(helloworld_pb2.HelloRequest(name='you'))\r\n  print(\"Greeter client received: \" + response.message)\r\n\r\n\r\nif __name__ == '__main__':\r\n  p = multiprocessing.Pool(5, initializer=init_stub)\r\n  p.map(run, [1,2,3])\r\n```\r\n\r\nOutput:\r\n```\r\nGreeter client received: Hello, you!\r\nGreeter client received: Hello, you!\r\nGreeter client received: Hello, you!\r\n```\r\n\r\nWhich seems to be working as expected.\r\nOne thing to be careful to avoid is creating channels before forking.  Hopefully we will have support for that in the future, but it is currently unsupported."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341456861",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-341456861",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 341456861,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTQ1Njg2MQ==",
    "user": {
      "login": "katbusch",
      "id": 1623602,
      "node_id": "MDQ6VXNlcjE2MjM2MDI=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1623602?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/katbusch",
      "html_url": "https://github.com/katbusch",
      "followers_url": "https://api.github.com/users/katbusch/followers",
      "following_url": "https://api.github.com/users/katbusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/katbusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/katbusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/katbusch/subscriptions",
      "organizations_url": "https://api.github.com/users/katbusch/orgs",
      "repos_url": "https://api.github.com/users/katbusch/repos",
      "events_url": "https://api.github.com/users/katbusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/katbusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-02T15:22:52Z",
    "updated_at": "2017-11-02T15:22:52Z",
    "author_association": "NONE",
    "body": "I upgraded all my packages instead of just grpcio and it seems to be working now on 1.7 with the use-case I described!  Thanks for your help."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/348345552",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-348345552",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 348345552,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODM0NTU1Mg==",
    "user": {
      "login": "katbusch",
      "id": 1623602,
      "node_id": "MDQ6VXNlcjE2MjM2MDI=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1623602?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/katbusch",
      "html_url": "https://github.com/katbusch",
      "followers_url": "https://api.github.com/users/katbusch/followers",
      "following_url": "https://api.github.com/users/katbusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/katbusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/katbusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/katbusch/subscriptions",
      "organizations_url": "https://api.github.com/users/katbusch/orgs",
      "repos_url": "https://api.github.com/users/katbusch/repos",
      "events_url": "https://api.github.com/users/katbusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/katbusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-30T22:45:22Z",
    "updated_at": "2017-11-30T22:45:22Z",
    "author_association": "NONE",
    "body": "Update: I ran into this again, and it turns out that other packages break this as a side effect, perhaps by doing some initialization before the fork.  The libraries are google.cloud.storage and google.cloud.bigquery.\r\n\r\nThis fails but succeeds if the bigquery line is commented out:\r\n\r\n```\r\nimport grpc\r\nimport echo_pb2, echo_pb2_grpc\r\nfrom multiprocessing import Pool\r\nfrom google.cloud import bigquery\r\n\r\nstub = None\r\n\r\ndef init_stub():\r\n    global stub\r\n    channel = grpc.insecure_channel('localhost:50051')\r\n    stub = echo_pb2_grpc.EchoStub(channel)\r\n\r\ndef run(number):\r\n    response = stub.Echo(echo_pb2.StringMessage(value='hello {}'.format(number)))\r\n    print(\"Greeter client received: \" + response.value)\r\n\r\nif __name__ == '__main__':\r\n    pool = Pool(5, initializer=init_stub)\r\n    pool.map(run, [1, 2, 3])\r\n```"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/348578950",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-348578950",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 348578950,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODU3ODk1MA==",
    "user": {
      "login": "katbusch",
      "id": 1623602,
      "node_id": "MDQ6VXNlcjE2MjM2MDI=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1623602?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/katbusch",
      "html_url": "https://github.com/katbusch",
      "followers_url": "https://api.github.com/users/katbusch/followers",
      "following_url": "https://api.github.com/users/katbusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/katbusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/katbusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/katbusch/subscriptions",
      "organizations_url": "https://api.github.com/users/katbusch/orgs",
      "repos_url": "https://api.github.com/users/katbusch/repos",
      "events_url": "https://api.github.com/users/katbusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/katbusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-01T18:57:11Z",
    "updated_at": "2017-12-01T18:57:11Z",
    "author_association": "NONE",
    "body": "Another update: I can only reproduce this on mac, not on linux"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/353684257",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-353684257",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 353684257,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MzY4NDI1Nw==",
    "user": {
      "login": "zunger-humu",
      "id": 31084695,
      "node_id": "MDQ6VXNlcjMxMDg0Njk1",
      "avatar_url": "https://avatars0.githubusercontent.com/u/31084695?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zunger-humu",
      "html_url": "https://github.com/zunger-humu",
      "followers_url": "https://api.github.com/users/zunger-humu/followers",
      "following_url": "https://api.github.com/users/zunger-humu/following{/other_user}",
      "gists_url": "https://api.github.com/users/zunger-humu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zunger-humu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zunger-humu/subscriptions",
      "organizations_url": "https://api.github.com/users/zunger-humu/orgs",
      "repos_url": "https://api.github.com/users/zunger-humu/repos",
      "events_url": "https://api.github.com/users/zunger-humu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zunger-humu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-22T22:26:30Z",
    "updated_at": "2017-12-22T22:34:56Z",
    "author_association": "NONE",
    "body": "I seem to be encountering the same bug using grpcio==1.8.2. Here's a minimal repro using datastore as the example, but you can do it with nearly anything:\r\n\r\n```\r\nimport multiprocessing\r\n\r\nfrom google.cloud import datastore\r\n\r\n\r\ndef causeTrouble(where: str):\r\n    client = datastore.Client(project='dev-storage-humu', namespace='aquarium')\r\n    client.get(client.key('c', 'aquarium'))\r\n    # The call to get() hangs forever; this line is never reached.\r\n    print('OK')\r\n\r\n\r\nif __name__ == '__main__':\r\n    # Create a datastore client and do an RPC on it.\r\n    client = datastore.Client(project='dev-storage-humu', namespace='aquarium')\r\n    client.get(client.key('c', 'aquarium'))\r\n\r\n    # Kick off a child process while the first client is still in scope.\r\n    process = multiprocessing.Process(target=causeTrouble,\r\n                                      args=['child process'])\r\n    process.start()\r\n```\r\n\r\nIf the first client goes out of scope before you call Process() (e.g., if you call causeTrouble() from main instead of doing it right there) then this works correctly. (This was tested using Py3.6 on OSX, but I've seen similar issues running on GCP machines as well)\r\n\r\nThis is a pretty serious obstacle in my case, because I've got a server which uses all sorts of GCP systems, and it needs to fork subprocesses to do expensive asynchronous tasks, which also require those. Short of rearchitecting to pre-fork a bunch of processes before any of grpc is invoked, is there any way to deal with this? (And if @katbusch's result that simply *importing* various libraries before fork is enough to trigger the bug, that's going to be particularly difficult)\r\n\r\nSaying 'grpc is incompatible with fork()' feels like a pretty unsatisfying answer, especially given the lack of non-fork() based parallelism in Python."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/356720050",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-356720050",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 356720050,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NjcyMDA1MA==",
    "user": {
      "login": "kpayson64",
      "id": 18316330,
      "node_id": "MDQ6VXNlcjE4MzE2MzMw",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18316330?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kpayson64",
      "html_url": "https://github.com/kpayson64",
      "followers_url": "https://api.github.com/users/kpayson64/followers",
      "following_url": "https://api.github.com/users/kpayson64/following{/other_user}",
      "gists_url": "https://api.github.com/users/kpayson64/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kpayson64/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kpayson64/subscriptions",
      "organizations_url": "https://api.github.com/users/kpayson64/orgs",
      "repos_url": "https://api.github.com/users/kpayson64/repos",
      "events_url": "https://api.github.com/users/kpayson64/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kpayson64/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-10T20:03:27Z",
    "updated_at": "2018-01-10T20:03:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "@zunger-humu \r\nThe easiest way to deal with this is to wait to create the datastore client until after forking.\r\n\r\nThe following should work:\r\n```\r\nimport multiprocessing\r\n\r\nfrom google.cloud import datastore\r\n\r\n\r\ndef causeTrouble(where: str):\r\n    client = datastore.Client(project='dev-storage-humu', namespace='aquarium')\r\n    client.get(client.key('c', 'aquarium'))\r\n    # The call to get() hangs forever; this line is never reached.\r\n    print('OK')\r\n\r\n\r\nif __name__ == '__main__':\r\n    # Kick off a child process while the first client is still in scope.\r\n    process = multiprocessing.Process(target=causeTrouble,\r\n                                      args=['child process'])\r\n    process.start()\r\n``\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/356798403",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-356798403",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 356798403,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1Njc5ODQwMw==",
    "user": {
      "login": "zunger-humu",
      "id": 31084695,
      "node_id": "MDQ6VXNlcjMxMDg0Njk1",
      "avatar_url": "https://avatars0.githubusercontent.com/u/31084695?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zunger-humu",
      "html_url": "https://github.com/zunger-humu",
      "followers_url": "https://api.github.com/users/zunger-humu/followers",
      "following_url": "https://api.github.com/users/zunger-humu/following{/other_user}",
      "gists_url": "https://api.github.com/users/zunger-humu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zunger-humu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zunger-humu/subscriptions",
      "organizations_url": "https://api.github.com/users/zunger-humu/orgs",
      "repos_url": "https://api.github.com/users/zunger-humu/repos",
      "events_url": "https://api.github.com/users/zunger-humu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zunger-humu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-11T01:49:54Z",
    "updated_at": "2018-01-11T01:49:54Z",
    "author_association": "NONE",
    "body": "Alas, that doesn't work in my case: the datastore client (and more\nimportantly, the objects which own it, as well as the various other gRPC\nclients) are server-global, but the subprocesses need to be forked\non-demand.\n\nThis isn't a blocking issue for me right now, since I realized that for\nother reasons I needed to switch from multiprocessing to using subprocess\ndirectly (which does a fork+exec and so doesn't have this issue), but for\nother users, pre-forking child processes may or may not work, depending on\nwhat they're doing.\n\nOn Wed, Jan 10, 2018 at 12:03 PM, kpayson64 <notifications@github.com>\nwrote:\n\n> @zunger-humu <https://github.com/zunger-humu>\n> The easiest way to deal with this is to wait to create the datastore\n> client until after forking.\n>\n> The following should work:\n>\n> import multiprocessing\n>\n> from google.cloud import datastore\n>\n>\n> def causeTrouble(where: str):\n>     client = datastore.Client(project='dev-storage-humu', namespace='aquarium')\n>     client.get(client.key('c', 'aquarium'))\n>     # The call to get() hangs forever; this line is never reached.\n>     print('OK')\n>\n>\n> if __name__ == '__main__':\n>     # Kick off a child process while the first client is still in scope.\n>     process = multiprocessing.Process(target=causeTrouble,\n>                                       args=['child process'])\n>     process.start()\n> ``\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/grpc/grpc/issues/12455#issuecomment-356720050>, or mute\n> the thread\n> <https://github.com/notifications/unsubscribe-auth/AdpQl7AiH_LpecvF50lsLdcBky3cdHmRks5tJRejgaJpZM4PRltp>\n> .\n>\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/360708728",
    "html_url": "https://github.com/grpc/grpc/issues/12455#issuecomment-360708728",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12455",
    "id": 360708728,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MDcwODcyOA==",
    "user": {
      "login": "mbarnathan",
      "id": 4897493,
      "node_id": "MDQ6VXNlcjQ4OTc0OTM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/4897493?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mbarnathan",
      "html_url": "https://github.com/mbarnathan",
      "followers_url": "https://api.github.com/users/mbarnathan/followers",
      "following_url": "https://api.github.com/users/mbarnathan/following{/other_user}",
      "gists_url": "https://api.github.com/users/mbarnathan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mbarnathan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mbarnathan/subscriptions",
      "organizations_url": "https://api.github.com/users/mbarnathan/orgs",
      "repos_url": "https://api.github.com/users/mbarnathan/repos",
      "events_url": "https://api.github.com/users/mbarnathan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mbarnathan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-26T07:54:03Z",
    "updated_at": "2018-01-26T07:54:03Z",
    "author_association": "NONE",
    "body": "This appears to be causing RPCs to time out when running Google APIs from within celery tasks (I'm using -P eventlet, but other values appear to suffer the same issue as well). Downgrading to grpcio==1.4.0 works; no later version appears to."
  }
]
