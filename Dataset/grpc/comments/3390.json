[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/141840520",
    "html_url": "https://github.com/grpc/grpc/issues/3390#issuecomment-141840520",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/3390",
    "id": 141840520,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MTg0MDUyMA==",
    "user": {
      "login": "ohad7",
      "id": 9012046,
      "node_id": "MDQ6VXNlcjkwMTIwNDY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/9012046?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ohad7",
      "html_url": "https://github.com/ohad7",
      "followers_url": "https://api.github.com/users/ohad7/followers",
      "following_url": "https://api.github.com/users/ohad7/following{/other_user}",
      "gists_url": "https://api.github.com/users/ohad7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ohad7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ohad7/subscriptions",
      "organizations_url": "https://api.github.com/users/ohad7/orgs",
      "repos_url": "https://api.github.com/users/ohad7/repos",
      "events_url": "https://api.github.com/users/ohad7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ohad7/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-20T22:06:00Z",
    "updated_at": "2015-09-20T22:06:00Z",
    "author_association": "NONE",
    "body": "Hi again\nThe issue is reproducible when sending a lot of requests, then shutting down the server and restarting it after some time (1 minute). The client will then fail on the assertion.\n\nHere's an example of the stack when it fails, note that op is all NULLs, and that cancel_with_status is GRPC_STATUS_CANCELED:\n\n![image](https://cloud.githubusercontent.com/assets/9012046/9983167/351b1520-5ffc-11e5-8c1a-d7929bf93c22.png)\n\n@danageva managed to workaround this issue with avoiding entering the assertion if the status is canceled. Here's the code that currently works for us : \n\n``` c++\nif (calld->security_context_set == 0 && op->cancel_with_status != GRPC_STATUS_CANCELLED) {\n    calld->security_context_set = 1;\n    GPR_ASSERT(op->context);\n    if (op->context[GRPC_CONTEXT_SECURITY].value == NULL) {\n      op->context[GRPC_CONTEXT_SECURITY].value =\n      grpc_client_security_context_create();\n      op->context[GRPC_CONTEXT_SECURITY].destroy =\n      grpc_client_security_context_destroy;\n    }\n    sec_ctx = op->context[GRPC_CONTEXT_SECURITY].value;\n    GRPC_AUTH_CONTEXT_UNREF(sec_ctx->auth_context, \"client auth filter\");\n    sec_ctx->auth_context = GRPC_AUTH_CONTEXT_REF(\n                                                  chand->security_connector->base.auth_context, \"client_auth_filter\");\n  }\n```\n\nPlease let us know whether we're doing the right thing\n\ncc @olympium @dorongoffer @koker @danageva\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/142043859",
    "html_url": "https://github.com/grpc/grpc/issues/3390#issuecomment-142043859",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/3390",
    "id": 142043859,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MjA0Mzg1OQ==",
    "user": {
      "login": "jboeuf",
      "id": 6262765,
      "node_id": "MDQ6VXNlcjYyNjI3NjU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6262765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jboeuf",
      "html_url": "https://github.com/jboeuf",
      "followers_url": "https://api.github.com/users/jboeuf/followers",
      "following_url": "https://api.github.com/users/jboeuf/following{/other_user}",
      "gists_url": "https://api.github.com/users/jboeuf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jboeuf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jboeuf/subscriptions",
      "organizations_url": "https://api.github.com/users/jboeuf/orgs",
      "repos_url": "https://api.github.com/users/jboeuf/repos",
      "events_url": "https://api.github.com/users/jboeuf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jboeuf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-21T17:04:01Z",
    "updated_at": "2015-09-21T17:04:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for the bug report. I'm very busy today but I'll try to have a look. Tomorrow latest.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/142180948",
    "html_url": "https://github.com/grpc/grpc/issues/3390#issuecomment-142180948",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/3390",
    "id": 142180948,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0MjE4MDk0OA==",
    "user": {
      "login": "jboeuf",
      "id": 6262765,
      "node_id": "MDQ6VXNlcjYyNjI3NjU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6262765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jboeuf",
      "html_url": "https://github.com/jboeuf",
      "followers_url": "https://api.github.com/users/jboeuf/followers",
      "following_url": "https://api.github.com/users/jboeuf/following{/other_user}",
      "gists_url": "https://api.github.com/users/jboeuf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jboeuf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jboeuf/subscriptions",
      "organizations_url": "https://api.github.com/users/jboeuf/orgs",
      "repos_url": "https://api.github.com/users/jboeuf/repos",
      "events_url": "https://api.github.com/users/jboeuf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jboeuf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-22T04:49:27Z",
    "updated_at": "2015-09-22T04:49:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hopefully, the fix will make it in time for 0.11.1. Your fix was right but I generalized it a bit more. Thanks!\n"
  }
]
