[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/290512709",
    "html_url": "https://github.com/grpc/grpc/pull/10365#issuecomment-290512709",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10365",
    "id": 290512709,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MDUxMjcwOQ==",
    "user": {
      "login": "vjpai",
      "id": 8864912,
      "node_id": "MDQ6VXNlcjg4NjQ5MTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8864912?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vjpai",
      "html_url": "https://github.com/vjpai",
      "followers_url": "https://api.github.com/users/vjpai/followers",
      "following_url": "https://api.github.com/users/vjpai/following{/other_user}",
      "gists_url": "https://api.github.com/users/vjpai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vjpai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vjpai/subscriptions",
      "organizations_url": "https://api.github.com/users/vjpai/orgs",
      "repos_url": "https://api.github.com/users/vjpai/repos",
      "events_url": "https://api.github.com/users/vjpai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vjpai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-30T19:04:01Z",
    "updated_at": "2017-03-30T19:04:01Z",
    "author_association": "MEMBER",
    "body": "I take it that this review should be blocked behind the other PRs described? Otherwise, what are the relevant commits?\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/290515214",
    "html_url": "https://github.com/grpc/grpc/pull/10365#issuecomment-290515214",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10365",
    "id": 290515214,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MDUxNTIxNA==",
    "user": {
      "login": "ctiller",
      "id": 10120821,
      "node_id": "MDQ6VXNlcjEwMTIwODIx",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10120821?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ctiller",
      "html_url": "https://github.com/ctiller",
      "followers_url": "https://api.github.com/users/ctiller/followers",
      "following_url": "https://api.github.com/users/ctiller/following{/other_user}",
      "gists_url": "https://api.github.com/users/ctiller/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ctiller/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ctiller/subscriptions",
      "organizations_url": "https://api.github.com/users/ctiller/orgs",
      "repos_url": "https://api.github.com/users/ctiller/repos",
      "events_url": "https://api.github.com/users/ctiller/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ctiller/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-30T19:13:46Z",
    "updated_at": "2017-03-30T19:13:46Z",
    "author_association": "MEMBER",
    "body": "relevant commit is 1c10a7b... but this can wait until the other PR's are cleared"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/291560810",
    "html_url": "https://github.com/grpc/grpc/pull/10365#issuecomment-291560810",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10365",
    "id": 291560810,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MTU2MDgxMA==",
    "user": {
      "login": "grpc-kokoro",
      "id": 12722905,
      "node_id": "MDQ6VXNlcjEyNzIyOTA1",
      "avatar_url": "https://avatars3.githubusercontent.com/u/12722905?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/grpc-kokoro",
      "html_url": "https://github.com/grpc-kokoro",
      "followers_url": "https://api.github.com/users/grpc-kokoro/followers",
      "following_url": "https://api.github.com/users/grpc-kokoro/following{/other_user}",
      "gists_url": "https://api.github.com/users/grpc-kokoro/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/grpc-kokoro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/grpc-kokoro/subscriptions",
      "organizations_url": "https://api.github.com/users/grpc-kokoro/orgs",
      "repos_url": "https://api.github.com/users/grpc-kokoro/repos",
      "events_url": "https://api.github.com/users/grpc-kokoro/events{/privacy}",
      "received_events_url": "https://api.github.com/users/grpc-kokoro/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-04-04T16:46:04Z",
    "updated_at": "2017-04-04T16:46:04Z",
    "author_association": "NONE",
    "body": "```\nPerformance differences noted:\nBenchmark                    allocs_per_iteration    atm_add_per_iteration    atm_cas_per_iteration    cpu_time      locks_per_iteration  real_time    writes_per_iteration\n---------------------------  ----------------------  -----------------------  -----------------------  ----------  ---------------------  -----------  ----------------------\nBM_IsolatedCall_Unary                                                                                                              -1.00\nBM_LameChannelCallCreateCpp                                                                                                        -1.00\n```"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/291999684",
    "html_url": "https://github.com/grpc/grpc/pull/10365#issuecomment-291999684",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10365",
    "id": 291999684,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MTk5OTY4NA==",
    "user": {
      "login": "grpc-kokoro",
      "id": 12722905,
      "node_id": "MDQ6VXNlcjEyNzIyOTA1",
      "avatar_url": "https://avatars3.githubusercontent.com/u/12722905?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/grpc-kokoro",
      "html_url": "https://github.com/grpc-kokoro",
      "followers_url": "https://api.github.com/users/grpc-kokoro/followers",
      "following_url": "https://api.github.com/users/grpc-kokoro/following{/other_user}",
      "gists_url": "https://api.github.com/users/grpc-kokoro/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/grpc-kokoro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/grpc-kokoro/subscriptions",
      "organizations_url": "https://api.github.com/users/grpc-kokoro/orgs",
      "repos_url": "https://api.github.com/users/grpc-kokoro/repos",
      "events_url": "https://api.github.com/users/grpc-kokoro/events{/privacy}",
      "received_events_url": "https://api.github.com/users/grpc-kokoro/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-04-05T21:16:08Z",
    "updated_at": "2017-04-05T21:16:08Z",
    "author_association": "NONE",
    "body": "```\nPerformance differences noted:\nBenchmark                    allocs_per_iteration    atm_add_per_iteration    atm_cas_per_iteration    cpu_time      locks_per_iteration  real_time    writes_per_iteration\n---------------------------  ----------------------  -----------------------  -----------------------  ----------  ---------------------  -----------  ----------------------\nBM_IsolatedCall_Unary                                                                                                              -1.00\nBM_LameChannelCallCreateCpp                                                                                                        -1.00\n```"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/292037384",
    "html_url": "https://github.com/grpc/grpc/pull/10365#issuecomment-292037384",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10365",
    "id": 292037384,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MjAzNzM4NA==",
    "user": {
      "login": "grpc-kokoro",
      "id": 12722905,
      "node_id": "MDQ6VXNlcjEyNzIyOTA1",
      "avatar_url": "https://avatars3.githubusercontent.com/u/12722905?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/grpc-kokoro",
      "html_url": "https://github.com/grpc-kokoro",
      "followers_url": "https://api.github.com/users/grpc-kokoro/followers",
      "following_url": "https://api.github.com/users/grpc-kokoro/following{/other_user}",
      "gists_url": "https://api.github.com/users/grpc-kokoro/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/grpc-kokoro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/grpc-kokoro/subscriptions",
      "organizations_url": "https://api.github.com/users/grpc-kokoro/orgs",
      "repos_url": "https://api.github.com/users/grpc-kokoro/repos",
      "events_url": "https://api.github.com/users/grpc-kokoro/events{/privacy}",
      "received_events_url": "https://api.github.com/users/grpc-kokoro/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-04-06T00:44:32Z",
    "updated_at": "2017-04-06T00:44:32Z",
    "author_association": "NONE",
    "body": "```\nPerformance differences noted:\nBenchmark                    allocs_per_iteration    atm_add_per_iteration    atm_cas_per_iteration    cpu_time      locks_per_iteration  real_time    writes_per_iteration\n---------------------------  ----------------------  -----------------------  -----------------------  ----------  ---------------------  -----------  ----------------------\nBM_IsolatedCall_Unary                                                                                                              -1.00\nBM_LameChannelCallCreateCpp                                                                                                        -1.00\n```"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/292245055",
    "html_url": "https://github.com/grpc/grpc/pull/10365#issuecomment-292245055",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10365",
    "id": 292245055,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MjI0NTA1NQ==",
    "user": {
      "login": "ctiller",
      "id": 10120821,
      "node_id": "MDQ6VXNlcjEwMTIwODIx",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10120821?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ctiller",
      "html_url": "https://github.com/ctiller",
      "followers_url": "https://api.github.com/users/ctiller/followers",
      "following_url": "https://api.github.com/users/ctiller/following{/other_user}",
      "gists_url": "https://api.github.com/users/ctiller/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ctiller/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ctiller/subscriptions",
      "organizations_url": "https://api.github.com/users/ctiller/orgs",
      "repos_url": "https://api.github.com/users/ctiller/repos",
      "events_url": "https://api.github.com/users/ctiller/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ctiller/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-04-06T17:20:30Z",
    "updated_at": "2017-04-06T17:20:30Z",
    "author_association": "MEMBER",
    "body": "Tests look good. Switching reviewers due to vacations.\r\n\r\nNoah: this change eliminates creating the mutex on grpc_call by default, and should help unary cases."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/292357459",
    "html_url": "https://github.com/grpc/grpc/pull/10365#issuecomment-292357459",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10365",
    "id": 292357459,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MjM1NzQ1OQ==",
    "user": {
      "login": "ctiller",
      "id": 10120821,
      "node_id": "MDQ6VXNlcjEwMTIwODIx",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10120821?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ctiller",
      "html_url": "https://github.com/ctiller",
      "followers_url": "https://api.github.com/users/ctiller/followers",
      "following_url": "https://api.github.com/users/ctiller/following{/other_user}",
      "gists_url": "https://api.github.com/users/ctiller/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ctiller/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ctiller/subscriptions",
      "organizations_url": "https://api.github.com/users/ctiller/orgs",
      "repos_url": "https://api.github.com/users/ctiller/repos",
      "events_url": "https://api.github.com/users/ctiller/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ctiller/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-04-06T23:16:27Z",
    "updated_at": "2017-04-06T23:16:27Z",
    "author_association": "MEMBER",
    "body": "It does leak... and any solution seems like more overhead than just wasting\nsome bytes in the case of this race. It's relatively small anyway, and I\nexpect we won't see many threads racing here.\n\nOn Thu, Apr 6, 2017 at 3:45 PM Noah Eisen <notifications@github.com> wrote:\n\n> *@ncteisen* approved this pull request.\n> ------------------------------\n>\n> In src/core/lib/surface/call.c\n> <https://github.com/grpc/grpc/pull/10365#discussion_r110281949>:\n>\n> > @@ -276,6 +282,23 @@ static void add_init_error(grpc_error **composite, grpc_error *new) {\n>    *composite = grpc_error_add_child(*composite, new);\n>  }\n>\n> +static parent_call *get_or_create_parent_call(grpc_call *call) {\n> +  parent_call *p = (parent_call *)gpr_atm_acq_load(&call->parent_call_atm);\n> +  if (p == NULL) {\n> +    p = gpr_arena_alloc(call->arena, sizeof(*p));\n> +    gpr_mu_init(&p->child_list_mu);\n> +    if (!gpr_atm_rel_cas(&call->parent_call_atm, (gpr_atm)NULL, (gpr_atm)p)) {\n> +      gpr_mu_destroy(&p->child_list_mu);\n> +      p = (parent_call *)gpr_atm_acq_load(&call->parent_call_atm);\n>\n> This \"leaks\" some of the arena, right? I guess that is just unavoidable.\n> Maybe we could add a two-part alloc to the arena that involves a sort of\n> commit action to actually reserve the space.\n>\n> —\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/grpc/grpc/pull/10365#pullrequestreview-31445901>, or mute\n> the thread\n> <https://github.com/notifications/unsubscribe-auth/AJpudXlcgo6aLJSitvyWSOhAiNNI3iJsks5rtWr5gaJpZM4Mtl00>\n> .\n>\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/292357585",
    "html_url": "https://github.com/grpc/grpc/pull/10365#issuecomment-292357585",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10365",
    "id": 292357585,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MjM1NzU4NQ==",
    "user": {
      "login": "ctiller",
      "id": 10120821,
      "node_id": "MDQ6VXNlcjEwMTIwODIx",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10120821?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ctiller",
      "html_url": "https://github.com/ctiller",
      "followers_url": "https://api.github.com/users/ctiller/followers",
      "following_url": "https://api.github.com/users/ctiller/following{/other_user}",
      "gists_url": "https://api.github.com/users/ctiller/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ctiller/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ctiller/subscriptions",
      "organizations_url": "https://api.github.com/users/ctiller/orgs",
      "repos_url": "https://api.github.com/users/ctiller/repos",
      "events_url": "https://api.github.com/users/ctiller/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ctiller/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-04-06T23:16:57Z",
    "updated_at": "2017-04-06T23:16:57Z",
    "author_association": "MEMBER",
    "body": "Failed: #9726"
  }
]
