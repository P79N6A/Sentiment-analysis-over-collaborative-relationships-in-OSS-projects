[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/430846713",
    "html_url": "https://github.com/grpc/grpc/issues/16876#issuecomment-430846713",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/16876",
    "id": 430846713,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDg0NjcxMw==",
    "user": {
      "login": "michihenning",
      "id": 3123561,
      "node_id": "MDQ6VXNlcjMxMjM1NjE=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/3123561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michihenning",
      "html_url": "https://github.com/michihenning",
      "followers_url": "https://api.github.com/users/michihenning/followers",
      "following_url": "https://api.github.com/users/michihenning/following{/other_user}",
      "gists_url": "https://api.github.com/users/michihenning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michihenning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michihenning/subscriptions",
      "organizations_url": "https://api.github.com/users/michihenning/orgs",
      "repos_url": "https://api.github.com/users/michihenning/repos",
      "events_url": "https://api.github.com/users/michihenning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michihenning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-18T01:46:01Z",
    "updated_at": "2018-10-18T01:46:01Z",
    "author_association": "NONE",
    "body": "I'm also seeing failures where the grpc runtime live-locks. My client writer thread gets stuck in a Write(), and no more messages flow. While in this state, some thread that's internal to grpc ends up spinning and consumes 100% CPU."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/431106163",
    "html_url": "https://github.com/grpc/grpc/issues/16876#issuecomment-431106163",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/16876",
    "id": 431106163,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTEwNjE2Mw==",
    "user": {
      "login": "hsaliak",
      "id": 150108,
      "node_id": "MDQ6VXNlcjE1MDEwOA==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/150108?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hsaliak",
      "html_url": "https://github.com/hsaliak",
      "followers_url": "https://api.github.com/users/hsaliak/followers",
      "following_url": "https://api.github.com/users/hsaliak/following{/other_user}",
      "gists_url": "https://api.github.com/users/hsaliak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hsaliak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hsaliak/subscriptions",
      "organizations_url": "https://api.github.com/users/hsaliak/orgs",
      "repos_url": "https://api.github.com/users/hsaliak/repos",
      "events_url": "https://api.github.com/users/hsaliak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hsaliak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-18T18:03:05Z",
    "updated_at": "2018-10-18T18:03:05Z",
    "author_association": "MEMBER",
    "body": "@yashykt could you please help take a look. /cc @vjpai @a11r "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/431115583",
    "html_url": "https://github.com/grpc/grpc/issues/16876#issuecomment-431115583",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/16876",
    "id": 431115583,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTExNTU4Mw==",
    "user": {
      "login": "yashykt",
      "id": 4181124,
      "node_id": "MDQ6VXNlcjQxODExMjQ=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/4181124?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yashykt",
      "html_url": "https://github.com/yashykt",
      "followers_url": "https://api.github.com/users/yashykt/followers",
      "following_url": "https://api.github.com/users/yashykt/following{/other_user}",
      "gists_url": "https://api.github.com/users/yashykt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yashykt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yashykt/subscriptions",
      "organizations_url": "https://api.github.com/users/yashykt/orgs",
      "repos_url": "https://api.github.com/users/yashykt/repos",
      "events_url": "https://api.github.com/users/yashykt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yashykt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-18T18:32:41Z",
    "updated_at": "2018-10-18T18:32:41Z",
    "author_association": "MEMBER",
    "body": "My plate is full for the next few days. Assigning it to @sheenaqotj"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/431177023",
    "html_url": "https://github.com/grpc/grpc/issues/16876#issuecomment-431177023",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/16876",
    "id": 431177023,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTE3NzAyMw==",
    "user": {
      "login": "a11r",
      "id": 10135698,
      "node_id": "MDQ6VXNlcjEwMTM1Njk4",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10135698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/a11r",
      "html_url": "https://github.com/a11r",
      "followers_url": "https://api.github.com/users/a11r/followers",
      "following_url": "https://api.github.com/users/a11r/following{/other_user}",
      "gists_url": "https://api.github.com/users/a11r/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/a11r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/a11r/subscriptions",
      "organizations_url": "https://api.github.com/users/a11r/orgs",
      "repos_url": "https://api.github.com/users/a11r/repos",
      "events_url": "https://api.github.com/users/a11r/events{/privacy}",
      "received_events_url": "https://api.github.com/users/a11r/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-18T21:53:43Z",
    "updated_at": "2018-10-18T21:53:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "I took a brief look at the test code and it looks like the test client is ignoring Read() and write() errors and continues to Read(0/Write() more. This will lead to undefined behavir as there is a requirement that once a Read or Write fails, subsequent attempts to Read or Write should not be made."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/431205501",
    "html_url": "https://github.com/grpc/grpc/issues/16876#issuecomment-431205501",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/16876",
    "id": 431205501,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTIwNTUwMQ==",
    "user": {
      "login": "michihenning",
      "id": 3123561,
      "node_id": "MDQ6VXNlcjMxMjM1NjE=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/3123561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michihenning",
      "html_url": "https://github.com/michihenning",
      "followers_url": "https://api.github.com/users/michihenning/followers",
      "following_url": "https://api.github.com/users/michihenning/following{/other_user}",
      "gists_url": "https://api.github.com/users/michihenning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michihenning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michihenning/subscriptions",
      "organizations_url": "https://api.github.com/users/michihenning/orgs",
      "repos_url": "https://api.github.com/users/michihenning/repos",
      "events_url": "https://api.github.com/users/michihenning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michihenning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-19T00:20:06Z",
    "updated_at": "2018-10-19T00:20:06Z",
    "author_association": "NONE",
    "body": "This is just a quick and dirty test case. The point is that no errors are ever reported by the grpc runtime on either the client or the server side. But tsan complains about race conditions and, in the production code that encounters this problem (which does of course not continue to read or write after an error), I get segfaults, live locks, and threads in the grpc runtime that spin forever.\n\nPlease have a look at the original bug description here:\n\nhttps://groups.google.com/d/msg/grpc-io/y4xE4C18c2c/1jATJkSCBAAJ\n\nCheers,\n\nMichi.\n\n> On 19 Oct 2018, at 7:54 , Abhishek Kumar <notifications@github.com> wrote:\n> \n> I took a brief look at the test code and it looks like the test client is ignoring Read() and write() errors and continues to Read(0/Write() more. This will lead to undefined behavir as there is a requirement that once a Read or Write fails, subsequent attempts to Read or Write should not be made.\n> \n> â€”\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub <https://github.com/grpc/grpc/issues/16876#issuecomment-431177023>, or mute the thread <https://github.com/notifications/unsubscribe-auth/AC-paW7H11VdLYFuglKK5yaHFCQJOTFjks5umPitgaJpZM4XbgrK>.\n> \n\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/431944138",
    "html_url": "https://github.com/grpc/grpc/issues/16876#issuecomment-431944138",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/16876",
    "id": 431944138,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTk0NDEzOA==",
    "user": {
      "login": "a11r",
      "id": 10135698,
      "node_id": "MDQ6VXNlcjEwMTM1Njk4",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10135698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/a11r",
      "html_url": "https://github.com/a11r",
      "followers_url": "https://api.github.com/users/a11r/followers",
      "following_url": "https://api.github.com/users/a11r/following{/other_user}",
      "gists_url": "https://api.github.com/users/a11r/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/a11r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/a11r/subscriptions",
      "organizations_url": "https://api.github.com/users/a11r/orgs",
      "repos_url": "https://api.github.com/users/a11r/repos",
      "events_url": "https://api.github.com/users/a11r/events{/privacy}",
      "received_events_url": "https://api.github.com/users/a11r/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-22T19:14:59Z",
    "updated_at": "2018-10-22T19:14:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "The best way to fix the test is for the client-side sender to just Finish() the RPC when it sees a failing Write(). It can then start a new RPC and resume Write() calls on it. \r\n\r\nIf the application has long-lived session semantics, it would need to add enough data to each message to make resumption across RPCs possible.\r\n\r\nThanks\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/432094047",
    "html_url": "https://github.com/grpc/grpc/issues/16876#issuecomment-432094047",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/16876",
    "id": 432094047,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMjA5NDA0Nw==",
    "user": {
      "login": "michihenning",
      "id": 3123561,
      "node_id": "MDQ6VXNlcjMxMjM1NjE=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/3123561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michihenning",
      "html_url": "https://github.com/michihenning",
      "followers_url": "https://api.github.com/users/michihenning/followers",
      "following_url": "https://api.github.com/users/michihenning/following{/other_user}",
      "gists_url": "https://api.github.com/users/michihenning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michihenning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michihenning/subscriptions",
      "organizations_url": "https://api.github.com/users/michihenning/orgs",
      "repos_url": "https://api.github.com/users/michihenning/repos",
      "events_url": "https://api.github.com/users/michihenning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michihenning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-23T05:08:02Z",
    "updated_at": "2018-10-23T05:09:02Z",
    "author_association": "NONE",
    "body": "What the code does when a write fails is irrelevant for this because no write() ever fails. When I run the code, it runs without ever encountering an error. But thread sanitizer complains about race conditions. This is with both gRPC and the test code compiled with g++-7 and thread sanitizer. There should not be any race conditions reported at all, and I suspect that these race conditions relate to hangs and crashes I'm seeing in my production code.\r\n\r\nHere is a link to another archive. The code just calls _exit() if there is an error (but I don't see an error when the code runs).\r\n\r\nPlease compile this and gRPC with thread sanitizer and run it. You should see complaints from thread sanitizer, but it may take quite a while. (It took over an hour for me to get a bunch of complaints from tsan on a Core-i7 7700 machine.)\r\n\r\n[bug2.zip](https://github.com/grpc/grpc/files/2504575/bug2.zip)\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/432862804",
    "html_url": "https://github.com/grpc/grpc/issues/16876#issuecomment-432862804",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/16876",
    "id": 432862804,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMjg2MjgwNA==",
    "user": {
      "login": "michihenning",
      "id": 3123561,
      "node_id": "MDQ6VXNlcjMxMjM1NjE=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/3123561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michihenning",
      "html_url": "https://github.com/michihenning",
      "followers_url": "https://api.github.com/users/michihenning/followers",
      "following_url": "https://api.github.com/users/michihenning/following{/other_user}",
      "gists_url": "https://api.github.com/users/michihenning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michihenning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michihenning/subscriptions",
      "organizations_url": "https://api.github.com/users/michihenning/orgs",
      "repos_url": "https://api.github.com/users/michihenning/repos",
      "events_url": "https://api.github.com/users/michihenning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michihenning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-24T23:32:51Z",
    "updated_at": "2018-10-24T23:32:51Z",
    "author_association": "NONE",
    "body": "I left the code running for most of the day and overnight. Beside the tsan complaints, I got a segfault in the client. That was after the code had run between 7 and 20 hours. I've attached the stack trace. The thread that caused the fault is thread #3.\r\n\r\n[gdb.txt](https://github.com/grpc/grpc/files/2512705/gdb.txt)\r\n"
  }
]
