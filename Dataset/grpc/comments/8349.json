[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/253085135",
    "html_url": "https://github.com/grpc/grpc/issues/8349#issuecomment-253085135",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8349",
    "id": 253085135,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzA4NTEzNQ==",
    "user": {
      "login": "apolcyn",
      "id": 9566254,
      "node_id": "MDQ6VXNlcjk1NjYyNTQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9566254?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apolcyn",
      "html_url": "https://github.com/apolcyn",
      "followers_url": "https://api.github.com/users/apolcyn/followers",
      "following_url": "https://api.github.com/users/apolcyn/following{/other_user}",
      "gists_url": "https://api.github.com/users/apolcyn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apolcyn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apolcyn/subscriptions",
      "organizations_url": "https://api.github.com/users/apolcyn/orgs",
      "repos_url": "https://api.github.com/users/apolcyn/repos",
      "events_url": "https://api.github.com/users/apolcyn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apolcyn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-12T00:24:12Z",
    "updated_at": "2016-10-12T04:30:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "FTR, ruby benchmarks on master are currently crashing with these large numbers of outstanding RPCs. This is largely related to the benchmark server just using a thread pool of size 100 (for the older scenario parameters), but the issue here seems to be an underlying bug.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/253602304",
    "html_url": "https://github.com/grpc/grpc/issues/8349#issuecomment-253602304",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8349",
    "id": 253602304,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzYwMjMwNA==",
    "user": {
      "login": "apolcyn",
      "id": 9566254,
      "node_id": "MDQ6VXNlcjk1NjYyNTQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9566254?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apolcyn",
      "html_url": "https://github.com/apolcyn",
      "followers_url": "https://api.github.com/users/apolcyn/followers",
      "following_url": "https://api.github.com/users/apolcyn/following{/other_user}",
      "gists_url": "https://api.github.com/users/apolcyn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apolcyn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apolcyn/subscriptions",
      "organizations_url": "https://api.github.com/users/apolcyn/orgs",
      "repos_url": "https://api.github.com/users/apolcyn/repos",
      "events_url": "https://api.github.com/users/apolcyn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apolcyn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-13T18:45:19Z",
    "updated_at": "2016-10-13T18:45:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "possibly related: when running checking gdb and so pausing for unusual amounts of time, it seems that \n1) multiple calls to completion_queue_pluck end up failing, but 2) the process almost always ends up crashing when GC tries to destroy a call:\n\n```\nProgram received signal SIGABRT, Aborted.\n0x00007ffff7554c37 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56\n56  ../nptl/sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n(gdb) bt\n#0  0x00007ffff7554c37 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56\n#1  0x00007ffff7558028 in __GI_abort () at abort.c:89\n#2  0x00007ffff796332d in die () at error.c:407\n#3  rb_bug_context (ctx=ctx@entry=0x671a00, fmt=fmt@entry=0x7ffff7b1b9ba \"Segmentation fault at %p\") at error.c:437\n#4  0x00007ffff7a427ee in sigsegv (sig=<optimized out>, info=0x671b30, ctx=0x671a00) at signal.c:890\n#5  <signal handler called>\n#6  0x00007ffff512c250 in ?? () from /usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/grpc_c.so\n#7  0x00007ffff512ec17 in ?? () from /usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/grpc_c.so\n#8  0x00007ffff5129117 in grpc_exec_ctx_flush () from /usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/grpc_c.so\n#9  0x00007ffff512e746 in grpc_call_cancel_with_status () from /usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/grpc_c.so\n#10 0x00007ffff512e9b8 in grpc_call_destroy () from /usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/grpc_c.so\n#11 0x00007ffff511eb51 in destroy_call () from /usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/grpc_c.so\n#12 0x00007ffff798a2e9 in obj_free (obj=140732455310200, objspace=0x603a00) at gc.c:2144\n#13 gc_page_sweep (heap=0x603a20, sweep_page=0x7ffed40079a0, objspace=0x603a00) at gc.c:3380\n#14 gc_sweep_step (objspace=objspace@entry=0x603a00, heap=heap@entry=0x603a20) at gc.c:3559\n#15 0x00007ffff798b82b in gc_sweep_rest (objspace=<optimized out>) at gc.c:3608\n#16 gc_rest (objspace=0x603a00) at gc.c:6267\n#17 0x00007ffff798de0c in rb_objspace_call_finalizer (objspace=0x603a00) at gc.c:2773\n#18 rb_gc_call_finalizer_at_exit () at gc.c:2764\n#19 0x00007ffff796d862 in ruby_finalize_1 () at eval.c:130\n#20 ruby_cleanup (ex=<optimized out>) at eval.c:221\n#21 0x00007ffff796da93 in ruby_run_node (n=0x620728) at eval.c:301\n#22 0x000000000040087b in main (argc=4, argv=0x7fffffffda58) at main.c:36\n```\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/253607832",
    "html_url": "https://github.com/grpc/grpc/issues/8349#issuecomment-253607832",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8349",
    "id": 253607832,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzYwNzgzMg==",
    "user": {
      "login": "apolcyn",
      "id": 9566254,
      "node_id": "MDQ6VXNlcjk1NjYyNTQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9566254?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apolcyn",
      "html_url": "https://github.com/apolcyn",
      "followers_url": "https://api.github.com/users/apolcyn/followers",
      "following_url": "https://api.github.com/users/apolcyn/following{/other_user}",
      "gists_url": "https://api.github.com/users/apolcyn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apolcyn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apolcyn/subscriptions",
      "organizations_url": "https://api.github.com/users/apolcyn/orgs",
      "repos_url": "https://api.github.com/users/apolcyn/repos",
      "events_url": "https://api.github.com/users/apolcyn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apolcyn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-13T19:04:18Z",
    "updated_at": "2016-10-13T19:04:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "On the server side, it appears that while this is happening on the client side, server side core ops with attempts to RECV_MESSAGE receive a nil message. A subsequent batch of ops from the server that tries to send initial metadata and a status ends up failing.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/253684053",
    "html_url": "https://github.com/grpc/grpc/issues/8349#issuecomment-253684053",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8349",
    "id": 253684053,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzY4NDA1Mw==",
    "user": {
      "login": "apolcyn",
      "id": 9566254,
      "node_id": "MDQ6VXNlcjk1NjYyNTQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9566254?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apolcyn",
      "html_url": "https://github.com/apolcyn",
      "followers_url": "https://api.github.com/users/apolcyn/followers",
      "following_url": "https://api.github.com/users/apolcyn/following{/other_user}",
      "gists_url": "https://api.github.com/users/apolcyn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apolcyn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apolcyn/subscriptions",
      "organizations_url": "https://api.github.com/users/apolcyn/orgs",
      "repos_url": "https://api.github.com/users/apolcyn/repos",
      "events_url": "https://api.github.com/users/apolcyn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apolcyn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-14T01:16:45Z",
    "updated_at": "2016-10-14T01:16:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "backtrace of the thread that's hanging while doing another pluck right after a failed pluck, while it's hanging:\n\n```\n#0  0x00007f8bf09405b7 in __GI_epoll_pwait (epfd=87, events=0x7f8bcbbf6880, maxevents=1000, timeout=-1, set=0x7f8bbc027b88) at ../sysdeps/unix/sysv/linux/epoll_pwait.c:48\n#1  0x00007f8bee53769a in ?? () from /usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/grpc_c.so\n#2  0x00007f8bee537aeb in ?? () from /usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/grpc_c.so\n#3  0x00007f8bee45986a in grpc_completion_queue_pluck () from /usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/grpc_c.so\n#4  0x00007f8bee444a5c in ?? () from /usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/grpc_c.so\n#5  0x00007f8bf0e11ea2 in call_without_gvl (fail_if_interrupted=0, data2=<optimized out>, ubf=<optimized out>, data1=0x7f8bcbbf9a40, func=0x7f8bee4449e0) at thread.c:1287\n#6  rb_thread_call_without_gvl (func=0x7f8bee4449e0, data1=0x7f8bcbbf9a40, ubf=<optimized out>, data2=<optimized out>) at thread.c:1397\n#7  0x00007f8bee444b08 in rb_completion_queue_pluck () from /usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/grpc_c.so\n#8  0x00007f8bee4473c7 in grpc_rb_call_run_batch () from /usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/grpc_c.so\n#9  0x00007f8bf0de8eb6 in vm_call_cfunc_with_frame (ci=<optimized out>, cc=<optimized out>, calling=<optimized out>, reg_cfp=0x7f8bcbcfbe10, th=0x7f8be40306b0) at vm_insnhelper.c:1638\n#10 vm_call_cfunc (th=0x7f8be40306b0, reg_cfp=0x7f8bcbcfbe10, calling=<optimized out>, ci=<optimized out>, cc=<optimized out>) at vm_insnhelper.c:1733\n#11 0x00007f8bf0df3bc9 in vm_exec_core (th=th@entry=0x7f8be40306b0, initial=initial@entry=0) at insns.def:995\n#12 0x00007f8bf0df7741 in vm_exec (th=th@entry=0x7f8be40306b0) at vm.c:1645\n#13 0x00007f8bf0df8091 in invoke_bmethod (th=th@entry=0x7f8be40306b0, iseq=iseq@entry=0x1b574e8, self=self@entry=33934440, type=type@entry=161, opt_pc=<optimized out>, block=0x23ce8b0) at vm.c:938\n#14 0x00007f8bf0df8205 in invoke_block_from_c_0 (th=0x7f8be40306b0, block=0x23ce8b0, self=33934440, argc=<optimized out>, argv=<optimized out>, blockptr=<optimized out>, cref=0x0, splattable=0) at vm.c:969\n#15 0x00007f8bf0df856a in invoke_block_from_c_unsplattable (cref=0x0, blockptr=<optimized out>, argv=<optimized out>, argc=<optimized out>, self=<optimized out>, block=<optimized out>, th=0x7f8be40306b0) at vm.c:991\n#16 vm_invoke_bmethod (blockptr=<optimized out>, argv=<optimized out>, argc=<optimized out>, self=<optimized out>, proc=<optimized out>, th=0x7f8be40306b0) at vm.c:1055\n#17 vm_call_bmethod_body (ci=<optimized out>, cc=0x23015d0, argv=<optimized out>, calling=0x7f8bcbbfa630, th=0x7f8be40306b0) at vm_insnhelper.c:1762\n#18 vm_call_bmethod (th=0x7f8be40306b0, cfp=0x7f8bcbcfbf50, calling=0x7f8bcbbfa630, ci=<optimized out>, cc=0x23015d0) at vm_insnhelper.c:1780\n#19 0x00007f8bf0df3bc9 in vm_exec_core (th=th@entry=0x7f8be40306b0, initial=initial@entry=0) at insns.def:995\n#20 0x00007f8bf0df7741 in vm_exec (th=0x7f8be40306b0) at vm.c:1645\n#21 0x00007f8bf0df7ee3 in invoke_block (th=th@entry=0x7f8be40306b0, iseq=iseq@entry=0x199bcd0, self=self@entry=33936680, cref=cref@entry=0x0, type=type@entry=33, opt_pc=0, block=0x7f8be4034b90) at vm.c:916\n#22 0x00007f8bf0df8281 in invoke_block_from_c_0 (th=0x7f8be40306b0, block=0x7f8be4034b90, self=33936680, argc=<optimized out>, argv=<optimized out>, blockptr=<optimized out>, cref=0x0, splattable=0) at vm.c:966\n#23 0x00007f8bf0df8358 in invoke_block_from_c_unsplattable (cref=0x0, blockptr=0x0, argv=0x205c020, argc=0, self=33936680, block=0x7f8be4034b90, th=0x7f8be40306b0) at vm.c:991\n#24 vm_invoke_proc (th=th@entry=0x7f8be40306b0, proc=proc@entry=0x7f8be4034b90, self=33936680, argc=0, argv=0x205c020, blockptr=blockptr@entry=0x0) at vm.c:1039\n#25 0x00007f8bf0df83f9 in rb_vm_invoke_proc (th=th@entry=0x7f8be40306b0, proc=proc@entry=0x7f8be4034b90, argc=<optimized out>, argv=<optimized out>, blockptr=blockptr@entry=0x0) at vm.c:1067\n#26 0x00007f8bf0e0ed66 in thread_start_func_2 (th=th@entry=0x7f8be40306b0, stack_start=<optimized out>) at thread.c:584\n#27 0x00007f8bf0e0f270 in thread_start_func_1 (th_ptr=0x7f8be40306b0) at thread_pthread.c:865\n#28 0x00007f8bf0630184 in start_thread (arg=0x7f8bcbbfb700) at pthread_create.c:312\n#29 0x00007f8bf094037d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\n```\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/253685413",
    "html_url": "https://github.com/grpc/grpc/issues/8349#issuecomment-253685413",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8349",
    "id": 253685413,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzY4NTQxMw==",
    "user": {
      "login": "apolcyn",
      "id": 9566254,
      "node_id": "MDQ6VXNlcjk1NjYyNTQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9566254?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apolcyn",
      "html_url": "https://github.com/apolcyn",
      "followers_url": "https://api.github.com/users/apolcyn/followers",
      "following_url": "https://api.github.com/users/apolcyn/following{/other_user}",
      "gists_url": "https://api.github.com/users/apolcyn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apolcyn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apolcyn/subscriptions",
      "organizations_url": "https://api.github.com/users/apolcyn/orgs",
      "repos_url": "https://api.github.com/users/apolcyn/repos",
      "events_url": "https://api.github.com/users/apolcyn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apolcyn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-14T01:27:00Z",
    "updated_at": "2016-10-14T01:27:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "ruby-level back trace, where 29 identifies the call:\n\n```\nJOINING: 29 \nSTATUS of 29 is sleep\nBT of 29 is [\"/usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/generic/active_call.rb:188:in `run_batch_debug'\", \"/usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/generic/active_call.rb:188:in `finished'\", \"/usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/generic/active_call.rb:331:in `rescue in request_response'\", \"/usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/generic/active_call.rb:323:in `request_response'\", \"/usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/generic/client_stub.rb:168:in `request_response'\", \"/usr/local/google/home/apolcyn/grpc/src/ruby/lib/grpc/generic/service.rb:184:in `block (3 levels) in rpc_stub_class'\", \"/usr/local/google/home/apolcyn/grpc/src/ruby/qps/client.rb:133:in `unary_ping_ponger'\", \"/usr/local/google/home/apolcyn/grpc/src/ruby/qps/client.rb:113:in `block (3 levels) in initialize'\"]\n```\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/253685773",
    "html_url": "https://github.com/grpc/grpc/issues/8349#issuecomment-253685773",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8349",
    "id": 253685773,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzY4NTc3Mw==",
    "user": {
      "login": "apolcyn",
      "id": 9566254,
      "node_id": "MDQ6VXNlcjk1NjYyNTQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9566254?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apolcyn",
      "html_url": "https://github.com/apolcyn",
      "followers_url": "https://api.github.com/users/apolcyn/followers",
      "following_url": "https://api.github.com/users/apolcyn/following{/other_user}",
      "gists_url": "https://api.github.com/users/apolcyn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apolcyn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apolcyn/subscriptions",
      "organizations_url": "https://api.github.com/users/apolcyn/orgs",
      "repos_url": "https://api.github.com/users/apolcyn/repos",
      "events_url": "https://api.github.com/users/apolcyn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apolcyn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-14T01:30:01Z",
    "updated_at": "2016-10-14T16:45:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "under debug build with more symbols, back trace of a hanging thread is:\n\n```\n#0  0x00007fe8146be5b7 in __GI_epoll_pwait (epfd=94, events=0x7fe7f8cc7810, maxevents=1000, timeout=-1, set=0x7fe78c001f08) at ../sysdeps/unix/sysv/linux/epoll_pwait.c:48\n#1  0x00007fe8122ad15d in pollset_work_and_unlock (exec_ctx=0x7fe7f8cca920, pollset=0x7fe780017c28, worker=0x7fe7f8cca750, timeout_ms=19, sig_mask=0x7fe78c001f08, error=0x7fe7f8cca748) at src/core/lib/iomgr/ev_epoll_linux.c:1359\n#2  0x00007fe8122ad75d in pollset_work (exec_ctx=0x7fe7f8cca920, pollset=0x7fe780017c28, worker_hdl=0x7fe7f8cca8c0, now=..., deadline=...) at src/core/lib/iomgr/ev_epoll_linux.c:1492\n#3  0x00007fe8121faaea in grpc_pollset_work (exec_ctx=0x7fe7f8cca920, pollset=0x7fe780017c28, worker=0x7fe7f8cca8c0, now=..., deadline=...) at src/core/lib/iomgr/ev_posix.c:204\n#4  0x00007fe812164a1c in grpc_completion_queue_pluck (cc=0x7fe780017b30, tag=0x7fe7f8ccab00, deadline=..., reserved=0x0) at src/core/lib/surface/completion_queue.c:510\n#5  0x00007fe812149282 in grpc_rb_completion_queue_pluck_no_gil (param=0x7fe7f8ccaa60) at ../../../../src/ruby/ext/grpc/rb_completion_queue.c:62\n#6  0x00007fe814b8fea2 in call_without_gvl (fail_if_interrupted=0, data2=<optimized out>, ubf=<optimized out>, data1=0x7fe7f8ccaa60, func=0x7fe8121491f6 <grpc_rb_completion_queue_pluck_no_gil>) at thread.c:1287\n#7  rb_thread_call_without_gvl (func=0x7fe8121491f6 <grpc_rb_completion_queue_pluck_no_gil>, data1=0x7fe7f8ccaa60, ubf=<optimized out>, data2=<optimized out>) at thread.c:1397\n#8  0x00007fe812149398 in rb_completion_queue_pluck (queue=0x7fe780017b30, tag=0x7fe7f8ccab00, deadline=..., reserved=0x0) at ../../../../src/ruby/ext/grpc/rb_completion_queue.c:109\n#9  0x00007fe81214ce28 in grpc_rb_call_run_batch (self=42749480, ops_hash=140631590688520) at ../../../../src/ruby/ext/grpc/rb_call.c:824\n#10 0x00007fe81214cff1 in grpc_rb_call_run_batch_debug (self=42749480, ops_hash=140631590688520) at ../../../../src/ruby/ext/grpc/rb_call.c:858\n#11 0x00007fe814b66eb6 in vm_call_cfunc_with_frame (ci=<optimized out>, cc=<optimized out>, calling=<optimized out>, reg_cfp=0x7fe7f8dcce10, th=0x7fe808093ac0) at vm_insnhelper.c:1638\n#12 vm_call_cfunc (th=0x7fe808093ac0, reg_cfp=0x7fe7f8dcce10, calling=<optimized out>, ci=<optimized out>, cc=<optimized out>) at vm_insnhelper.c:1733\n#13 0x00007fe814b71bc9 in vm_exec_core (th=th@entry=0x7fe808093ac0, initial=initial@entry=0) at insns.def:995\n#14 0x00007fe814b75741 in vm_exec (th=th@entry=0x7fe808093ac0) at vm.c:1645\n#15 0x00007fe814b76091 in invoke_bmethod (th=th@entry=0x7fe808093ac0, iseq=iseq@entry=0x23038b8, self=self@entry=43741200, type=type@entry=161, opt_pc=<optimized out>, block=0x2b7b460) at vm.c:938\n#16 0x00007fe814b76205 in invoke_block_from_c_0 (th=0x7fe808093ac0, block=0x2b7b460, self=43741200, argc=<optimized out>, argv=<optimized out>, blockptr=<optimized out>, cref=0x0, splattable=0) at vm.c:969\n#17 0x00007fe814b7656a in invoke_block_from_c_unsplattable (cref=0x0, blockptr=<optimized out>, argv=<optimized out>, argc=<optimized out>, self=<optimized out>, block=<optimized out>, th=0x7fe808093ac0) at vm.c:991\n#18 vm_invoke_bmethod (blockptr=<optimized out>, argv=<optimized out>, argc=<optimized out>, self=<optimized out>, proc=<optimized out>, th=0x7fe808093ac0) at vm.c:1055\n#19 vm_call_bmethod_body (ci=<optimized out>, cc=0x2aaead0, argv=<optimized out>, calling=0x7fe7f8ccb630, th=0x7fe808093ac0) at vm_insnhelper.c:1762\n#20 vm_call_bmethod (th=0x7fe808093ac0, cfp=0x7fe7f8dccf50, calling=0x7fe7f8ccb630, ci=<optimized out>, cc=0x2aaead0) at vm_insnhelper.c:1780\n#21 0x00007fe814b71bc9 in vm_exec_core (th=th@entry=0x7fe808093ac0, initial=initial@entry=0) at insns.def:995\n#22 0x00007fe814b75741 in vm_exec (th=0x7fe808093ac0) at vm.c:1645\n#23 0x00007fe814b75ee3 in invoke_block (th=th@entry=0x7fe808093ac0, iseq=iseq@entry=0x2147c40, self=self@entry=41982800, cref=cref@entry=0x0, type=type@entry=33, opt_pc=0, block=0x7fe808097fa0) at vm.c:916\n#24 0x00007fe814b76281 in invoke_block_from_c_0 (th=0x7fe808093ac0, block=0x7fe808097fa0, self=41982800, argc=<optimized out>, argv=<optimized out>, blockptr=<optimized out>, cref=0x0, splattable=0) at vm.c:966\n#25 0x00007fe814b76358 in invoke_block_from_c_unsplattable (cref=0x0, blockptr=0x0, argv=0x29b5e78, argc=0, self=41982800, block=0x7fe808097fa0, th=0x7fe808093ac0) at vm.c:991\n#26 vm_invoke_proc (th=th@entry=0x7fe808093ac0, proc=proc@entry=0x7fe808097fa0, self=41982800, argc=0, argv=0x29b5e78, blockptr=blockptr@entry=0x0) at vm.c:1039\n#27 0x00007fe814b763f9 in rb_vm_invoke_proc (th=th@entry=0x7fe808093ac0, proc=proc@entry=0x7fe808097fa0, argc=<optimized out>, argv=<optimized out>, blockptr=blockptr@entry=0x0) at vm.c:1067\n#28 0x00007fe814b8cd66 in thread_start_func_2 (th=th@entry=0x7fe808093ac0, stack_start=<optimized out>) at thread.c:584\n#29 0x00007fe814b8d270 in thread_start_func_1 (th_ptr=0x7fe808093ac0) at thread_pthread.c:865\n#30 0x00007fe8143ae184 in start_thread (arg=0x7fe7f8ccc700) at pthread_create.c:312\n#31 0x00007fe8146be37d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\n```\n\nand at a later time period, it looks like it calls pollset_work_and_unlock again:\n\n```\n#0  0x00007fe8146be5b7 in __GI_epoll_pwait (epfd=94, events=0x7fe7f8cc7810, maxevents=1000, timeout=-1, set=0x7fe78c001f08) at ../sysdeps/unix/sysv/linux/epoll_pwait.c:48\n#1  0x00007fe8122ad15d in pollset_work_and_unlock (exec_ctx=0x7fe7f8cca920, pollset=0x7fe780017c28, worker=0x7fe7f8cca750, timeout_ms=20, sig_mask=0x7fe78c001f08, error=0x7fe7f8cca748) at src/core/lib/iomgr/ev_epoll_linux.c:1359\n#2  0x00007fe8122ad75d in pollset_work (exec_ctx=0x7fe7f8cca920, pollset=0x7fe780017c28, worker_hdl=0x7fe7f8cca8c0, now=..., deadline=...) at src/core/lib/iomgr/ev_epoll_linux.c:1492\n#3  0x00007fe8121faaea in grpc_pollset_work (exec_ctx=0x7fe7f8cca920, pollset=0x7fe780017c28, worker=0x7fe7f8cca8c0, now=..., deadline=...) at src/core/lib/iomgr/ev_posix.c:204\n#4  0x00007fe812164a1c in grpc_completion_queue_pluck (cc=0x7fe780017b30, tag=0x7fe7f8ccab00, deadline=..., reserved=0x0) at src/core/lib/surface/completion_queue.c:510\n#5  0x00007fe812149282 in grpc_rb_completion_queue_pluck_no_gil (param=0x7fe7f8ccaa60) at ../../../../src/ruby/ext/grpc/rb_completion_queue.c:62\n#6  0x00007fe814b8fea2 in call_without_gvl (fail_if_interrupted=0, data2=<optimized out>, ubf=<optimized out>, data1=0x7fe7f8ccaa60, func=0x7fe8121491f6 <grpc_rb_completion_queue_pluck_no_gil>) at thread.c:1287\n#7  rb_thread_call_without_gvl (func=0x7fe8121491f6 <grpc_rb_completion_queue_pluck_no_gil>, data1=0x7fe7f8ccaa60, ubf=<optimized out>, data2=<optimized out>) at thread.c:1397\n#8  0x00007fe812149398 in rb_completion_queue_pluck (queue=0x7fe780017b30, tag=0x7fe7f8ccab00, deadline=..., reserved=0x0) at ../../../../src/ruby/ext/grpc/rb_completion_queue.c:109\n#9  0x00007fe81214ce28 in grpc_rb_call_run_batch (self=42749480, ops_hash=140631590688520) at ../../../../src/ruby/ext/grpc/rb_call.c:824\n#10 0x00007fe81214cff1 in grpc_rb_call_run_batch_debug (self=42749480, ops_hash=140631590688520) at ../../../../src/ruby/ext/grpc/rb_call.c:858\n#11 0x00007fe814b66eb6 in vm_call_cfunc_with_frame (ci=<optimized out>, cc=<optimized out>, calling=<optimized out>, reg_cfp=0x7fe7f8dcce10, th=0x7fe808093ac0) at vm_insnhelper.c:1638\n#12 vm_call_cfunc (th=0x7fe808093ac0, reg_cfp=0x7fe7f8dcce10, calling=<optimized out>, ci=<optimized out>, cc=<optimized out>) at vm_insnhelper.c:1733\n#13 0x00007fe814b71bc9 in vm_exec_core (th=th@entry=0x7fe808093ac0, initial=initial@entry=0) at insns.def:995\n#14 0x00007fe814b75741 in vm_exec (th=th@entry=0x7fe808093ac0) at vm.c:1645\n#15 0x00007fe814b76091 in invoke_bmethod (th=th@entry=0x7fe808093ac0, iseq=iseq@entry=0x23038b8, self=self@entry=43741200, type=type@entry=161, opt_pc=<optimized out>, block=0x2b7b460) at vm.c:938\n#16 0x00007fe814b76205 in invoke_block_from_c_0 (th=0x7fe808093ac0, block=0x2b7b460, self=43741200, argc=<optimized out>, argv=<optimized out>, blockptr=<optimized out>, cref=0x0, splattable=0) at vm.c:969\n#17 0x00007fe814b7656a in invoke_block_from_c_unsplattable (cref=0x0, blockptr=<optimized out>, argv=<optimized out>, argc=<optimized out>, self=<optimized out>, block=<optimized out>, th=0x7fe808093ac0) at vm.c:991\n#18 vm_invoke_bmethod (blockptr=<optimized out>, argv=<optimized out>, argc=<optimized out>, self=<optimized out>, proc=<optimized out>, th=0x7fe808093ac0) at vm.c:1055\n#19 vm_call_bmethod_body (ci=<optimized out>, cc=0x2aaead0, argv=<optimized out>, calling=0x7fe7f8ccb630, th=0x7fe808093ac0) at vm_insnhelper.c:1762\n#20 vm_call_bmethod (th=0x7fe808093ac0, cfp=0x7fe7f8dccf50, calling=0x7fe7f8ccb630, ci=<optimized out>, cc=0x2aaead0) at vm_insnhelper.c:1780\n#21 0x00007fe814b71bc9 in vm_exec_core (th=th@entry=0x7fe808093ac0, initial=initial@entry=0) at insns.def:995\n#22 0x00007fe814b75741 in vm_exec (th=0x7fe808093ac0) at vm.c:1645\n#23 0x00007fe814b75ee3 in invoke_block (th=th@entry=0x7fe808093ac0, iseq=iseq@entry=0x2147c40, self=self@entry=41982800, cref=cref@entry=0x0, type=type@entry=33, opt_pc=0, block=0x7fe808097fa0) at vm.c:916\n#24 0x00007fe814b76281 in invoke_block_from_c_0 (th=0x7fe808093ac0, block=0x7fe808097fa0, self=41982800, argc=<optimized out>, argv=<optimized out>, blockptr=<optimized out>, cref=0x0, splattable=0) at vm.c:966\n#25 0x00007fe814b76358 in invoke_block_from_c_unsplattable (cref=0x0, blockptr=0x0, argv=0x29b5e78, argc=0, self=41982800, block=0x7fe808097fa0, th=0x7fe808093ac0) at vm.c:991\n#26 vm_invoke_proc (th=th@entry=0x7fe808093ac0, proc=proc@entry=0x7fe808097fa0, self=41982800, argc=0, argv=0x29b5e78, blockptr=blockptr@entry=0x0) at vm.c:1039\n#27 0x00007fe814b763f9 in rb_vm_invoke_proc (th=th@entry=0x7fe808093ac0, proc=proc@entry=0x7fe808097fa0, argc=<optimized out>, argv=<optimized out>, blockptr=blockptr@entry=0x0) at vm.c:1067\n#28 0x00007fe814b8cd66 in thread_start_func_2 (th=th@entry=0x7fe808093ac0, stack_start=<optimized out>) at thread.c:584\n#29 0x00007fe814b8d270 in thread_start_func_1 (th_ptr=0x7fe808093ac0) at thread_pthread.c:865\n#30 0x00007fe8143ae184 in start_thread (arg=0x7fe7f8ccc700) at pthread_create.c:312\n#31 0x00007fe8146be37d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\n```\n\nThis appears to happen to about 30 unary calls in the 30 second benchmark time period, mostly on different channels.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/253894714",
    "html_url": "https://github.com/grpc/grpc/issues/8349#issuecomment-253894714",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8349",
    "id": 253894714,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1Mzg5NDcxNA==",
    "user": {
      "login": "apolcyn",
      "id": 9566254,
      "node_id": "MDQ6VXNlcjk1NjYyNTQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9566254?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apolcyn",
      "html_url": "https://github.com/apolcyn",
      "followers_url": "https://api.github.com/users/apolcyn/followers",
      "following_url": "https://api.github.com/users/apolcyn/following{/other_user}",
      "gists_url": "https://api.github.com/users/apolcyn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apolcyn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apolcyn/subscriptions",
      "organizations_url": "https://api.github.com/users/apolcyn/orgs",
      "repos_url": "https://api.github.com/users/apolcyn/repos",
      "events_url": "https://api.github.com/users/apolcyn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apolcyn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-14T19:11:07Z",
    "updated_at": "2016-10-14T19:11:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "to update on the server side, the corresponding server side call completes it's RECV_MESSAGE, RECV_CLOSE_ON_SERVER and SEND_STATUS_FROM_SERVER ops, but the SEND_CLOSE_FROM_CLIENT op is seen as unsuccessful on the client side.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/253913260",
    "html_url": "https://github.com/grpc/grpc/issues/8349#issuecomment-253913260",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8349",
    "id": 253913260,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzkxMzI2MA==",
    "user": {
      "login": "apolcyn",
      "id": 9566254,
      "node_id": "MDQ6VXNlcjk1NjYyNTQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9566254?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apolcyn",
      "html_url": "https://github.com/apolcyn",
      "followers_url": "https://api.github.com/users/apolcyn/followers",
      "following_url": "https://api.github.com/users/apolcyn/following{/other_user}",
      "gists_url": "https://api.github.com/users/apolcyn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apolcyn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apolcyn/subscriptions",
      "organizations_url": "https://api.github.com/users/apolcyn/orgs",
      "repos_url": "https://api.github.com/users/apolcyn/repos",
      "events_url": "https://api.github.com/users/apolcyn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apolcyn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-14T20:38:37Z",
    "updated_at": "2016-10-14T20:38:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "from the GRPC_TRACE logging, a failure can be seen in:\n\n```\n 220785 I1014 13:26:29.504567868  112787 metadata_array.c:47]        grpc_metadata_array_destroy(array=0x7f6533538da8)\n 220786 I1014 13:26:29.504572243  112804 completion_queue.c:252]     grpc_cq_end_op(exec_ctx=0x7f6531316940, cc=0x7f6608023560, tag=0x7f6531316b20, error={\"created\":\"@1476476789.504181269\",\"description\":\"Error in HTTP transport completing operation\",\"file\":\"src/core/ext/transport/c        http2/transport/chttp2_transport.c\",\"file_line\":985,\"referenced_errors\":[{\"created\":\"@1476476789.504177921\",\"description\":\"Failed due to stream removal\",\"file\":\"src/core/ext/transport/chttp2/transport/chttp2_transport.c\",\"file_line\":1622,\"referenced_errors\":[{\"created\":\"@14        76476789.503985450\",\"description\":\"RST_STREAM\",\"file\":\"src/core/ext/transport/chttp2/transport/frame_rst_stream.c\",\"file_line\":107,\"http2_error\":0}]}],\"target_address\":\"ipv6:[::1]:59893\"}, done=0x7f671dad6047, done_arg=0x7f6608023728, storage=0x7f6608023730)\n 220787 I1014 13:26:29.504584197  112787 metadata_array.c:47]        grpc_metadata_array_destroy(array=0x7f6533538dc0)\n 220788 E1014 13:26:29.504600147  112804 completion_queue.c:254]     Operation failed: tag=0x7f6531316b20, error={\"created\":\"@1476476789.504181269\",\"description\":\"Error in HTTP transport completing operation\",\"file\":\"src/core/ext/transport/chttp2/transport/chttp2_transport.c\",\"file        _line\":985,\"referenced_errors\":[{\"created\":\"@1476476789.504177921\",\"description\":\"Failed due to stream removal\",\"file\":\"src/core/ext/transport/chttp2/transport/chttp2_transport.c\",\"file_line\":1622,\"referenced_errors\":[{\"created\":\"@1476476789.503985450\",\"description\":\"RST_ST        REAM\",\"file\":\"src/core/ext/transport/chttp2/transport/frame_rst_stream.c\",\"file_line\":107,\"http2_error\":0}]}],\"target_address\":\"ipv6:[::1]:59893\"}\n 220789 I1014 13:26:29.504611002  112787 metadata_array.c:47]        grpc_metadata_array_destroy(array=0x7f6533538de0)\n 220790 D1014 13:26:29.504631675  112804 combiner.c:239]             C:0x7f6624002f20 grpc_combiner_execute c=0x7f661001d9c0\n 220791 I1014 13:26:29.504633313  112787 metadata_array.c:47]        grpc_metadata_array_destroy(array=0x7f6533538df8)\n 220792 D1014 13:26:29.504654665  112804 combiner.c:207]             C:0x7f6624002f20 finish[0] old_state=3\n 220793 I1014 13:26:29.504675688  112787 call.c:705]                 grpc_call_destroy(c=0x7f65c0006dd0)\n 220794 D1014 13:26:29.504677656  112804 combiner.c:239]             C:0x7f6624002f20 grpc_combiner_execute c=0x7f661001d9f8\n 220795 D1014 13:26:29.504697461  112787 combiner.c:239]             C:0x7f65fc012910 grpc_combiner_execute c=0x7f65c0008708\n 220796 D1014 13:26:29.504701801  112804 combiner.c:271]             C:0x7f6624002f20 grpc_combiner_execute_finally c=0x7f662400dff8 force_async_break=0; ac=0x7f6624002f20\n 220797 D1014 13:26:29.504721634  112787 combiner.c:207]             C:0x7f65fc012910 finish[0] old_state=3\n 220798 D1014 13:26:29.504725038  112804 combiner.c:207]             C:0x7f6624002f20 finish[0] old_state=5\n 220799 I1014 13:26:29.504743974  112787 completion_queue.c:541]     grpc_completion_queue_shutdown(cc=0x7f65c0006c70)\n 220800 D1014 13:26:29.504756091  112804 combiner.c:157]             C:0x7f6624002f20 start_execute_final take_async_break_before_final_list=0\n 220801 I1014 13:26:29.504772013  112787 completion_queue.c:561]     grpc_completion_queue_destroy(cc=0x7f65c0006c70)\n 220802 D1014 13:26:29.504782052  112804 combiner.c:119]             C:0x7f6624002f20 execute_final[0] c=0x7f662400dff8\n 220803 I1014 13:26:29.504795293  112787 completion_queue.c:541]     grpc_completion_queue_shutdown(cc=0x7f65c0006c70)\n 220804 D1014 13:26:29.504808382  112804 combiner.c:207]             C:0x7f6624002f20 finish[1] old_state=3\n}\n```\n\nwhere the tag \"0x7f6531316b20\" in there is the tag of the start_batch with the SEND_CLOSE op, and its the pluck ends up failing just after in:\n\n```\n 220808 I1014 13:26:29.504852088  112804 completion_queue.c:527]    RETURN_EVENT[0x7f6608023560]: OP_COMPLETE: tag:0x7f6531316b20 ERROR\n```\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/273281617",
    "html_url": "https://github.com/grpc/grpc/issues/8349#issuecomment-273281617",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8349",
    "id": 273281617,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MzI4MTYxNw==",
    "user": {
      "login": "apolcyn",
      "id": 9566254,
      "node_id": "MDQ6VXNlcjk1NjYyNTQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9566254?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apolcyn",
      "html_url": "https://github.com/apolcyn",
      "followers_url": "https://api.github.com/users/apolcyn/followers",
      "following_url": "https://api.github.com/users/apolcyn/following{/other_user}",
      "gists_url": "https://api.github.com/users/apolcyn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apolcyn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apolcyn/subscriptions",
      "organizations_url": "https://api.github.com/users/apolcyn/orgs",
      "repos_url": "https://api.github.com/users/apolcyn/repos",
      "events_url": "https://api.github.com/users/apolcyn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apolcyn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-17T19:58:51Z",
    "updated_at": "2017-01-17T19:58:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "Removing this from 1.1 milestone as this is no longer seen on the master branch. \r\n\r\n(error that appeared to be causing it was https://github.com/grpc/grpc/issues/8404)\r\n\r\nLeaving open though, this is an issue on `v1.0.x`."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/389343624",
    "html_url": "https://github.com/grpc/grpc/issues/8349#issuecomment-389343624",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8349",
    "id": 389343624,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4OTM0MzYyNA==",
    "user": {
      "login": "apolcyn",
      "id": 9566254,
      "node_id": "MDQ6VXNlcjk1NjYyNTQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9566254?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apolcyn",
      "html_url": "https://github.com/apolcyn",
      "followers_url": "https://api.github.com/users/apolcyn/followers",
      "following_url": "https://api.github.com/users/apolcyn/following{/other_user}",
      "gists_url": "https://api.github.com/users/apolcyn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apolcyn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apolcyn/subscriptions",
      "organizations_url": "https://api.github.com/users/apolcyn/orgs",
      "repos_url": "https://api.github.com/users/apolcyn/repos",
      "events_url": "https://api.github.com/users/apolcyn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apolcyn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-15T23:13:10Z",
    "updated_at": "2018-05-15T23:13:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "closing as per the last comment, this wasn't seen after the 1.0.x branch, which is over a year old now."
  }
]
