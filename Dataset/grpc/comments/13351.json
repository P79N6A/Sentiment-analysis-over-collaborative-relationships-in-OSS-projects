[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/343562338",
    "html_url": "https://github.com/grpc/grpc/issues/13351#issuecomment-343562338",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13351",
    "id": 343562338,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzU2MjMzOA==",
    "user": {
      "login": "adelez",
      "id": 14932100,
      "node_id": "MDQ6VXNlcjE0OTMyMTAw",
      "avatar_url": "https://avatars3.githubusercontent.com/u/14932100?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/adelez",
      "html_url": "https://github.com/adelez",
      "followers_url": "https://api.github.com/users/adelez/followers",
      "following_url": "https://api.github.com/users/adelez/following{/other_user}",
      "gists_url": "https://api.github.com/users/adelez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/adelez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adelez/subscriptions",
      "organizations_url": "https://api.github.com/users/adelez/orgs",
      "repos_url": "https://api.github.com/users/adelez/repos",
      "events_url": "https://api.github.com/users/adelez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/adelez/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-10T19:20:43Z",
    "updated_at": "2017-11-10T19:20:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi Vijay, feel free to reassign if you are not the best owner."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/345083044",
    "html_url": "https://github.com/grpc/grpc/issues/13351#issuecomment-345083044",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13351",
    "id": 345083044,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NTA4MzA0NA==",
    "user": {
      "login": "vjpai",
      "id": 8864912,
      "node_id": "MDQ6VXNlcjg4NjQ5MTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8864912?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vjpai",
      "html_url": "https://github.com/vjpai",
      "followers_url": "https://api.github.com/users/vjpai/followers",
      "following_url": "https://api.github.com/users/vjpai/following{/other_user}",
      "gists_url": "https://api.github.com/users/vjpai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vjpai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vjpai/subscriptions",
      "organizations_url": "https://api.github.com/users/vjpai/orgs",
      "repos_url": "https://api.github.com/users/vjpai/repos",
      "events_url": "https://api.github.com/users/vjpai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vjpai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-16T22:26:34Z",
    "updated_at": "2017-11-16T22:26:34Z",
    "author_association": "MEMBER",
    "body": "The data race trace indicates that a resource user is being shutdown while it is still being read at another thread:\r\n\r\n```\r\nWARNING: ThreadSanitizer: data race (pid=25439)\r\n  Write of size 1 at 0x7d540000faf8 by thread T3 (mutexes: write M6653):\r\n    #0 grpc_resource_user_alloc /var/local/git/grpc/src/core/lib/iomgr/resource_quota.cc:825:33 (secure_endpoint_test+0x0000004fea8d)\r\n    #1 grpc_resource_user_alloc_slices /var/local/git/grpc/src/core/lib/iomgr/resource_quota.cc:896:3 (secure_endpoint_test+0x0000004ff4c5)\r\n    #2 tcp_continue_read(grpc_exec_ctx*, grpc_tcp*) /var/local/git/grpc/src/core/lib/iomgr/tcp_posix.cc:475:5 (secure_endpoint_test+0x0000004bee30)\r\n    #3 tcp_handle_read(grpc_exec_ctx*, void*, grpc_error*) /var/local/git/grpc/src/core/lib/iomgr/tcp_posix.cc:500:5 (secure_endpoint_test+0x0000004be915)\r\n    #4 exec_ctx_run(grpc_exec_ctx*, grpc_closure*, grpc_error*) /var/local/git/grpc/src/core/lib/iomgr/exec_ctx.cc:70:3 (secure_endpoint_test+0x0000004bade3)\r\n    #5 grpc_exec_ctx_flush /var/local/git/grpc/src/core/lib/iomgr/exec_ctx.cc:90:9 (secure_endpoint_test+0x0000004bab27)\r\n    #6 pollset_work(grpc_exec_ctx*, grpc_pollset*, grpc_pollset_worker**, long) /var/local/git/grpc/src/core/lib/iomgr/ev_epollsig_linux.cc:1367:5 (secure_endpoint_test+0x0000004e8bda)\r\n    #7 grpc_pollset_work /var/local/git/grpc/src/core/lib/iomgr/ev_posix.cc:238:10 (secure_endpoint_test+0x0000004b9de2)\r\n    #8 run_poller(grpc_exec_ctx*, void*, grpc_error*) /var/local/git/grpc/src/core/lib/iomgr/tcp_posix.cc:140:54 (secure_endpoint_test+0x0000004c1966)\r\n    #9 run_closures(grpc_exec_ctx*, grpc_closure_list) /var/local/git/grpc/src/core/lib/iomgr/executor.cc:77:5 (secure_endpoint_test+0x0000004fa1f7)\r\n    #10 executor_thread(void*) /var/local/git/grpc/src/core/lib/iomgr/executor.cc:182:22 (secure_endpoint_test+0x0000004f9f65)\r\n    #11 thread_body(void*) /var/local/git/grpc/src/core/lib/support/thd_posix.cc:42:3 (secure_endpoint_test+0x0000005520ed)\r\n\r\n  Previous read of size 1 at 0x7d540000faf8 by thread T1:\r\n    #0 ru_shutdown(grpc_exec_ctx*, void*, grpc_error*) /var/local/git/grpc/src/core/lib/iomgr/resource_quota.cc:530:22 (secure_endpoint_test+0x0000004fe7b2)\r\n    #1 closure_wrapper(grpc_exec_ctx*, void*, grpc_error*) /var/local/git/grpc/src/core/lib/iomgr/closure.cc:116:3 (secure_endpoint_test+0x0000004b34fe)\r\n    #2 grpc_combiner_continue_exec_ctx /var/local/git/grpc/src/core/lib/iomgr/combiner.cc:261:5 (secure_endpoint_test+0x0000004d5847)\r\n    #3 grpc_exec_ctx_flush /var/local/git/grpc/src/core/lib/iomgr/exec_ctx.cc:93:17 (secure_endpoint_test+0x0000004bab42)\r\n    #4 run_closures(grpc_exec_ctx*, grpc_closure_list) /var/local/git/grpc/src/core/lib/iomgr/executor.cc:81:5 (secure_endpoint_test+0x0000004fa229)\r\n    #5 executor_thread(void*) /var/local/git/grpc/src/core/lib/iomgr/executor.cc:182:22 (secure_endpoint_test+0x0000004f9f65)\r\n    #6 thread_body(void*) /var/local/git/grpc/src/core/lib/support/thd_posix.cc:42:3 (secure_endpoint_test+0x0000005520ed)\r\n\r\n  Location is heap block of size 616 at 0x7d540000fa00 allocated by main thread:\r\n    #0 malloc /llvm/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:595 (secure_endpoint_test+0x000000442e68)\r\n    #1 gpr_malloc /var/local/git/grpc/src/core/lib/support/alloc.cc:56:7 (secure_endpoint_test+0x00000054c63d)\r\n    #2 grpc_resource_user_create /var/local/git/grpc/src/core/lib/iomgr/resource_quota.cc:726:28 (secure_endpoint_test+0x0000004fd43a)\r\n    #3 grpc_tcp_create /var/local/git/grpc/src/core/lib/iomgr/tcp_posix.cc:803:24 (secure_endpoint_test+0x0000004bd42a)\r\n    #4 grpc_iomgr_create_endpoint_pair /var/local/git/grpc/src/core/lib/iomgr/endpoint_pair_posix.cc:60:14 (secure_endpoint_test+0x0000004b44c4)\r\n    #5 secure_endpoint_create_fixture_tcp_socketpair(unsigned long, grpc_slice*, unsigned long, bool) /var/local/git/grpc/test/core/security/secure_endpoint_test.cc:60:9 (secure_endpoint_test+0x0000004b0357)\r\n    #6 secure_endpoint_create_fixture_tcp_socketpair_noleftover(unsigned long) /var/local/git/grpc/test/core/security/secure_endpoint_test.cc:124:10 (secure_endpoint_test+0x0000004b0017)\r\n    #7 begin_test(grpc_endpoint_test_config, char const*, unsigned long) /var/local/git/grpc/test/core/iomgr/endpoint_tests.cc:72:10 (secure_endpoint_test+0x0000004b1d7e)\r\n    #8 read_and_write_test(grpc_endpoint_test_config, unsigned long, unsigned long, unsigned long, bool) /var/local/git/grpc/test/core/iomgr/endpoint_tests.cc:180:7 (secure_endpoint_test+0x0000004b1652)\r\n    #9 grpc_endpoint_tests(grpc_endpoint_test_config, grpc_pollset*, pthread_mutex_t*) /var/local/git/grpc/test/core/iomgr/endpoint_tests.cc:331:3 (secure_endpoint_test+0x0000004b1011)\r\n    #10 main /var/local/git/grpc/test/core/security/secure_endpoint_test.cc:217:3 (secure_endpoint_test+0x0000004af8b6)\r\n\r\n  Mutex M6653 (0x7d540000fab8) created at:\r\n    #0 pthread_mutex_init /llvm/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:1169 (secure_endpoint_test+0x000000436395)\r\n    #1 gpr_mu_init /var/local/git/grpc/src/core/lib/support/sync_posix.cc:36:43 (secure_endpoint_test+0x00000055152c)\r\n    #2 grpc_resource_user_create /var/local/git/grpc/src/core/lib/iomgr/resource_quota.cc:743:3 (secure_endpoint_test+0x0000004fd752)\r\n    #3 grpc_tcp_create /var/local/git/grpc/src/core/lib/iomgr/tcp_posix.cc:803:24 (secure_endpoint_test+0x0000004bd42a)\r\n    #4 grpc_iomgr_create_endpoint_pair /var/local/git/grpc/src/core/lib/iomgr/endpoint_pair_posix.cc:60:14 (secure_endpoint_test+0x0000004b44c4)\r\n    #5 secure_endpoint_create_fixture_tcp_socketpair(unsigned long, grpc_slice*, unsigned long, bool) /var/local/git/grpc/test/core/security/secure_endpoint_test.cc:60:9 (secure_endpoint_test+0x0000004b0357)\r\n    #6 secure_endpoint_create_fixture_tcp_socketpair_noleftover(unsigned long) /var/local/git/grpc/test/core/security/secure_endpoint_test.cc:124:10 (secure_endpoint_test+0x0000004b0017)\r\n    #7 begin_test(grpc_endpoint_test_config, char const*, unsigned long) /var/local/git/grpc/test/core/iomgr/endpoint_tests.cc:72:10 (secure_endpoint_test+0x0000004b1d7e)\r\n    #8 read_and_write_test(grpc_endpoint_test_config, unsigned long, unsigned long, unsigned long, bool) /var/local/git/grpc/test/core/iomgr/endpoint_tests.cc:180:7 (secure_endpoint_test+0x0000004b1652)\r\n    #9 grpc_endpoint_tests(grpc_endpoint_test_config, grpc_pollset*, pthread_mutex_t*) /var/local/git/grpc/test/core/iomgr/endpoint_tests.cc:331:3 (secure_endpoint_test+0x0000004b1011)\r\n    #10 main /var/local/git/grpc/test/core/security/secure_endpoint_test.cc:217:3 (secure_endpoint_test+0x0000004af8b6)\r\n\r\n  Thread T3 (tid=25484, running) created by thread T1 at:\r\n    #0 pthread_create /llvm/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:954 (secure_endpoint_test+0x00000044c543)\r\n    #1 gpr_thd_new /var/local/git/grpc/src/core/lib/support/thd_posix.cc:66:21 (secure_endpoint_test+0x000000551fd3)\r\n    #2 executor_push(grpc_exec_ctx*, grpc_closure*, grpc_error*, bool) /var/local/git/grpc/src/core/lib/iomgr/executor.cc:268:9 (secure_endpoint_test+0x0000004facee)\r\n    #3 executor_push_long(grpc_exec_ctx*, grpc_closure*, grpc_error*) /var/local/git/grpc/src/core/lib/iomgr/executor.cc:286:3 (secure_endpoint_test+0x0000004fae0a)\r\n    #4 grpc_closure_sched /var/local/git/grpc/src/core/lib/iomgr/closure.cc:184:5 (secure_endpoint_test+0x0000004b39ee)\r\n    #5 run_poller(grpc_exec_ctx*, void*, grpc_error*) /var/local/git/grpc/src/core/lib/iomgr/tcp_posix.cc:164:5 (secure_endpoint_test+0x0000004c1bc4)\r\n    #6 run_closures(grpc_exec_ctx*, grpc_closure_list) /var/local/git/grpc/src/core/lib/iomgr/executor.cc:77:5 (secure_endpoint_test+0x0000004fa1f7)\r\n    #7 executor_thread(void*) /var/local/git/grpc/src/core/lib/iomgr/executor.cc:182:22 (secure_endpoint_test+0x0000004f9f65)\r\n    #8 thread_body(void*) /var/local/git/grpc/src/core/lib/support/thd_posix.cc:42:3 (secure_endpoint_test+0x0000005520ed)\r\n\r\n  Thread T1 (tid=25444, running) created by main thread at:\r\n    #0 pthread_create /llvm/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:954 (secure_endpoint_test+0x00000044c543)\r\n    #1 gpr_thd_new /var/local/git/grpc/src/core/lib/support/thd_posix.cc:66:21 (secure_endpoint_test+0x000000551fd3)\r\n    #2 grpc_executor_set_threading /var/local/git/grpc/src/core/lib/iomgr/executor.cc:108:5 (secure_endpoint_test+0x0000004f959a)\r\n    #3 grpc_executor_init /var/local/git/grpc/src/core/lib/iomgr/executor.cc:139:3 (secure_endpoint_test+0x0000004fa2b3)\r\n    #4 grpc_iomgr_init /var/local/git/grpc/src/core/lib/iomgr/iomgr.cc:53:3 (secure_endpoint_test+0x0000004fae8e)\r\n    #5 grpc_init /var/local/git/grpc/src/core/lib/surface/init.cc:154:5 (secure_endpoint_test+0x00000050ad5a)\r\n    #6 main /var/local/git/grpc/test/core/security/secure_endpoint_test.cc:214:3 (secure_endpoint_test+0x0000004af7dd)\r\n\r\nSUMMARY: ThreadSanitizer: data race /var/local/git/grpc/src/core/lib/iomgr/resource_quota.cc:825:33 in grpc_resource_user_alloc\r\n```\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/351832163",
    "html_url": "https://github.com/grpc/grpc/issues/13351#issuecomment-351832163",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13351",
    "id": 351832163,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTgzMjE2Mw==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-14T20:51:55Z",
    "updated_at": "2017-12-14T20:51:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "This is now one of the most reasons why c_tsan is red."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/351832656",
    "html_url": "https://github.com/grpc/grpc/issues/13351#issuecomment-351832656",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13351",
    "id": 351832656,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTgzMjY1Ng==",
    "user": {
      "login": "sreecha",
      "id": 2754995,
      "node_id": "MDQ6VXNlcjI3NTQ5OTU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/2754995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sreecha",
      "html_url": "https://github.com/sreecha",
      "followers_url": "https://api.github.com/users/sreecha/followers",
      "following_url": "https://api.github.com/users/sreecha/following{/other_user}",
      "gists_url": "https://api.github.com/users/sreecha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sreecha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sreecha/subscriptions",
      "organizations_url": "https://api.github.com/users/sreecha/orgs",
      "repos_url": "https://api.github.com/users/sreecha/repos",
      "events_url": "https://api.github.com/users/sreecha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sreecha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-14T20:54:02Z",
    "updated_at": "2017-12-14T20:54:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "I have been looking into this today. will update eod"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/351835264",
    "html_url": "https://github.com/grpc/grpc/issues/13351#issuecomment-351835264",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13351",
    "id": 351835264,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTgzNTI2NA==",
    "user": {
      "login": "ncteisen",
      "id": 6148140,
      "node_id": "MDQ6VXNlcjYxNDgxNDA=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6148140?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ncteisen",
      "html_url": "https://github.com/ncteisen",
      "followers_url": "https://api.github.com/users/ncteisen/followers",
      "following_url": "https://api.github.com/users/ncteisen/following{/other_user}",
      "gists_url": "https://api.github.com/users/ncteisen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ncteisen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ncteisen/subscriptions",
      "organizations_url": "https://api.github.com/users/ncteisen/orgs",
      "repos_url": "https://api.github.com/users/ncteisen/repos",
      "events_url": "https://api.github.com/users/ncteisen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ncteisen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-14T21:04:32Z",
    "updated_at": "2017-12-14T21:04:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think this was fixed in #13773.\r\n\r\nBefore that PR this command would fail withing 10 tests:\r\n```\r\ntools/run_tests/run_tests.py -l c -c tsan -r 'bins/tsan/secure_endpoint_test' -S -n 100\r\n```\r\nAfter it (at HEAD) if runs to completion.\r\n\r\nThough my fix my just be a bandaid which doesn't address the question of why shutdown and alloc were being called concurrently...\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/351836148",
    "html_url": "https://github.com/grpc/grpc/issues/13351#issuecomment-351836148",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13351",
    "id": 351836148,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTgzNjE0OA==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-14T21:07:58Z",
    "updated_at": "2017-12-14T21:07:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ncteisen  thanks for the update! (and for the fix)"
  }
]
