[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/316468740",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-316468740",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 316468740,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxNjQ2ODc0MA==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-07-19T18:02:52Z",
    "updated_at": "2017-07-19T18:02:52Z",
    "author_association": "MEMBER",
    "body": "Are you able to share with us sample code that demonstrates the problem?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/317139675",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-317139675",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 317139675,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxNzEzOTY3NQ==",
    "user": {
      "login": "dctrwatson",
      "id": 395054,
      "node_id": "MDQ6VXNlcjM5NTA1NA==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/395054?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dctrwatson",
      "html_url": "https://github.com/dctrwatson",
      "followers_url": "https://api.github.com/users/dctrwatson/followers",
      "following_url": "https://api.github.com/users/dctrwatson/following{/other_user}",
      "gists_url": "https://api.github.com/users/dctrwatson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dctrwatson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dctrwatson/subscriptions",
      "organizations_url": "https://api.github.com/users/dctrwatson/orgs",
      "repos_url": "https://api.github.com/users/dctrwatson/repos",
      "events_url": "https://api.github.com/users/dctrwatson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dctrwatson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-07-22T00:16:02Z",
    "updated_at": "2017-07-22T00:16:02Z",
    "author_association": "NONE",
    "body": "Example backtrace from a coredump:\r\n```\r\n#0  new_threadstate (interp=0x0, init=1) at Python/pystate.c:202\r\n#1  0x00007feef8328d7c in PyGILState_Ensure () at Python/pystate.c:600\r\n#2  0x00007feef005ff18 in __pyx_pw_4grpc_7_cython_6cygrpc_15CompletionQueue_3poll () from grpc/_cython/cygrpc.so\r\n```"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/317494418",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-317494418",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 317494418,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxNzQ5NDQxOA==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-07-24T17:25:42Z",
    "updated_at": "2017-07-24T17:25:42Z",
    "author_association": "MEMBER",
    "body": "@dctrwatson: are you able to share with us the code that, when run, causes that backtrace to be produced?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/320060460",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-320060460",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 320060460,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMDA2MDQ2MA==",
    "user": {
      "login": "dzbarsky",
      "id": 1565842,
      "node_id": "MDQ6VXNlcjE1NjU4NDI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/1565842?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dzbarsky",
      "html_url": "https://github.com/dzbarsky",
      "followers_url": "https://api.github.com/users/dzbarsky/followers",
      "following_url": "https://api.github.com/users/dzbarsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/dzbarsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dzbarsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dzbarsky/subscriptions",
      "organizations_url": "https://api.github.com/users/dzbarsky/orgs",
      "repos_url": "https://api.github.com/users/dzbarsky/repos",
      "events_url": "https://api.github.com/users/dzbarsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dzbarsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-03T19:00:53Z",
    "updated_at": "2017-08-03T19:00:53Z",
    "author_association": "NONE",
    "body": "@nathanielmanistaatgoogle watson and I haven't been able to get a repro that doesn't involve Dropbox code, I suspect the issue may be that we are actually calling `del` on channel. It seems like somewhere in https://github.com/grpc/grpc/blob/9a69478498232b6b42169f8a1a389b51fb4e03ec/src/python/grpcio/grpc/_channel.py#L964 or lower in the stack you may want to guard against multiple calls (Python does not guarantee __del__ is only called once)"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/320746864",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-320746864",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 320746864,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMDc0Njg2NA==",
    "user": {
      "login": "dzbarsky",
      "id": 1565842,
      "node_id": "MDQ6VXNlcjE1NjU4NDI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/1565842?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dzbarsky",
      "html_url": "https://github.com/dzbarsky",
      "followers_url": "https://api.github.com/users/dzbarsky/followers",
      "following_url": "https://api.github.com/users/dzbarsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/dzbarsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dzbarsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dzbarsky/subscriptions",
      "organizations_url": "https://api.github.com/users/dzbarsky/orgs",
      "repos_url": "https://api.github.com/users/dzbarsky/repos",
      "events_url": "https://api.github.com/users/dzbarsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dzbarsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-07T18:43:22Z",
    "updated_at": "2017-08-07T18:43:22Z",
    "author_association": "NONE",
    "body": "Sorry, I misspoke earlier, this is still a segfault."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/326373285",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-326373285",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 326373285,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNjM3MzI4NQ==",
    "user": {
      "login": "dzbarsky",
      "id": 1565842,
      "node_id": "MDQ6VXNlcjE1NjU4NDI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/1565842?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dzbarsky",
      "html_url": "https://github.com/dzbarsky",
      "followers_url": "https://api.github.com/users/dzbarsky/followers",
      "following_url": "https://api.github.com/users/dzbarsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/dzbarsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dzbarsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dzbarsky/subscriptions",
      "organizations_url": "https://api.github.com/users/dzbarsky/orgs",
      "repos_url": "https://api.github.com/users/dzbarsky/repos",
      "events_url": "https://api.github.com/users/dzbarsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dzbarsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-31T17:53:09Z",
    "updated_at": "2017-08-31T17:53:09Z",
    "author_association": "NONE",
    "body": "We suspect that this may be due to completion queue polling while connection is partially destroyed."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/326392614",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-326392614",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 326392614,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNjM5MjYxNA==",
    "user": {
      "login": "mehrdada",
      "id": 900411,
      "node_id": "MDQ6VXNlcjkwMDQxMQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/900411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mehrdada",
      "html_url": "https://github.com/mehrdada",
      "followers_url": "https://api.github.com/users/mehrdada/followers",
      "following_url": "https://api.github.com/users/mehrdada/following{/other_user}",
      "gists_url": "https://api.github.com/users/mehrdada/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mehrdada/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mehrdada/subscriptions",
      "organizations_url": "https://api.github.com/users/mehrdada/orgs",
      "repos_url": "https://api.github.com/users/mehrdada/repos",
      "events_url": "https://api.github.com/users/mehrdada/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mehrdada/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-31T19:08:25Z",
    "updated_at": "2017-08-31T19:08:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "Running the problematic program under `GRPC_TRACE=api GRPC_VERBOSITY=DEBUG`  environment might help you figure out the sequence of calls to gRPC C Core and that help with coming up with a reduced reproduction test case."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/331202631",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-331202631",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 331202631,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTIwMjYzMQ==",
    "user": {
      "login": "alexbarcelo",
      "id": 665750,
      "node_id": "MDQ6VXNlcjY2NTc1MA==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/665750?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexbarcelo",
      "html_url": "https://github.com/alexbarcelo",
      "followers_url": "https://api.github.com/users/alexbarcelo/followers",
      "following_url": "https://api.github.com/users/alexbarcelo/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexbarcelo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexbarcelo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexbarcelo/subscriptions",
      "organizations_url": "https://api.github.com/users/alexbarcelo/orgs",
      "repos_url": "https://api.github.com/users/alexbarcelo/repos",
      "events_url": "https://api.github.com/users/alexbarcelo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexbarcelo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-21T16:01:31Z",
    "updated_at": "2017-09-21T16:01:31Z",
    "author_association": "NONE",
    "body": "I am not able to provide (yet) a MCVE, but I think that I am having the same issue as OP and I am able to provide some extra feedback.\r\n\r\nThe output at the end of execution is the following:\r\n\r\n```\r\nI0921 17:56:30.233889641   25091 completion_queue.c:620]     cq_end_op_for_next(exec_ctx=0x7f15a50deec0, cq=0x7f159c0014e0, tag=0x7f15a80acec0, error={\"created\":\"@1506009390.233868309\",\"description\":\"Timed out waiting for connection state change\",\"file\":\"src/core/ext/filters/client_channel/channel_connectivity.c\",\"file_line\":131}, done=0x7f15a6f43220, done_arg=0x7f159c001650, storage=0x7f159c001730)\r\nI0921 17:56:30.233931560   25089 completion_queue.c:937]     RETURN_EVENT[0x7f159c0014e0]: OP_COMPLETE: tag:0x7f15a80acec0 ERROR\r\nI0921 17:56:30.233993131   25089 completion_queue.c:1227]    grpc_completion_queue_shutdown(cq=0x7f159c0014e0)\r\nI0921 17:56:30.234006679   25089 completion_queue.c:833]     grpc_completion_queue_next(cq=0x7f159c0014e0, deadline=gpr_timespec { tv_sec: 9223372036854775807, tv_nsec: 0, clock_type: 1 }, reserved=(nil))\r\nI0921 17:56:30.234013734   25089 completion_queue.c:937]     RETURN_EVENT[0x7f159c0014e0]: QUEUE_SHUTDOWN\r\nI0921 17:56:30.234019434   25089 completion_queue.c:1234]    grpc_completion_queue_destroy(cq=0x7f159c0014e0)\r\nI0921 17:56:30.234025213   25089 completion_queue.c:1227]    grpc_completion_queue_shutdown(cq=0x7f159c0014e0)\r\nI0921 17:56:30.234044873   25089 init.c:173]                 grpc_shutdown(void)\r\nI0921 17:56:30.252134743   25073 metadata_array.c:32]        grpc_metadata_array_destroy(array=0x7f15a6c60af8)\r\nI0921 17:56:30.252159413   25073 init.c:173]                 grpc_shutdown(void)\r\nException TypeError: \"'NoneType' object is not callable\" in <bound method Channel.__del__ of <grpc._channel.Channel object at 0x7f15a595a3d0>> ignored\r\nI0921 17:56:30.255251765   25073 completion_queue.c:1227]    grpc_completion_queue_shutdown(cq=0x55aa4dc9e100)\r\nI0921 17:56:30.255408283   25073 completion_queue.c:833]     grpc_completion_queue_next(cq=0x55aa4dc9e100, deadline=gpr_timespec { tv_sec: 9223372036854775807, tv_nsec: 0, clock_type: 1 }, reserved=(nil))\r\nI0921 17:56:30.255440548   25073 completion_queue.c:937]     RETURN_EVENT[0x55aa4dc9e100]: QUEUE_SHUTDOWN\r\nI0921 17:56:30.255464826   25073 completion_queue.c:1234]    grpc_completion_queue_destroy(cq=0x55aa4dc9e100)\r\nI0921 17:56:30.255473318   25073 completion_queue.c:1227]    grpc_completion_queue_shutdown(cq=0x55aa4dc9e100)\r\nI0921 17:56:30.255481604   25073 init.c:173]                 grpc_shutdown(void)\r\nI0921 17:56:30.255506987   25073 channel.c:385]              grpc_channel_destroy(channel=0x55aa4df069c0)\r\nI0921 17:56:30.255897445   25073 init.c:173]                 grpc_shutdown(void)\r\nI0921 17:56:30.255921009   25073 init.c:173]                 grpc_shutdown(void)\r\n```\r\n\r\nA workaround (It Works For Me:tm:) is to explicitly `del` both the channel and the stub. That avoids the `Exception TypeError` message"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/331315731",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-331315731",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 331315731,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTMxNTczMQ==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-22T00:15:40Z",
    "updated_at": "2017-09-22T00:15:40Z",
    "author_association": "MEMBER",
    "body": "I think we now believe that the right solution to this is going to be [implementing explicit object life cycles](https://github.com/grpc/grpc/issues/12531) (we think we can do it without significantly degrading the developer experience)."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/331318226",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-331318226",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 331318226,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTMxODIyNg==",
    "user": {
      "login": "mehrdada",
      "id": 900411,
      "node_id": "MDQ6VXNlcjkwMDQxMQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/900411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mehrdada",
      "html_url": "https://github.com/mehrdada",
      "followers_url": "https://api.github.com/users/mehrdada/followers",
      "following_url": "https://api.github.com/users/mehrdada/following{/other_user}",
      "gists_url": "https://api.github.com/users/mehrdada/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mehrdada/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mehrdada/subscriptions",
      "organizations_url": "https://api.github.com/users/mehrdada/orgs",
      "repos_url": "https://api.github.com/users/mehrdada/repos",
      "events_url": "https://api.github.com/users/mehrdada/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mehrdada/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-22T00:33:29Z",
    "updated_at": "2017-09-22T00:33:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "For the record, I think this old bug might be related to this issue https://github.com/grpc/grpc/issues/10084"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/331346637",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-331346637",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 331346637,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTM0NjYzNw==",
    "user": {
      "login": "dzbarsky",
      "id": 1565842,
      "node_id": "MDQ6VXNlcjE1NjU4NDI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/1565842?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dzbarsky",
      "html_url": "https://github.com/dzbarsky",
      "followers_url": "https://api.github.com/users/dzbarsky/followers",
      "following_url": "https://api.github.com/users/dzbarsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/dzbarsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dzbarsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dzbarsky/subscriptions",
      "organizations_url": "https://api.github.com/users/dzbarsky/orgs",
      "repos_url": "https://api.github.com/users/dzbarsky/repos",
      "events_url": "https://api.github.com/users/dzbarsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dzbarsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-22T04:24:21Z",
    "updated_at": "2017-09-22T04:24:21Z",
    "author_association": "NONE",
    "body": "Not convinced it's the same as https://github.com/grpc/grpc/issues/10084 - we see this with python client talking to go server over a secure connection..."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/331346929",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-331346929",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 331346929,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTM0NjkyOQ==",
    "user": {
      "login": "mehrdada",
      "id": 900411,
      "node_id": "MDQ6VXNlcjkwMDQxMQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/900411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mehrdada",
      "html_url": "https://github.com/mehrdada",
      "followers_url": "https://api.github.com/users/mehrdada/followers",
      "following_url": "https://api.github.com/users/mehrdada/following{/other_user}",
      "gists_url": "https://api.github.com/users/mehrdada/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mehrdada/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mehrdada/subscriptions",
      "organizations_url": "https://api.github.com/users/mehrdada/orgs",
      "repos_url": "https://api.github.com/users/mehrdada/repos",
      "events_url": "https://api.github.com/users/mehrdada/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mehrdada/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-22T04:27:13Z",
    "updated_at": "2017-09-22T04:27:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "@dzbarsky I don't believe the symptom is exactly identical either, but I think the root cause of both might be overreliance of GC to free non-memory resources instead of expecting an explicit close command from user code."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/331349113",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-331349113",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 331349113,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMTM0OTExMw==",
    "user": {
      "login": "dzbarsky",
      "id": 1565842,
      "node_id": "MDQ6VXNlcjE1NjU4NDI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/1565842?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dzbarsky",
      "html_url": "https://github.com/dzbarsky",
      "followers_url": "https://api.github.com/users/dzbarsky/followers",
      "following_url": "https://api.github.com/users/dzbarsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/dzbarsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dzbarsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dzbarsky/subscriptions",
      "organizations_url": "https://api.github.com/users/dzbarsky/orgs",
      "repos_url": "https://api.github.com/users/dzbarsky/repos",
      "events_url": "https://api.github.com/users/dzbarsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dzbarsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-22T04:47:44Z",
    "updated_at": "2017-09-22T04:47:44Z",
    "author_association": "NONE",
    "body": "That's a very generic problem, but sure, we'd love an explicit Close method."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/336288433",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-336288433",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 336288433,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNjI4ODQzMw==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-12T22:05:47Z",
    "updated_at": "2017-10-12T22:05:47Z",
    "author_association": "MEMBER",
    "body": "@dctrwatson: was it you with whom we spoke during the community meeting today? Does @alexbarcelo's [workaround of explicitly deleting the channel (and everything that holds a reference to the channel, which in practice means at least the stub too)](https://github.com/grpc/grpc/issues/11804#issuecomment-331202631) resolve this for you too? Deterministically, or is there still some fuzz (like if you keep a reference to the `response_iterator` of a live RPC - of course the deletion of the channel causes the RPC to be canceled, but does merely holding the `response_iterator` object trigger the segfault?)?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/336311073",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-336311073",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 336311073,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNjMxMTA3Mw==",
    "user": {
      "login": "dzbarsky",
      "id": 1565842,
      "node_id": "MDQ6VXNlcjE1NjU4NDI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/1565842?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dzbarsky",
      "html_url": "https://github.com/dzbarsky",
      "followers_url": "https://api.github.com/users/dzbarsky/followers",
      "following_url": "https://api.github.com/users/dzbarsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/dzbarsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dzbarsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dzbarsky/subscriptions",
      "organizations_url": "https://api.github.com/users/dzbarsky/orgs",
      "repos_url": "https://api.github.com/users/dzbarsky/repos",
      "events_url": "https://api.github.com/users/dzbarsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dzbarsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-12T23:43:51Z",
    "updated_at": "2017-10-12T23:43:51Z",
    "author_association": "NONE",
    "body": "@nathanielmanistaatgoogle No, that was me. We ended up implementing refcounting on top of grpc channel to prevent it from getting deleted while there are in-flight RPCs. It's not really practical to `del` every channel because a multi-million line of code application has channels open to lots of different services. Also there's no reason to delete the stub (we wrote custom stubs that don't hold any reference to the channel). It's pretty hard to tell if anything we try helps with the segfault since the probability seems pretty low (think 1 in a million), but at our scale we see it happen very frequently.\r\n\r\nI saw some PRs go by that changed the shutdown ordering (sounded like internal google teams were also hitting issues), it's possible those would help or that the ordering needs further tweaks. The ideal scenario from our point of view would be for the refcounting to happen at your layer and when we call Close that just derefs the original ref. Or don't try to clean up so hard during interpreter shutdown :)"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/345406174",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-345406174",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 345406174,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NTQwNjE3NA==",
    "user": {
      "login": "kpayson64",
      "id": 18316330,
      "node_id": "MDQ6VXNlcjE4MzE2MzMw",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18316330?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kpayson64",
      "html_url": "https://github.com/kpayson64",
      "followers_url": "https://api.github.com/users/kpayson64/followers",
      "following_url": "https://api.github.com/users/kpayson64/following{/other_user}",
      "gists_url": "https://api.github.com/users/kpayson64/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kpayson64/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kpayson64/subscriptions",
      "organizations_url": "https://api.github.com/users/kpayson64/orgs",
      "repos_url": "https://api.github.com/users/kpayson64/repos",
      "events_url": "https://api.github.com/users/kpayson64/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kpayson64/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-18T01:13:16Z",
    "updated_at": "2017-11-18T01:13:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "@dzbarsky \r\nThe error is really bizarre, if I had to guess, the _moot() function is getting destroyed as part of Python's cleanup (and set to None).\r\n\r\nWould it be possible to try the following patch and see what the output is?\r\nhttps://github.com/grpc/grpc/commit/238e36c8b5a6376e17bb8dc90b4b7b2ce63eb26e"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/346196587",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-346196587",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 346196587,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NjE5NjU4Nw==",
    "user": {
      "login": "dzbarsky",
      "id": 1565842,
      "node_id": "MDQ6VXNlcjE1NjU4NDI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/1565842?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dzbarsky",
      "html_url": "https://github.com/dzbarsky",
      "followers_url": "https://api.github.com/users/dzbarsky/followers",
      "following_url": "https://api.github.com/users/dzbarsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/dzbarsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dzbarsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dzbarsky/subscriptions",
      "organizations_url": "https://api.github.com/users/dzbarsky/orgs",
      "repos_url": "https://api.github.com/users/dzbarsky/repos",
      "events_url": "https://api.github.com/users/dzbarsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dzbarsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-21T23:38:05Z",
    "updated_at": "2017-11-21T23:38:05Z",
    "author_association": "NONE",
    "body": "@kpayson64 Nope, we see the same problem with the patch. At this point the cleanest way forward would be to provide an explicit `Close` api on the channel as suggested previously in this issue. Is there an ETA for this?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/347758061",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-347758061",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 347758061,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0Nzc1ODA2MQ==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-29T05:35:19Z",
    "updated_at": "2017-11-29T05:35:19Z",
    "author_association": "MEMBER",
    "body": "@dzbarsky: the ETA for [issue 12531](https://github.com/grpc/grpc/issues/12531) is \"days\". Probably between seven and fourteen of them?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/347759563",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-347759563",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 347759563,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0Nzc1OTU2Mw==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-29T05:46:15Z",
    "updated_at": "2017-11-29T05:46:15Z",
    "author_association": "MEMBER",
    "body": "Something slightly head-desky that occurred to me today in the course of working on [issue 12531](https://github.com/grpc/grpc/issues/12531) is that in the current implementation `grpc.ChannelCredentials` and `grpc.CallCredentials` instances maintain references to gRPC Core structures throughout their entire lifetimes (and that means that they do a `grpc_init` when they are instantiated and a `grpc_shutdown` when (or _if_) they are garbage collected).\r\n\r\n@dzbarsky and others affected by this issue: take a look at your code and see if you're assigning any `grpc.ChannelCredentials` or `grpc.CallCredentials` instances to any \"forever\" fields (like module-scope constants or global variables or whatnot). That _could_ be a source of interpreter-shutdown-time shenanigans like what's going on in this issue and would (or at least could) affect code that otherwise responsibly shuts down use of and deletes all instances of all other kinds of gRPC Python code elements (specifically `grpc.Channel` instances).\r\n\r\n(Or maybe I'm wrong and this is just me sending y'all on a goose chase, in which case: sorry!)"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/348723717",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-348723717",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 348723717,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODcyMzcxNw==",
    "user": {
      "login": "dzbarsky",
      "id": 1565842,
      "node_id": "MDQ6VXNlcjE1NjU4NDI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/1565842?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dzbarsky",
      "html_url": "https://github.com/dzbarsky",
      "followers_url": "https://api.github.com/users/dzbarsky/followers",
      "following_url": "https://api.github.com/users/dzbarsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/dzbarsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dzbarsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dzbarsky/subscriptions",
      "organizations_url": "https://api.github.com/users/dzbarsky/orgs",
      "repos_url": "https://api.github.com/users/dzbarsky/repos",
      "events_url": "https://api.github.com/users/dzbarsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dzbarsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-02T22:08:32Z",
    "updated_at": "2017-12-02T22:08:32Z",
    "author_association": "NONE",
    "body": "@nathanielmanistaatgoogle ok, it would be great if you could get it in before 1.8 (or backport soon after).\r\n\r\n@kpayson64 By the way, I think you're right that the moot function is getting destroyed, that should probably be fixed anyway if this code remains. Interpreter removes vars with _ prefix first. See https://docs.python.org/2/reference/datamodel.html#object.__del__"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/351546650",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-351546650",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 351546650,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTU0NjY1MA==",
    "user": {
      "login": "alexmv",
      "id": 28347,
      "node_id": "MDQ6VXNlcjI4MzQ3",
      "avatar_url": "https://avatars2.githubusercontent.com/u/28347?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexmv",
      "html_url": "https://github.com/alexmv",
      "followers_url": "https://api.github.com/users/alexmv/followers",
      "following_url": "https://api.github.com/users/alexmv/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexmv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexmv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexmv/subscriptions",
      "organizations_url": "https://api.github.com/users/alexmv/orgs",
      "repos_url": "https://api.github.com/users/alexmv/repos",
      "events_url": "https://api.github.com/users/alexmv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexmv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-13T22:32:24Z",
    "updated_at": "2017-12-13T22:32:24Z",
    "author_association": "NONE",
    "body": "Any progress on this?  We're getting bitten by this more frequently of late -- certainly more than the 1 in a million estimate above.\r\n\r\nThanks!"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/354622557",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-354622557",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 354622557,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NDYyMjU1Nw==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-31T20:31:29Z",
    "updated_at": "2017-12-31T20:31:29Z",
    "author_association": "MEMBER",
    "body": "@alexmv: progress is happening incrementally and steadily in [issue 12531](https://github.com/grpc/grpc/issues/12531) and we believe that solving [issue 12531](https://github.com/grpc/grpc/issues/12531) will also solve this issue. Look for the solution to land in 1.9.0? Possibly in 1.8.x."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/354947868",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-354947868",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 354947868,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NDk0Nzg2OA==",
    "user": {
      "login": "alexmv",
      "id": 28347,
      "node_id": "MDQ6VXNlcjI4MzQ3",
      "avatar_url": "https://avatars2.githubusercontent.com/u/28347?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexmv",
      "html_url": "https://github.com/alexmv",
      "followers_url": "https://api.github.com/users/alexmv/followers",
      "following_url": "https://api.github.com/users/alexmv/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexmv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexmv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexmv/subscriptions",
      "organizations_url": "https://api.github.com/users/alexmv/orgs",
      "repos_url": "https://api.github.com/users/alexmv/repos",
      "events_url": "https://api.github.com/users/alexmv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexmv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-03T07:02:54Z",
    "updated_at": "2018-01-03T07:02:54Z",
    "author_association": "NONE",
    "body": "Thanks for the update!  I'll follow along there."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/367140406",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-367140406",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 367140406,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NzE0MDQwNg==",
    "user": {
      "login": "aamitdb",
      "id": 30242850,
      "node_id": "MDQ6VXNlcjMwMjQyODUw",
      "avatar_url": "https://avatars0.githubusercontent.com/u/30242850?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aamitdb",
      "html_url": "https://github.com/aamitdb",
      "followers_url": "https://api.github.com/users/aamitdb/followers",
      "following_url": "https://api.github.com/users/aamitdb/following{/other_user}",
      "gists_url": "https://api.github.com/users/aamitdb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aamitdb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aamitdb/subscriptions",
      "organizations_url": "https://api.github.com/users/aamitdb/orgs",
      "repos_url": "https://api.github.com/users/aamitdb/repos",
      "events_url": "https://api.github.com/users/aamitdb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aamitdb/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-20T22:18:57Z",
    "updated_at": "2018-02-20T22:18:57Z",
    "author_association": "NONE",
    "body": "The specific segfaults we hit ended up being a python issue. When a daemon thread wakes up while main thread is past _PyGILState_Fini and tries to reaccquire the gil (what the completion queue threads do), it was possible to segfault because `autoInterpreterState` was NULL. This issue exists in the 2.7 branch with the general daemon thread shutdown patch (from https://bugs.python.org/issue1856) backported, not tested in 3.x."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/379903640",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-379903640",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 379903640,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3OTkwMzY0MA==",
    "user": {
      "login": "meawoppl",
      "id": 579782,
      "node_id": "MDQ6VXNlcjU3OTc4Mg==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/579782?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/meawoppl",
      "html_url": "https://github.com/meawoppl",
      "followers_url": "https://api.github.com/users/meawoppl/followers",
      "following_url": "https://api.github.com/users/meawoppl/following{/other_user}",
      "gists_url": "https://api.github.com/users/meawoppl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/meawoppl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/meawoppl/subscriptions",
      "organizations_url": "https://api.github.com/users/meawoppl/orgs",
      "repos_url": "https://api.github.com/users/meawoppl/repos",
      "events_url": "https://api.github.com/users/meawoppl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/meawoppl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-09T21:44:16Z",
    "updated_at": "2018-04-09T21:44:16Z",
    "author_association": "NONE",
    "body": "Certainly related to https://github.com/grpc/grpc/issues/12531.  This is the biggest source of flakes in our CI at the moment."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/389345967",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-389345967",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 389345967,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4OTM0NTk2Nw==",
    "user": {
      "login": "kpayson64",
      "id": 18316330,
      "node_id": "MDQ6VXNlcjE4MzE2MzMw",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18316330?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kpayson64",
      "html_url": "https://github.com/kpayson64",
      "followers_url": "https://api.github.com/users/kpayson64/followers",
      "following_url": "https://api.github.com/users/kpayson64/following{/other_user}",
      "gists_url": "https://api.github.com/users/kpayson64/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kpayson64/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kpayson64/subscriptions",
      "organizations_url": "https://api.github.com/users/kpayson64/orgs",
      "repos_url": "https://api.github.com/users/kpayson64/repos",
      "events_url": "https://api.github.com/users/kpayson64/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kpayson64/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-15T23:26:26Z",
    "updated_at": "2018-05-15T23:26:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "A ```close()``` API has been included in the 1.12 release.\r\n\r\nFeel free to re-open if this doesn't meet the needs of this issue."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/450242514",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-450242514",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 450242514,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MDI0MjUxNA==",
    "user": {
      "login": "ericgribkoff",
      "id": 5067076,
      "node_id": "MDQ6VXNlcjUwNjcwNzY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/5067076?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ericgribkoff",
      "html_url": "https://github.com/ericgribkoff",
      "followers_url": "https://api.github.com/users/ericgribkoff/followers",
      "following_url": "https://api.github.com/users/ericgribkoff/following{/other_user}",
      "gists_url": "https://api.github.com/users/ericgribkoff/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ericgribkoff/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ericgribkoff/subscriptions",
      "organizations_url": "https://api.github.com/users/ericgribkoff/orgs",
      "repos_url": "https://api.github.com/users/ericgribkoff/repos",
      "events_url": "https://api.github.com/users/ericgribkoff/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ericgribkoff/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-27T22:28:26Z",
    "updated_at": "2018-12-27T22:28:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "Reopening this. While users explicitly closing their channels and stopping their servers is recommended, seg faults when they decline to do so is bad and remains unresolved.\r\n\r\nInterestingly, our own tests began hitting similar-looking [issues](https://github.com/grpc/grpc/issues/15308) immediately after the `grpc.channel.close()` API was introduced."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/466562915",
    "html_url": "https://github.com/grpc/grpc/issues/11804#issuecomment-466562915",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11804",
    "id": 466562915,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NjU2MjkxNQ==",
    "user": {
      "login": "ericgribkoff",
      "id": 5067076,
      "node_id": "MDQ6VXNlcjUwNjcwNzY=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/5067076?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ericgribkoff",
      "html_url": "https://github.com/ericgribkoff",
      "followers_url": "https://api.github.com/users/ericgribkoff/followers",
      "following_url": "https://api.github.com/users/ericgribkoff/following{/other_user}",
      "gists_url": "https://api.github.com/users/ericgribkoff/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ericgribkoff/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ericgribkoff/subscriptions",
      "organizations_url": "https://api.github.com/users/ericgribkoff/orgs",
      "repos_url": "https://api.github.com/users/ericgribkoff/repos",
      "events_url": "https://api.github.com/users/ericgribkoff/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ericgribkoff/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-22T22:00:17Z",
    "updated_at": "2019-02-22T22:00:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "@lidizheng @gnossen https://github.com/grpc/grpc/pull/17621 was my ill-fated attempt to fix this. Basically daemon threads that have released the GIL (in our code, polling the completion queue) are prone to segfault when the interpreter is shutting down. There's a much longer discussion on the PR itself, but in short the segfault occurs in CPython, not in our code, so the only reasonable fix seems to be not using daemon threads - which means that applications attempting to exit without shutting down their clients/servers would be unable to exit (as opposed to the current behavior of segfaulting)."
  }
]
