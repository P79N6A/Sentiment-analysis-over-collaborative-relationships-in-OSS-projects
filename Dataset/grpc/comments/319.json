[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/72492683",
    "html_url": "https://github.com/grpc/grpc/issues/319#issuecomment-72492683",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/319",
    "id": 72492683,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNDkyNjgz",
    "user": {
      "login": "ctiller",
      "id": 10120821,
      "node_id": "MDQ6VXNlcjEwMTIwODIx",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10120821?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ctiller",
      "html_url": "https://github.com/ctiller",
      "followers_url": "https://api.github.com/users/ctiller/followers",
      "following_url": "https://api.github.com/users/ctiller/following{/other_user}",
      "gists_url": "https://api.github.com/users/ctiller/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ctiller/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ctiller/subscriptions",
      "organizations_url": "https://api.github.com/users/ctiller/orgs",
      "repos_url": "https://api.github.com/users/ctiller/repos",
      "events_url": "https://api.github.com/users/ctiller/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ctiller/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-02-02T16:56:55Z",
    "updated_at": "2015-02-02T16:56:55Z",
    "author_association": "MEMBER",
    "body": "Repro:\ntools/run_tests/run_tests.py -c tsan -l c\n\n# Sample race:\n\nWARNING: ThreadSanitizer: data race (pid=10699)\n  Write of size 8 at 0x7d2c0000ae80 by thread T2:\n    #0 lh_retrieve <null>:0 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001af8f7)\n    #1 def_get_class <null>:0 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001a3b55)\n    #2 int_free_ex_data <null>:0 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001a37f9)\n    #3 CRYPTO_free_ex_data <null>:0 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001a2da2)\n    #4 SSL_free <null>:0 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001ef9bb)\n    #5 ssl_protector_destroy /usr/local/google/home/ctiller/grpc-ct2/src/core/tsi/ssl_transport_security.c:702 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x00000011f48f)\n    #6 tsi_frame_protector_destroy /usr/local/google/home/ctiller/grpc-ct2/src/core/tsi/transport_security.c:134 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x00000012c572)\n    #7 destroy /usr/local/google/home/ctiller/grpc-ct2/src/core/security/secure_endpoint.c:72 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001e26e8)\n    #8 secure_endpoint_unref /usr/local/google/home/ctiller/grpc-ct2/src/core/security/secure_endpoint.c:84 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001e2699)\n    #9 call_read_cb /usr/local/google/home/ctiller/grpc-ct2/src/core/security/secure_endpoint.c:109 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001e2fd0)\n    #10 on_read /usr/local/google/home/ctiller/grpc-ct2/src/core/security/secure_endpoint.c:183 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001e2e3d)\n    #11 call_read_cb /usr/local/google/home/ctiller/grpc-ct2/src/core/iomgr/tcp_posix.c:306 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x00000012aa3b)\n    #12 grpc_tcp_handle_read /usr/local/google/home/ctiller/grpc-ct2/src/core/iomgr/tcp_posix.c:327 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x00000012a8d3)\n    #13 background_callback_executor /usr/local/google/home/ctiller/grpc-ct2/src/core/iomgr/iomgr.c:71 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000000f2e11)\n    #14 thread_body /usr/local/google/home/ctiller/grpc-ct2/src/core/support/thd_posix.c:57 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000002b811b)\n\n  Previous write of size 8 at 0x7d2c0000ae80 by main thread:\n    [failed to restore the stack]\n\n  Location is heap block of size 176 at 0x7d2c0000adf0 allocated by main thread:\n    #0 malloc <null>:0 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x00000008b2fd)\n    #1 default_malloc_ex <null>:0 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001b2946)\n    #2 CRYPTO_malloc <null>:0 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001b32fc)\n    #3 lh_new <null>:0 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001aea2f)\n    #4 def_get_class <null>:0 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001a3ad3)\n    #5 int_get_new_index <null>:0 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001a3104)\n    #6 CRYPTO_get_ex_new_index <null>:0 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001a2b03)\n    #7 X509_STORE_CTX_get_ex_new_index <null>:0 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x00000013c11e)\n    #8 SSL_get_ex_data_X509_STORE_CTX_idx <null>:0 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001e79aa)\n    #9 SSL_CTX_new <null>:0 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000001f3c0a)\n    #10 tsi_create_ssl_client_handshaker_factory /usr/local/google/home/ctiller/grpc-ct2/src/core/tsi/ssl_transport_security.c:1104 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x00000011cbc8)\n    #11 grpc_ssl_channel_security_context_create /usr/local/google/home/ctiller/grpc-ct2/src/core/security/security_context.c:360 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x000000111901)\n    #12 grpc_ssl_channel_create /usr/local/google/home/ctiller/grpc-ct2/src/core/security/security_context.c:459 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x000000111e0c)\n    #13 grpc_secure_channel_create_with_factories /usr/local/google/home/ctiller/grpc-ct2/src/core/security/security_context.c:507 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x00000011205e)\n    #14 grpc_secure_channel_create /usr/local/google/home/ctiller/grpc-ct2/src/core/security/factories.c:50 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000000f1b9e)\n    #15 chttp2_init_client_secure_fullstack /usr/local/google/home/ctiller/grpc-ct2/test/core/end2end/fixtures/chttp2_simple_ssl_fullstack.c:74 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000000e7a61)\n    #16 chttp2_init_client_simple_ssl_secure_fullstack /usr/local/google/home/ctiller/grpc-ct2/test/core/end2end/fixtures/chttp2_simple_ssl_fullstack.c:108 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000000e7897)\n    #17 disappearing_server_test /usr/local/google/home/ctiller/grpc-ct2/test/core/end2end/tests/disappearing_server.c:146 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000000e7bab)\n    #18 grpc_end2end_tests /usr/local/google/home/ctiller/grpc-ct2/test/core/end2end/tests/disappearing_server.c:165 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000000e7b01)\n    #19 main /usr/local/google/home/ctiller/grpc-ct2/test/core/end2end/fixtures/chttp2_simple_ssl_fullstack.c:137 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000000e772f)\n\n  Thread T2 (tid=10710, running) created by main thread at:\n    #0 pthread_create <null>:0 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x00000008f1d1)\n    #1 gpr_thd_new /usr/local/google/home/ctiller/grpc-ct2/src/core/support/thd_posix.c:71 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000002b803d)\n    #2 grpc_iomgr_init /usr/local/google/home/ctiller/grpc-ct2/src/core/iomgr/iomgr.c:93 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000000f2cb3)\n    #3 grpc_init /usr/local/google/home/ctiller/grpc-ct2/src/core/surface/init.c:39 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000000f2bf1)\n    #4 main /usr/local/google/home/ctiller/grpc-ct2/test/core/end2end/fixtures/chttp2_simple_ssl_fullstack.c:134 (chttp2_simple_ssl_fullstack_disappearing_server_test+0x0000000e7707)\n\n# SUMMARY: ThreadSanitizer: data race ??:0 lh_retrieve\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/72492858",
    "html_url": "https://github.com/grpc/grpc/issues/319#issuecomment-72492858",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/319",
    "id": 72492858,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNDkyODU4",
    "user": {
      "login": "ctiller",
      "id": 10120821,
      "node_id": "MDQ6VXNlcjEwMTIwODIx",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10120821?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ctiller",
      "html_url": "https://github.com/ctiller",
      "followers_url": "https://api.github.com/users/ctiller/followers",
      "following_url": "https://api.github.com/users/ctiller/following{/other_user}",
      "gists_url": "https://api.github.com/users/ctiller/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ctiller/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ctiller/subscriptions",
      "organizations_url": "https://api.github.com/users/ctiller/orgs",
      "repos_url": "https://api.github.com/users/ctiller/repos",
      "events_url": "https://api.github.com/users/ctiller/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ctiller/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-02-02T16:57:41Z",
    "updated_at": "2015-02-02T16:57:41Z",
    "author_association": "MEMBER",
    "body": "@nicolasnoble @dklempner if anyone has some thoughts\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/72503680",
    "html_url": "https://github.com/grpc/grpc/issues/319#issuecomment-72503680",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/319",
    "id": 72503680,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNTAzNjgw",
    "user": {
      "login": "jboeuf",
      "id": 6262765,
      "node_id": "MDQ6VXNlcjYyNjI3NjU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6262765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jboeuf",
      "html_url": "https://github.com/jboeuf",
      "followers_url": "https://api.github.com/users/jboeuf/followers",
      "following_url": "https://api.github.com/users/jboeuf/following{/other_user}",
      "gists_url": "https://api.github.com/users/jboeuf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jboeuf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jboeuf/subscriptions",
      "organizations_url": "https://api.github.com/users/jboeuf/orgs",
      "repos_url": "https://api.github.com/users/jboeuf/repos",
      "events_url": "https://api.github.com/users/jboeuf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jboeuf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-02-02T17:56:00Z",
    "updated_at": "2015-02-02T17:56:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "We haven't hooked these up:\nhttps://www.openssl.org/docs/crypto/CRYPTO_lock.html\n\nI definitely think it's worth a try which I plan on doing this week.\n\nCheers,\n\n```\nJulien.\n```\n\nOn Mon, Feb 2, 2015 at 8:57 AM, Craig Tiller notifications@github.com\nwrote:\n\n> @nicolasnoble https://github.com/nicolasnoble @dklempner\n> https://github.com/dklempner if anyone has some thoughts\n> \n> —\n> Reply to this email directly or view it on GitHub\n> https://github.com/google/grpc/issues/319#issuecomment-72492858.\n"
  }
]
