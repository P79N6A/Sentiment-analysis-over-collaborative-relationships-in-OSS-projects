[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/257717673",
    "html_url": "https://github.com/grpc/grpc/issues/8603#issuecomment-257717673",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8603",
    "id": 257717673,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NzcxNzY3Mw==",
    "user": {
      "login": "murgatroid99",
      "id": 961599,
      "node_id": "MDQ6VXNlcjk2MTU5OQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/961599?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/murgatroid99",
      "html_url": "https://github.com/murgatroid99",
      "followers_url": "https://api.github.com/users/murgatroid99/followers",
      "following_url": "https://api.github.com/users/murgatroid99/following{/other_user}",
      "gists_url": "https://api.github.com/users/murgatroid99/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/murgatroid99/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/murgatroid99/subscriptions",
      "organizations_url": "https://api.github.com/users/murgatroid99/orgs",
      "repos_url": "https://api.github.com/users/murgatroid99/repos",
      "events_url": "https://api.github.com/users/murgatroid99/events{/privacy}",
      "received_events_url": "https://api.github.com/users/murgatroid99/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-01T22:25:44Z",
    "updated_at": "2016-11-01T22:25:44Z",
    "author_association": "MEMBER",
    "body": "For the record, Ruby currently uses the second solution that you list. If the thread pool is full, the server responds with RESOURCE_EXHAUSTED.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/257719817",
    "html_url": "https://github.com/grpc/grpc/issues/8603#issuecomment-257719817",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8603",
    "id": 257719817,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NzcxOTgxNw==",
    "user": {
      "login": "vjpai",
      "id": 8864912,
      "node_id": "MDQ6VXNlcjg4NjQ5MTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8864912?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vjpai",
      "html_url": "https://github.com/vjpai",
      "followers_url": "https://api.github.com/users/vjpai/followers",
      "following_url": "https://api.github.com/users/vjpai/following{/other_user}",
      "gists_url": "https://api.github.com/users/vjpai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vjpai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vjpai/subscriptions",
      "organizations_url": "https://api.github.com/users/vjpai/orgs",
      "repos_url": "https://api.github.com/users/vjpai/repos",
      "events_url": "https://api.github.com/users/vjpai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vjpai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-01T22:35:48Z",
    "updated_at": "2016-11-01T22:35:48Z",
    "author_association": "MEMBER",
    "body": "@murgatroid99 - only if the queue is full too in the current version.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/258019372",
    "html_url": "https://github.com/grpc/grpc/issues/8603#issuecomment-258019372",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8603",
    "id": 258019372,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODAxOTM3Mg==",
    "user": {
      "login": "vjpai",
      "id": 8864912,
      "node_id": "MDQ6VXNlcjg4NjQ5MTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8864912?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vjpai",
      "html_url": "https://github.com/vjpai",
      "followers_url": "https://api.github.com/users/vjpai/followers",
      "following_url": "https://api.github.com/users/vjpai/following{/other_user}",
      "gists_url": "https://api.github.com/users/vjpai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vjpai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vjpai/subscriptions",
      "organizations_url": "https://api.github.com/users/vjpai/orgs",
      "repos_url": "https://api.github.com/users/vjpai/repos",
      "events_url": "https://api.github.com/users/vjpai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vjpai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-02T22:30:35Z",
    "updated_at": "2016-11-02T22:30:35Z",
    "author_association": "MEMBER",
    "body": "I have just confirmed that the v1.0.x pool, though very different, also has the same issue. If each side has all of its worker threads processing RPCs that call into the other side, those RPCs get queued on the other side and don't get out.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/258019763",
    "html_url": "https://github.com/grpc/grpc/issues/8603#issuecomment-258019763",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8603",
    "id": 258019763,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODAxOTc2Mw==",
    "user": {
      "login": "vjpai",
      "id": 8864912,
      "node_id": "MDQ6VXNlcjg4NjQ5MTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8864912?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vjpai",
      "html_url": "https://github.com/vjpai",
      "followers_url": "https://api.github.com/users/vjpai/followers",
      "following_url": "https://api.github.com/users/vjpai/following{/other_user}",
      "gists_url": "https://api.github.com/users/vjpai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vjpai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vjpai/subscriptions",
      "organizations_url": "https://api.github.com/users/vjpai/orgs",
      "repos_url": "https://api.github.com/users/vjpai/repos",
      "events_url": "https://api.github.com/users/vjpai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vjpai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-02T22:32:09Z",
    "updated_at": "2016-11-03T15:23:07Z",
    "author_association": "MEMBER",
    "body": "CachedThreadPool is an ok choice if you let it have unlimited max pool size, but if you cap the pool size to allow for resource exhaustion triggers, even this won't do the job because it also has a mandatory waiting queue associated with it . Even a waiting queue of 1 can lead to a deadlock if the cyclic dependence spans multiple resources.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/258039278",
    "html_url": "https://github.com/grpc/grpc/issues/8603#issuecomment-258039278",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8603",
    "id": 258039278,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODAzOTI3OA==",
    "user": {
      "login": "soltanmm-google",
      "id": 21180148,
      "node_id": "MDQ6VXNlcjIxMTgwMTQ4",
      "avatar_url": "https://avatars2.githubusercontent.com/u/21180148?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/soltanmm-google",
      "html_url": "https://github.com/soltanmm-google",
      "followers_url": "https://api.github.com/users/soltanmm-google/followers",
      "following_url": "https://api.github.com/users/soltanmm-google/following{/other_user}",
      "gists_url": "https://api.github.com/users/soltanmm-google/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/soltanmm-google/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/soltanmm-google/subscriptions",
      "organizations_url": "https://api.github.com/users/soltanmm-google/orgs",
      "repos_url": "https://api.github.com/users/soltanmm-google/repos",
      "events_url": "https://api.github.com/users/soltanmm-google/events{/privacy}",
      "received_events_url": "https://api.github.com/users/soltanmm-google/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-03T00:25:55Z",
    "updated_at": "2016-11-03T00:25:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "@nathanielmanistaatgoogle We don't appear to use `RESOURCE_EXHAUSTED` in the suggested way. Do we?\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/258050253",
    "html_url": "https://github.com/grpc/grpc/issues/8603#issuecomment-258050253",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8603",
    "id": 258050253,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODA1MDI1Mw==",
    "user": {
      "login": "vjpai",
      "id": 8864912,
      "node_id": "MDQ6VXNlcjg4NjQ5MTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8864912?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vjpai",
      "html_url": "https://github.com/vjpai",
      "followers_url": "https://api.github.com/users/vjpai/followers",
      "following_url": "https://api.github.com/users/vjpai/following{/other_user}",
      "gists_url": "https://api.github.com/users/vjpai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vjpai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vjpai/subscriptions",
      "organizations_url": "https://api.github.com/users/vjpai/orgs",
      "repos_url": "https://api.github.com/users/vjpai/repos",
      "events_url": "https://api.github.com/users/vjpai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vjpai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-03T02:04:44Z",
    "updated_at": "2016-11-03T02:04:44Z",
    "author_association": "MEMBER",
    "body": "There might be other meaningful status response codes on a fail. The\nimportant thing, though, is not to have a queue backing up a bounded\nthreadpool that executes application service code.\n\nOn Wed, Nov 2, 2016, 5:26 PM Masood Malekghassemi notifications@github.com\nwrote:\n\n> @nathanielmanistaatgoogle https://github.com/nathanielmanistaatgoogle\n> We don't appear to use RESOURCE_EXHAUSTED in the suggested way. Do we?\n> \n> â€”\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> https://github.com/grpc/grpc/issues/8603#issuecomment-258039278, or mute\n> the thread\n> https://github.com/notifications/unsubscribe-auth/AIdEkJZxGTnbf_NoqMYwsouadDdhskJ6ks5q6SolgaJpZM4Kmo3d\n> .\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/258166693",
    "html_url": "https://github.com/grpc/grpc/issues/8603#issuecomment-258166693",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8603",
    "id": 258166693,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODE2NjY5Mw==",
    "user": {
      "login": "vjpai",
      "id": 8864912,
      "node_id": "MDQ6VXNlcjg4NjQ5MTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8864912?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vjpai",
      "html_url": "https://github.com/vjpai",
      "followers_url": "https://api.github.com/users/vjpai/followers",
      "following_url": "https://api.github.com/users/vjpai/following{/other_user}",
      "gists_url": "https://api.github.com/users/vjpai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vjpai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vjpai/subscriptions",
      "organizations_url": "https://api.github.com/users/vjpai/orgs",
      "repos_url": "https://api.github.com/users/vjpai/repos",
      "events_url": "https://api.github.com/users/vjpai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vjpai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-03T14:56:49Z",
    "updated_at": "2016-11-03T14:56:49Z",
    "author_association": "MEMBER",
    "body": "Ok, I looked over the issue in Python and I'm tagging the issue for Python as well then. futures.ThreadPoolExecutor has no way of being unbounded in worker count and, I think, always allows a new submit - there certainly isn't any error case being handled on submit.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/258168268",
    "html_url": "https://github.com/grpc/grpc/issues/8603#issuecomment-258168268",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8603",
    "id": 258168268,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODE2ODI2OA==",
    "user": {
      "login": "vjpai",
      "id": 8864912,
      "node_id": "MDQ6VXNlcjg4NjQ5MTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8864912?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vjpai",
      "html_url": "https://github.com/vjpai",
      "followers_url": "https://api.github.com/users/vjpai/followers",
      "following_url": "https://api.github.com/users/vjpai/following{/other_user}",
      "gists_url": "https://api.github.com/users/vjpai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vjpai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vjpai/subscriptions",
      "organizations_url": "https://api.github.com/users/vjpai/orgs",
      "repos_url": "https://api.github.com/users/vjpai/repos",
      "events_url": "https://api.github.com/users/vjpai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vjpai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-03T15:02:02Z",
    "updated_at": "2016-11-03T15:02:02Z",
    "author_association": "MEMBER",
    "body": "This does not affect C# or Node because the thread pools there are not executing application code.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/258174598",
    "html_url": "https://github.com/grpc/grpc/issues/8603#issuecomment-258174598",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8603",
    "id": 258174598,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODE3NDU5OA==",
    "user": {
      "login": "vjpai",
      "id": 8864912,
      "node_id": "MDQ6VXNlcjg4NjQ5MTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8864912?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vjpai",
      "html_url": "https://github.com/vjpai",
      "followers_url": "https://api.github.com/users/vjpai/followers",
      "following_url": "https://api.github.com/users/vjpai/following{/other_user}",
      "gists_url": "https://api.github.com/users/vjpai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vjpai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vjpai/subscriptions",
      "organizations_url": "https://api.github.com/users/vjpai/orgs",
      "repos_url": "https://api.github.com/users/vjpai/repos",
      "events_url": "https://api.github.com/users/vjpai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vjpai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-03T15:22:35Z",
    "updated_at": "2016-11-03T15:22:35Z",
    "author_association": "MEMBER",
    "body": "Just to show that even a waiting queue of 1 can cause deadlock.\nServer A and B proxy method foo/bar to each other, respectively, as in my earlier comment - but only sometimes. In non-language-specific pseudocode:\n\n```\nA::foo(x, y) {\n  A_mu.lock_guard\n    A_shared_state_1 += f(A_shared_ctr)\n    if (x)\n       A_shared_ctr += B::foo(A_shared_ctr, y)\n    else\n       A_shared_ctr += y\n}\n\nB::bar(x, y) {\n  B_mu.lock_guard\n    B_shared_state_1 += f(B_shared_ctr)\n    if (x)\n       B_shared_ctr += A::bar(B_shared_ctr, y)\n    else\n       B_shared_ctr += y\n}\n\n```\n\nAgain, as in the previous example, 4 simultaneous A::foos show up at A and 4 simultaneous B::bar show up at B. 1 of those RPCs at each side has boolean variable x set, and it gets the shared state mutex first. It has to hold on to the mutex while calling the other side since it has also used the current value one of its shared variables that is being updated as a result of this call. The queuing of the 5th request causes the lock to never be released, and deadlock has arisen.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/258180647",
    "html_url": "https://github.com/grpc/grpc/issues/8603#issuecomment-258180647",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8603",
    "id": 258180647,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODE4MDY0Nw==",
    "user": {
      "login": "vjpai",
      "id": 8864912,
      "node_id": "MDQ6VXNlcjg4NjQ5MTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8864912?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vjpai",
      "html_url": "https://github.com/vjpai",
      "followers_url": "https://api.github.com/users/vjpai/followers",
      "following_url": "https://api.github.com/users/vjpai/following{/other_user}",
      "gists_url": "https://api.github.com/users/vjpai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vjpai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vjpai/subscriptions",
      "organizations_url": "https://api.github.com/users/vjpai/orgs",
      "repos_url": "https://api.github.com/users/vjpai/repos",
      "events_url": "https://api.github.com/users/vjpai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vjpai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-03T15:41:32Z",
    "updated_at": "2016-11-03T15:41:32Z",
    "author_association": "MEMBER",
    "body": "Separating this out into python and ruby issues so that they can be tracked and closed separately.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/385975106",
    "html_url": "https://github.com/grpc/grpc/issues/8603#issuecomment-385975106",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8603",
    "id": 385975106,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTk3NTEwNg==",
    "user": {
      "login": "jacobvosmaer",
      "id": 1336311,
      "node_id": "MDQ6VXNlcjEzMzYzMTE=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1336311?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jacobvosmaer",
      "html_url": "https://github.com/jacobvosmaer",
      "followers_url": "https://api.github.com/users/jacobvosmaer/followers",
      "following_url": "https://api.github.com/users/jacobvosmaer/following{/other_user}",
      "gists_url": "https://api.github.com/users/jacobvosmaer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jacobvosmaer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jacobvosmaer/subscriptions",
      "organizations_url": "https://api.github.com/users/jacobvosmaer/orgs",
      "repos_url": "https://api.github.com/users/jacobvosmaer/repos",
      "events_url": "https://api.github.com/users/jacobvosmaer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jacobvosmaer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-02T13:20:34Z",
    "updated_at": "2018-05-02T13:20:34Z",
    "author_association": "NONE",
    "body": "We've spent a lot of time trying to understand why we were getting mysterious `ResourceExhausted dec=` errors in our application. It turned out to be because of this change. One thing that made it harder to diagnose is the fact that the string ResourceExhausted does not appear in this issue, so this issue does not float up in GitHub's issue search! So this is why I am saying ResourceExhausted here a few times, to aid discoverability. :)"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/385977293",
    "html_url": "https://github.com/grpc/grpc/issues/8603#issuecomment-385977293",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8603",
    "id": 385977293,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTk3NzI5Mw==",
    "user": {
      "login": "jacobvosmaer",
      "id": 1336311,
      "node_id": "MDQ6VXNlcjEzMzYzMTE=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1336311?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jacobvosmaer",
      "html_url": "https://github.com/jacobvosmaer",
      "followers_url": "https://api.github.com/users/jacobvosmaer/followers",
      "following_url": "https://api.github.com/users/jacobvosmaer/following{/other_user}",
      "gists_url": "https://api.github.com/users/jacobvosmaer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jacobvosmaer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jacobvosmaer/subscriptions",
      "organizations_url": "https://api.github.com/users/jacobvosmaer/orgs",
      "repos_url": "https://api.github.com/users/jacobvosmaer/repos",
      "events_url": "https://api.github.com/users/jacobvosmaer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jacobvosmaer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-02T13:28:06Z",
    "updated_at": "2018-05-02T13:28:06Z",
    "author_association": "NONE",
    "body": "I'm also submitting a PR to put a better message in the error. https://github.com/grpc/grpc/pull/15249"
  }
]
