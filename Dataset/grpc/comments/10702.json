[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/297608309",
    "html_url": "https://github.com/grpc/grpc/issues/10702#issuecomment-297608309",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10702",
    "id": 297608309,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5NzYwODMwOQ==",
    "user": {
      "login": "jboeuf",
      "id": 6262765,
      "node_id": "MDQ6VXNlcjYyNjI3NjU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6262765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jboeuf",
      "html_url": "https://github.com/jboeuf",
      "followers_url": "https://api.github.com/users/jboeuf/followers",
      "following_url": "https://api.github.com/users/jboeuf/following{/other_user}",
      "gists_url": "https://api.github.com/users/jboeuf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jboeuf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jboeuf/subscriptions",
      "organizations_url": "https://api.github.com/users/jboeuf/orgs",
      "repos_url": "https://api.github.com/users/jboeuf/repos",
      "events_url": "https://api.github.com/users/jboeuf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jboeuf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-04-27T04:26:02Z",
    "updated_at": "2017-04-27T04:26:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "as @nathanielmanistaatgoogle said in #10701.\r\nSetting GRPC_TRACE and GRPC_VERBOSITY should certainly work.\r\nThe trace for tls/ssl in particular is called \"transport_security\"."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/297638381",
    "html_url": "https://github.com/grpc/grpc/issues/10702#issuecomment-297638381",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10702",
    "id": 297638381,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5NzYzODM4MQ==",
    "user": {
      "login": "wisotzky",
      "id": 10410757,
      "node_id": "MDQ6VXNlcjEwNDEwNzU3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10410757?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wisotzky",
      "html_url": "https://github.com/wisotzky",
      "followers_url": "https://api.github.com/users/wisotzky/followers",
      "following_url": "https://api.github.com/users/wisotzky/following{/other_user}",
      "gists_url": "https://api.github.com/users/wisotzky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wisotzky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wisotzky/subscriptions",
      "organizations_url": "https://api.github.com/users/wisotzky/orgs",
      "repos_url": "https://api.github.com/users/wisotzky/repos",
      "events_url": "https://api.github.com/users/wisotzky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wisotzky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-04-27T07:46:56Z",
    "updated_at": "2017-04-27T07:46:56Z",
    "author_association": "NONE",
    "body": "I am now using the following settings:\r\n```\r\n# export GRPC_TRACE=transport_security\r\n# export GRPC_VERBOSITY=debug\r\n```\r\n\r\nThose are the debugs I am receiving:\r\n```\r\nI0427 08:35:54.732603695   16024 ssl_transport_security.c:193]      HANDSHAKE START -  before connect initialization  - CINIT\r\nI0427 08:35:54.732662083   16024 ssl_transport_security.c:193]                 LOOP -  before connect initialization  - CINIT\r\nI0427 08:35:54.732748500   16024 ssl_transport_security.c:193]                 LOOP -     SSLv3 write client hello A  - 3WCH_A\r\nI0427 08:35:54.732759659   16024 ssl_transport_security.c:193]                 LOOP -               SSLv3 flush data  - 3FLUSH\r\nD0427 08:35:54.735555581   16024 security_handshaker.c:126]  Security handshake failed: {\"created\":\"@1493278554.735513685\",\"description\":\"Handshake read failed\",\"file\":\"src/core/lib/security/transport/security_handshaker.c\",\"file_line\":238,\"referenced_errors\":[{\"created\":\"@1493278554.735507582\",\"description\":\"Socket closed\",\"fd\":6,\"file\":\"src/core/lib/iomgr/tcp_posix.c\",\"file_line\":250,\"target_address\":\"ipv4:172.20.148.52:57400\"}]}\r\nI0427 08:35:54.735672540   16024 subchannel.c:705]           Connect failed: {\"created\":\"@1493278554.735513685\",\"description\":\"Handshake read failed\",\"file\":\"src/core/lib/security/transport/security_handshaker.c\",\"file_line\":238,\"referenced_errors\":[{\"created\":\"@1493278554.735507582\",\"description\":\"Socket closed\",\"fd\":6,\"file\":\"src/core/lib/iomgr/tcp_posix.c\",\"file_line\":250,\"target_address\":\"ipv4:172.20.148.52:57400\"}]}\r\nI0427 08:35:54.735696835   16024 subchannel.c:503]           Retry in 19.996015760 seconds\r\n17/04/27 08:35:54,736 ERROR    MainThread grpc.RpcError received:\r\n<bound method _Rendezvous.details of <_Rendezvous of RPC that terminated with (StatusCode.UNAVAILABLE, Connect Failed)>>\r\n```\r\n\r\nThese are the logs from the client implementation. What I was hoping to see is the cipher-suites offered from the server and the cipher-suites supported by the client. Also I would like to see, which side (client or server) is turning down the connection and why.\r\n\r\nIn the specific example the gRPC/TLS server enforces TLS security. The certificate is validated with success against the root certificate and provides the IP@ of the server as subjectAltName. But cipher suites does not match, while the server does not allow any unencrypted  transmission to be used as fallback. So I believe the logs are correct, as the socket is just closed by the server when it finds out, that it can not establish an encrypted TLS connectivity - but I would like to see in the logs (trace level is debug) that the certificate is good and what ciphers are exchanged.\r\n\r\nI don't think this limited logs help to understand, what is going wrong!\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/297710996",
    "html_url": "https://github.com/grpc/grpc/issues/10702#issuecomment-297710996",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10702",
    "id": 297710996,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5NzcxMDk5Ng==",
    "user": {
      "login": "wisotzky",
      "id": 10410757,
      "node_id": "MDQ6VXNlcjEwNDEwNzU3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10410757?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wisotzky",
      "html_url": "https://github.com/wisotzky",
      "followers_url": "https://api.github.com/users/wisotzky/followers",
      "following_url": "https://api.github.com/users/wisotzky/following{/other_user}",
      "gists_url": "https://api.github.com/users/wisotzky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wisotzky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wisotzky/subscriptions",
      "organizations_url": "https://api.github.com/users/wisotzky/orgs",
      "repos_url": "https://api.github.com/users/wisotzky/repos",
      "events_url": "https://api.github.com/users/wisotzky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wisotzky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-04-27T13:20:38Z",
    "updated_at": "2017-04-27T13:21:06Z",
    "author_association": "NONE",
    "body": "Potentially, once you've got a more complete trace, you can see in which phase of the TLS session setup the thing breaks. For this it is important to know, that first thing happens is cipher exchange. This is even before the server certificate will be send. If you see the TCP connection is established but stops after the Client Hello (including flush) - this is clear indication that the server does not like something in the hello which is most likely the ciphers.\r\n\r\nThe bad reality with my Python client is, that I am always receiving the same grpc.RpcError:\r\n```\r\n<bound method _Rendezvous.details of <_Rendezvous of RPC that terminated with (StatusCode.UNAVAILABLE, Connect Failed)>>\r\n```\r\n\r\nThis is for all of the following potential failure scenarios:\r\n- gRPC server not started (not listening on TCP port)\r\n- Running gRPC client against wrong server port 21/22/23 (TELNET, SSHv2, FTP port)\r\n- None of the cipher suites provided is supported by server (server closes connection)\r\n- Server certificate validation failed (check against CA root certificate failed)\r\n- Server certificate validation failed (subjectAltName / CN do not fit)\r\n\r\nI would be more than happy, if the grpc.RpcError would contain information enough to identify the issue and troubleshoot the issue immediately. Enabling gRPC debug-level on transport_security indeed provide some indication about the issue - but clearly this is not good enough for production use.\r\n\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/298618678",
    "html_url": "https://github.com/grpc/grpc/issues/10702#issuecomment-298618678",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10702",
    "id": 298618678,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5ODYxODY3OA==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-02T12:16:36Z",
    "updated_at": "2017-05-02T12:16:36Z",
    "author_association": "MEMBER",
    "body": "@dgquintas and @ctiller: what are the chances that Core would ever emit status details strings more descriptive than \"Connect Failed\" for any or all of [those scenarios](https://github.com/grpc/grpc/issues/10702#issuecomment-297710996)? Or should @wisotzky be looking elsewhere for more information, like in the metadata?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/301194684",
    "html_url": "https://github.com/grpc/grpc/issues/10702#issuecomment-301194684",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10702",
    "id": 301194684,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTE5NDY4NA==",
    "user": {
      "login": "wisotzky",
      "id": 10410757,
      "node_id": "MDQ6VXNlcjEwNDEwNzU3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10410757?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wisotzky",
      "html_url": "https://github.com/wisotzky",
      "followers_url": "https://api.github.com/users/wisotzky/followers",
      "following_url": "https://api.github.com/users/wisotzky/following{/other_user}",
      "gists_url": "https://api.github.com/users/wisotzky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wisotzky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wisotzky/subscriptions",
      "organizations_url": "https://api.github.com/users/wisotzky/orgs",
      "repos_url": "https://api.github.com/users/wisotzky/repos",
      "events_url": "https://api.github.com/users/wisotzky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wisotzky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-12T21:53:47Z",
    "updated_at": "2017-05-12T21:53:47Z",
    "author_association": "NONE",
    "body": "Any update?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/320391620",
    "html_url": "https://github.com/grpc/grpc/issues/10702#issuecomment-320391620",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10702",
    "id": 320391620,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMDM5MTYyMA==",
    "user": {
      "login": "MaxFangX",
      "id": 7884003,
      "node_id": "MDQ6VXNlcjc4ODQwMDM=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/7884003?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MaxFangX",
      "html_url": "https://github.com/MaxFangX",
      "followers_url": "https://api.github.com/users/MaxFangX/followers",
      "following_url": "https://api.github.com/users/MaxFangX/following{/other_user}",
      "gists_url": "https://api.github.com/users/MaxFangX/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MaxFangX/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MaxFangX/subscriptions",
      "organizations_url": "https://api.github.com/users/MaxFangX/orgs",
      "repos_url": "https://api.github.com/users/MaxFangX/repos",
      "events_url": "https://api.github.com/users/MaxFangX/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MaxFangX/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-05T03:19:11Z",
    "updated_at": "2017-08-05T03:19:11Z",
    "author_association": "NONE",
    "body": "@wisotzky I ran into a similar issue as well where I needed to see the cipher suite messages. The key here is that gRPC is trying to use SSLv3, which is old and insecure.\r\n\r\nRunning `export GRPC_SSL_CIPHER_SUITES=ECDHE-ECDSA-AES256-GCM-SHA384` to force the client to use a a different cipher suite worked for me. \r\n\r\nSolution found [here](https://groups.google.com/forum/#!topic/grpc-io/VhJAONcDI3c)"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/389350001",
    "html_url": "https://github.com/grpc/grpc/issues/10702#issuecomment-389350001",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10702",
    "id": 389350001,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4OTM1MDAwMQ==",
    "user": {
      "login": "ncteisen",
      "id": 6148140,
      "node_id": "MDQ6VXNlcjYxNDgxNDA=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6148140?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ncteisen",
      "html_url": "https://github.com/ncteisen",
      "followers_url": "https://api.github.com/users/ncteisen/followers",
      "following_url": "https://api.github.com/users/ncteisen/following{/other_user}",
      "gists_url": "https://api.github.com/users/ncteisen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ncteisen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ncteisen/subscriptions",
      "organizations_url": "https://api.github.com/users/ncteisen/orgs",
      "repos_url": "https://api.github.com/users/ncteisen/repos",
      "events_url": "https://api.github.com/users/ncteisen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ncteisen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-15T23:50:03Z",
    "updated_at": "2018-05-15T23:50:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "Sounds like the root issue is resolved.\r\n\r\nThe feature brought up in the comments, tracked in #13790, is being implemented in #13689 "
  }
]
