[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/273183274",
    "html_url": "https://github.com/grpc/grpc/issues/9360#issuecomment-273183274",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/9360",
    "id": 273183274,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MzE4MzI3NA==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-17T14:36:04Z",
    "updated_at": "2017-01-17T14:36:04Z",
    "author_association": "MEMBER",
    "body": "@sulliwane: what your code doesn't show but what I'd really like to know is what's happening in your first thread after launching the second thread. If your stub and channel go out of scope and are garbage-collected they will cancel all in-flight RPCs outstanding on them. Could that be the cause of the `StatusCode.CANCELLED` status that you are observing?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/273382622",
    "html_url": "https://github.com/grpc/grpc/issues/9360#issuecomment-273382622",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/9360",
    "id": 273382622,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MzM4MjYyMg==",
    "user": {
      "login": "sulliwane",
      "id": 1733686,
      "node_id": "MDQ6VXNlcjE3MzM2ODY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1733686?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sulliwane",
      "html_url": "https://github.com/sulliwane",
      "followers_url": "https://api.github.com/users/sulliwane/followers",
      "following_url": "https://api.github.com/users/sulliwane/following{/other_user}",
      "gists_url": "https://api.github.com/users/sulliwane/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sulliwane/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sulliwane/subscriptions",
      "organizations_url": "https://api.github.com/users/sulliwane/orgs",
      "repos_url": "https://api.github.com/users/sulliwane/repos",
      "events_url": "https://api.github.com/users/sulliwane/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sulliwane/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-18T04:53:42Z",
    "updated_at": "2017-01-18T04:55:38Z",
    "author_association": "NONE",
    "body": "So basically I have a class **GrpcClient** that wraps the grpc stub methods, and all of its streaming methods will first get the stream, and then delegate the ```for elem in stream``` loop into a thread, using ```add_worker(stream)```:\r\n```python\r\nclass GrpcClient:\r\n    def __init__(self):\r\n        self.__stub = self.get_grpc_stub()\r\n\r\n    def get_grpc_stub(self):\r\n        auth_plugin = GrpcAuthPlugin()\r\n        metadata_auth = grpc.metadata_call_credentials(auth_plugin, None)\r\n        ssl_creds = grpc.ssl_channel_credentials(None, None, None)\r\n        channel_creds = grpc.composite_channel_credentials(\r\n            ssl_creds,\r\n            metadata_auth,\r\n        )\r\n        channel = grpc.secure_channel(\r\n            self.server_url,\r\n            channel_creds,\r\n        )\r\n        return grpc_pb2.ClassNameStub(channel)\r\n\r\n    def add_worker(self, stream):\r\n        def stream_worker(thestream):\r\n            for elem in thestream:\r\n                logging.info(elem)\r\n        mythread = Thread(\r\n            target=stream_worker,\r\n            args=(stream),\r\n        )\r\n        mythread.start()\r\n\r\n    def getStream(self):\r\n        stream = stub.GetStream(md.Empty())\r\n        self.add_worker(stream)\r\n\r\n\"\"\" The main loop \"\"\"\"\r\nmyClient = GrpcClient()\r\nmyClient.getStream()\r\n```\r\nI don't think that my stub is going out of scope as it is attached to the **GrpcClient instance** (which is living in the main thread).\r\n\r\nBut I will try to come up with a code sample that makes my problem reproducible (my mistake is probably less obvious than I thought) and I'll update the issue after that."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/273558075",
    "html_url": "https://github.com/grpc/grpc/issues/9360#issuecomment-273558075",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/9360",
    "id": 273558075,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MzU1ODA3NQ==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-18T18:25:16Z",
    "updated_at": "2017-01-18T18:25:16Z",
    "author_association": "MEMBER",
    "body": "What happens in \"The main loop\" after \"myClient.getStream()\"? Is that where your main thread runs out of things to do?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/273582088",
    "html_url": "https://github.com/grpc/grpc/issues/9360#issuecomment-273582088",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/9360",
    "id": 273582088,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MzU4MjA4OA==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-18T19:52:08Z",
    "updated_at": "2017-01-18T19:52:08Z",
    "author_association": "MEMBER",
    "body": "Punting; there's nothing here that should hold up the release of `1.1.0`."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/273915611",
    "html_url": "https://github.com/grpc/grpc/issues/9360#issuecomment-273915611",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/9360",
    "id": 273915611,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MzkxNTYxMQ==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-19T22:14:02Z",
    "updated_at": "2017-01-19T22:14:02Z",
    "author_association": "MEMBER",
    "body": "@ctiller, @dgquintas: look at the way the issue reporter is seeing status code `grpc.StatusCode.CANCELLED` and status details string \"`Cancelled`\". I _suspect_ that what's happening is the user is allowing the `grpc.Channel` object to be garbage-collected while the RPC is active and that's causing `grpc_channel_destroy` to be called while there is still a live RPC. Please confirm that in the case of `grpc_channel_destroy` being called while an RPC is active that status details string \"`Cancelled`\" is what's used for the killed-at-that-time RPC? **Most importantly, how feasible would it be to isolate that circumstance and change the status details string to something like \"`RPC cancelled as part of grpc_channel_destroy`\"?** "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/400461200",
    "html_url": "https://github.com/grpc/grpc/issues/9360#issuecomment-400461200",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/9360",
    "id": 400461200,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDQ2MTIwMA==",
    "user": {
      "login": "dgquintas",
      "id": 120217,
      "node_id": "MDQ6VXNlcjEyMDIxNw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/120217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dgquintas",
      "html_url": "https://github.com/dgquintas",
      "followers_url": "https://api.github.com/users/dgquintas/followers",
      "following_url": "https://api.github.com/users/dgquintas/following{/other_user}",
      "gists_url": "https://api.github.com/users/dgquintas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dgquintas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dgquintas/subscriptions",
      "organizations_url": "https://api.github.com/users/dgquintas/orgs",
      "repos_url": "https://api.github.com/users/dgquintas/repos",
      "events_url": "https://api.github.com/users/dgquintas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dgquintas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-26T21:02:21Z",
    "updated_at": "2018-06-26T21:02:21Z",
    "author_association": "NONE",
    "body": "It this issue still relevant? Closing for now, please reopen if so."
  }
]
