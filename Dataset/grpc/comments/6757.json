[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/261033960",
    "html_url": "https://github.com/grpc/grpc/issues/6757#issuecomment-261033960",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6757",
    "id": 261033960,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MTAzMzk2MA==",
    "user": {
      "login": "murgatroid99",
      "id": 961599,
      "node_id": "MDQ6VXNlcjk2MTU5OQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/961599?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/murgatroid99",
      "html_url": "https://github.com/murgatroid99",
      "followers_url": "https://api.github.com/users/murgatroid99/followers",
      "following_url": "https://api.github.com/users/murgatroid99/following{/other_user}",
      "gists_url": "https://api.github.com/users/murgatroid99/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/murgatroid99/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/murgatroid99/subscriptions",
      "organizations_url": "https://api.github.com/users/murgatroid99/orgs",
      "repos_url": "https://api.github.com/users/murgatroid99/repos",
      "events_url": "https://api.github.com/users/murgatroid99/events{/privacy}",
      "received_events_url": "https://api.github.com/users/murgatroid99/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-16T18:43:22Z",
    "updated_at": "2016-11-16T18:43:22Z",
    "author_association": "MEMBER",
    "body": "@jboeuf Do you know what might cause this?\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/261040875",
    "html_url": "https://github.com/grpc/grpc/issues/6757#issuecomment-261040875",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6757",
    "id": 261040875,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MTA0MDg3NQ==",
    "user": {
      "login": "jboeuf",
      "id": 6262765,
      "node_id": "MDQ6VXNlcjYyNjI3NjU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6262765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jboeuf",
      "html_url": "https://github.com/jboeuf",
      "followers_url": "https://api.github.com/users/jboeuf/followers",
      "following_url": "https://api.github.com/users/jboeuf/following{/other_user}",
      "gists_url": "https://api.github.com/users/jboeuf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jboeuf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jboeuf/subscriptions",
      "organizations_url": "https://api.github.com/users/jboeuf/orgs",
      "repos_url": "https://api.github.com/users/jboeuf/repos",
      "events_url": "https://api.github.com/users/jboeuf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jboeuf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-16T19:08:08Z",
    "updated_at": "2016-11-16T19:08:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "For your second snippet, I checked the code and what is happening is that if `null` (2nd block in the first comment) is passed for the client roots, client certificate check is not enforced: see:\nhttps://github.com/grpc/grpc/blob/master/src/core/lib/tsi/ssl_transport_security.c#L1477\n\nThis is a bug we should enforce params checking. Also, some type of mutual auth does not require a root to be specified (e.g. `REQUEST_CLIENT_CERTIFICATE_BUT_DONT_VERIFY`). \n\nAs to why your first snippet does not work, one explanation could be that your client certificate has a server-only bit set on its extended key usage extension (https://tools.ietf.org/html/rfc5280#page-44). Can you post the client cert here so that I can have a look?\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/261703455",
    "html_url": "https://github.com/grpc/grpc/issues/6757#issuecomment-261703455",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6757",
    "id": 261703455,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MTcwMzQ1NQ==",
    "user": {
      "login": "blerest",
      "id": 5416573,
      "node_id": "MDQ6VXNlcjU0MTY1NzM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/5416573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/blerest",
      "html_url": "https://github.com/blerest",
      "followers_url": "https://api.github.com/users/blerest/followers",
      "following_url": "https://api.github.com/users/blerest/following{/other_user}",
      "gists_url": "https://api.github.com/users/blerest/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/blerest/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/blerest/subscriptions",
      "organizations_url": "https://api.github.com/users/blerest/orgs",
      "repos_url": "https://api.github.com/users/blerest/repos",
      "events_url": "https://api.github.com/users/blerest/events{/privacy}",
      "received_events_url": "https://api.github.com/users/blerest/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-19T09:30:49Z",
    "updated_at": "2016-11-19T09:30:49Z",
    "author_association": "NONE",
    "body": "@jboeuf @murgatroid99 I'm having the same issue. I'm working with nodejs client and server with TLS on both side.\n\nHere how I generate the certificates:\n\n```\nopenssl genrsa -passout pass:1111 -des3 -out ca.key 4096\n\nopenssl req -passin pass:1111 -new -x509 -days 365 -key ca.key -out ca.crt -subj  \"/C=FR/ST=Paris/L=Paris/O=Test/OU=Test/CN=localhost\"\n\nopenssl genrsa -passout pass:1111 -des3 -out server.key 4096\n\nopenssl req -passin pass:1111 -new -key server.key -out server.csr -subj  \"/C=FR/ST=Paris/L=Paris/O=Test/OU=Test/CN=localhost\"\n\nopenssl x509 -req -passin pass:1111 -days 365 -in server.csr -CA ca.crt -CAkey ca.key -set_serial 01 -out server.crt\n\nopenssl rsa -passin pass:1111 -in server.key -out server.key\n\nopenssl genrsa -passout pass:1111 -des3 -out client.key 4096\n\nopenssl req -passin pass:1111 -new -key client.key -out client.csr -subj  \"/C=FR/ST=Paris/L=Paris/O=Test/OU=Test/CN=localhost\"\n\nopenssl x509 -passin pass:1111 -req -days 365 -in client.csr -CA ca.crt -CAkey ca.key -set_serial 01 -out client.crt\n\nopenssl rsa -passin pass:1111 -in client.key -out client.key\n```\n\nHere my server in nodejs:\n\n```\nconst fs = require('fs');\nconst grpc = require('grpc');\n\nlet credentials = grpc.ServerCredentials.createSsl(fs.readFileSync('./ssl/ca.crt'), [{\n    cert_chain: fs.readFileSync('./ssl/server.crt'),\n    private_key: fs.readFileSync('./ssl/server.key')\n}], true);\nlet server = new grpc.Server();\nlet helloWorld = grpc.load('./hello_world.proto');\nserver.addProtoService(helloWorld.HelloWorldGrpc.service, {\n    helloWorld: (_context, _callback) => {\n        _callback(null, null);\n    }\n});\nserver.bind('localhost:1983', credentials);\nserver.start();\n```\n\nHere my client in nodejs:\n\n```\nconst fs = require('fs');\nconst grpc = require('grpc');\n\nlet credentials = grpc.credentials.createSsl(fs.readFileSync('./ssl/server.crt'), fs.readFileSync('./ssl/client.key'), fs.readFileSync('./ssl/client.crt'));\nlet helloWorld = grpc.load('./hello_world.proto');\nlet client = new helloWorld.HelloWorldGrpc('localhost:1983', credentials);\nclient.helloWorld(null, (_error, _response) => {\n    if (_error) {\n        return console.error(_error);\n    }\n});\n```\n\nAnd finally my proto:\n\n```\nsyntax = \"proto3\";\n\nservice HelloWorldGrpc {\n    rpc helloWorld(HelloWorldRequest) returns (HelloWorldResponse);\n}\n\nmessage HelloWorldRequest {\n    HelloWorld hello_world = 1;\n}\n\nmessage HelloWorldResponse {\n    HelloWorld hello_world = 2;\n}\n\nmessage HelloWorld {\n    string message = 1;\n}\n```\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/263035645",
    "html_url": "https://github.com/grpc/grpc/issues/6757#issuecomment-263035645",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6757",
    "id": 263035645,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MzAzNTY0NQ==",
    "user": {
      "login": "blerest",
      "id": 5416573,
      "node_id": "MDQ6VXNlcjU0MTY1NzM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/5416573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/blerest",
      "html_url": "https://github.com/blerest",
      "followers_url": "https://api.github.com/users/blerest/followers",
      "following_url": "https://api.github.com/users/blerest/following{/other_user}",
      "gists_url": "https://api.github.com/users/blerest/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/blerest/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/blerest/subscriptions",
      "organizations_url": "https://api.github.com/users/blerest/orgs",
      "repos_url": "https://api.github.com/users/blerest/repos",
      "events_url": "https://api.github.com/users/blerest/events{/privacy}",
      "received_events_url": "https://api.github.com/users/blerest/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-26T00:38:51Z",
    "updated_at": "2016-11-26T00:38:51Z",
    "author_association": "NONE",
    "body": "do you have any news regarding this issue?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/263335185",
    "html_url": "https://github.com/grpc/grpc/issues/6757#issuecomment-263335185",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6757",
    "id": 263335185,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MzMzNTE4NQ==",
    "user": {
      "login": "jboeuf",
      "id": 6262765,
      "node_id": "MDQ6VXNlcjYyNjI3NjU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6262765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jboeuf",
      "html_url": "https://github.com/jboeuf",
      "followers_url": "https://api.github.com/users/jboeuf/followers",
      "following_url": "https://api.github.com/users/jboeuf/following{/other_user}",
      "gists_url": "https://api.github.com/users/jboeuf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jboeuf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jboeuf/subscriptions",
      "organizations_url": "https://api.github.com/users/jboeuf/orgs",
      "repos_url": "https://api.github.com/users/jboeuf/repos",
      "events_url": "https://api.github.com/users/jboeuf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jboeuf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-28T17:25:36Z",
    "updated_at": "2016-11-28T17:25:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "Sorry, I was on vacation, I'll have a look shortly."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/264152698",
    "html_url": "https://github.com/grpc/grpc/issues/6757#issuecomment-264152698",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6757",
    "id": 264152698,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NDE1MjY5OA==",
    "user": {
      "login": "blerest",
      "id": 5416573,
      "node_id": "MDQ6VXNlcjU0MTY1NzM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/5416573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/blerest",
      "html_url": "https://github.com/blerest",
      "followers_url": "https://api.github.com/users/blerest/followers",
      "following_url": "https://api.github.com/users/blerest/following{/other_user}",
      "gists_url": "https://api.github.com/users/blerest/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/blerest/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/blerest/subscriptions",
      "organizations_url": "https://api.github.com/users/blerest/orgs",
      "repos_url": "https://api.github.com/users/blerest/repos",
      "events_url": "https://api.github.com/users/blerest/events{/privacy}",
      "received_events_url": "https://api.github.com/users/blerest/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-01T11:51:07Z",
    "updated_at": "2016-12-01T11:51:07Z",
    "author_association": "NONE",
    "body": "hi @jboeuf, did you have a look? Thank you."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/264511463",
    "html_url": "https://github.com/grpc/grpc/issues/6757#issuecomment-264511463",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6757",
    "id": 264511463,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NDUxMTQ2Mw==",
    "user": {
      "login": "jboeuf",
      "id": 6262765,
      "node_id": "MDQ6VXNlcjYyNjI3NjU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6262765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jboeuf",
      "html_url": "https://github.com/jboeuf",
      "followers_url": "https://api.github.com/users/jboeuf/followers",
      "following_url": "https://api.github.com/users/jboeuf/following{/other_user}",
      "gists_url": "https://api.github.com/users/jboeuf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jboeuf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jboeuf/subscriptions",
      "organizations_url": "https://api.github.com/users/jboeuf/orgs",
      "repos_url": "https://api.github.com/users/jboeuf/repos",
      "events_url": "https://api.github.com/users/jboeuf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jboeuf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-02T17:28:29Z",
    "updated_at": "2016-12-02T17:28:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "I've started to do so. I hope to be able to reply some time today with my findings."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/264617793",
    "html_url": "https://github.com/grpc/grpc/issues/6757#issuecomment-264617793",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6757",
    "id": 264617793,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NDYxNzc5Mw==",
    "user": {
      "login": "jboeuf",
      "id": 6262765,
      "node_id": "MDQ6VXNlcjYyNjI3NjU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6262765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jboeuf",
      "html_url": "https://github.com/jboeuf",
      "followers_url": "https://api.github.com/users/jboeuf/followers",
      "following_url": "https://api.github.com/users/jboeuf/following{/other_user}",
      "gists_url": "https://api.github.com/users/jboeuf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jboeuf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jboeuf/subscriptions",
      "organizations_url": "https://api.github.com/users/jboeuf/orgs",
      "repos_url": "https://api.github.com/users/jboeuf/repos",
      "events_url": "https://api.github.com/users/jboeuf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jboeuf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-03T05:20:14Z",
    "updated_at": "2016-12-03T05:20:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "@blerest \r\nI tested your certs (in C++, not in nodejs) and it fails as well. It has to do with the fact that all your certs have the same subject which confuses the openssl cert chain builder (best guess).\r\n\r\nIf you change the lines in your script that assign identities to:\r\n```\r\nopenssl req -passin pass:1111 -new -x509 -days 365 -key ca.key -out ca.crt -subj  \"/C=FR/ST=Paris/L=Paris/O=Test/OU=Test/CN=ca\"\r\n\r\nopenssl req -passin pass:1111 -new -key server.key -out server.csr -subj  \"/C=FR/ST=Paris/L=Paris/O=Test/OU=Server/CN=localhost\"\r\n\r\nopenssl req -passin pass:1111 -new -key client.key -out client.csr -subj  \"/C=FR/ST=Paris/L=Paris/O=Test/OU=Client/CN=localhost\"\r\n```\r\n\r\nAnd change your client code to really use the CA cert as the CA as opposed to the server cert:\r\n```\r\nlet credentials = grpc.credentials.createSsl(fs.readFileSync('./ssl/ca.crt'), fs.readFileSync('./ssl/client.key'), fs.readFileSync('./ssl/client.crt'));\r\n```\r\n\r\nThings should work (at least they do in C++). Please let me know if that's not the case."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/264714549",
    "html_url": "https://github.com/grpc/grpc/issues/6757#issuecomment-264714549",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6757",
    "id": 264714549,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NDcxNDU0OQ==",
    "user": {
      "login": "blerest",
      "id": 5416573,
      "node_id": "MDQ6VXNlcjU0MTY1NzM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/5416573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/blerest",
      "html_url": "https://github.com/blerest",
      "followers_url": "https://api.github.com/users/blerest/followers",
      "following_url": "https://api.github.com/users/blerest/following{/other_user}",
      "gists_url": "https://api.github.com/users/blerest/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/blerest/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/blerest/subscriptions",
      "organizations_url": "https://api.github.com/users/blerest/orgs",
      "repos_url": "https://api.github.com/users/blerest/repos",
      "events_url": "https://api.github.com/users/blerest/events{/privacy}",
      "received_events_url": "https://api.github.com/users/blerest/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-04T16:43:30Z",
    "updated_at": "2016-12-04T16:43:30Z",
    "author_association": "NONE",
    "body": "@jboeuf thank you, it's working like a charm now. "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/264716834",
    "html_url": "https://github.com/grpc/grpc/issues/6757#issuecomment-264716834",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6757",
    "id": 264716834,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NDcxNjgzNA==",
    "user": {
      "login": "blerest",
      "id": 5416573,
      "node_id": "MDQ6VXNlcjU0MTY1NzM=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/5416573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/blerest",
      "html_url": "https://github.com/blerest",
      "followers_url": "https://api.github.com/users/blerest/followers",
      "following_url": "https://api.github.com/users/blerest/following{/other_user}",
      "gists_url": "https://api.github.com/users/blerest/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/blerest/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/blerest/subscriptions",
      "organizations_url": "https://api.github.com/users/blerest/orgs",
      "repos_url": "https://api.github.com/users/blerest/repos",
      "events_url": "https://api.github.com/users/blerest/events{/privacy}",
      "received_events_url": "https://api.github.com/users/blerest/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-04T17:17:48Z",
    "updated_at": "2016-12-04T17:17:48Z",
    "author_association": "NONE",
    "body": "Using a server on nodejs, does it possible to know which certificate (which client) is doing a request (like an access to the OU value)? "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/264764935",
    "html_url": "https://github.com/grpc/grpc/issues/6757#issuecomment-264764935",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6757",
    "id": 264764935,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NDc2NDkzNQ==",
    "user": {
      "login": "jboeuf",
      "id": 6262765,
      "node_id": "MDQ6VXNlcjYyNjI3NjU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6262765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jboeuf",
      "html_url": "https://github.com/jboeuf",
      "followers_url": "https://api.github.com/users/jboeuf/followers",
      "following_url": "https://api.github.com/users/jboeuf/following{/other_user}",
      "gists_url": "https://api.github.com/users/jboeuf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jboeuf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jboeuf/subscriptions",
      "organizations_url": "https://api.github.com/users/jboeuf/orgs",
      "repos_url": "https://api.github.com/users/jboeuf/repos",
      "events_url": "https://api.github.com/users/jboeuf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jboeuf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-05T04:19:37Z",
    "updated_at": "2016-12-05T04:20:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "@blerest Thanks for the confirmation. The client certificate info has not been plugged in yet in the nodejs server (this is only available in C++). However, @jtattermusch and I are probably going to make a plan soon on how to support this in all wrapped languages. Stay tuned!\r\n\r\nShould we close this specific issue now? (please feel free to open another one for the client info, server side in nodejs). Thanks!"
  }
]
