[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/213616819",
    "html_url": "https://github.com/grpc/grpc/issues/6251#issuecomment-213616819",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6251",
    "id": 213616819,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxMzYxNjgxOQ==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-04-22T22:51:27Z",
    "updated_at": "2016-04-22T22:51:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "FTR:\n\n```\n+ bins/opt/qps_json_driver '--scenarios_json={\"scenarios\": [{\"name\": \"cpp_single_channel_throughput_secure\", \"warmup_seconds\": 5, \"benchmark_seconds\": 30, \"num_servers\": 1, \"server_config\": {\"async_server_threads\": 0, \"core_limit\": 4, \"security_params\": {\"use_test_ca\": true, \"server_host_override\": \"foo.test.google.fr\"}, \"payload_config\": {\"bytebuf_params\": {\"resp_size\": 65536, \"req_size\": 65536}}, \"server_type\": \"ASYNC_GENERIC_SERVER\"}, \"client_config\": {\"client_type\": \"ASYNC_CLIENT\", \"security_params\": {\"use_test_ca\": true, \"server_host_override\": \"foo.test.google.fr\"}, \"payload_config\": {\"bytebuf_params\": {\"resp_size\": 65536, \"req_size\": 65536}}, \"client_channels\": 1, \"async_client_threads\": 0, \"outstanding_rpcs_per_channel\": 100, \"rpc_type\": \"STREAMING\", \"load_params\": {\"closed_loop\": {}}, \"histogram_params\": {\"max_possible\": 60000000000.0, \"resolution\": 0.01}}, \"num_clients\": 1}]}' --scenario_result_file=scenario_result.json\nRUNNING SCENARIO: cpp_single_channel_throughput_secure\nI0421 18:10:05.072179138   21327 socket_utils_common_posix.c:170] Disabling AF_INET6 sockets because ::1 is not available.\nI0421 18:10:05.075903514   21326 driver.cc:246]              Starting server on grpc-performance-server1:10000 (worker #0)\nI0421 18:10:05.092287827   21326 driver.cc:309]              Starting client on grpc-performance-client1:10000 (worker #1)\nI0421 18:10:05.096191303   21326 driver.cc:352]              Warming up\nI0421 18:10:10.096316084   21326 driver.cc:358]              Starting\nI0421 18:12:05.588090237   21326 driver.cc:379]              Running\nI0421 18:12:05.588174367   21326 driver.cc:390]              Finishing clients\n\nTIMEOUT: qps_json_driver.cpp_single_channel_throughput_secure [pid=21323]\n```\n\nhttps://grpc-testing.appspot.com/job/gRPC_performance_experiment/166/console\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/213618442",
    "html_url": "https://github.com/grpc/grpc/issues/6251#issuecomment-213618442",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6251",
    "id": 213618442,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxMzYxODQ0Mg==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-04-22T22:58:06Z",
    "updated_at": "2016-04-22T22:58:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "Looking at the build history, this time the test times out is https://grpc-testing.appspot.com/job/gRPC_performance_experiment/147/    - which is right after we merged #6236. So it's definitely one of the changes from that PR (but probably not the one we are trying to revert in #6250)\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/228193431",
    "html_url": "https://github.com/grpc/grpc/issues/6251#issuecomment-228193431",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6251",
    "id": 228193431,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyODE5MzQzMQ==",
    "user": {
      "login": "hsaliak",
      "id": 150108,
      "node_id": "MDQ6VXNlcjE1MDEwOA==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/150108?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hsaliak",
      "html_url": "https://github.com/hsaliak",
      "followers_url": "https://api.github.com/users/hsaliak/followers",
      "following_url": "https://api.github.com/users/hsaliak/following{/other_user}",
      "gists_url": "https://api.github.com/users/hsaliak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hsaliak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hsaliak/subscriptions",
      "organizations_url": "https://api.github.com/users/hsaliak/orgs",
      "repos_url": "https://api.github.com/users/hsaliak/repos",
      "events_url": "https://api.github.com/users/hsaliak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hsaliak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-06-23T21:42:37Z",
    "updated_at": "2016-06-23T21:42:37Z",
    "author_association": "MEMBER",
    "body": "@vjpai any updates on tracking down this flake?\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/228430364",
    "html_url": "https://github.com/grpc/grpc/issues/6251#issuecomment-228430364",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6251",
    "id": 228430364,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIyODQzMDM2NA==",
    "user": {
      "login": "vjpai",
      "id": 8864912,
      "node_id": "MDQ6VXNlcjg4NjQ5MTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8864912?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vjpai",
      "html_url": "https://github.com/vjpai",
      "followers_url": "https://api.github.com/users/vjpai/followers",
      "following_url": "https://api.github.com/users/vjpai/following{/other_user}",
      "gists_url": "https://api.github.com/users/vjpai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vjpai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vjpai/subscriptions",
      "organizations_url": "https://api.github.com/users/vjpai/orgs",
      "repos_url": "https://api.github.com/users/vjpai/repos",
      "events_url": "https://api.github.com/users/vjpai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vjpai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-06-24T18:52:44Z",
    "updated_at": "2016-06-24T18:52:44Z",
    "author_association": "MEMBER",
    "body": "No, getting back to this today. I had to set it aside for a bit to put in #7018 since that code needed to get reviewed (even though it's not important for GA)\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/231175586",
    "html_url": "https://github.com/grpc/grpc/issues/6251#issuecomment-231175586",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6251",
    "id": 231175586,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzMTE3NTU4Ng==",
    "user": {
      "login": "vjpai",
      "id": 8864912,
      "node_id": "MDQ6VXNlcjg4NjQ5MTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/8864912?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vjpai",
      "html_url": "https://github.com/vjpai",
      "followers_url": "https://api.github.com/users/vjpai/followers",
      "following_url": "https://api.github.com/users/vjpai/following{/other_user}",
      "gists_url": "https://api.github.com/users/vjpai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vjpai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vjpai/subscriptions",
      "organizations_url": "https://api.github.com/users/vjpai/orgs",
      "repos_url": "https://api.github.com/users/vjpai/repos",
      "events_url": "https://api.github.com/users/vjpai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vjpai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-07-07T19:02:37Z",
    "updated_at": "2016-07-07T19:02:37Z",
    "author_association": "MEMBER",
    "body": "Ok, I have root-caused this.\nThis happens as a result of BeginSwap/EndSwap in the client histogram management.\nThe thread that is calling CQ.next is actually out of work, so it gets stuck waiting for CQ.next to complete. This could theoretically happen with any test but is more likely with large message tests since they inherently send fewer messages at a time. However, its completion is expected so that the histogram can be swapped out and EndSwap can continue. So we have a simple deadlock in the test. This is not a core flake; it is a test flake. I propose that we downgrade this from GA-blocking.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/231217248",
    "html_url": "https://github.com/grpc/grpc/issues/6251#issuecomment-231217248",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6251",
    "id": 231217248,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzMTIxNzI0OA==",
    "user": {
      "login": "hsaliak",
      "id": 150108,
      "node_id": "MDQ6VXNlcjE1MDEwOA==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/150108?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hsaliak",
      "html_url": "https://github.com/hsaliak",
      "followers_url": "https://api.github.com/users/hsaliak/followers",
      "following_url": "https://api.github.com/users/hsaliak/following{/other_user}",
      "gists_url": "https://api.github.com/users/hsaliak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hsaliak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hsaliak/subscriptions",
      "organizations_url": "https://api.github.com/users/hsaliak/orgs",
      "repos_url": "https://api.github.com/users/hsaliak/repos",
      "events_url": "https://api.github.com/users/hsaliak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hsaliak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-07-07T21:47:00Z",
    "updated_at": "2016-07-07T21:47:00Z",
    "author_association": "MEMBER",
    "body": "Removing this from GA blocking per @vjpai's comment earlier.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/231242074",
    "html_url": "https://github.com/grpc/grpc/issues/6251#issuecomment-231242074",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6251",
    "id": 231242074,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzMTI0MjA3NA==",
    "user": {
      "login": "sreecha",
      "id": 2754995,
      "node_id": "MDQ6VXNlcjI3NTQ5OTU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/2754995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sreecha",
      "html_url": "https://github.com/sreecha",
      "followers_url": "https://api.github.com/users/sreecha/followers",
      "following_url": "https://api.github.com/users/sreecha/following{/other_user}",
      "gists_url": "https://api.github.com/users/sreecha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sreecha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sreecha/subscriptions",
      "organizations_url": "https://api.github.com/users/sreecha/orgs",
      "repos_url": "https://api.github.com/users/sreecha/repos",
      "events_url": "https://api.github.com/users/sreecha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sreecha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-07-08T00:00:37Z",
    "updated_at": "2016-07-08T00:01:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "@vjpai -  I should have checked with you before looking at this - my apologies.\n (I can't believe you worked on this during your vacation! :)). I missed your update; refreshed the page too late. \n\n@ctiller  and I also looked at this. You are correct about the root case. I am just documenting our findings as FYI:\n\nIn this particular case, the bug happens (i.e cq.next() never returns for one of the threads) because of the following code. The `config.client_channels() == 1` but the `cli_cqs_` are more than `1` (we create as many completion queues as the number of client threads). Which means that only `cli_cqs_[0]` has any rpcs. All other completion queues are idle and threads on them will block. \n\n`File: client_async.cc` \n\n```\n   AsyncClient(const ClientConfig& config,\n              std::function<ClientRpcContext*(\n                  StubType*, std::function<gpr_timespec()> next_issue,\n                  const RequestType&)>\n                  setup_ctx,\n              std::function<std::unique_ptr<StubType>(std::shared_ptr<Channel>)>\n                  create_stub)\n      : ClientImpl<StubType, RequestType>(config, create_stub),\n        num_async_threads_(NumThreads(config)) {\n    ..\n    for (int ch = 0; ch < config.client_channels(); ch++) {\n      for (int i = 0; i < config.outstanding_rpcs_per_channel(); i++) {\n        auto* cq = cli_cqs_[t].get();\n        auto ctx =\n            setup_ctx(channels_[ch].get_stub(), next_issuers_[t], request_);\n        ctx->Start(cq);\n      }\n      t = (t + 1) % cli_cqs_.size();    // <<<<<< [sreek] This is the problem. >>>>\n    } \n```\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/350879367",
    "html_url": "https://github.com/grpc/grpc/issues/6251#issuecomment-350879367",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/6251",
    "id": 350879367,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MDg3OTM2Nw==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-11T22:28:14Z",
    "updated_at": "2017-12-11T22:28:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "No activity here for long time, closing."
  }
]
