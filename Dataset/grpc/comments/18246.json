[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/469552001",
    "html_url": "https://github.com/grpc/grpc/pull/18246#issuecomment-469552001",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18246",
    "id": 469552001,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2OTU1MjAwMQ==",
    "user": {
      "login": "mehrdada",
      "id": 900411,
      "node_id": "MDQ6VXNlcjkwMDQxMQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/900411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mehrdada",
      "html_url": "https://github.com/mehrdada",
      "followers_url": "https://api.github.com/users/mehrdada/followers",
      "following_url": "https://api.github.com/users/mehrdada/following{/other_user}",
      "gists_url": "https://api.github.com/users/mehrdada/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mehrdada/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mehrdada/subscriptions",
      "organizations_url": "https://api.github.com/users/mehrdada/orgs",
      "repos_url": "https://api.github.com/users/mehrdada/repos",
      "events_url": "https://api.github.com/users/mehrdada/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mehrdada/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-05T06:08:46Z",
    "updated_at": "2019-03-05T06:08:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "@lidizheng please retrigger the test"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/469833551",
    "html_url": "https://github.com/grpc/grpc/pull/18246#issuecomment-469833551",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18246",
    "id": 469833551,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2OTgzMzU1MQ==",
    "user": {
      "login": "mehrdada",
      "id": 900411,
      "node_id": "MDQ6VXNlcjkwMDQxMQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/900411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mehrdada",
      "html_url": "https://github.com/mehrdada",
      "followers_url": "https://api.github.com/users/mehrdada/followers",
      "following_url": "https://api.github.com/users/mehrdada/following{/other_user}",
      "gists_url": "https://api.github.com/users/mehrdada/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mehrdada/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mehrdada/subscriptions",
      "organizations_url": "https://api.github.com/users/mehrdada/orgs",
      "repos_url": "https://api.github.com/users/mehrdada/repos",
      "events_url": "https://api.github.com/users/mehrdada/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mehrdada/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-05T19:53:09Z",
    "updated_at": "2019-03-05T19:53:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "@lidizheng not sure why windows fails in particular. Let's try again."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/469865221",
    "html_url": "https://github.com/grpc/grpc/pull/18246#issuecomment-469865221",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18246",
    "id": 469865221,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2OTg2NTIyMQ==",
    "user": {
      "login": "mehrdada",
      "id": 900411,
      "node_id": "MDQ6VXNlcjkwMDQxMQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/900411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mehrdada",
      "html_url": "https://github.com/mehrdada",
      "followers_url": "https://api.github.com/users/mehrdada/followers",
      "following_url": "https://api.github.com/users/mehrdada/following{/other_user}",
      "gists_url": "https://api.github.com/users/mehrdada/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mehrdada/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mehrdada/subscriptions",
      "organizations_url": "https://api.github.com/users/mehrdada/orgs",
      "repos_url": "https://api.github.com/users/mehrdada/repos",
      "events_url": "https://api.github.com/users/mehrdada/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mehrdada/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-05T21:31:03Z",
    "updated_at": "2019-03-05T21:31:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "@lidizheng that's strange... I cannot see the full logs and have no access to a Windows machine. I wonder why `gpr_timespec_from_nanos` might be affected by Windows. Do you have an idea?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/469865703",
    "html_url": "https://github.com/grpc/grpc/pull/18246#issuecomment-469865703",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18246",
    "id": 469865703,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2OTg2NTcwMw==",
    "user": {
      "login": "lidizheng",
      "id": 7394928,
      "node_id": "MDQ6VXNlcjczOTQ5Mjg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7394928?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lidizheng",
      "html_url": "https://github.com/lidizheng",
      "followers_url": "https://api.github.com/users/lidizheng/followers",
      "following_url": "https://api.github.com/users/lidizheng/following{/other_user}",
      "gists_url": "https://api.github.com/users/lidizheng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lidizheng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lidizheng/subscriptions",
      "organizations_url": "https://api.github.com/users/lidizheng/orgs",
      "repos_url": "https://api.github.com/users/lidizheng/repos",
      "events_url": "https://api.github.com/users/lidizheng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lidizheng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-05T21:32:24Z",
    "updated_at": "2019-03-05T21:32:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "@mehrdada I have no idea as well. I'm trying to reproduce the error in Windows machine."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/470750526",
    "html_url": "https://github.com/grpc/grpc/pull/18246#issuecomment-470750526",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18246",
    "id": 470750526,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MDc1MDUyNg==",
    "user": {
      "login": "lidizheng",
      "id": 7394928,
      "node_id": "MDQ6VXNlcjczOTQ5Mjg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7394928?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lidizheng",
      "html_url": "https://github.com/lidizheng",
      "followers_url": "https://api.github.com/users/lidizheng/followers",
      "following_url": "https://api.github.com/users/lidizheng/following{/other_user}",
      "gists_url": "https://api.github.com/users/lidizheng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lidizheng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lidizheng/subscriptions",
      "organizations_url": "https://api.github.com/users/lidizheng/orgs",
      "repos_url": "https://api.github.com/users/lidizheng/repos",
      "events_url": "https://api.github.com/users/lidizheng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lidizheng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-08T00:01:37Z",
    "updated_at": "2019-03-08T00:01:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "The failure is caused by an OverflowError in the initialization stage.\r\n![image](https://user-images.githubusercontent.com/7394928/53997724-2a73b480-40f2-11e9-8439-51aa55c6f2ec.png)\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/470830025",
    "html_url": "https://github.com/grpc/grpc/pull/18246#issuecomment-470830025",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18246",
    "id": 470830025,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MDgzMDAyNQ==",
    "user": {
      "login": "mehrdada",
      "id": 900411,
      "node_id": "MDQ6VXNlcjkwMDQxMQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/900411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mehrdada",
      "html_url": "https://github.com/mehrdada",
      "followers_url": "https://api.github.com/users/mehrdada/followers",
      "following_url": "https://api.github.com/users/mehrdada/following{/other_user}",
      "gists_url": "https://api.github.com/users/mehrdada/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mehrdada/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mehrdada/subscriptions",
      "organizations_url": "https://api.github.com/users/mehrdada/orgs",
      "repos_url": "https://api.github.com/users/mehrdada/repos",
      "events_url": "https://api.github.com/users/mehrdada/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mehrdada/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-08T07:13:37Z",
    "updated_at": "2019-03-08T07:13:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "lolz"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/473020153",
    "html_url": "https://github.com/grpc/grpc/pull/18246#issuecomment-473020153",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18246",
    "id": 473020153,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MzAyMDE1Mw==",
    "user": {
      "login": "lidizheng",
      "id": 7394928,
      "node_id": "MDQ6VXNlcjczOTQ5Mjg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7394928?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lidizheng",
      "html_url": "https://github.com/lidizheng",
      "followers_url": "https://api.github.com/users/lidizheng/followers",
      "following_url": "https://api.github.com/users/lidizheng/following{/other_user}",
      "gists_url": "https://api.github.com/users/lidizheng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lidizheng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lidizheng/subscriptions",
      "organizations_url": "https://api.github.com/users/lidizheng/orgs",
      "repos_url": "https://api.github.com/users/lidizheng/repos",
      "events_url": "https://api.github.com/users/lidizheng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lidizheng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-14T19:17:22Z",
    "updated_at": "2019-03-14T19:17:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "The root cause of the Windows test case failure is a Cython bug in Windows. Cython provides several `PyInt` to C integer conversion functions, e.g. `__Pyx_PyInt_As_int`, `__Pyx_PyInt_As_hid_t `. The longest possible C integer type conversion is `__Pyx_PyInt_As_long`. It's possible the Cython to Cpp compiler either failed to recognize the size difference of `long` across platforms, or it uses `__Pyx_PyInt_As_long` as default. Eventually, that resulted in the OverflowError we observed.\r\n\r\nAlso, the clock type mismatch is caused by uninitialized C struct. The C struct is allocated in the stack, and the clock type is assigned to the random value in the stack.\r\n\r\nThe source\r\n```cpp\r\ngpr_time_from_nanos(<int64_t>(time * GPR_NS_PER_SEC), GPR_CLOCK_REALTIME)\r\n```\r\n\r\nGenerated CPP highlight:\r\n```cpp\r\n__pyx_t_3 = __Pyx_PyInt_From_int(GPR_NS_PER_SEC);\r\n__pyx_t_4 = PyNumber_Multiply(__pyx_v_time, __pyx_t_3);\r\n__pyx_t_5 = __Pyx_PyInt_As_long(__pyx_t_4);        # <- Evil!\r\n__pyx_v_timespec = gpr_time_from_nanos(((__pyx_t_4grpc_7_cython_6cygrpc_int64_t)__pyx_t_5), GPR_CLOCK_REALTIME);\r\n```\r\n\r\nOS | Architecture | Size of \"long\" type\r\n-- | -- | --\r\nWindows | IA-32 | 4 bytes\r\n  | Intel® 64 | 4 bytes\r\nLinux | IA-32 | 4 bytes\r\n  | Intel® 64 | 8 bytes\r\nmac OS | Intel® 64 | 8 bytes\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/473125481",
    "html_url": "https://github.com/grpc/grpc/pull/18246#issuecomment-473125481",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18246",
    "id": 473125481,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MzEyNTQ4MQ==",
    "user": {
      "login": "lidizheng",
      "id": 7394928,
      "node_id": "MDQ6VXNlcjczOTQ5Mjg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7394928?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lidizheng",
      "html_url": "https://github.com/lidizheng",
      "followers_url": "https://api.github.com/users/lidizheng/followers",
      "following_url": "https://api.github.com/users/lidizheng/following{/other_user}",
      "gists_url": "https://api.github.com/users/lidizheng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lidizheng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lidizheng/subscriptions",
      "organizations_url": "https://api.github.com/users/lidizheng/orgs",
      "repos_url": "https://api.github.com/users/lidizheng/repos",
      "events_url": "https://api.github.com/users/lidizheng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lidizheng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-15T01:28:57Z",
    "updated_at": "2019-03-15T01:28:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "Converting the Python `time.time()` float into C `double` will not solve the situation, the test cases under Windows will hang or failed with deadline exceeded.\r\n\r\nLog: https://source.cloud.google.com/results/invocations/20b86bb1-768c-448a-acdd-ea4046ce87d1/targets/github%2Fgrpc%2Fpython_windows_opt_native/tests;group=python_windows_opt_native;test=py35_native.test.unit._metadata_flags_test.MetadataFlagsTest;row=6\r\n\r\nCython line of conversion:\r\n``` cpp\r\ngpr_time_from_nanos(<int64_t>(<double>(time) * GPR_NS_PER_SEC), GPR_CLOCK_REALTIME)\r\n```\r\n\r\nGenerated cpp lines:\r\n```cpp\r\n__pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_v_time);\r\n__pyx_v_timespec = gpr_time_from_nanos(((__pyx_t_4grpc_7_cython_6cygrpc_int64_t)(((double)__pyx_t_3) * GPR_NS_PER_SEC)), GPR_CLOCK_REALTIME);\r\n```"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/473137982",
    "html_url": "https://github.com/grpc/grpc/pull/18246#issuecomment-473137982",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18246",
    "id": 473137982,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MzEzNzk4Mg==",
    "user": {
      "login": "lidizheng",
      "id": 7394928,
      "node_id": "MDQ6VXNlcjczOTQ5Mjg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7394928?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lidizheng",
      "html_url": "https://github.com/lidizheng",
      "followers_url": "https://api.github.com/users/lidizheng/followers",
      "following_url": "https://api.github.com/users/lidizheng/following{/other_user}",
      "gists_url": "https://api.github.com/users/lidizheng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lidizheng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lidizheng/subscriptions",
      "organizations_url": "https://api.github.com/users/lidizheng/orgs",
      "repos_url": "https://api.github.com/users/lidizheng/repos",
      "events_url": "https://api.github.com/users/lidizheng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lidizheng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-15T02:42:42Z",
    "updated_at": "2019-03-15T02:42:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "I printed out the conversion result. It is quite funny that all the timestamp conversion will silently overflow to a negative number, even with above conversion to securely convert to float number and back.\r\n```\r\nInput 1552617058.89 time, output -3 seconds 852516352 nanoseconds 1 clock type\r\n```\r\n\r\nAnother fun fact is that, the `int64_t` above, I assume it is the `int64_t` defined by cpp library, but turned out it is override by ourself in `grpc.pxi`.\r\n\r\n```Cython\r\n# Typedef types with approximately the same semantics to provide their names to\r\n# Cython\r\nctypedef unsigned char uint8_t\r\nctypedef int int32_t\r\nctypedef unsigned uint32_t\r\nctypedef long int64_t\r\n```\r\n\r\nAs I mentioned before, the size of `long` will be 64 bits only on Linux 64 or macOS. It is amazing that the data loss (overflow) never got reported."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/473455975",
    "html_url": "https://github.com/grpc/grpc/pull/18246#issuecomment-473455975",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18246",
    "id": 473455975,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MzQ1NTk3NQ==",
    "user": {
      "login": "mehrdada",
      "id": 900411,
      "node_id": "MDQ6VXNlcjkwMDQxMQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/900411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mehrdada",
      "html_url": "https://github.com/mehrdada",
      "followers_url": "https://api.github.com/users/mehrdada/followers",
      "following_url": "https://api.github.com/users/mehrdada/following{/other_user}",
      "gists_url": "https://api.github.com/users/mehrdada/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mehrdada/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mehrdada/subscriptions",
      "organizations_url": "https://api.github.com/users/mehrdada/orgs",
      "repos_url": "https://api.github.com/users/mehrdada/repos",
      "events_url": "https://api.github.com/users/mehrdada/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mehrdada/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-15T22:06:09Z",
    "updated_at": "2019-03-15T22:06:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "@lidizheng are we using latest Cython? I remember something broke once on windows and we had to pin cython."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/473472986",
    "html_url": "https://github.com/grpc/grpc/pull/18246#issuecomment-473472986",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18246",
    "id": 473472986,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MzQ3Mjk4Ng==",
    "user": {
      "login": "lidizheng",
      "id": 7394928,
      "node_id": "MDQ6VXNlcjczOTQ5Mjg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7394928?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lidizheng",
      "html_url": "https://github.com/lidizheng",
      "followers_url": "https://api.github.com/users/lidizheng/followers",
      "following_url": "https://api.github.com/users/lidizheng/following{/other_user}",
      "gists_url": "https://api.github.com/users/lidizheng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lidizheng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lidizheng/subscriptions",
      "organizations_url": "https://api.github.com/users/lidizheng/orgs",
      "repos_url": "https://api.github.com/users/lidizheng/repos",
      "events_url": "https://api.github.com/users/lidizheng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lidizheng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-15T23:35:42Z",
    "updated_at": "2019-03-15T23:35:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "@mehrdada Nope, we are pining to \"0.28.3\" for now. I created #18408, let's see what could possibly go wrong. "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/474074403",
    "html_url": "https://github.com/grpc/grpc/pull/18246#issuecomment-474074403",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18246",
    "id": 474074403,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NDA3NDQwMw==",
    "user": {
      "login": "lidizheng",
      "id": 7394928,
      "node_id": "MDQ6VXNlcjczOTQ5Mjg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7394928?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lidizheng",
      "html_url": "https://github.com/lidizheng",
      "followers_url": "https://api.github.com/users/lidizheng/followers",
      "following_url": "https://api.github.com/users/lidizheng/following{/other_user}",
      "gists_url": "https://api.github.com/users/lidizheng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lidizheng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lidizheng/subscriptions",
      "organizations_url": "https://api.github.com/users/lidizheng/orgs",
      "repos_url": "https://api.github.com/users/lidizheng/repos",
      "events_url": "https://api.github.com/users/lidizheng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lidizheng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-18T19:51:27Z",
    "updated_at": "2019-03-18T19:51:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "Changes are submitted in https://github.com/grpc/grpc/pull/18398 which fixes the Windows issues."
  }
]
