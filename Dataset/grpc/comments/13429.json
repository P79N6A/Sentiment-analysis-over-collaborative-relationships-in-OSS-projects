[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/350396370",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-350396370",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 350396370,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MDM5NjM3MA==",
    "user": {
      "login": "dgquintas",
      "id": 120217,
      "node_id": "MDQ6VXNlcjEyMDIxNw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/120217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dgquintas",
      "html_url": "https://github.com/dgquintas",
      "followers_url": "https://api.github.com/users/dgquintas/followers",
      "following_url": "https://api.github.com/users/dgquintas/following{/other_user}",
      "gists_url": "https://api.github.com/users/dgquintas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dgquintas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dgquintas/subscriptions",
      "organizations_url": "https://api.github.com/users/dgquintas/orgs",
      "repos_url": "https://api.github.com/users/dgquintas/repos",
      "events_url": "https://api.github.com/users/dgquintas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dgquintas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-08T23:18:16Z",
    "updated_at": "2017-12-08T23:18:16Z",
    "author_association": "NONE",
    "body": "Seems to be the same one, but now with an asan trace, heap-use-after free: https://sponge.corp.google.com/target?id=ccdc5d62-9302-4523-9c2d-edd0ec1bec76&target=github/grpc/c%2B%2B_linux_asan_native&searchFor=&show=ALL&sortBy=STATUS"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/357673620",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-357673620",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 357673620,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzY3MzYyMA==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-15T12:47:56Z",
    "updated_at": "2018-01-15T12:47:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "This is failing 16% of all asan builds (because the test case runs multiple times in each suite which amplifies the flakiness rate).\r\n\r\nhttps://sponge.corp.google.com/invocation?id=795838cc-15e1-4dee-a072-7ccbf6e8307c\r\nhttps://sponge.corp.google.com/invocation?id=dcafccf1-2899-475d-8474-2683a9c57c9e\r\nhttps://sponge.corp.google.com/invocation?id=676654ff-6a73-417d-ace8-e4dc7a5a9fad\r\nhttps://sponge.corp.google.com/invocation?id=6f3bb451-9e4d-4b45-9fae-a0121a02036c\r\nhttps://sponge.corp.google.com/invocation?id=59ec1149-8061-4137-b183-19cd23a9a2da"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/360276735",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-360276735",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 360276735,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MDI3NjczNQ==",
    "user": {
      "login": "mehrdada",
      "id": 900411,
      "node_id": "MDQ6VXNlcjkwMDQxMQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/900411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mehrdada",
      "html_url": "https://github.com/mehrdada",
      "followers_url": "https://api.github.com/users/mehrdada/followers",
      "following_url": "https://api.github.com/users/mehrdada/following{/other_user}",
      "gists_url": "https://api.github.com/users/mehrdada/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mehrdada/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mehrdada/subscriptions",
      "organizations_url": "https://api.github.com/users/mehrdada/orgs",
      "repos_url": "https://api.github.com/users/mehrdada/repos",
      "events_url": "https://api.github.com/users/mehrdada/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mehrdada/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-24T21:19:20Z",
    "updated_at": "2018-01-24T21:19:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "Failure: json_run_localhost:cpp_protobuf_async_unary_qps_unconstrained_2waysharedcq_insecure\r\n\r\nhttps://sponge.corp.google.com/target?id=f5192b51-10fe-484b-91f2-743d20d3fc75&target=github/grpc/aggregate_tests&searchFor=&show=ALL&sortBy=STATUS"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/361225006",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-361225006",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 361225006,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MTIyNTAwNg==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-29T12:02:38Z",
    "updated_at": "2018-01-29T12:02:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "More data:\r\n- only happening with `epollex`\r\n- test is timing out (and the preset timeout is actually too high - 1200 or 3600sec).\r\n\r\nTSAN:\r\nhttps://sponge.corp.google.com/invocation?id=7bddf59f-9c48-4a72-93f2-1dcb232e8404\r\n\r\nASAN:\r\nhttps://sponge.corp.google.com/invocation?id=57c3dff8-b7ab-4d9e-af02-9f56ea93620d\r\n\r\ndbg:\r\nhttps://sponge.corp.google.com/invocation?id=404c1aa9-2355-485d-ac19-74fa1c6f4536\r\n\r\nopt:\r\nhttps://sponge.corp.google.com/invocation?id=04ea9c1f-5688-4fa2-b2fe-d509e33994e0\r\n\r\n\r\n\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/361261449",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-361261449",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 361261449,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MTI2MTQ0OQ==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-29T14:26:45Z",
    "updated_at": "2018-01-29T14:33:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm able to reproduce on a VM with\r\n`tools/run_tests/run_tests.py -l c++ -c opt -r 'bm_fullstack_streaming_pump.*SockPair' -n 50 --force_use_pollers epollex` (given enough runs).\r\n\r\nThe test gets stuck ( (I'm not yet sure why) in https://github.com/grpc/grpc/blob/123547c9625c56fdf5cb4ddd1df55ae0c785fa60/test/cpp/microbenchmarks/fullstack_fixtures.h#L211, which invokes https://github.com/grpc/grpc/blob/123547c9625c56fdf5cb4ddd1df55ae0c785fa60/src/cpp/server/server_cc.cc#L595\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/361328339",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-361328339",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 361328339,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MTMyODMzOQ==",
    "user": {
      "login": "dgquintas",
      "id": 120217,
      "node_id": "MDQ6VXNlcjEyMDIxNw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/120217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dgquintas",
      "html_url": "https://github.com/dgquintas",
      "followers_url": "https://api.github.com/users/dgquintas/followers",
      "following_url": "https://api.github.com/users/dgquintas/following{/other_user}",
      "gists_url": "https://api.github.com/users/dgquintas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dgquintas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dgquintas/subscriptions",
      "organizations_url": "https://api.github.com/users/dgquintas/orgs",
      "repos_url": "https://api.github.com/users/dgquintas/repos",
      "events_url": "https://api.github.com/users/dgquintas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dgquintas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-29T17:51:17Z",
    "updated_at": "2018-01-29T17:51:17Z",
    "author_association": "NONE",
    "body": "@ncteisen given all this info, do you think it'd be possible to tackle this issue soon? It's responsible for 16% of non-green PRs."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/361342214",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-361342214",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 361342214,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MTM0MjIxNA==",
    "user": {
      "login": "ncteisen",
      "id": 6148140,
      "node_id": "MDQ6VXNlcjYxNDgxNDA=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6148140?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ncteisen",
      "html_url": "https://github.com/ncteisen",
      "followers_url": "https://api.github.com/users/ncteisen/followers",
      "following_url": "https://api.github.com/users/ncteisen/following{/other_user}",
      "gists_url": "https://api.github.com/users/ncteisen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ncteisen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ncteisen/subscriptions",
      "organizations_url": "https://api.github.com/users/ncteisen/orgs",
      "repos_url": "https://api.github.com/users/ncteisen/repos",
      "events_url": "https://api.github.com/users/ncteisen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ncteisen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-29T18:36:10Z",
    "updated_at": "2018-01-29T18:36:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "@sreecha is going to take a look and see if his #14217 will fix this. If not, I will dive in. I need to update my machine to enable epollex and then I will start digging"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/361423053",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-361423053",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 361423053,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MTQyMzA1Mw==",
    "user": {
      "login": "sreecha",
      "id": 2754995,
      "node_id": "MDQ6VXNlcjI3NTQ5OTU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/2754995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sreecha",
      "html_url": "https://github.com/sreecha",
      "followers_url": "https://api.github.com/users/sreecha/followers",
      "following_url": "https://api.github.com/users/sreecha/following{/other_user}",
      "gists_url": "https://api.github.com/users/sreecha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sreecha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sreecha/subscriptions",
      "organizations_url": "https://api.github.com/users/sreecha/orgs",
      "repos_url": "https://api.github.com/users/sreecha/repos",
      "events_url": "https://api.github.com/users/sreecha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sreecha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-29T23:28:17Z",
    "updated_at": "2018-01-29T23:28:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "Issue #14217 does not seem to fix this. However, the tests also fail for `poll` polling engine. \r\nNote that the test is disabled for `poll` and `poll-cv` (Just to reduce the number of polling engines this runs on; no other particular reason for disabling).\r\n\r\nSo I had to modify `build.yaml` to enable the tests for `poll` engine. \r\n\r\nLike Jan mentioned earlier, this is stuck in server shutdown path. The thread is waiting for server shutdown to complete. It is not clear why the shutdown isn't progressing.. I suspect that progress isn't happening on some fd. \r\n\r\nI will try to add more detailed tracing.."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/361686770",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-361686770",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 361686770,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MTY4Njc3MA==",
    "user": {
      "login": "sreecha",
      "id": 2754995,
      "node_id": "MDQ6VXNlcjI3NTQ5OTU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/2754995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sreecha",
      "html_url": "https://github.com/sreecha",
      "followers_url": "https://api.github.com/users/sreecha/followers",
      "following_url": "https://api.github.com/users/sreecha/following{/other_user}",
      "gists_url": "https://api.github.com/users/sreecha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sreecha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sreecha/subscriptions",
      "organizations_url": "https://api.github.com/users/sreecha/orgs",
      "repos_url": "https://api.github.com/users/sreecha/repos",
      "events_url": "https://api.github.com/users/sreecha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sreecha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-30T18:22:44Z",
    "updated_at": "2018-01-30T18:22:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "I looked at this some more.. Don't have the root cause yet but the server is stuck in shutdown because it is waiting for the channel to be destroyed.\r\n\r\nThe server shutdown method (i.e https://github.com/grpc/grpc/blob/v1.8.6/src/core/lib/surface/server.cc#L1202) \r\n  - Kills pending work: https://github.com/grpc/grpc/blob/v1.8.6/src/core/lib/surface/server.cc#L1247 (which just fails any pending calls)\r\n-  Sees if the shutdown can complete (see: https://github.com/grpc/grpc/blob/v1.8.6/src/core/lib/surface/server.cc#L680)\r\n-  The shutdown does not happen if the listeners and channels are not destroyed (once all of them are shutdown, the shutdown would proceed - i.e `maybe_finish_shutdown` is also calledwhen channel is destroyed, when listener is destroyed ).  https://github.com/grpc/grpc/blob/v1.8.6/src/core/lib/surface/server.cc#L691\r\n\r\nWhen I looked at the failing test (i.e test where the thread is stuck in shutdown), I notice that the server does not have any listeners and it has one channel that is in idle state (see `server-> root_channel_data`)..not sure why.\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/362215304",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-362215304",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 362215304,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MjIxNTMwNA==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-01T09:54:39Z",
    "updated_at": "2018-02-01T09:54:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for the updates, @sreecha. Btw, after fixing other stuff, this is now our most frequent flake, so it would be beautiful if we could fix this."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/362302703",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-362302703",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 362302703,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MjMwMjcwMw==",
    "user": {
      "login": "ncteisen",
      "id": 6148140,
      "node_id": "MDQ6VXNlcjYxNDgxNDA=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6148140?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ncteisen",
      "html_url": "https://github.com/ncteisen",
      "followers_url": "https://api.github.com/users/ncteisen/followers",
      "following_url": "https://api.github.com/users/ncteisen/following{/other_user}",
      "gists_url": "https://api.github.com/users/ncteisen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ncteisen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ncteisen/subscriptions",
      "organizations_url": "https://api.github.com/users/ncteisen/orgs",
      "repos_url": "https://api.github.com/users/ncteisen/repos",
      "events_url": "https://api.github.com/users/ncteisen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ncteisen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-01T15:34:16Z",
    "updated_at": "2018-02-01T15:34:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "I have set aside some time today to work on this"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/363484411",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-363484411",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 363484411,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MzQ4NDQxMQ==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-06T16:42:30Z",
    "updated_at": "2018-02-06T16:42:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "Any progress here?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/363490051",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-363490051",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 363490051,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MzQ5MDA1MQ==",
    "user": {
      "login": "sreecha",
      "id": 2754995,
      "node_id": "MDQ6VXNlcjI3NTQ5OTU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/2754995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sreecha",
      "html_url": "https://github.com/sreecha",
      "followers_url": "https://api.github.com/users/sreecha/followers",
      "following_url": "https://api.github.com/users/sreecha/following{/other_user}",
      "gists_url": "https://api.github.com/users/sreecha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sreecha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sreecha/subscriptions",
      "organizations_url": "https://api.github.com/users/sreecha/orgs",
      "repos_url": "https://api.github.com/users/sreecha/repos",
      "events_url": "https://api.github.com/users/sreecha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sreecha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-06T16:58:06Z",
    "updated_at": "2018-02-06T16:58:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "I looked at it some more last evening ..no update yet. I'll send an update by EOD "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/363657093",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-363657093",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 363657093,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MzY1NzA5Mw==",
    "user": {
      "login": "sreecha",
      "id": 2754995,
      "node_id": "MDQ6VXNlcjI3NTQ5OTU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/2754995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sreecha",
      "html_url": "https://github.com/sreecha",
      "followers_url": "https://api.github.com/users/sreecha/followers",
      "following_url": "https://api.github.com/users/sreecha/following{/other_user}",
      "gists_url": "https://api.github.com/users/sreecha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sreecha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sreecha/subscriptions",
      "organizations_url": "https://api.github.com/users/sreecha/orgs",
      "repos_url": "https://api.github.com/users/sreecha/repos",
      "events_url": "https://api.github.com/users/sreecha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sreecha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-07T04:55:02Z",
    "updated_at": "2018-02-07T23:37:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "I found the root cause for the issue. \r\n(Thanks to Yuchen(@y-zeng) and Yash (@yashykt ) for brainstorming on this and for proposing solutions)\r\n\r\nTLDR; Server shutdown does a write that **sometimes** does not complete and needs some thread to do a cq-next() to complete the write. This test is single threaded and the thread is blocked in the server shutdown call and since no other thread is doing a cq-next, no progress is made.\r\n\r\nThe fix may look trivial but it is not. The problem is a bit more subtle. Here are more details of the issue:\r\n1) During teardown, the fixture first calls the following operations (in that order - all in one thread)\r\n - Server shutdown\r\n - Cq shutdown\r\n - Drain Cq \r\n(source [here](https://github.com/grpc/grpc/blob/v1.9.0/test/cpp/microbenchmarks/fullstack_fixtures.h#L86))\r\n\r\n2) Server Shutdown is a **blocking call**  - It internally calls the grpc API `grpc_server_shutdown_and_notify` and **blocks** on a separate shutdown_cq for to be notified of the shutdown completion. (see source [here](https://github.com/grpc/grpc/blob/v1.9.0/src/cpp/server/server_cc.cc#L557))\r\n\r\n3) [grpc_server_shutdown_and_notify](https://github.com/grpc/grpc/blob/v1.9.0/src/core/lib/surface/server.cc#L1159)  as a part of shutting down sends a [GOAWAY](https://github.com/grpc/grpc/blob/v1.9.0/src/core/lib/surface/server.cc#L293) on all its connections (i.e a write operation) and once the GOAWAY write is done, it [closes](https://github.com/grpc/grpc/blob/v1.9.0/src/core/ext/transport/chttp2/transport/chttp2_transport.cc#L828) the connection (i.e 'transport'). Unless the transport is closed, it won't release the reference to the server and the [shutdown](https://github.com/grpc/grpc/blob/v1.9.0/src/core/lib/surface/server.cc#L417) will not complete.\r\n\r\n4) Now, in most of the cases the GOAWAY write finishes just fine in a synchronous way. In some cases the `sendmsg` API may written `EAGAIN` (see [here](https://github.com/grpc/grpc/blob/v1.9.0/src/core/lib/iomgr/tcp_posix.cc#L564))\r\n\r\n5) When this happens, the write happens only when some thread calls `grpc_completion_queue_next()` on the server completion queue.\r\n(But from step (1) above, that does not happen until AFTER the server and cq shutdown) and hence the thread blocks indefinitely on server shutdown.\r\n\r\nIn most of the cases, in step (4), `sendmsg()` succeeds without sending EAGAIN and everything works out fine.\r\n\r\n---\r\nI will fix the test for now by calling C-Core APIs directly (i.e `grpc_shutdown_and_notify()` and pass the same server cq as the shutdown cq) . I can't think of a better way at this point.\r\n\r\nIn future, it would really help to add a Async server Shutdown at C++ level.\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/363667562",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-363667562",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 363667562,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MzY2NzU2Mg==",
    "user": {
      "login": "dgquintas",
      "id": 120217,
      "node_id": "MDQ6VXNlcjEyMDIxNw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/120217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dgquintas",
      "html_url": "https://github.com/dgquintas",
      "followers_url": "https://api.github.com/users/dgquintas/followers",
      "following_url": "https://api.github.com/users/dgquintas/following{/other_user}",
      "gists_url": "https://api.github.com/users/dgquintas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dgquintas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dgquintas/subscriptions",
      "organizations_url": "https://api.github.com/users/dgquintas/orgs",
      "repos_url": "https://api.github.com/users/dgquintas/repos",
      "events_url": "https://api.github.com/users/dgquintas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dgquintas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-07T06:08:28Z",
    "updated_at": "2018-02-07T06:08:28Z",
    "author_association": "NONE",
    "body": "Sree you are THE BOSS!\n\nOn Tue, 6 Feb 2018, 20:55 Sree Kuchibhotla, <notifications@github.com>\nwrote:\n\n> I found the root cause for the issue.\n>\n> TLDR; Server shutdown does a write that *sometimes* does not complete and\n> needs some thread to do a cq-next() to complete the write. This thread is\n> single threaded and the thread is blocked in the server shutdown call and\n> no other thread is doing a cq-next.\n>\n> The fix may look trivial but it is not. The problem is a bit more subtle.\n> Here are more details of the issue:\n>\n>    1. During teardown, the fixture first calls the following operations\n>    (in that order - all in one thread)\n>\n>\n>    - Server shutdown\n>    - Cq shutdown\n>    - Drain Cq\n>    (source here\n>    <https://github.com/grpc/grpc/blob/v1.9.0/test/cpp/microbenchmarks/fullstack_fixtures.h#L86>\n>    )\n>\n>\n>    1.\n>\n>    Server Shutdown is a *blocking call* - It internally calls the grpc\n>    API grpc_server_shutdown_and_notify and *blocks* on a separate\n>    shutdown_cq for to be notified of the shutdown completion. (see source\n>    here\n>    <https://github.com/grpc/grpc/blob/v1.9.0/src/cpp/server/server_cc.cc#L557>\n>    )\n>    2.\n>\n>    grpc_server_shutdown_and_notify as a part of shutting down sends a\n>    GOAWAY on all its connections (i.e a write operation) and once the GOAWAY\n>    write is done, it closes the connection (i.e 'transport'). Unless the\n>    transport is closed, it won't release the reference to the server and the\n>    shutdown will not complete.\n>    3.\n>\n>    Now, in most of the cases the GOAWAY write finishes just fine in a\n>    synchronous way. In some cases the sendmsg API may written EAGAIN (see\n>    here\n>    <https://github.com/grpc/grpc/blob/v1.9.0/src/core/lib/iomgr/tcp_posix.cc#L564>\n>    )\n>    4.\n>\n>    When this happens, the write happens only when some thread calls\n>    grpc_completion_queue_next() on the server completion queue.\n>    (But from step (1) above, that does not happen until AFTER the server\n>    and cq shutdown) and hence the thread blocks indefinitely on server\n>    shutdown.\n>\n> In most of the cases, in step (4), sendmsg() succeeds without sending\n> EAGAIN and everything works out fine.\n> ------------------------------\n>\n> I will fix the test for now by calling C-Core APIs directly (i.e\n> grpc_shutdown_and_notify() and pass the same server cq as the shutdown\n> cq) . I can't think of a better way at this point.\n>\n> In future, it would really help to add a Async server Shutdown at C++\n> level.\n>\n> —\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/grpc/grpc/issues/13429#issuecomment-363657093>, or mute\n> the thread\n> <https://github.com/notifications/unsubscribe-auth/AAHVmYaoGmgVB83S_KoaJ4DDDw5PK1ZRks5tSSy5gaJpZM4QhP_E>\n> .\n>\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/363687871",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-363687871",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 363687871,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MzY4Nzg3MQ==",
    "user": {
      "login": "sreecha",
      "id": 2754995,
      "node_id": "MDQ6VXNlcjI3NTQ5OTU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/2754995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sreecha",
      "html_url": "https://github.com/sreecha",
      "followers_url": "https://api.github.com/users/sreecha/followers",
      "following_url": "https://api.github.com/users/sreecha/following{/other_user}",
      "gists_url": "https://api.github.com/users/sreecha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sreecha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sreecha/subscriptions",
      "organizations_url": "https://api.github.com/users/sreecha/orgs",
      "repos_url": "https://api.github.com/users/sreecha/repos",
      "events_url": "https://api.github.com/users/sreecha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sreecha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-07T08:04:46Z",
    "updated_at": "2018-02-07T08:04:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "Fix is here: https://github.com/grpc/grpc/pull/14351\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/363948192",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-363948192",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 363948192,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2Mzk0ODE5Mg==",
    "user": {
      "login": "yang-g",
      "id": 10122250,
      "node_id": "MDQ6VXNlcjEwMTIyMjUw",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10122250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yang-g",
      "html_url": "https://github.com/yang-g",
      "followers_url": "https://api.github.com/users/yang-g/followers",
      "following_url": "https://api.github.com/users/yang-g/following{/other_user}",
      "gists_url": "https://api.github.com/users/yang-g/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yang-g/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yang-g/subscriptions",
      "organizations_url": "https://api.github.com/users/yang-g/orgs",
      "repos_url": "https://api.github.com/users/yang-g/repos",
      "events_url": "https://api.github.com/users/yang-g/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yang-g/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-07T23:32:11Z",
    "updated_at": "2018-02-07T23:32:11Z",
    "author_association": "MEMBER",
    "body": "Approved the fix. I think it is fair to say the user of async server should keep polling the ServerCqs until the server is shut down. And thus the real applications should not have this problem."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/363950010",
    "html_url": "https://github.com/grpc/grpc/issues/13429#issuecomment-363950010",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13429",
    "id": 363950010,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2Mzk1MDAxMA==",
    "user": {
      "login": "sreecha",
      "id": 2754995,
      "node_id": "MDQ6VXNlcjI3NTQ5OTU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/2754995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sreecha",
      "html_url": "https://github.com/sreecha",
      "followers_url": "https://api.github.com/users/sreecha/followers",
      "following_url": "https://api.github.com/users/sreecha/following{/other_user}",
      "gists_url": "https://api.github.com/users/sreecha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sreecha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sreecha/subscriptions",
      "organizations_url": "https://api.github.com/users/sreecha/orgs",
      "repos_url": "https://api.github.com/users/sreecha/repos",
      "events_url": "https://api.github.com/users/sreecha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sreecha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-07T23:40:07Z",
    "updated_at": "2018-02-07T23:40:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "@yang-g , yes.. you are right - we are technically not violating our contract and this is not a \"bug\" in grpc code. However, I am thinking it might help if we exposed a  `ShutdownAsync()` API at C++ level. This way, user can pass their own completion queue (which can be one of the server completion queues) and even a single thread can coordinate the shutdown."
  }
]
