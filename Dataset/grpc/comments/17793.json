[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/457487577",
    "html_url": "https://github.com/grpc/grpc/pull/17793#issuecomment-457487577",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17793",
    "id": 457487577,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NzQ4NzU3Nw==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-25T08:00:05Z",
    "updated_at": "2019-01-25T08:00:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "A few insights:\r\n- AFAIK the only reason why tools/run_tests/run_performance_tests.py is slow is that python build is also slow. The script doesn't do much beside building and then running the scenario (each scenario takes ~35 secs to run). Perhaps we should focus on making python build faster (and make sure the right args are used in https://github.com/grpc/grpc/blob/f7a4d1e0c74f3c76bd09d8f54ab1d2c357df2788/tools/run_tests/performance/build_performance.sh#L73)\r\n- there is a kokoro job that allows you to run the performance benchmark in a single-machine setup: \r\nhttps://fusion.corp.google.com/projectanalysis/current/KOKORO/prod%3Agrpc%2Fcore%2Fmaster%2Flinux%2Fgrpc_e2e_performance_singlevm\r\n- before submitting please doublecheck that the performance benchmark scenarios continue to work as they are a bit fragile (there is a way to run an adhoc run with multimachine setup, I can help with that once I have a bit of free time).\r\n- please do not submit any changes to performance benchmarks without me reviewing first."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/457489138",
    "html_url": "https://github.com/grpc/grpc/pull/17793#issuecomment-457489138",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17793",
    "id": 457489138,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NzQ4OTEzOA==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-25T08:06:34Z",
    "updated_at": "2019-01-25T08:07:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "I scanned through the code quickly and looks like this is only adding a bazel test that runs a few basic python benchmarks locally. If that's the case and there are no changes to the run_performance_tests.py suite, I probably don't need to review.\r\n\r\n(but I still don't quite understand why running the run_performance_tests.py script is so slow for python - we have accelerated the python build recently, haven't we?)."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/457693582",
    "html_url": "https://github.com/grpc/grpc/pull/17793#issuecomment-457693582",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17793",
    "id": 457693582,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NzY5MzU4Mg==",
    "user": {
      "login": "lidizheng",
      "id": 7394928,
      "node_id": "MDQ6VXNlcjczOTQ5Mjg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7394928?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lidizheng",
      "html_url": "https://github.com/lidizheng",
      "followers_url": "https://api.github.com/users/lidizheng/followers",
      "following_url": "https://api.github.com/users/lidizheng/following{/other_user}",
      "gists_url": "https://api.github.com/users/lidizheng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lidizheng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lidizheng/subscriptions",
      "organizations_url": "https://api.github.com/users/lidizheng/orgs",
      "repos_url": "https://api.github.com/users/lidizheng/repos",
      "events_url": "https://api.github.com/users/lidizheng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lidizheng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-25T19:23:20Z",
    "updated_at": "2019-01-25T19:23:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "There are two major performance issue with `setuptools` which is the build tooling gRPC Python is using. The first is that it builds C files one-by-one which solved by your PR. And the second is that it doesn't do incremental builds as I wrote in the description... In comparison, Bazel is doing really well to produce a development build, it is fast and stable.\r\n\r\nThe purpose of this PR is adding a handy tool to tune performance locally with frequent code changes. However, we still need the `build_python.sh` to depend on `setuptools` since only `setuptools` is able to generate distribution packages which is the version actually used by our users."
  }
]
