[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/451048646",
    "html_url": "https://github.com/grpc/grpc/issues/17516#issuecomment-451048646",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17516",
    "id": 451048646,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MTA0ODY0Ng==",
    "user": {
      "login": "moonspirit",
      "id": 1793306,
      "node_id": "MDQ6VXNlcjE3OTMzMDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1793306?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/moonspirit",
      "html_url": "https://github.com/moonspirit",
      "followers_url": "https://api.github.com/users/moonspirit/followers",
      "following_url": "https://api.github.com/users/moonspirit/following{/other_user}",
      "gists_url": "https://api.github.com/users/moonspirit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/moonspirit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/moonspirit/subscriptions",
      "organizations_url": "https://api.github.com/users/moonspirit/orgs",
      "repos_url": "https://api.github.com/users/moonspirit/repos",
      "events_url": "https://api.github.com/users/moonspirit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/moonspirit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-03T03:31:14Z",
    "updated_at": "2019-01-03T03:48:45Z",
    "author_association": "NONE",
    "body": "any update on this? i got the similar problem with v.1.17.x\r\n\r\n(ubuntu 14.04 gcc 4.8.4)\r\nsimple code:\r\n```\r\n#include <iostream>\r\n#include <unistd.h>\r\n#include <grpcpp/grpcpp.h>\r\n#include <grpcpp/alarm.h>\r\n#include <grpc/support/log.h>\r\n#include <grpc/support/time.h>\r\n#include <thread>\r\n#include \"helloworld.grpc.pb.h\"\r\n\r\nusing namespace grpc;\r\n\r\nstd::unique_ptr<Server> server;\r\nstd::unique_ptr<CompletionQueue> cq;\r\n\r\n\r\nint main() {\r\n\r\n  std::string server_address(\"0.0.0.0:50051\");\r\n  ServerBuilder builder;\r\n  builder.AddListeningPort(server_address, grpc::InsecureServerCredentials());\r\n  helloworld::Greeter::AsyncService service;\r\n  builder.RegisterService(&service);\r\n\r\n  cq = builder.AddCompletionQueue();\r\n  server = builder.BuildAndStart();\r\n\r\n  Alarm alarm1;\r\n  alarm1.Set(cq.get(), std::chrono::system_clock::now() + std::chrono::seconds(1), (void*)0x1234567);\r\n  Alarm alarm2;\r\n  alarm2.Set(cq.get(), std::chrono::system_clock::now() + std::chrono::seconds(10*1000), (void*)0x12345678);\r\n\r\n  void* tag;\r\n  bool ok;\r\n  while (true) {\r\n    if (!cq->Next(&tag, &ok)) {\r\n      break;\r\n    }\r\n\r\n    if (!ok) {\r\n      break;\r\n    }\r\n\r\n    std::cout << tag << std::endl;\r\n    if (tag == (void *)0x1234567) {\r\n      server->Shutdown();\r\n      cq->Shutdown();\r\n      break;\r\n    }\r\n  }\r\n\r\n  return 0;\r\n}\r\n```\r\n=================================\r\nmoving \r\nstd::unique_ptr<Server> server;\r\nstd::unique_ptr<CompletionQueue> cq;\r\ninside the main function runs fine though.\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/451597528",
    "html_url": "https://github.com/grpc/grpc/issues/17516#issuecomment-451597528",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17516",
    "id": 451597528,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MTU5NzUyOA==",
    "user": {
      "login": "maxw",
      "id": 396729,
      "node_id": "MDQ6VXNlcjM5NjcyOQ==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/396729?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maxw",
      "html_url": "https://github.com/maxw",
      "followers_url": "https://api.github.com/users/maxw/followers",
      "following_url": "https://api.github.com/users/maxw/following{/other_user}",
      "gists_url": "https://api.github.com/users/maxw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maxw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maxw/subscriptions",
      "organizations_url": "https://api.github.com/users/maxw/orgs",
      "repos_url": "https://api.github.com/users/maxw/repos",
      "events_url": "https://api.github.com/users/maxw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maxw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-04T23:16:43Z",
    "updated_at": "2019-01-04T23:16:43Z",
    "author_association": "NONE",
    "body": "Still having the issue on our end :S"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/454250779",
    "html_url": "https://github.com/grpc/grpc/issues/17516#issuecomment-454250779",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17516",
    "id": 454250779,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDI1MDc3OQ==",
    "user": {
      "login": "maxw",
      "id": 396729,
      "node_id": "MDQ6VXNlcjM5NjcyOQ==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/396729?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maxw",
      "html_url": "https://github.com/maxw",
      "followers_url": "https://api.github.com/users/maxw/followers",
      "following_url": "https://api.github.com/users/maxw/following{/other_user}",
      "gists_url": "https://api.github.com/users/maxw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maxw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maxw/subscriptions",
      "organizations_url": "https://api.github.com/users/maxw/orgs",
      "repos_url": "https://api.github.com/users/maxw/repos",
      "events_url": "https://api.github.com/users/maxw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maxw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-15T03:03:03Z",
    "updated_at": "2019-01-15T03:03:03Z",
    "author_association": "NONE",
    "body": "No luck hunting this bug down. Any ideas? Would love some insight."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/458416489",
    "html_url": "https://github.com/grpc/grpc/issues/17516#issuecomment-458416489",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17516",
    "id": 458416489,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1ODQxNjQ4OQ==",
    "user": {
      "login": "maxw",
      "id": 396729,
      "node_id": "MDQ6VXNlcjM5NjcyOQ==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/396729?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maxw",
      "html_url": "https://github.com/maxw",
      "followers_url": "https://api.github.com/users/maxw/followers",
      "following_url": "https://api.github.com/users/maxw/following{/other_user}",
      "gists_url": "https://api.github.com/users/maxw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maxw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maxw/subscriptions",
      "organizations_url": "https://api.github.com/users/maxw/orgs",
      "repos_url": "https://api.github.com/users/maxw/repos",
      "events_url": "https://api.github.com/users/maxw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maxw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-29T05:52:12Z",
    "updated_at": "2019-01-29T05:52:12Z",
    "author_association": "NONE",
    "body": "@moonspirit were you able to find a fix?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/458508655",
    "html_url": "https://github.com/grpc/grpc/issues/17516#issuecomment-458508655",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17516",
    "id": 458508655,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1ODUwODY1NQ==",
    "user": {
      "login": "moonspirit",
      "id": 1793306,
      "node_id": "MDQ6VXNlcjE3OTMzMDY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/1793306?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/moonspirit",
      "html_url": "https://github.com/moonspirit",
      "followers_url": "https://api.github.com/users/moonspirit/followers",
      "following_url": "https://api.github.com/users/moonspirit/following{/other_user}",
      "gists_url": "https://api.github.com/users/moonspirit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/moonspirit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/moonspirit/subscriptions",
      "organizations_url": "https://api.github.com/users/moonspirit/orgs",
      "repos_url": "https://api.github.com/users/moonspirit/repos",
      "events_url": "https://api.github.com/users/moonspirit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/moonspirit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-29T11:37:19Z",
    "updated_at": "2019-01-29T11:37:19Z",
    "author_association": "NONE",
    "body": "DON'T use Server or CompletionQueue as global/static variables\n\nMax Weisel <notifications@github.com> 于2019年1月29日周二 下午1:52写道：\n\n> @moonspirit <https://github.com/moonspirit> were you able to find a fix?\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/grpc/grpc/issues/17516#issuecomment-458416489>, or mute\n> the thread\n> <https://github.com/notifications/unsubscribe-auth/ABtdGj_pTGp41j7Cz8JqIBjki0hjoz6Aks5vH-GmgaJpZM4ZUjIg>\n> .\n>\n\n\n-- \nBest Regards,\nyuexuan\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/460854864",
    "html_url": "https://github.com/grpc/grpc/issues/17516#issuecomment-460854864",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17516",
    "id": 460854864,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2MDg1NDg2NA==",
    "user": {
      "login": "jeffd",
      "id": 2890,
      "node_id": "MDQ6VXNlcjI4OTA=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/2890?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jeffd",
      "html_url": "https://github.com/jeffd",
      "followers_url": "https://api.github.com/users/jeffd/followers",
      "following_url": "https://api.github.com/users/jeffd/following{/other_user}",
      "gists_url": "https://api.github.com/users/jeffd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jeffd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jeffd/subscriptions",
      "organizations_url": "https://api.github.com/users/jeffd/orgs",
      "repos_url": "https://api.github.com/users/jeffd/repos",
      "events_url": "https://api.github.com/users/jeffd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jeffd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-06T00:08:42Z",
    "updated_at": "2019-02-06T00:08:42Z",
    "author_association": "NONE",
    "body": "The issue is still present without the use of global or static variables. I don’t think the issue should be closed. "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/460864708",
    "html_url": "https://github.com/grpc/grpc/issues/17516#issuecomment-460864708",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17516",
    "id": 460864708,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2MDg2NDcwOA==",
    "user": {
      "login": "yang-g",
      "id": 10122250,
      "node_id": "MDQ6VXNlcjEwMTIyMjUw",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10122250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yang-g",
      "html_url": "https://github.com/yang-g",
      "followers_url": "https://api.github.com/users/yang-g/followers",
      "following_url": "https://api.github.com/users/yang-g/following{/other_user}",
      "gists_url": "https://api.github.com/users/yang-g/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yang-g/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yang-g/subscriptions",
      "organizations_url": "https://api.github.com/users/yang-g/orgs",
      "repos_url": "https://api.github.com/users/yang-g/repos",
      "events_url": "https://api.github.com/users/yang-g/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yang-g/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-06T00:58:22Z",
    "updated_at": "2019-02-06T00:58:22Z",
    "author_association": "MEMBER",
    "body": "Does anyone have a correct, working reproduction?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/467675931",
    "html_url": "https://github.com/grpc/grpc/issues/17516#issuecomment-467675931",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17516",
    "id": 467675931,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NzY3NTkzMQ==",
    "user": {
      "login": "yang-g",
      "id": 10122250,
      "node_id": "MDQ6VXNlcjEwMTIyMjUw",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10122250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yang-g",
      "html_url": "https://github.com/yang-g",
      "followers_url": "https://api.github.com/users/yang-g/followers",
      "following_url": "https://api.github.com/users/yang-g/following{/other_user}",
      "gists_url": "https://api.github.com/users/yang-g/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yang-g/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yang-g/subscriptions",
      "organizations_url": "https://api.github.com/users/yang-g/orgs",
      "repos_url": "https://api.github.com/users/yang-g/repos",
      "events_url": "https://api.github.com/users/yang-g/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yang-g/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-27T00:44:46Z",
    "updated_at": "2019-02-27T00:44:46Z",
    "author_association": "MEMBER",
    "body": "Looking at this again. I suspect what happened in the original issue is an out of order destruction of global variables. @maxw did you happen to put the destructions of grpc objects into some atexit handler? \r\nBecause we have a global `g_gli_initializer`, it may have been destroyed when the atexit handler is running.\r\n@jeffd Do you have a working repro?"
  }
]
