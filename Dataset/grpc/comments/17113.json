[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/436227830",
    "html_url": "https://github.com/grpc/grpc/issues/17113#issuecomment-436227830",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17113",
    "id": 436227830,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjIyNzgzMA==",
    "user": {
      "login": "none-da",
      "id": 157880,
      "node_id": "MDQ6VXNlcjE1Nzg4MA==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/157880?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/none-da",
      "html_url": "https://github.com/none-da",
      "followers_url": "https://api.github.com/users/none-da/followers",
      "following_url": "https://api.github.com/users/none-da/following{/other_user}",
      "gists_url": "https://api.github.com/users/none-da/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/none-da/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/none-da/subscriptions",
      "organizations_url": "https://api.github.com/users/none-da/orgs",
      "repos_url": "https://api.github.com/users/none-da/repos",
      "events_url": "https://api.github.com/users/none-da/events{/privacy}",
      "received_events_url": "https://api.github.com/users/none-da/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-06T11:56:20Z",
    "updated_at": "2018-11-06T11:56:20Z",
    "author_association": "NONE",
    "body": "<img width=\"493\" alt=\"screenshot 2018-11-06 at 5 22 59 pm\" src=\"https://user-images.githubusercontent.com/157880/48062794-0ad28b00-e1e9-11e8-813e-65f43b826225.png\">\r\n<img width=\"683\" alt=\"screenshot 2018-11-06 at 5 23 11 pm\" src=\"https://user-images.githubusercontent.com/157880/48062795-0b6b2180-e1e9-11e8-95ac-789b0a8ba003.png\">\r\n\r\nScreenshots showing the leaks."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/437530554",
    "html_url": "https://github.com/grpc/grpc/issues/17113#issuecomment-437530554",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17113",
    "id": 437530554,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzUzMDU1NA==",
    "user": {
      "login": "lidizheng",
      "id": 7394928,
      "node_id": "MDQ6VXNlcjczOTQ5Mjg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7394928?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lidizheng",
      "html_url": "https://github.com/lidizheng",
      "followers_url": "https://api.github.com/users/lidizheng/followers",
      "following_url": "https://api.github.com/users/lidizheng/following{/other_user}",
      "gists_url": "https://api.github.com/users/lidizheng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lidizheng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lidizheng/subscriptions",
      "organizations_url": "https://api.github.com/users/lidizheng/orgs",
      "repos_url": "https://api.github.com/users/lidizheng/repos",
      "events_url": "https://api.github.com/users/lidizheng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lidizheng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-09T23:46:43Z",
    "updated_at": "2018-11-09T23:46:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "@lidizheng "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/437535393",
    "html_url": "https://github.com/grpc/grpc/issues/17113#issuecomment-437535393",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17113",
    "id": 437535393,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzUzNTM5Mw==",
    "user": {
      "login": "srini100",
      "id": 35056280,
      "node_id": "MDQ6VXNlcjM1MDU2Mjgw",
      "avatar_url": "https://avatars2.githubusercontent.com/u/35056280?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/srini100",
      "html_url": "https://github.com/srini100",
      "followers_url": "https://api.github.com/users/srini100/followers",
      "following_url": "https://api.github.com/users/srini100/following{/other_user}",
      "gists_url": "https://api.github.com/users/srini100/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/srini100/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/srini100/subscriptions",
      "organizations_url": "https://api.github.com/users/srini100/orgs",
      "repos_url": "https://api.github.com/users/srini100/repos",
      "events_url": "https://api.github.com/users/srini100/events{/privacy}",
      "received_events_url": "https://api.github.com/users/srini100/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-10T00:21:31Z",
    "updated_at": "2018-11-10T00:21:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "@none-da, What kind of RPCs is your server handling? If it is streaming RPCs then how many concurrent RPCs are there? Can you provide a minimal reproduction?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/437639894",
    "html_url": "https://github.com/grpc/grpc/issues/17113#issuecomment-437639894",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17113",
    "id": 437639894,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzYzOTg5NA==",
    "user": {
      "login": "none-da",
      "id": 157880,
      "node_id": "MDQ6VXNlcjE1Nzg4MA==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/157880?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/none-da",
      "html_url": "https://github.com/none-da",
      "followers_url": "https://api.github.com/users/none-da/followers",
      "following_url": "https://api.github.com/users/none-da/following{/other_user}",
      "gists_url": "https://api.github.com/users/none-da/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/none-da/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/none-da/subscriptions",
      "organizations_url": "https://api.github.com/users/none-da/orgs",
      "repos_url": "https://api.github.com/users/none-da/repos",
      "events_url": "https://api.github.com/users/none-da/events{/privacy}",
      "received_events_url": "https://api.github.com/users/none-da/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-11T03:07:18Z",
    "updated_at": "2018-11-11T03:07:18Z",
    "author_association": "NONE",
    "body": "Its the unary RPCs. Infact it was just health-check RPCs, running every 5 secs once."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/437640197",
    "html_url": "https://github.com/grpc/grpc/issues/17113#issuecomment-437640197",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17113",
    "id": 437640197,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzY0MDE5Nw==",
    "user": {
      "login": "none-da",
      "id": 157880,
      "node_id": "MDQ6VXNlcjE1Nzg4MA==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/157880?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/none-da",
      "html_url": "https://github.com/none-da",
      "followers_url": "https://api.github.com/users/none-da/followers",
      "following_url": "https://api.github.com/users/none-da/following{/other_user}",
      "gists_url": "https://api.github.com/users/none-da/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/none-da/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/none-da/subscriptions",
      "organizations_url": "https://api.github.com/users/none-da/orgs",
      "repos_url": "https://api.github.com/users/none-da/repos",
      "events_url": "https://api.github.com/users/none-da/events{/privacy}",
      "received_events_url": "https://api.github.com/users/none-da/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-11T03:15:10Z",
    "updated_at": "2018-11-11T03:15:10Z",
    "author_association": "NONE",
    "body": "> Its the unary RPCs. Infact it was just health-check RPCs, running every 5 secs once.\r\n\r\n@srini100 Something like this:\r\n```py\r\nimport os\r\nimport socket\r\n\r\nclass HealthCheckService(HealthCheckServicer):\r\n\r\n    def GetHealth(self, request, context):\r\n        try:\r\n            '''\r\n            SQL Query for this is:\r\n               SELECT (1) AS `a`\r\n               FROM `some_important_table`\r\n               WHERE `some_important_table`.`id` = 1234\r\n               LIMIT 1;\r\n            \r\n            '''\r\n            is_object_exists = SomeImportantTable.objects.filter(id=settings.DEFAULT_ID).using('default').exists()\r\n        except OperationalError as mysql_error:\r\n            from django.db import connection\r\n            connection.close()\r\n\r\n            # We should propagate the db operationalerror so that subsequent traffic is never directed to the\r\n            # current running service\r\n            raise mysql_error\r\n\r\n        if not is_object_exists:\r\n            # as a safe check, in case in future if we deleted this entry from our DB.\r\n            # Still this is a valid case to test mysql availability.\r\n            logger.exception(\"HealthCheckService: SomeImportantTable Object doesn't exist for ID: {}\".\r\n                             format(settings.DEFAULT_ID))\r\n        response_dict = {\r\n            'HOST': socket.gethostname(),\r\n            'uptime': elapsed(),\r\n            'SLA': '40 ms',\r\n            'version': os.getenv('VERSION', '0.1.0')\r\n        }\r\n        return GetHealthResponse(health_response=str(response_dict))\r\n```\r\n\r\nand the Health-Check probe definition is like this:\r\n```yaml\r\nreadinessProbe:\r\n    exec:\r\n    command:\r\n    - /app/bin/python\r\n    - /app/health_check/rpc/v1/get_health_check.py\r\n    failureThreshold: 2\r\n    initialDelaySeconds: 20\r\n    periodSeconds: 5\r\n    successThreshold: 3\r\n    timeoutSeconds: 1\r\n```"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/438438467",
    "html_url": "https://github.com/grpc/grpc/issues/17113#issuecomment-438438467",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17113",
    "id": 438438467,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzODQzODQ2Nw==",
    "user": {
      "login": "srini100",
      "id": 35056280,
      "node_id": "MDQ6VXNlcjM1MDU2Mjgw",
      "avatar_url": "https://avatars2.githubusercontent.com/u/35056280?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/srini100",
      "html_url": "https://github.com/srini100",
      "followers_url": "https://api.github.com/users/srini100/followers",
      "following_url": "https://api.github.com/users/srini100/following{/other_user}",
      "gists_url": "https://api.github.com/users/srini100/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/srini100/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/srini100/subscriptions",
      "organizations_url": "https://api.github.com/users/srini100/orgs",
      "repos_url": "https://api.github.com/users/srini100/repos",
      "events_url": "https://api.github.com/users/srini100/events{/privacy}",
      "received_events_url": "https://api.github.com/users/srini100/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-13T21:13:04Z",
    "updated_at": "2018-11-13T21:13:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "@none-da, have you tried swapping the database query with a dummy response_dict and see if the problem persists. The FD leak could be due to open DB connections. "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/438541909",
    "html_url": "https://github.com/grpc/grpc/issues/17113#issuecomment-438541909",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17113",
    "id": 438541909,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzODU0MTkwOQ==",
    "user": {
      "login": "none-da",
      "id": 157880,
      "node_id": "MDQ6VXNlcjE1Nzg4MA==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/157880?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/none-da",
      "html_url": "https://github.com/none-da",
      "followers_url": "https://api.github.com/users/none-da/followers",
      "following_url": "https://api.github.com/users/none-da/following{/other_user}",
      "gists_url": "https://api.github.com/users/none-da/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/none-da/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/none-da/subscriptions",
      "organizations_url": "https://api.github.com/users/none-da/orgs",
      "repos_url": "https://api.github.com/users/none-da/repos",
      "events_url": "https://api.github.com/users/none-da/events{/privacy}",
      "received_events_url": "https://api.github.com/users/none-da/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-14T05:25:00Z",
    "updated_at": "2018-11-14T05:25:00Z",
    "author_association": "NONE",
    "body": "> @none-da, have you tried swapping the database query with a dummy response_dict and see if the problem persists. The FD leak could be due to open DB connections.\r\n\r\n@srini100 Thanks for responding. Sure I could try that and get back to you on results. But as I mentioned earlier the same code/pod was running fine in a different cluster with the below specifications: ` Python 3.6.5, gcc version 5.4.0 20160609, Ubuntu 16.04.09, 4.4.0-1062-aws Kernel, Glibc 2.23\r\n`"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/442548517",
    "html_url": "https://github.com/grpc/grpc/issues/17113#issuecomment-442548517",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/17113",
    "id": 442548517,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MjU0ODUxNw==",
    "user": {
      "login": "srini100",
      "id": 35056280,
      "node_id": "MDQ6VXNlcjM1MDU2Mjgw",
      "avatar_url": "https://avatars2.githubusercontent.com/u/35056280?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/srini100",
      "html_url": "https://github.com/srini100",
      "followers_url": "https://api.github.com/users/srini100/followers",
      "following_url": "https://api.github.com/users/srini100/following{/other_user}",
      "gists_url": "https://api.github.com/users/srini100/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/srini100/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/srini100/subscriptions",
      "organizations_url": "https://api.github.com/users/srini100/orgs",
      "repos_url": "https://api.github.com/users/srini100/repos",
      "events_url": "https://api.github.com/users/srini100/events{/privacy}",
      "received_events_url": "https://api.github.com/users/srini100/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-28T18:11:34Z",
    "updated_at": "2018-11-28T18:11:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "Closing this. Please reopen of the issue can be reproduced without the mysql code."
  }
]
