[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/327328818",
    "html_url": "https://github.com/grpc/grpc/issues/12215#issuecomment-327328818",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12215",
    "id": 327328818,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNzMyODgxOA==",
    "user": {
      "login": "murgatroid99",
      "id": 961599,
      "node_id": "MDQ6VXNlcjk2MTU5OQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/961599?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/murgatroid99",
      "html_url": "https://github.com/murgatroid99",
      "followers_url": "https://api.github.com/users/murgatroid99/followers",
      "following_url": "https://api.github.com/users/murgatroid99/following{/other_user}",
      "gists_url": "https://api.github.com/users/murgatroid99/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/murgatroid99/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/murgatroid99/subscriptions",
      "organizations_url": "https://api.github.com/users/murgatroid99/orgs",
      "repos_url": "https://api.github.com/users/murgatroid99/repos",
      "events_url": "https://api.github.com/users/murgatroid99/events{/privacy}",
      "received_events_url": "https://api.github.com/users/murgatroid99/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-05T23:11:44Z",
    "updated_at": "2017-09-05T23:11:44Z",
    "author_association": "MEMBER",
    "body": "Can you provide more context for this data? What is the actual performance problem you were experiencing? Can you provide the benchmark you ran to gather this data? Is there a specific reason you have highlighted the `writeUtf8String` function?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/327408853",
    "html_url": "https://github.com/grpc/grpc/issues/12215#issuecomment-327408853",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12215",
    "id": 327408853,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNzQwODg1Mw==",
    "user": {
      "login": "yunnysunny",
      "id": 734818,
      "node_id": "MDQ6VXNlcjczNDgxOA==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/734818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yunnysunny",
      "html_url": "https://github.com/yunnysunny",
      "followers_url": "https://api.github.com/users/yunnysunny/followers",
      "following_url": "https://api.github.com/users/yunnysunny/following{/other_user}",
      "gists_url": "https://api.github.com/users/yunnysunny/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yunnysunny/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yunnysunny/subscriptions",
      "organizations_url": "https://api.github.com/users/yunnysunny/orgs",
      "repos_url": "https://api.github.com/users/yunnysunny/repos",
      "events_url": "https://api.github.com/users/yunnysunny/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yunnysunny/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-06T08:09:42Z",
    "updated_at": "2017-09-06T08:09:42Z",
    "author_association": "NONE",
    "body": "The reason of `writeUtf8String` is cased by high request of redis server. But the function of `cloneRaw`, which uses the most cpu time,  is cased by `protobufjs 5.0.2`, which is called by grpc. And the function of `Call` `Message` `MessagePrototype.set` is also used by grpc.\r\nThe cpu profile file is generated in my company's project, I can supply a benchmark , it may take some time to write a simple project to remove the detail of my company's code. "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/328509633",
    "html_url": "https://github.com/grpc/grpc/issues/12215#issuecomment-328509633",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12215",
    "id": 328509633,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyODUwOTYzMw==",
    "user": {
      "login": "yunnysunny",
      "id": 734818,
      "node_id": "MDQ6VXNlcjczNDgxOA==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/734818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yunnysunny",
      "html_url": "https://github.com/yunnysunny",
      "followers_url": "https://api.github.com/users/yunnysunny/followers",
      "following_url": "https://api.github.com/users/yunnysunny/following{/other_user}",
      "gists_url": "https://api.github.com/users/yunnysunny/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yunnysunny/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yunnysunny/subscriptions",
      "organizations_url": "https://api.github.com/users/yunnysunny/orgs",
      "repos_url": "https://api.github.com/users/yunnysunny/repos",
      "events_url": "https://api.github.com/users/yunnysunny/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yunnysunny/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-11T12:09:40Z",
    "updated_at": "2017-09-11T12:09:40Z",
    "author_association": "NONE",
    "body": "I have written a project with node-grpc, hosted on [bench4grpc](https://github.com/yunnysunny/bench4grpc). For doing benchmark conveniently, I also create a jmeter project , hosted on [jmeter4grpc](https://github.com/yunnysunny/jmeter4grpc) . In fact, the jar file and jmx file, needed for the test, have been uploaded [here](https://silian.whyun.com/download/jmeter4grpc-0.0.1.jar) and [here](https://silian.whyun.com/download/grpc_bench.jmx).\r\nI also uploaded a cpu profile file on [here](https://silian.whyun.com/download/20170911T194842.cpuprofile)."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/332399352",
    "html_url": "https://github.com/grpc/grpc/issues/12215#issuecomment-332399352",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12215",
    "id": 332399352,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjM5OTM1Mg==",
    "user": {
      "login": "yunnysunny",
      "id": 734818,
      "node_id": "MDQ6VXNlcjczNDgxOA==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/734818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yunnysunny",
      "html_url": "https://github.com/yunnysunny",
      "followers_url": "https://api.github.com/users/yunnysunny/followers",
      "following_url": "https://api.github.com/users/yunnysunny/following{/other_user}",
      "gists_url": "https://api.github.com/users/yunnysunny/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yunnysunny/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yunnysunny/subscriptions",
      "organizations_url": "https://api.github.com/users/yunnysunny/orgs",
      "repos_url": "https://api.github.com/users/yunnysunny/repos",
      "events_url": "https://api.github.com/users/yunnysunny/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yunnysunny/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-27T03:35:05Z",
    "updated_at": "2017-09-27T06:41:34Z",
    "author_association": "NONE",
    "body": "I read the c++ addon code of node , and found that the `StartBatch` function of the `Call` class called  grpc's native function `grpc_call_start_batch` in a  synchronized way, which is showed here:\r\nhttps://github.com/grpc/grpc/blob/c3d8237b15322d3b80954349ed027152ce83f3eb/src/node/ext/call.cc#L724-L729\r\nThis synchronized call will block the V8's main thread, I think it should be run in libuv's thread pool to reduce the competition of CPU between the main thread."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/350841024",
    "html_url": "https://github.com/grpc/grpc/issues/12215#issuecomment-350841024",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12215",
    "id": 350841024,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MDg0MTAyNA==",
    "user": {
      "login": "dgquintas",
      "id": 120217,
      "node_id": "MDQ6VXNlcjEyMDIxNw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/120217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dgquintas",
      "html_url": "https://github.com/dgquintas",
      "followers_url": "https://api.github.com/users/dgquintas/followers",
      "following_url": "https://api.github.com/users/dgquintas/following{/other_user}",
      "gists_url": "https://api.github.com/users/dgquintas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dgquintas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dgquintas/subscriptions",
      "organizations_url": "https://api.github.com/users/dgquintas/orgs",
      "repos_url": "https://api.github.com/users/dgquintas/repos",
      "events_url": "https://api.github.com/users/dgquintas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dgquintas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-11T20:02:20Z",
    "updated_at": "2017-12-11T20:02:20Z",
    "author_association": "NONE",
    "body": "@murgatroid99 can this issue be closed or addressed somehow?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/351029987",
    "html_url": "https://github.com/grpc/grpc/issues/12215#issuecomment-351029987",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12215",
    "id": 351029987,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTAyOTk4Nw==",
    "user": {
      "login": "yunnysunny",
      "id": 734818,
      "node_id": "MDQ6VXNlcjczNDgxOA==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/734818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yunnysunny",
      "html_url": "https://github.com/yunnysunny",
      "followers_url": "https://api.github.com/users/yunnysunny/followers",
      "following_url": "https://api.github.com/users/yunnysunny/following{/other_user}",
      "gists_url": "https://api.github.com/users/yunnysunny/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yunnysunny/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yunnysunny/subscriptions",
      "organizations_url": "https://api.github.com/users/yunnysunny/orgs",
      "repos_url": "https://api.github.com/users/yunnysunny/repos",
      "events_url": "https://api.github.com/users/yunnysunny/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yunnysunny/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-12T11:53:58Z",
    "updated_at": "2017-12-12T11:53:58Z",
    "author_association": "NONE",
    "body": "@dgquintas Have you have changed the way of calling the function of grpc_call_start_batch in an asynchronous way?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/351130211",
    "html_url": "https://github.com/grpc/grpc/issues/12215#issuecomment-351130211",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12215",
    "id": 351130211,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTEzMDIxMQ==",
    "user": {
      "login": "dgquintas",
      "id": 120217,
      "node_id": "MDQ6VXNlcjEyMDIxNw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/120217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dgquintas",
      "html_url": "https://github.com/dgquintas",
      "followers_url": "https://api.github.com/users/dgquintas/followers",
      "following_url": "https://api.github.com/users/dgquintas/following{/other_user}",
      "gists_url": "https://api.github.com/users/dgquintas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dgquintas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dgquintas/subscriptions",
      "organizations_url": "https://api.github.com/users/dgquintas/orgs",
      "repos_url": "https://api.github.com/users/dgquintas/repos",
      "events_url": "https://api.github.com/users/dgquintas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dgquintas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-12T17:49:57Z",
    "updated_at": "2017-12-12T17:49:57Z",
    "author_association": "NONE",
    "body": "`grpc_call_start_batch` is always asynchronous. See documentation [here](https://github.com/grpc/grpc/blob/de110af820a912ae926a1a9659a385b6a972f84d/include/grpc/grpc.h#L237). "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/352230832",
    "html_url": "https://github.com/grpc/grpc/issues/12215#issuecomment-352230832",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12215",
    "id": 352230832,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MjIzMDgzMg==",
    "user": {
      "login": "yunnysunny",
      "id": 734818,
      "node_id": "MDQ6VXNlcjczNDgxOA==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/734818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yunnysunny",
      "html_url": "https://github.com/yunnysunny",
      "followers_url": "https://api.github.com/users/yunnysunny/followers",
      "following_url": "https://api.github.com/users/yunnysunny/following{/other_user}",
      "gists_url": "https://api.github.com/users/yunnysunny/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yunnysunny/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yunnysunny/subscriptions",
      "organizations_url": "https://api.github.com/users/yunnysunny/orgs",
      "repos_url": "https://api.github.com/users/yunnysunny/repos",
      "events_url": "https://api.github.com/users/yunnysunny/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yunnysunny/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-17T04:20:06Z",
    "updated_at": "2017-12-17T04:20:06Z",
    "author_association": "NONE",
    "body": "Yes, I have made a mistake. `grpc_call_start_batch` is  asynchronous actually. The cpu time is almost costed by protobuf's serialization and deserialization. I think this problem can not been avoided if grpc do encoding protobuf in pure js. \r\nMaybe parsing protobuf in native code ( such as the package [node-protobuf](https://www.npmjs.com/package/node-protobuf) ) is a better choice for performance,  but it will make project more complex."
  }
]
