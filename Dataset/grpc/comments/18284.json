[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/470336918",
    "html_url": "https://github.com/grpc/grpc/pull/18284#issuecomment-470336918",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18284",
    "id": 470336918,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MDMzNjkxOA==",
    "user": {
      "login": "yashykt",
      "id": 4181124,
      "node_id": "MDQ6VXNlcjQxODExMjQ=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/4181124?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yashykt",
      "html_url": "https://github.com/yashykt",
      "followers_url": "https://api.github.com/users/yashykt/followers",
      "following_url": "https://api.github.com/users/yashykt/following{/other_user}",
      "gists_url": "https://api.github.com/users/yashykt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yashykt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yashykt/subscriptions",
      "organizations_url": "https://api.github.com/users/yashykt/orgs",
      "repos_url": "https://api.github.com/users/yashykt/repos",
      "events_url": "https://api.github.com/users/yashykt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yashykt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-07T00:47:14Z",
    "updated_at": "2019-03-07T00:47:14Z",
    "author_association": "MEMBER",
    "body": "how does changing gpr_malloc to malloc help?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/470607638",
    "html_url": "https://github.com/grpc/grpc/pull/18284#issuecomment-470607638",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18284",
    "id": 470607638,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MDYwNzYzOA==",
    "user": {
      "login": "yang-g",
      "id": 10122250,
      "node_id": "MDQ6VXNlcjEwMTIyMjUw",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10122250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yang-g",
      "html_url": "https://github.com/yang-g",
      "followers_url": "https://api.github.com/users/yang-g/followers",
      "following_url": "https://api.github.com/users/yang-g/following{/other_user}",
      "gists_url": "https://api.github.com/users/yang-g/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yang-g/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yang-g/subscriptions",
      "organizations_url": "https://api.github.com/users/yang-g/orgs",
      "repos_url": "https://api.github.com/users/yang-g/repos",
      "events_url": "https://api.github.com/users/yang-g/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yang-g/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-07T16:59:28Z",
    "updated_at": "2019-03-07T16:59:28Z",
    "author_association": "MEMBER",
    "body": "The leak detector uses an override of gpr_malloc to track the bytes allocated. By switching to malloc, the piece of memory is not tracked by leak detector any more, which is fine because it is not a leak."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/470718933",
    "html_url": "https://github.com/grpc/grpc/pull/18284#issuecomment-470718933",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18284",
    "id": 470718933,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MDcxODkzMw==",
    "user": {
      "login": "yashykt",
      "id": 4181124,
      "node_id": "MDQ6VXNlcjQxODExMjQ=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/4181124?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yashykt",
      "html_url": "https://github.com/yashykt",
      "followers_url": "https://api.github.com/users/yashykt/followers",
      "following_url": "https://api.github.com/users/yashykt/following{/other_user}",
      "gists_url": "https://api.github.com/users/yashykt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yashykt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yashykt/subscriptions",
      "organizations_url": "https://api.github.com/users/yashykt/orgs",
      "repos_url": "https://api.github.com/users/yashykt/repos",
      "events_url": "https://api.github.com/users/yashykt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yashykt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-07T22:17:37Z",
    "updated_at": "2019-03-07T22:19:25Z",
    "author_association": "MEMBER",
    "body": "but that seems like a bug in the fuzzer. should we be switching to malloc for that though. We are using gpr_malloc for a reason. If we switch to malloc at random places, then things would just start getting confusing"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/470722030",
    "html_url": "https://github.com/grpc/grpc/pull/18284#issuecomment-470722030",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18284",
    "id": 470722030,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MDcyMjAzMA==",
    "user": {
      "login": "yang-g",
      "id": 10122250,
      "node_id": "MDQ6VXNlcjEwMTIyMjUw",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10122250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yang-g",
      "html_url": "https://github.com/yang-g",
      "followers_url": "https://api.github.com/users/yang-g/followers",
      "following_url": "https://api.github.com/users/yang-g/following{/other_user}",
      "gists_url": "https://api.github.com/users/yang-g/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yang-g/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yang-g/subscriptions",
      "organizations_url": "https://api.github.com/users/yang-g/orgs",
      "repos_url": "https://api.github.com/users/yang-g/repos",
      "events_url": "https://api.github.com/users/yang-g/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yang-g/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-07T22:25:22Z",
    "updated_at": "2019-03-07T22:25:22Z",
    "author_association": "MEMBER",
    "body": "The reported \"leak\" is a thread local thread_id item on the main thread, it will only be destroyed when the thread exits. But we have to let the LeakDetector to do its job before the thread exits. That is why we cannot use  gpr_malloc.\r\n\r\nAlternatively, I can move LeakDetector inside of the grpc_init/grpc_shutdown block. But that will cause similar problems as we create threads when needed but only destroy them in grpc_shutdown..."
  }
]
