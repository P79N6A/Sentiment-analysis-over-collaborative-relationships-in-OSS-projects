[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/389924077",
    "html_url": "https://github.com/grpc/grpc/issues/15426#issuecomment-389924077",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/15426",
    "id": 389924077,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4OTkyNDA3Nw==",
    "user": {
      "login": "ZhouyihaiDing",
      "id": 28968539,
      "node_id": "MDQ6VXNlcjI4OTY4NTM5",
      "avatar_url": "https://avatars3.githubusercontent.com/u/28968539?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ZhouyihaiDing",
      "html_url": "https://github.com/ZhouyihaiDing",
      "followers_url": "https://api.github.com/users/ZhouyihaiDing/followers",
      "following_url": "https://api.github.com/users/ZhouyihaiDing/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZhouyihaiDing/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ZhouyihaiDing/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZhouyihaiDing/subscriptions",
      "organizations_url": "https://api.github.com/users/ZhouyihaiDing/orgs",
      "repos_url": "https://api.github.com/users/ZhouyihaiDing/repos",
      "events_url": "https://api.github.com/users/ZhouyihaiDing/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ZhouyihaiDing/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-17T16:16:46Z",
    "updated_at": "2018-05-17T16:16:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "cc @fengli79 "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/395255035",
    "html_url": "https://github.com/grpc/grpc/issues/15426#issuecomment-395255035",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/15426",
    "id": 395255035,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NTI1NTAzNQ==",
    "user": {
      "login": "ZhouyihaiDing",
      "id": 28968539,
      "node_id": "MDQ6VXNlcjI4OTY4NTM5",
      "avatar_url": "https://avatars3.githubusercontent.com/u/28968539?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ZhouyihaiDing",
      "html_url": "https://github.com/ZhouyihaiDing",
      "followers_url": "https://api.github.com/users/ZhouyihaiDing/followers",
      "following_url": "https://api.github.com/users/ZhouyihaiDing/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZhouyihaiDing/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ZhouyihaiDing/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZhouyihaiDing/subscriptions",
      "organizations_url": "https://api.github.com/users/ZhouyihaiDing/orgs",
      "repos_url": "https://api.github.com/users/ZhouyihaiDing/repos",
      "events_url": "https://api.github.com/users/ZhouyihaiDing/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ZhouyihaiDing/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-07T00:27:59Z",
    "updated_at": "2018-06-07T00:29:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @jdpedrie. Thanks for the help!\r\n\r\nI am working on this issue.\r\n\r\nThis issue looks like provide a way to manage channels. Adding this support in the PHP layer instead of c extension layer may offer more benefits. For example, if we can insert the channel management like plugin, this plugin can be implemented with many solutions, like create a new channel when the number of streams arrives 100, or create 10 channels for the same target in advance and do the round robin to spread the load as you described.\r\n\r\nFor your concerns:\r\n\r\n1. I am not sure how much channel pool will affect the latency. Assume we can manage channels and inside it we push 10 channels into a global pool like `apcu`(Although `Channel` object doesn't have serialize/deserialize handler, we can save the argument because when `[target+ argument+hash[credentials]]` is the same, it will reuse the channel created before). When a request come, it will fetch the argument, and then create a channel means reuse a channel.\r\n\r\nAlso, for persistent channel reuse, if we provide different argument when creating the channel, it will create a new channel. Thus the channel management plugin can create channel like `new \\Grpc\\Channel($target, [..., channel_id => $channel_numbers_in_plugin])` which can create a new channel until the number arrives to 10.\r\n\r\n2. Currently, channel can only be shared within the same PHP-FPM process. Within the plugin, when we push/fetch the channel to/from the pool, we can record which process this channel is created, so that it won't fetch the channel created by other process."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/400121487",
    "html_url": "https://github.com/grpc/grpc/issues/15426#issuecomment-400121487",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/15426",
    "id": 400121487,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDEyMTQ4Nw==",
    "user": {
      "login": "ZhouyihaiDing",
      "id": 28968539,
      "node_id": "MDQ6VXNlcjI4OTY4NTM5",
      "avatar_url": "https://avatars3.githubusercontent.com/u/28968539?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ZhouyihaiDing",
      "html_url": "https://github.com/ZhouyihaiDing",
      "followers_url": "https://api.github.com/users/ZhouyihaiDing/followers",
      "following_url": "https://api.github.com/users/ZhouyihaiDing/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZhouyihaiDing/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ZhouyihaiDing/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZhouyihaiDing/subscriptions",
      "organizations_url": "https://api.github.com/users/ZhouyihaiDing/orgs",
      "repos_url": "https://api.github.com/users/ZhouyihaiDing/repos",
      "events_url": "https://api.github.com/users/ZhouyihaiDing/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ZhouyihaiDing/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-25T22:56:00Z",
    "updated_at": "2018-06-25T22:56:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @jdpedrie ,\r\n\r\nCan you please provide me a sample for reproducing the issue?\r\n\r\nI am trying to insert my fix([GCP extension)](https://github.com/ZhouyihaiDing/grpc/pull/21) into the spanner client, which will create a new channel and use it for the next RPC when all channels in the channel pool have active stream == 100. However, I have some problems when reproduce the original issue. \r\n\r\nI was trying to create >100 sessions and sending >100 `ExecuteStreamingSql` RPC without the fix, but the 101th RPC can still get the response OK without hanging/failing. "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/409082278",
    "html_url": "https://github.com/grpc/grpc/issues/15426#issuecomment-409082278",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/15426",
    "id": 409082278,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwOTA4MjI3OA==",
    "user": {
      "login": "ZhouyihaiDing",
      "id": 28968539,
      "node_id": "MDQ6VXNlcjI4OTY4NTM5",
      "avatar_url": "https://avatars3.githubusercontent.com/u/28968539?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ZhouyihaiDing",
      "html_url": "https://github.com/ZhouyihaiDing",
      "followers_url": "https://api.github.com/users/ZhouyihaiDing/followers",
      "following_url": "https://api.github.com/users/ZhouyihaiDing/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZhouyihaiDing/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ZhouyihaiDing/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZhouyihaiDing/subscriptions",
      "organizations_url": "https://api.github.com/users/ZhouyihaiDing/orgs",
      "repos_url": "https://api.github.com/users/ZhouyihaiDing/repos",
      "events_url": "https://api.github.com/users/ZhouyihaiDing/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ZhouyihaiDing/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-31T03:26:04Z",
    "updated_at": "2018-07-31T03:26:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "`Grpc\\Gcp` [library](https://packagist.org/packages/google/grpc-gcp) is designed to support multiple persistent channels. When the number of concurrent streams exceed 100, and the new RPC is not supposed to use an existing channel(eg, some RPCs are bind with a session, which use the existing channel), we will create a new channel for this RPC.\r\n\r\nI created [a test](https://github.com/GoogleCloudPlatform/grpc-gcp-php/pull/17) to mock 100 concurrent streams issue with/without `Grpc\\Gcp` library if you are interested. Thanks!"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/410389206",
    "html_url": "https://github.com/grpc/grpc/issues/15426#issuecomment-410389206",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/15426",
    "id": 410389206,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMDM4OTIwNg==",
    "user": {
      "login": "ZhouyihaiDing",
      "id": 28968539,
      "node_id": "MDQ6VXNlcjI4OTY4NTM5",
      "avatar_url": "https://avatars3.githubusercontent.com/u/28968539?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ZhouyihaiDing",
      "html_url": "https://github.com/ZhouyihaiDing",
      "followers_url": "https://api.github.com/users/ZhouyihaiDing/followers",
      "following_url": "https://api.github.com/users/ZhouyihaiDing/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZhouyihaiDing/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ZhouyihaiDing/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZhouyihaiDing/subscriptions",
      "organizations_url": "https://api.github.com/users/ZhouyihaiDing/orgs",
      "repos_url": "https://api.github.com/users/ZhouyihaiDing/repos",
      "events_url": "https://api.github.com/users/ZhouyihaiDing/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ZhouyihaiDing/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-03T22:09:35Z",
    "updated_at": "2018-08-03T22:09:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "Close this issue with the [`grpc-gcp`](https://packagist.org/packages/google/grpc-gcp) library solution."
  }
]
