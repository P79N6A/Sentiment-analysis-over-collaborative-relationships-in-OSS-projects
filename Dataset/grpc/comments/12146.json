[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/321626007",
    "html_url": "https://github.com/grpc/grpc/issues/12146#issuecomment-321626007",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12146",
    "id": 321626007,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMTYyNjAwNw==",
    "user": {
      "login": "cauthu",
      "id": 1170852,
      "node_id": "MDQ6VXNlcjExNzA4NTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/1170852?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cauthu",
      "html_url": "https://github.com/cauthu",
      "followers_url": "https://api.github.com/users/cauthu/followers",
      "following_url": "https://api.github.com/users/cauthu/following{/other_user}",
      "gists_url": "https://api.github.com/users/cauthu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cauthu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cauthu/subscriptions",
      "organizations_url": "https://api.github.com/users/cauthu/orgs",
      "repos_url": "https://api.github.com/users/cauthu/repos",
      "events_url": "https://api.github.com/users/cauthu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cauthu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-10T17:53:19Z",
    "updated_at": "2017-08-10T17:53:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "1. the `cpp/ssl-helloworld` example, including the keys/certs (client and server both use self-signed certs)\r\n[ssl-helloworld.zip](https://github.com/grpc/grpc/files/1215854/ssl-helloworld.zip)\r\n\r\n2. the patch to `ssl_transport_security.c` just for some logging\r\n[0001-some-logging-in-cert-verification.patch.txt](https://github.com/grpc/grpc/files/1215855/0001-some-logging-in-cert-verification.patch.txt)\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/321627641",
    "html_url": "https://github.com/grpc/grpc/issues/12146#issuecomment-321627641",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12146",
    "id": 321627641,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMTYyNzY0MQ==",
    "user": {
      "login": "cauthu",
      "id": 1170852,
      "node_id": "MDQ6VXNlcjExNzA4NTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/1170852?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cauthu",
      "html_url": "https://github.com/cauthu",
      "followers_url": "https://api.github.com/users/cauthu/followers",
      "following_url": "https://api.github.com/users/cauthu/following{/other_user}",
      "gists_url": "https://api.github.com/users/cauthu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cauthu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cauthu/subscriptions",
      "organizations_url": "https://api.github.com/users/cauthu/orgs",
      "repos_url": "https://api.github.com/users/cauthu/repos",
      "events_url": "https://api.github.com/users/cauthu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cauthu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-10T17:59:25Z",
    "updated_at": "2017-08-10T17:59:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "for convenience, here's the relevant code in the server\r\n```\r\n  auto client_ca_pem = get_file_contents(argv[1]); // for verifying clients\r\n  auto my_key_pem = get_file_contents(argv[2]);\r\n  auto my_cert_pem = get_file_contents(argv[3]);\r\n\r\n  grpc::SslServerCredentialsOptions::PemKeyCertPair pkcp = {\r\n    my_key_pem.c_str(), my_cert_pem.c_str()\r\n  };\r\n\r\n  grpc::SslServerCredentialsOptions ssl_opts(GRPC_SSL_REQUEST_AND_REQUIRE_CLIENT_CERTIFICATE_AND_VERIFY);\r\n  ssl_opts.pem_root_certs = client_ca_pem;\r\n  ssl_opts.pem_key_cert_pairs.push_back(pkcp);\r\n  std::cout << \"pem_root_certs length: \" << ssl_opts.pem_root_certs.length() << std::endl;\r\n\r\n  std::shared_ptr<grpc::ServerCredentials> creds = grpc::SslServerCredentials(ssl_opts);\r\n\r\n  ServerBuilder builder;\r\n  // Listen on the given address without any authentication mechanism.\r\n  builder.AddListeningPort(server_address, creds);\r\n```\r\nand the client\r\n```\r\n  auto server_ca_pem = get_file_contents(argv[1]);\r\n  auto my_key_pem = get_file_contents(argv[2]);\r\n  auto my_cert_pem = get_file_contents(argv[3]);\r\n\r\n  grpc::SslCredentialsOptions ssl_opts;\r\n  ssl_opts.pem_root_certs = server_ca_pem;\r\n  ssl_opts.pem_private_key = my_key_pem;\r\n  ssl_opts.pem_cert_chain = my_cert_pem;\r\n\r\n  std::shared_ptr<grpc::ChannelCredentials> creds = grpc::SslCredentials(ssl_opts);\r\n\r\n  GreeterClient greeter(grpc::CreateChannel(\r\n      \"localhost:50051\", creds));\r\n  std::string user(\"world\");\r\n  std::string reply = greeter.SayHello(user);\r\n  std::cout << \"Greeter received: \" << reply << std::endl;\r\n```"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/321632850",
    "html_url": "https://github.com/grpc/grpc/issues/12146#issuecomment-321632850",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12146",
    "id": 321632850,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMTYzMjg1MA==",
    "user": {
      "login": "cauthu",
      "id": 1170852,
      "node_id": "MDQ6VXNlcjExNzA4NTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/1170852?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cauthu",
      "html_url": "https://github.com/cauthu",
      "followers_url": "https://api.github.com/users/cauthu/followers",
      "following_url": "https://api.github.com/users/cauthu/following{/other_user}",
      "gists_url": "https://api.github.com/users/cauthu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cauthu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cauthu/subscriptions",
      "organizations_url": "https://api.github.com/users/cauthu/orgs",
      "repos_url": "https://api.github.com/users/cauthu/repos",
      "events_url": "https://api.github.com/users/cauthu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cauthu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-10T18:19:23Z",
    "updated_at": "2017-08-10T18:19:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "the python server is behaving correctly when given the empty ca certificate: it rejects the client.\r\nin particular, it is being clear reporting the error when loading the empty ca certificate.\r\n\r\nserver:\r\n```\r\nssl-helloworld$ GRPC_VERBOSITY=INFO python ./greeter_server.py empty.pem server.key.pem server-self-signed.cert.pem \r\nI0810 11:13:46.816352080    6010 ev_epollsig_linux.c:71]     epoll engine will be using signal: 40\r\nclient_ca_pem length: 0\r\nE0810 11:13:46.824827204    6010 ssl_transport_security.c:588] Could not load any root certificate.\r\nE0810 11:13:46.824862054    6010 ssl_transport_security.c:1437] Invalid verification certs.\r\nE0810 11:13:46.824878103    6010 security_connector.c:902]   Handshaker factory creation failed with TSI_INVALID_ARGUMENT.\r\nE0810 11:13:46.824903644    6010 server_secure_chttp2.c:81]  {\"created\":\"@1502388826.824890226\",\"description\":\"Unable to create secure server with credentials of type Ssl.\",\"file\":\"src/core/ext/transport/chttp2/server/secure/server_secure_chttp2.c\",\"file_line\":60,\"security_status\":1}\r\n```\r\n\r\nclient:\r\n```\r\nssl-helloworld$ python ./greeter_client.py server-self-signed.cert.pem client-key.pem client-self-signed-cert.pem \r\nTraceback (most recent call last):\r\n  File \"./greeter_client.py\", line 43, in <module>\r\n    run()\r\n  File \"./greeter_client.py\", line 38, in run\r\n    response = stub.SayHello(helloworld_pb2.HelloRequest(name='you'))\r\n  File \"/home/cauthu/.local/lib/python2.7/site-packages/grpc/_channel.py\", line 492, in __call__\r\n    return _end_unary_response_blocking(state, call, False, deadline)\r\n  File \"/home/cauthu/.local/lib/python2.7/site-packages/grpc/_channel.py\", line 440, in _end_unary_response_blocking\r\n    raise _Rendezvous(state, None, None, deadline)\r\ngrpc._channel._Rendezvous: <_Rendezvous of RPC that terminated with (StatusCode.UNAVAILABLE, Connect Failed)>\r\nssl-helloworld$ \r\n```\r\n\r\n---\r\n#### server code\r\n```\r\nfrom concurrent import futures\r\nimport time\r\n\r\nimport grpc\r\n\r\nimport helloworld_pb2\r\nimport helloworld_pb2_grpc\r\n\r\n_ONE_DAY_IN_SECONDS = 60 * 60 * 24\r\n\r\n\r\nclass Greeter(helloworld_pb2_grpc.GreeterServicer):\r\n\r\n  def SayHello(self, request, context):\r\n    return helloworld_pb2.HelloReply(message='Hello, %s!' % request.name)\r\n\r\n\r\nimport sys\r\n\r\nclient_ca_pem = open(sys.argv[1]).read() # for verifying clients\r\nmy_key_pem = open(sys.argv[2]).read()\r\nmy_cert_pem = open(sys.argv[3]).read()\r\n\r\ndef serve():\r\n  server_credentials = grpc.ssl_server_credentials(\r\n      [(my_key_pem, my_cert_pem)],\r\n      require_client_auth=True,\r\n      root_certificates=client_ca_pem, # for verifying clients\r\n  )\r\n\r\n  print(\"client_ca_pem length: {}\".format(len(client_ca_pem)))\r\n\r\n  server = grpc.server(futures.ThreadPoolExecutor(max_workers=10))\r\n  helloworld_pb2_grpc.add_GreeterServicer_to_server(Greeter(), server)\r\n  server.add_secure_port('[::]:50051', server_credentials)\r\n  server.start()\r\n  try:\r\n    while True:\r\n      time.sleep(_ONE_DAY_IN_SECONDS)\r\n  except KeyboardInterrupt:\r\n    server.stop(0)\r\n\r\nif __name__ == '__main__':\r\n  serve()\r\n```\r\n\r\n#### client code\r\n```\r\nfrom __future__ import print_function\r\n\r\nimport grpc\r\n\r\nimport helloworld_pb2\r\nimport helloworld_pb2_grpc\r\n\r\nimport sys\r\n\r\nserver_ca_pem = open(sys.argv[1]).read()\r\nmy_key_pem = open(sys.argv[2]).read()\r\nmy_cert_pem = open(sys.argv[3]).read()\r\n\r\ndef run():\r\n  credentials = grpc.ssl_channel_credentials(\r\n    private_key=my_key_pem, certificate_chain=my_cert_pem,\r\n    root_certificates=server_ca_pem,\r\n  )\r\n  \r\n  channel = grpc.secure_channel('localhost:50051', credentials)\r\n  stub = helloworld_pb2_grpc.GreeterStub(channel)\r\n  response = stub.SayHello(helloworld_pb2.HelloRequest(name='you'))\r\n  print(\"Greeter client received: \" + response.message)\r\n\r\n\r\nif __name__ == '__main__':\r\n  run()\r\n```"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/321718881",
    "html_url": "https://github.com/grpc/grpc/issues/12146#issuecomment-321718881",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12146",
    "id": 321718881,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMTcxODg4MQ==",
    "user": {
      "login": "jboeuf",
      "id": 6262765,
      "node_id": "MDQ6VXNlcjYyNjI3NjU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6262765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jboeuf",
      "html_url": "https://github.com/jboeuf",
      "followers_url": "https://api.github.com/users/jboeuf/followers",
      "following_url": "https://api.github.com/users/jboeuf/following{/other_user}",
      "gists_url": "https://api.github.com/users/jboeuf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jboeuf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jboeuf/subscriptions",
      "organizations_url": "https://api.github.com/users/jboeuf/orgs",
      "repos_url": "https://api.github.com/users/jboeuf/repos",
      "events_url": "https://api.github.com/users/jboeuf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jboeuf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-11T02:15:39Z",
    "updated_at": "2017-08-11T02:15:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "@deepaklukose would you mind having a look at the issue? Thanks!"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/321733863",
    "html_url": "https://github.com/grpc/grpc/issues/12146#issuecomment-321733863",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12146",
    "id": 321733863,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMTczMzg2Mw==",
    "user": {
      "login": "deepaklukose",
      "id": 17751169,
      "node_id": "MDQ6VXNlcjE3NzUxMTY5",
      "avatar_url": "https://avatars0.githubusercontent.com/u/17751169?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/deepaklukose",
      "html_url": "https://github.com/deepaklukose",
      "followers_url": "https://api.github.com/users/deepaklukose/followers",
      "following_url": "https://api.github.com/users/deepaklukose/following{/other_user}",
      "gists_url": "https://api.github.com/users/deepaklukose/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/deepaklukose/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/deepaklukose/subscriptions",
      "organizations_url": "https://api.github.com/users/deepaklukose/orgs",
      "repos_url": "https://api.github.com/users/deepaklukose/repos",
      "events_url": "https://api.github.com/users/deepaklukose/events{/privacy}",
      "received_events_url": "https://api.github.com/users/deepaklukose/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-11T05:21:08Z",
    "updated_at": "2017-08-11T05:21:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jboeuf https://github.com/grpc/grpc/blob/master/src/core/tsi/ssl_transport_security.h#L144 does indeed claim that the pem_client_root_certs needs to be non-null for the server to validate the client certs. Let me update the code to get rid of this since rejecting the client seems like the safer option."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/321734128",
    "html_url": "https://github.com/grpc/grpc/issues/12146#issuecomment-321734128",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12146",
    "id": 321734128,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMTczNDEyOA==",
    "user": {
      "login": "jboeuf",
      "id": 6262765,
      "node_id": "MDQ6VXNlcjYyNjI3NjU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6262765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jboeuf",
      "html_url": "https://github.com/jboeuf",
      "followers_url": "https://api.github.com/users/jboeuf/followers",
      "following_url": "https://api.github.com/users/jboeuf/following{/other_user}",
      "gists_url": "https://api.github.com/users/jboeuf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jboeuf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jboeuf/subscriptions",
      "organizations_url": "https://api.github.com/users/jboeuf/orgs",
      "repos_url": "https://api.github.com/users/jboeuf/repos",
      "events_url": "https://api.github.com/users/jboeuf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jboeuf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-11T05:24:06Z",
    "updated_at": "2017-08-11T05:24:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks much Deepak!\n\nOn Thu, Aug 10, 2017 at 10:21 PM, deepaklukose <notifications@github.com>\nwrote:\n\n> @jboeuf <https://github.com/jboeuf> https://github.com/grpc/grpc/\n> blob/master/src/core/tsi/ssl_transport_security.h#L144 does indeed claim\n> that the pem_client_root_certs needs to be non-null for the server to\n> validate the client certs. Let me update the code to get rid of this since\n> rejecting the client seems like the safer option.\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/grpc/grpc/issues/12146#issuecomment-321733863>, or mute\n> the thread\n> <https://github.com/notifications/unsubscribe-auth/AF-P7Znx9AnmI5JaG0RFyOm__mn7vnnBks5sW-TTgaJpZM4Ozw3g>\n> .\n>\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/321952450",
    "html_url": "https://github.com/grpc/grpc/issues/12146#issuecomment-321952450",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12146",
    "id": 321952450,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMTk1MjQ1MA==",
    "user": {
      "login": "cauthu",
      "id": 1170852,
      "node_id": "MDQ6VXNlcjExNzA4NTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/1170852?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cauthu",
      "html_url": "https://github.com/cauthu",
      "followers_url": "https://api.github.com/users/cauthu/followers",
      "following_url": "https://api.github.com/users/cauthu/following{/other_user}",
      "gists_url": "https://api.github.com/users/cauthu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cauthu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cauthu/subscriptions",
      "organizations_url": "https://api.github.com/users/cauthu/orgs",
      "repos_url": "https://api.github.com/users/cauthu/repos",
      "events_url": "https://api.github.com/users/cauthu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cauthu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-12T02:37:11Z",
    "updated_at": "2017-08-12T02:37:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "That'd be great! Thanks, Deepak!\n\n(sent from phone)\n\nOn Aug 10, 2017 10:24 PM, \"jboeuf\" <notifications@github.com> wrote:\n\nThanks much Deepak!\n\nOn Thu, Aug 10, 2017 at 10:21 PM, deepaklukose <notifications@github.com>\nwrote:\n\n> @jboeuf <https://github.com/jboeuf> https://github.com/grpc/grpc/\n\n> blob/master/src/core/tsi/ssl_transport_security.h#L144 does indeed claim\n> that the pem_client_root_certs needs to be non-null for the server to\n> validate the client certs. Let me update the code to get rid of this since\n> rejecting the client seems like the safer option.\n>\n> —\n> You are receiving this because you were mentioned.\n\n> Reply to this email directly, view it on GitHub\n> <https://github.com/grpc/grpc/issues/12146#issuecomment-321733863>, or\nmute\n> the thread\n> <https://github.com/notifications/unsubscribe-\nauth/AF-P7Znx9AnmI5JaG0RFyOm__mn7vnnBks5sW-TTgaJpZM4Ozw3g>\n\n> .\n>\n\n—\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\n<https://github.com/grpc/grpc/issues/12146#issuecomment-321734128>, or mute\nthe thread\n<https://github.com/notifications/unsubscribe-auth/ABHdpKgnC_38OfavEdWU2B20UZlhhgVOks5sW-WEgaJpZM4Ozw3g>\n.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/402668449",
    "html_url": "https://github.com/grpc/grpc/issues/12146#issuecomment-402668449",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12146",
    "id": 402668449,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMjY2ODQ0OQ==",
    "user": {
      "login": "kboyapa1",
      "id": 30464877,
      "node_id": "MDQ6VXNlcjMwNDY0ODc3",
      "avatar_url": "https://avatars1.githubusercontent.com/u/30464877?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kboyapa1",
      "html_url": "https://github.com/kboyapa1",
      "followers_url": "https://api.github.com/users/kboyapa1/followers",
      "following_url": "https://api.github.com/users/kboyapa1/following{/other_user}",
      "gists_url": "https://api.github.com/users/kboyapa1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kboyapa1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kboyapa1/subscriptions",
      "organizations_url": "https://api.github.com/users/kboyapa1/orgs",
      "repos_url": "https://api.github.com/users/kboyapa1/repos",
      "events_url": "https://api.github.com/users/kboyapa1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kboyapa1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-05T09:48:36Z",
    "updated_at": "2018-07-05T09:48:36Z",
    "author_association": "NONE",
    "body": "What is the status of this issue? is this closed? if so, Can please share the commit ID in which the issue is fixed?\r\n\r\nWe are also facing similar issue in python when used grpc.dynamic_ssl_server_credentials() function to update the server credentials dynamically for hitless certificate rotation. The scenario is,\r\n1. The server is started with valid certificate and client can connect with the server.\r\n2. We deleted the roots.pem from the server.\r\n3. Now attempted a new client connection with the same crt details as used in step-1. The client connection is accepted eventhough roots.pem is deleted.\r\n\r\ngrpc.dynamic_ssl_server_credentials() api notes says that \r\ncertificate_configuration_fetcher (callable) – A callable that takes no arguments and should return a ServerCertificateConfiguration to replace the server’s current certificate, or **None for no change (i.e., the server will continue its current certificate config).** The library will call this callback on every new client connection before starting the TLS handshake with the client, thus allowing the user application to optionally return a new ServerCertificateConfiguration that the server will then use for the handshake."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/403613598",
    "html_url": "https://github.com/grpc/grpc/issues/12146#issuecomment-403613598",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12146",
    "id": 403613598,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMzYxMzU5OA==",
    "user": {
      "login": "deepaklukose",
      "id": 17751169,
      "node_id": "MDQ6VXNlcjE3NzUxMTY5",
      "avatar_url": "https://avatars0.githubusercontent.com/u/17751169?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/deepaklukose",
      "html_url": "https://github.com/deepaklukose",
      "followers_url": "https://api.github.com/users/deepaklukose/followers",
      "following_url": "https://api.github.com/users/deepaklukose/following{/other_user}",
      "gists_url": "https://api.github.com/users/deepaklukose/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/deepaklukose/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/deepaklukose/subscriptions",
      "organizations_url": "https://api.github.com/users/deepaklukose/orgs",
      "repos_url": "https://api.github.com/users/deepaklukose/repos",
      "events_url": "https://api.github.com/users/deepaklukose/events{/privacy}",
      "received_events_url": "https://api.github.com/users/deepaklukose/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-09T20:42:46Z",
    "updated_at": "2018-07-09T20:42:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "The fix has not been committed. The proposed fix (https://github.com/grpc/grpc/pull/12193) needs a lot more work to rebase for which I unfortunately don't have the time right now."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/403623486",
    "html_url": "https://github.com/grpc/grpc/issues/12146#issuecomment-403623486",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12146",
    "id": 403623486,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMzYyMzQ4Ng==",
    "user": {
      "login": "cauthu",
      "id": 1170852,
      "node_id": "MDQ6VXNlcjExNzA4NTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/1170852?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cauthu",
      "html_url": "https://github.com/cauthu",
      "followers_url": "https://api.github.com/users/cauthu/followers",
      "following_url": "https://api.github.com/users/cauthu/following{/other_user}",
      "gists_url": "https://api.github.com/users/cauthu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cauthu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cauthu/subscriptions",
      "organizations_url": "https://api.github.com/users/cauthu/orgs",
      "repos_url": "https://api.github.com/users/cauthu/repos",
      "events_url": "https://api.github.com/users/cauthu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cauthu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-09T21:17:46Z",
    "updated_at": "2018-07-09T21:17:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "> 1. The server is started with valid certificate and client can connect with the server.\r\n> 2. We deleted the roots.pem from the server.\r\n> 3. Now attempted a new client connection with the same crt details as used in step-1\r\n\r\n@kboyapa1 so i assume you want the server to reject all new clients after you delete the roots.pem? while i understand that technically, that is the behavior promised by the `grpc.dynamic_ssl_server_credentials()` api, i dont know why that would be useful in real life? is it a scenario where you want to essentially temporarily \"take a server offline\" but instead of shutting down the service/cutting off network, you want to keep the server running, so that it can continue serving existing clients and also avoid the subsequent server startup cost, and in the mean time just rejects new clients? then later you \"bring the server back up\" by simply restoring the roots.pem?\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/405005059",
    "html_url": "https://github.com/grpc/grpc/issues/12146#issuecomment-405005059",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12146",
    "id": 405005059,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNTAwNTA1OQ==",
    "user": {
      "login": "kboyapa1",
      "id": 30464877,
      "node_id": "MDQ6VXNlcjMwNDY0ODc3",
      "avatar_url": "https://avatars1.githubusercontent.com/u/30464877?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kboyapa1",
      "html_url": "https://github.com/kboyapa1",
      "followers_url": "https://api.github.com/users/kboyapa1/followers",
      "following_url": "https://api.github.com/users/kboyapa1/following{/other_user}",
      "gists_url": "https://api.github.com/users/kboyapa1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kboyapa1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kboyapa1/subscriptions",
      "organizations_url": "https://api.github.com/users/kboyapa1/orgs",
      "repos_url": "https://api.github.com/users/kboyapa1/repos",
      "events_url": "https://api.github.com/users/kboyapa1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kboyapa1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-14T07:18:17Z",
    "updated_at": "2018-07-14T07:19:51Z",
    "author_association": "NONE",
    "body": "@cauthu Your understanding is correct. I am expecting server should reject all new client connections when roots.pem is deleted.\r\n\r\nWe are looking for hitless server certificate rotation. The existing client connections should not interrupted due to new certificates installation. All the new client connections should use new certificates to connect to the server.\r\n\r\nusing grpc.dynamic_ssl_server_credentials() api, \r\n\r\nScenario-1: (Working)\r\n==============\r\n1. Server started with cert-1(private_key_certificate_chain_pairs + roots.pem) and client session-1 with cert-1 establisged.\r\n2. Installed new certificate cert-2 (with different private_key_certificate_chain_pairs + roots.pem). The client session-2 with cert-1 should not connect. Its not connecting. The client session-1 should not terminate.  (Working)\r\n3. Client session-2 with cert-2 will connect to Server. Client session-1 also continues to work.\r\n\r\nScenario-2 (Not Working):\r\n===============\r\n1. Server started with cert-1(private_key_certificate_chain_pairs + roots.pem) and client session-1 with cert-1 establisged.\r\n2. Remove the roots.pem while server is running. The client session-2 with cert-1 should not connect because roots.pem is deleted. But client session-2 with cert-1 is connecting. (**Not Working**).\r\n The reason for this is, grpc.dynamic_ssl_server_credentials() returns None and gRPC server continues to use previously loaded certificate. So clients with old certificates still connect to server.\r\n\r\nScenario-3 (Not Working):\r\n================\r\n1. Server started with cert-1(private_key_certificate_chain_pairs + roots.pem) and client session-1 with cert-1 establisged.\r\n2. Install new certificate cert-2 but invalid private_key_certificate_chain_pairs. The client session-2 with cert-1 should not connect because of invalid chain_pairs. But client session-2 with cert-1 is connecting. (**Not Working**).\r\n  Seeing error message \"security_connector.cc:692]  Failed fetching new server credentials, continuing to use previously-loaded credentials.\""
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/447379932",
    "html_url": "https://github.com/grpc/grpc/issues/12146#issuecomment-447379932",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12146",
    "id": 447379932,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NzM3OTkzMg==",
    "user": {
      "login": "jiangtaoli2016",
      "id": 19913700,
      "node_id": "MDQ6VXNlcjE5OTEzNzAw",
      "avatar_url": "https://avatars2.githubusercontent.com/u/19913700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jiangtaoli2016",
      "html_url": "https://github.com/jiangtaoli2016",
      "followers_url": "https://api.github.com/users/jiangtaoli2016/followers",
      "following_url": "https://api.github.com/users/jiangtaoli2016/following{/other_user}",
      "gists_url": "https://api.github.com/users/jiangtaoli2016/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jiangtaoli2016/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jiangtaoli2016/subscriptions",
      "organizations_url": "https://api.github.com/users/jiangtaoli2016/orgs",
      "repos_url": "https://api.github.com/users/jiangtaoli2016/repos",
      "events_url": "https://api.github.com/users/jiangtaoli2016/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jiangtaoli2016/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-14T16:37:25Z",
    "updated_at": "2018-12-14T16:37:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "@cauthu This should be fixed. Let me know if problem still exists. Thanks for patience."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/447382172",
    "html_url": "https://github.com/grpc/grpc/issues/12146#issuecomment-447382172",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/12146",
    "id": 447382172,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NzM4MjE3Mg==",
    "user": {
      "login": "cauthu",
      "id": 1170852,
      "node_id": "MDQ6VXNlcjExNzA4NTI=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/1170852?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cauthu",
      "html_url": "https://github.com/cauthu",
      "followers_url": "https://api.github.com/users/cauthu/followers",
      "following_url": "https://api.github.com/users/cauthu/following{/other_user}",
      "gists_url": "https://api.github.com/users/cauthu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cauthu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cauthu/subscriptions",
      "organizations_url": "https://api.github.com/users/cauthu/orgs",
      "repos_url": "https://api.github.com/users/cauthu/repos",
      "events_url": "https://api.github.com/users/cauthu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cauthu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-14T16:44:55Z",
    "updated_at": "2018-12-14T16:44:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "Ah cool, thanks Jiangtao.\n\nOn Fri, Dec 14, 2018, 8:37 AM Jiangtao Li <notifications@github.com wrote:\n\n> @cauthu <https://github.com/cauthu> This should be fixed. Let me know if\n> problem still exists. Thanks for patience.\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/grpc/grpc/issues/12146#issuecomment-447379932>, or mute\n> the thread\n> <https://github.com/notifications/unsubscribe-auth/ABHdpPOqH0UipDwvfSkbSec18_rQwcj_ks5u49PlgaJpZM4Ozw3g>\n> .\n>\n"
  }
]
