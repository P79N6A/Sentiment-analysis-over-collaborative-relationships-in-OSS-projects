[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/474569252",
    "html_url": "https://github.com/grpc/grpc/pull/18435#issuecomment-474569252",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18435",
    "id": 474569252,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NDU2OTI1Mg==",
    "user": {
      "login": "nicolasnoble",
      "id": 7281574,
      "node_id": "MDQ6VXNlcjcyODE1NzQ=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/7281574?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nicolasnoble",
      "html_url": "https://github.com/nicolasnoble",
      "followers_url": "https://api.github.com/users/nicolasnoble/followers",
      "following_url": "https://api.github.com/users/nicolasnoble/following{/other_user}",
      "gists_url": "https://api.github.com/users/nicolasnoble/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nicolasnoble/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nicolasnoble/subscriptions",
      "organizations_url": "https://api.github.com/users/nicolasnoble/orgs",
      "repos_url": "https://api.github.com/users/nicolasnoble/repos",
      "events_url": "https://api.github.com/users/nicolasnoble/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nicolasnoble/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-19T20:28:32Z",
    "updated_at": "2019-03-19T20:28:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'd rather see whole new tests instead of having half of the code defined out. We try hard not to have portions of our code be disabled using `#ifdef`, as it increases complexity and decreases readability. Most of the time when we have an `#ifdef` in the middle of the code, it's because we really had no other option. In the other cases, what we do is create a new file, and protect the whole file using an ifdef, so that it's basically all of the code or nothing.\r\n\r\nSee for instance this code:\r\n\r\nhttps://github.com/grpc/grpc/blob/master/src/core/lib/gpr/tmpfile_windows.cc"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/474635199",
    "html_url": "https://github.com/grpc/grpc/pull/18435#issuecomment-474635199",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18435",
    "id": 474635199,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NDYzNTE5OQ==",
    "user": {
      "login": "nicolasnoble",
      "id": 7281574,
      "node_id": "MDQ6VXNlcjcyODE1NzQ=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/7281574?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nicolasnoble",
      "html_url": "https://github.com/nicolasnoble",
      "followers_url": "https://api.github.com/users/nicolasnoble/followers",
      "following_url": "https://api.github.com/users/nicolasnoble/following{/other_user}",
      "gists_url": "https://api.github.com/users/nicolasnoble/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nicolasnoble/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nicolasnoble/subscriptions",
      "organizations_url": "https://api.github.com/users/nicolasnoble/orgs",
      "repos_url": "https://api.github.com/users/nicolasnoble/repos",
      "events_url": "https://api.github.com/users/nicolasnoble/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nicolasnoble/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-20T00:23:10Z",
    "updated_at": "2019-03-20T00:23:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Overall, is it necessary to disable this code on Windows? The `uv_pipe_t` type exists across platforms. I expect that on Windows it will simply reject the UDS name and fail to construct the socket.\r\n\r\nThat's a valid point, and overall, there's a lot of complexity added with `#ifdef` that seem to simply try to disable the feature under Windows, whereas libuv should simply be able to accept these calls under Windows."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/474732247",
    "html_url": "https://github.com/grpc/grpc/pull/18435#issuecomment-474732247",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18435",
    "id": 474732247,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NDczMjI0Nw==",
    "user": {
      "login": "jkryl",
      "id": 5690145,
      "node_id": "MDQ6VXNlcjU2OTAxNDU=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/5690145?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jkryl",
      "html_url": "https://github.com/jkryl",
      "followers_url": "https://api.github.com/users/jkryl/followers",
      "following_url": "https://api.github.com/users/jkryl/following{/other_user}",
      "gists_url": "https://api.github.com/users/jkryl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jkryl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jkryl/subscriptions",
      "organizations_url": "https://api.github.com/users/jkryl/orgs",
      "repos_url": "https://api.github.com/users/jkryl/repos",
      "events_url": "https://api.github.com/users/jkryl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jkryl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-20T08:23:54Z",
    "updated_at": "2019-03-20T08:23:54Z",
    "author_association": "NONE",
    "body": "@nicolasnoble and @murgatroid99 thanks for looking at the changes! I understand the concern about scattered ifdef's throughout the files. I can try to minimise their number by putting all UDS specific code to a new file wrapped in ifdef as @nicolasnoble has suggested.\r\n\r\nAs for the second suggestion of removing all ifdefs entirely because uv_pipe_t works on all platforms - that's unlikely going to work. libuv is fine, but grpc is not. I cannot use socket_un structure and AF_UNIX constant on windows and grpc lib does not provide abstraction layer to hide differences between UDS and named pipes on windows (unlike libuv). Also I know nothing about windows and cannot even test such code. So I think that the most safe way is to simply disable this code on windows unless there is a volunteer who would like to help with this part.\r\n\r\nIf you are fine with putting UDS specific code to a new file specific to unix-like OS's and creating yet another file with mostly just stubs returning errors for windows, then let me know and I will try to refactor the code. thanks"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/474843628",
    "html_url": "https://github.com/grpc/grpc/pull/18435#issuecomment-474843628",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18435",
    "id": 474843628,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NDg0MzYyOA==",
    "user": {
      "login": "nicolasnoble",
      "id": 7281574,
      "node_id": "MDQ6VXNlcjcyODE1NzQ=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/7281574?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nicolasnoble",
      "html_url": "https://github.com/nicolasnoble",
      "followers_url": "https://api.github.com/users/nicolasnoble/followers",
      "following_url": "https://api.github.com/users/nicolasnoble/following{/other_user}",
      "gists_url": "https://api.github.com/users/nicolasnoble/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nicolasnoble/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nicolasnoble/subscriptions",
      "organizations_url": "https://api.github.com/users/nicolasnoble/orgs",
      "repos_url": "https://api.github.com/users/nicolasnoble/repos",
      "events_url": "https://api.github.com/users/nicolasnoble/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nicolasnoble/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-20T14:05:02Z",
    "updated_at": "2019-03-20T16:45:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "The only moment you have to actually interact with the socket_un structure is the getpeername code, right? "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/474929813",
    "html_url": "https://github.com/grpc/grpc/pull/18435#issuecomment-474929813",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18435",
    "id": 474929813,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NDkyOTgxMw==",
    "user": {
      "login": "nicolasnoble",
      "id": 7281574,
      "node_id": "MDQ6VXNlcjcyODE1NzQ=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/7281574?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nicolasnoble",
      "html_url": "https://github.com/nicolasnoble",
      "followers_url": "https://api.github.com/users/nicolasnoble/followers",
      "following_url": "https://api.github.com/users/nicolasnoble/following{/other_user}",
      "gists_url": "https://api.github.com/users/nicolasnoble/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nicolasnoble/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nicolasnoble/subscriptions",
      "organizations_url": "https://api.github.com/users/nicolasnoble/orgs",
      "repos_url": "https://api.github.com/users/nicolasnoble/repos",
      "events_url": "https://api.github.com/users/nicolasnoble/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nicolasnoble/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-20T16:56:59Z",
    "updated_at": "2019-03-20T16:57:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "Digging a bit, the getpeername API is horrendous. The only two locations of code where we actively use it is to transform it immediately into a string:\r\n\r\nhttps://github.com/grpc/grpc/blob/618a3f561d4a93f263cca23abad086ed8f4d5e86/src/core/lib/iomgr/tcp_server_custom.cc#L218\r\n\r\nand in \r\n\r\nhttps://github.com/grpc/grpc/blob/c339ba32298a00436ba98800d513dcf4d0944d11/src/python/grpcio/grpc/_cython/_cygrpc/grpc_gevent.pyx.pxi#L222\r\n\r\n\r\nMaybe we should refactor this to always return a string instead? That would avoid exposing system-dependent structures into a system-agnostic API."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/474974862",
    "html_url": "https://github.com/grpc/grpc/pull/18435#issuecomment-474974862",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18435",
    "id": 474974862,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NDk3NDg2Mg==",
    "user": {
      "login": "jkryl",
      "id": 5690145,
      "node_id": "MDQ6VXNlcjU2OTAxNDU=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/5690145?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jkryl",
      "html_url": "https://github.com/jkryl",
      "followers_url": "https://api.github.com/users/jkryl/followers",
      "following_url": "https://api.github.com/users/jkryl/following{/other_user}",
      "gists_url": "https://api.github.com/users/jkryl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jkryl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jkryl/subscriptions",
      "organizations_url": "https://api.github.com/users/jkryl/orgs",
      "repos_url": "https://api.github.com/users/jkryl/repos",
      "events_url": "https://api.github.com/users/jkryl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jkryl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-20T18:34:42Z",
    "updated_at": "2019-03-20T18:35:48Z",
    "author_association": "NONE",
    "body": "Indirect use of socket_un is also in uv_resolve_async() and uv_resolve(), but it's not apparent because we make use of grpc_resolve_unix_domain_address() which hides the manipulation with socket_un. On windows the function is just a stub returning \"not supported\" error. That's actually the approach I thought we would be taking with libuv UDS as well. Another use of socket_un is in uv_socket_bind() btw.\r\n\r\nAnd AF_UNIX? I guess that neither that one is defined on windows. So we would need to eliminate use of that one too if we want to have exactly the same code on all platforms without ifdef's."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/475048629",
    "html_url": "https://github.com/grpc/grpc/pull/18435#issuecomment-475048629",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18435",
    "id": 475048629,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTA0ODYyOQ==",
    "user": {
      "login": "nicolasnoble",
      "id": 7281574,
      "node_id": "MDQ6VXNlcjcyODE1NzQ=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/7281574?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nicolasnoble",
      "html_url": "https://github.com/nicolasnoble",
      "followers_url": "https://api.github.com/users/nicolasnoble/followers",
      "following_url": "https://api.github.com/users/nicolasnoble/following{/other_user}",
      "gists_url": "https://api.github.com/users/nicolasnoble/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nicolasnoble/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nicolasnoble/subscriptions",
      "organizations_url": "https://api.github.com/users/nicolasnoble/orgs",
      "repos_url": "https://api.github.com/users/nicolasnoble/repos",
      "events_url": "https://api.github.com/users/nicolasnoble/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nicolasnoble/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-20T22:12:07Z",
    "updated_at": "2019-03-20T22:12:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "`AF_UNIX` is supposed to be defined in the windows headers, interestingly. Even if it's not supported, it's defined."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/475358291",
    "html_url": "https://github.com/grpc/grpc/pull/18435#issuecomment-475358291",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18435",
    "id": 475358291,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTM1ODI5MQ==",
    "user": {
      "login": "jkryl",
      "id": 5690145,
      "node_id": "MDQ6VXNlcjU2OTAxNDU=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/5690145?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jkryl",
      "html_url": "https://github.com/jkryl",
      "followers_url": "https://api.github.com/users/jkryl/followers",
      "following_url": "https://api.github.com/users/jkryl/following{/other_user}",
      "gists_url": "https://api.github.com/users/jkryl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jkryl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jkryl/subscriptions",
      "organizations_url": "https://api.github.com/users/jkryl/orgs",
      "repos_url": "https://api.github.com/users/jkryl/repos",
      "events_url": "https://api.github.com/users/jkryl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jkryl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-21T18:49:57Z",
    "updated_at": "2019-03-26T07:39:08Z",
    "author_association": "NONE",
    "body": "I have updated the fix. I removed all ifdefs in tcp_uv code. I make use  of existing `unix_sockets_posix.c` and `unix_sockets_posix_noop.c` files for platform dependent code related to UDS."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/476510409",
    "html_url": "https://github.com/grpc/grpc/pull/18435#issuecomment-476510409",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18435",
    "id": 476510409,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjUxMDQwOQ==",
    "user": {
      "login": "jkryl",
      "id": 5690145,
      "node_id": "MDQ6VXNlcjU2OTAxNDU=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/5690145?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jkryl",
      "html_url": "https://github.com/jkryl",
      "followers_url": "https://api.github.com/users/jkryl/followers",
      "following_url": "https://api.github.com/users/jkryl/following{/other_user}",
      "gists_url": "https://api.github.com/users/jkryl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jkryl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jkryl/subscriptions",
      "organizations_url": "https://api.github.com/users/jkryl/orgs",
      "repos_url": "https://api.github.com/users/jkryl/repos",
      "events_url": "https://api.github.com/users/jkryl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jkryl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-26T07:45:19Z",
    "updated_at": "2019-03-26T07:45:19Z",
    "author_association": "NONE",
    "body": "@nicolasnoble : there was an issue with building grpc without libuv which I think that should be fixed now. Is there a way how to trigger the test run again? thanks"
  }
]
