[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/265316247",
    "html_url": "https://github.com/grpc/grpc/issues/8974#issuecomment-265316247",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8974",
    "id": 265316247,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTMxNjI0Nw==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-07T00:18:19Z",
    "updated_at": "2016-12-07T00:18:19Z",
    "author_association": "MEMBER",
    "body": "Are you able to run with `GRPC_VERBOSITY=DEBUG` and `GRPC_TRACE=ALL`?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/265410422",
    "html_url": "https://github.com/grpc/grpc/issues/8974#issuecomment-265410422",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8974",
    "id": 265410422,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTQxMDQyMg==",
    "user": {
      "login": "athei",
      "id": 2580396,
      "node_id": "MDQ6VXNlcjI1ODAzOTY=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/2580396?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/athei",
      "html_url": "https://github.com/athei",
      "followers_url": "https://api.github.com/users/athei/followers",
      "following_url": "https://api.github.com/users/athei/following{/other_user}",
      "gists_url": "https://api.github.com/users/athei/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/athei/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/athei/subscriptions",
      "organizations_url": "https://api.github.com/users/athei/orgs",
      "repos_url": "https://api.github.com/users/athei/repos",
      "events_url": "https://api.github.com/users/athei/events{/privacy}",
      "received_events_url": "https://api.github.com/users/athei/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-07T10:22:45Z",
    "updated_at": "2016-12-07T10:22:45Z",
    "author_association": "NONE",
    "body": "I did run it with `GRPC_VERBOSITY=DEBUG`. This is the sequence that pops up before a request fails:\r\n```\r\nI1207 10:57:18.575999000 123145534390272 subchannel.c:642] Connect failed: {\"created\":\"@1481104638.575942000\",\"description\":\"Failed to connect to remote host\",\"file\":\"src/core/lib/iomgr/ev_poll_posix.c\",\"file_line\":427,\"os_error\":\"Timeout occurred\",\"target_address\":\"ipv4:127.0.0.1:50051\"}\r\nI1207 10:57:18.576049000 123145534390272 subchannel.c:645] Retry immediately\r\nI1207 10:57:18.576091000 123145534390272 subchannel.c:642] Connect failed: {\"created\":\"@1481104638.575950000\",\"description\":\"Failed to connect to remote host\",\"file\":\"src/core/lib/iomgr/ev_poll_posix.c\",\"file_line\":427,\"os_error\":\"Timeout occurred\",\"target_address\":\"ipv4:127.0.0.1:50051\"}\r\nI1207 10:57:18.576101000 123145534390272 subchannel.c:645] Retry immediately\r\nI1207 10:57:18.576109000 123145534390272 subchannel.c:609] Failed to connect to channel, retrying\r\nI1207 10:57:18.576203000 123145534390272 subchannel.c:609] Failed to connect to channel, retrying\r\n```\r\n\r\nAll the nodes share one server with the IP `127.0.0.1:50051`. So the server is there. It may be overloaded or something?\r\n\r\nI also ran the test program with tracing enabled. This yields a massive log file (35MB). I have attached it in compressed form. In my code I print out failed client requests with the error number. So grep for `(14)` to get to the places where the request failed.\r\n\r\nI use the sync API for the server and the async API for the client. Currently I use 4 client threads each with their own completion queue. Thread sanitizer does not report any issues.\r\n\r\nThe trace file (1,5MB compressed):\r\nhttps://cloud.theissen.io:14101/f/8e7e7ce024/?raw=1\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/265562682",
    "html_url": "https://github.com/grpc/grpc/issues/8974#issuecomment-265562682",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8974",
    "id": 265562682,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTU2MjY4Mg==",
    "user": {
      "login": "dgquintas",
      "id": 120217,
      "node_id": "MDQ6VXNlcjEyMDIxNw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/120217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dgquintas",
      "html_url": "https://github.com/dgquintas",
      "followers_url": "https://api.github.com/users/dgquintas/followers",
      "following_url": "https://api.github.com/users/dgquintas/following{/other_user}",
      "gists_url": "https://api.github.com/users/dgquintas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dgquintas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dgquintas/subscriptions",
      "organizations_url": "https://api.github.com/users/dgquintas/orgs",
      "repos_url": "https://api.github.com/users/dgquintas/repos",
      "events_url": "https://api.github.com/users/dgquintas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dgquintas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-07T20:23:25Z",
    "updated_at": "2016-12-07T20:23:25Z",
    "author_association": "NONE",
    "body": "Looking at the logs, it seems your intuition is correct: the system resources are exhausted. Look at log messages from \"connectivity_state.c:156\", eg (formatted for readability):\r\n```\r\nD1207 11:19:34.926607000 123145478201344 connectivity_state.c:156] \r\nSET: 0x10554a9d0 subchannel: CONNECTING --> TRANSIENT_FAILURE [connect_failed] \r\nerror=0x1056473b0 \r\n{\r\n    \"created\": \"@1481105974.926567000\",\r\n    \"description\": \"Connect Failed\",\r\n    \"file\": \"src/core/ext/client_config/subchannel.c\",\r\n    \"file_line\": 638,\r\n    \"referenced_errors\": [\r\n        {\r\n            \"created\": \"@1481105974.858292000\",\r\n            \"description\": \"Failed to connect to remote host\",\r\n            \"errno\": 35,\r\n            \"file\": \"src/core/lib/iomgr/tcp_client_posix.c\",\r\n            \"file_line\": 186,\r\n            \"os_error\": \"Resource temporarily unavailable\",\r\n            \"syscall\": \"getsockopt(SO_ERROR)\",\r\n            \"target_address\": \"ipv4:127.0.0.1:50051\"\r\n        }\r\n    ]\r\n}\r\n```\r\n(btw, you can get traces of this kind by only specifying \"connectivity_state\" in the `GRPC_TRACE` env var. Using `all` is usually overkill, see [here](https://github.com/grpc/grpc/blob/master/doc/environment_variables.md)).\r\n\r\nThere's another issue at play here: Retries happen too eagerly. This has been recently fixed [see this PR](https://github.com/grpc/grpc/pull/8854). By waiting longer we prevent the avalanche effect that only compounds the problem of not having resources available.\r\n\r\nThe problem with appending the info you see in the traces to the Status is that it may get too verbose. Imagine a connection goes over 10 retries, succeeds, fails again and then the call times out. You then get a Status indicating the deadline exceeded failure (the higher level cause of the failure after all). Which information should be included? all 10+1+1 transitions of the connectivity? That being said, I believe @ncteisen is working on something that'd actually make it possible to fully trace the cause of a failure. For now though, there's the traces. \r\n\r\n@ncteisen is there an issue/description of the error tracing feature somewhere?\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/265618733",
    "html_url": "https://github.com/grpc/grpc/issues/8974#issuecomment-265618733",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8974",
    "id": 265618733,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTYxODczMw==",
    "user": {
      "login": "ncteisen",
      "id": 6148140,
      "node_id": "MDQ6VXNlcjYxNDgxNDA=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6148140?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ncteisen",
      "html_url": "https://github.com/ncteisen",
      "followers_url": "https://api.github.com/users/ncteisen/followers",
      "following_url": "https://api.github.com/users/ncteisen/following{/other_user}",
      "gists_url": "https://api.github.com/users/ncteisen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ncteisen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ncteisen/subscriptions",
      "organizations_url": "https://api.github.com/users/ncteisen/orgs",
      "repos_url": "https://api.github.com/users/ncteisen/repos",
      "events_url": "https://api.github.com/users/ncteisen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ncteisen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-08T00:38:22Z",
    "updated_at": "2016-12-08T00:38:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "The channel tracing internal design doc is WIP, and should be done by the end of this quarter. Once it is finalized, I will publish it to Github. The implementation is going to occur next quarter."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/289800308",
    "html_url": "https://github.com/grpc/grpc/issues/8974#issuecomment-289800308",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8974",
    "id": 289800308,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4OTgwMDMwOA==",
    "user": {
      "login": "rajnkamr",
      "id": 20070979,
      "node_id": "MDQ6VXNlcjIwMDcwOTc5",
      "avatar_url": "https://avatars0.githubusercontent.com/u/20070979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rajnkamr",
      "html_url": "https://github.com/rajnkamr",
      "followers_url": "https://api.github.com/users/rajnkamr/followers",
      "following_url": "https://api.github.com/users/rajnkamr/following{/other_user}",
      "gists_url": "https://api.github.com/users/rajnkamr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rajnkamr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rajnkamr/subscriptions",
      "organizations_url": "https://api.github.com/users/rajnkamr/orgs",
      "repos_url": "https://api.github.com/users/rajnkamr/repos",
      "events_url": "https://api.github.com/users/rajnkamr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rajnkamr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-28T15:06:09Z",
    "updated_at": "2017-03-28T15:06:09Z",
    "author_association": "NONE",
    "body": "I got exactly same error for a single client ( not multi threaded).\r\nwhat could be the issue?\r\n\r\nGRPC:INFO [socket_utils_common_posix.c:<unk>:205] Disabling AF_INET6 sockets because ::1 is not available.\r\nMar 28 15:13:26 MaestrOS SysRepoSync.elf: 27266:GRPC:INFO [subchannel.c:<unk>:642] Connect failed: {\"created\":\"@1490732006.164787096\",\"description\":\"Failed to connect to remote host\",\"file\":\"src/core/lib/iomgr/ev_poll_posix.c\",\"file_line\":427,\"os_error\":\"Timeout occurred\",\"target_address\":\"ipv4:10.64.156.72:35128\"}"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/290498379",
    "html_url": "https://github.com/grpc/grpc/issues/8974#issuecomment-290498379",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8974",
    "id": 290498379,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MDQ5ODM3OQ==",
    "user": {
      "login": "dgquintas",
      "id": 120217,
      "node_id": "MDQ6VXNlcjEyMDIxNw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/120217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dgquintas",
      "html_url": "https://github.com/dgquintas",
      "followers_url": "https://api.github.com/users/dgquintas/followers",
      "following_url": "https://api.github.com/users/dgquintas/following{/other_user}",
      "gists_url": "https://api.github.com/users/dgquintas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dgquintas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dgquintas/subscriptions",
      "organizations_url": "https://api.github.com/users/dgquintas/orgs",
      "repos_url": "https://api.github.com/users/dgquintas/repos",
      "events_url": "https://api.github.com/users/dgquintas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dgquintas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-30T18:17:11Z",
    "updated_at": "2017-03-30T18:17:11Z",
    "author_association": "NONE",
    "body": "@rajnkamr is there a (responsive) server listening at 10.64.156.72:35128?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/290616890",
    "html_url": "https://github.com/grpc/grpc/issues/8974#issuecomment-290616890",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8974",
    "id": 290616890,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MDYxNjg5MA==",
    "user": {
      "login": "rajnkamr",
      "id": 20070979,
      "node_id": "MDQ6VXNlcjIwMDcwOTc5",
      "avatar_url": "https://avatars0.githubusercontent.com/u/20070979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rajnkamr",
      "html_url": "https://github.com/rajnkamr",
      "followers_url": "https://api.github.com/users/rajnkamr/followers",
      "following_url": "https://api.github.com/users/rajnkamr/following{/other_user}",
      "gists_url": "https://api.github.com/users/rajnkamr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rajnkamr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rajnkamr/subscriptions",
      "organizations_url": "https://api.github.com/users/rajnkamr/orgs",
      "repos_url": "https://api.github.com/users/rajnkamr/repos",
      "events_url": "https://api.github.com/users/rajnkamr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rajnkamr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-31T05:06:07Z",
    "updated_at": "2017-03-31T05:06:07Z",
    "author_association": "NONE",
    "body": "Yes server is listening on 35128.I got another error with loopback and 35128\r\nGRPC:INFO [socket_utils_common_posix.c:<unk>:205] Disabling AF_INET6 sockets because ::1 is not available.\r\n\r\nGRPC:ERRO [chttp2_transport.c:<u[DBG] Thread id=140737308677888 signaled.490924672.415574602\",\"description\":\"FD shutdown\",\"file\":\"src/core/lib/iomgr/ev_poll_posix.c\",\"file_line\":427}"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/350851159",
    "html_url": "https://github.com/grpc/grpc/issues/8974#issuecomment-350851159",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/8974",
    "id": 350851159,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MDg1MTE1OQ==",
    "user": {
      "login": "ncteisen",
      "id": 6148140,
      "node_id": "MDQ6VXNlcjYxNDgxNDA=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/6148140?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ncteisen",
      "html_url": "https://github.com/ncteisen",
      "followers_url": "https://api.github.com/users/ncteisen/followers",
      "following_url": "https://api.github.com/users/ncteisen/following{/other_user}",
      "gists_url": "https://api.github.com/users/ncteisen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ncteisen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ncteisen/subscriptions",
      "organizations_url": "https://api.github.com/users/ncteisen/orgs",
      "repos_url": "https://api.github.com/users/ncteisen/repos",
      "events_url": "https://api.github.com/users/ncteisen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ncteisen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-11T20:39:48Z",
    "updated_at": "2017-12-11T20:39:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "Is this still relevant? "
  }
]
