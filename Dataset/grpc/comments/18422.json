[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/475312889",
    "html_url": "https://github.com/grpc/grpc/issues/18422#issuecomment-475312889",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18422",
    "id": 475312889,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTMxMjg4OQ==",
    "user": {
      "login": "lidizheng",
      "id": 7394928,
      "node_id": "MDQ6VXNlcjczOTQ5Mjg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7394928?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lidizheng",
      "html_url": "https://github.com/lidizheng",
      "followers_url": "https://api.github.com/users/lidizheng/followers",
      "following_url": "https://api.github.com/users/lidizheng/following{/other_user}",
      "gists_url": "https://api.github.com/users/lidizheng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lidizheng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lidizheng/subscriptions",
      "organizations_url": "https://api.github.com/users/lidizheng/orgs",
      "repos_url": "https://api.github.com/users/lidizheng/repos",
      "events_url": "https://api.github.com/users/lidizheng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lidizheng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-21T16:52:02Z",
    "updated_at": "2019-03-21T16:52:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "@colincadams I am unable to reproduce the bug, and I posted my approach below. Can you provide more specific details of the bug?\r\n\r\nTo execute the example:\r\n\r\n```bash\r\npython server.py\r\ngunicorn -c config.py app:app\r\n```\r\n\r\nHere is my example:\r\n\r\n```Python\r\n# app.py\r\nfrom flask import Flask\r\nimport grpc\r\n\r\napp = Flask(__name__)\r\n\r\n@app.route('/')\r\ndef home():\r\n    with grpc.insecure_channel('localhost:10000') as channel:\r\n        resp = channel.unary_unary('Any')(b'Hi')\r\n        return 'Server respond: \"%s\"' % resp\r\n```\r\n\r\n```Python\r\n# server.py\r\nimport time\r\nimport grpc\r\nfrom concurrent import futures\r\n\r\ndef logic(request, context):\r\n    print(\"Recv\", request)\r\n    return request\r\n\r\nclass GenericHandler(grpc.GenericRpcHandler):\r\n    def service(self, handler_details):\r\n        return grpc.unary_unary_rpc_method_handler(logic)\r\n\r\nserver = grpc.server(futures.ThreadPoolExecutor())\r\nserver.add_generic_rpc_handlers((GenericHandler(),))\r\nserver.add_insecure_port(':10000')\r\nserver.start()\r\n\r\ntime.sleep(10000)\r\n```\r\n\r\n```Python\r\n# config.py\r\nimport multiprocessing\r\nfrom gevent_grpc_worker import GeventGrpcWorker\r\n\r\n\r\n# http://docs.gunicorn.org/en/stable/design.html#how-many-workers\r\nworkers = multiprocessing.cpu_count() * 2 + 1\r\nworker_connections = 10000\r\n# Use an asynchronous worker as most of the work is waiting for websites to load\r\nworker_class = '.'.join([GeventGrpcWorker.__module__,\r\n                         GeventGrpcWorker.__name__])\r\ntimeout = 30\r\n```\r\n\r\n```Python\r\n# gevent_grpc_worker.py\r\nfrom gunicorn.workers.ggevent import GeventWorker\r\nfrom grpc.experimental import gevent\r\n\r\n\r\nclass GeventGrpcWorker(GeventWorker):\r\n    def patch(self):\r\n        super(GeventGrpcWorker, self).patch()\r\n        gevent.init_gevent()\r\n        self.log.info('patched grpc')\r\n```\r\n\r\nHere is my `pip freeze`:\r\n```\r\nClick==7.0\r\ndnspython==1.16.0\r\neventlet==0.24.1\r\nFlask==1.0.2\r\ngevent==1.4.0\r\ngreenlet==0.4.15\r\ngrpcio==1.19.0\r\ngunicorn==19.9.0\r\nitsdangerous==1.1.0\r\nJinja2==2.10\r\nMarkupSafe==1.1.1\r\nmonotonic==1.5\r\nsix==1.12.0\r\nWerkzeug==0.15.0\r\n```"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/475968877",
    "html_url": "https://github.com/grpc/grpc/issues/18422#issuecomment-475968877",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18422",
    "id": 475968877,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTk2ODg3Nw==",
    "user": {
      "login": "colincadams",
      "id": 3762913,
      "node_id": "MDQ6VXNlcjM3NjI5MTM=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/3762913?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/colincadams",
      "html_url": "https://github.com/colincadams",
      "followers_url": "https://api.github.com/users/colincadams/followers",
      "following_url": "https://api.github.com/users/colincadams/following{/other_user}",
      "gists_url": "https://api.github.com/users/colincadams/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/colincadams/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/colincadams/subscriptions",
      "organizations_url": "https://api.github.com/users/colincadams/orgs",
      "repos_url": "https://api.github.com/users/colincadams/repos",
      "events_url": "https://api.github.com/users/colincadams/events{/privacy}",
      "received_events_url": "https://api.github.com/users/colincadams/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-24T15:18:31Z",
    "updated_at": "2019-03-25T00:30:12Z",
    "author_association": "NONE",
    "body": "I adapted a different example I had to reproduce the bug, so it might not be the minimal set but is still small:\r\n* 1.19.0: colincadams/opencensus-example@bc81d70f32dffc0d3530eda087c65a38cc064c9a\r\n* 1.18.0: colincadams/opencensus-example@8d8459891b53a442f08f5483c6095f633fc59dc2\r\n\r\nIf you run `gcloud app deploy` on each version, 1.19.0 will have the `segfault at 10` error, whereas 1.18.0 will not.\r\n\r\nThis uses opencensus to report metrics to stackdriver via grpc, instead of making plain grpc calls directly. It also is running on appengine instead of locally. Those seem to be the main differences, but hopefully it helps you debug?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/476399617",
    "html_url": "https://github.com/grpc/grpc/issues/18422#issuecomment-476399617",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18422",
    "id": 476399617,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjM5OTYxNw==",
    "user": {
      "login": "lidizheng",
      "id": 7394928,
      "node_id": "MDQ6VXNlcjczOTQ5Mjg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7394928?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lidizheng",
      "html_url": "https://github.com/lidizheng",
      "followers_url": "https://api.github.com/users/lidizheng/followers",
      "following_url": "https://api.github.com/users/lidizheng/following{/other_user}",
      "gists_url": "https://api.github.com/users/lidizheng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lidizheng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lidizheng/subscriptions",
      "organizations_url": "https://api.github.com/users/lidizheng/orgs",
      "repos_url": "https://api.github.com/users/lidizheng/repos",
      "events_url": "https://api.github.com/users/lidizheng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lidizheng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-25T22:20:10Z",
    "updated_at": "2019-03-25T22:20:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "Able to reproduce the error, here is the core dump in `lldb`:\r\n\r\n```\r\n* thread #1, stop reason = signal SIGSTOP\r\n  * frame #0: 0x000000010f5a67cd cygrpc.so`grpc_fd_create(int, char const*, bool) + 77\r\n    frame #1: 0x000000010f630c72 cygrpc.so`grpc_core::GrpcPolledFdFactoryPosix::NewGrpcPolledFdLocked(int, grpc_pollset_set*, grpc_combiner*) + 82\r\n    frame #2: 0x000000010f63059b cygrpc.so`grpc_ares_notify_on_event_locked(grpc_ares_ev_driver*) + 299\r\n    frame #3: 0x000000010f6303aa cygrpc.so`grpc_ares_ev_driver_start_locked(grpc_ares_ev_driver*) + 42\r\n    frame #4: 0x000000010f63178d cygrpc.so`grpc_dns_lookup_ares_continue_after_check_localhost_and_ip_literals_locked(grpc_ares_request*, char const*, char const*, char const*, grpc_pollset_set*, bool, int, grpc_combiner*) + 1261\r\n    frame #5: 0x000000010f6329c5 cygrpc.so`grpc_dns_lookup_ares_locked_impl(char const*, char const*, char const*, grpc_pollset_set*, grpc_closure*, std::__1::unique_ptr<grpc_core::InlinedVector<grpc_core::ServerAddress, 1ul>, grpc_core::DefaultDelete<grpc_core::InlinedVector<grpc_core::ServerAddress, 1ul> > >*, bool, char**, int, grpc_combiner*) + 1077\r\n    frame #6: 0x000000010f62fbfe cygrpc.so`grpc_core::(anonymous namespace)::AresDnsResolver::StartResolvingLocked() + 126\r\n    frame #7: 0x000000010f60d96c cygrpc.so`grpc_core::RequestRouter::RouteCallLocked(grpc_core::RequestRouter::Request*) + 124\r\n    frame #8: 0x000000010f5a006c cygrpc.so`grpc_combiner_continue_exec_ctx() + 92\r\n    frame #9: 0x000000010f5a6e8d cygrpc.so`grpc_core::ExecCtx::Flush() + 45\r\n    frame #10: 0x000000010f5c16df cygrpc.so`grpc_call_start_batch + 335\r\n    frame #11: 0x000000010f456502 cygrpc.so`__pyx_f_4grpc_7_cython_6cygrpc__operate(grpc_call*, _object*, _object*) + 258\r\n    frame #12: 0x000000010f4636e0 cygrpc.so`__pyx_f_4grpc_7_cython_6cygrpc__call(__pyx_obj_4grpc_7_cython_6cygrpc__ChannelState*, __pyx_obj_4grpc_7_cython_6cygrpc__CallState*, grpc_completion_queue*, _object*, int, _object*, _object*, _object*, __pyx_obj_4grpc_7_cython_6cygrpc_CallCredentials*, _object*, _object*, _object*) + 2704\r\n    frame #13: 0x000000010f45e380 cygrpc.so`__pyx_pw_4grpc_7_cython_6cygrpc_7Channel_9segregated_call(_object*, _object*, _object*) + 2000\r\n    frame #14: 0x000000010e633ebe Python`PyEval_EvalFrameEx + 30206\r\n    frame #15: 0x000000010e638e82 Python`fast_function + 274\r\n    frame #16: 0x000000010e633ab4 Python`PyEval_EvalFrameEx + 29172\r\n    frame #17: 0x000000010e62c5b2 Python`PyEval_EvalCodeEx + 1538\r\n    frame #18: 0x000000010e5b6b9c Python`function_call + 364\r\n    frame #19: 0x000000010e5907e3 Python`PyObject_Call + 99\r\n    frame #20: 0x000000010e59db96 Python`instancemethod_call + 182\r\n    frame #21: 0x000000010e5907e3 Python`PyObject_Call + 99\r\n    frame #22: 0x000000010e5ec325 Python`slot_tp_call + 133\r\n    frame #23: 0x000000010e5907e3 Python`PyObject_Call + 99\r\n    frame #24: 0x000000010e634602 Python`PyEval_EvalFrameEx + 32066\r\n    frame #25: 0x000000010e62c5b2 Python`PyEval_EvalCodeEx + 1538\r\n    frame #26: 0x000000010e5b6b9c Python`function_call + 364\r\n    frame #27: 0x000000010e5907e3 Python`PyObject_Call + 99\r\n    frame #28: 0x000000010e634602 Python`PyEval_EvalFrameEx + 32066\r\n    frame #29: 0x000000010e62c5b2 Python`PyEval_EvalCodeEx + 1538\r\n    frame #30: 0x000000010e5b6b9c Python`function_call + 364\r\n    frame #31: 0x000000010e5907e3 Python`PyObject_Call + 99\r\n    frame #32: 0x000000010e9e5942 _functools.so`partial_call + 194\r\n    frame #33: 0x000000010e5907e3 Python`PyObject_Call + 99\r\n    frame #34: 0x000000010e633b90 Python`PyEval_EvalFrameEx + 29392\r\n    frame #35: 0x000000010e62c5b2 Python`PyEval_EvalCodeEx + 1538\r\n    frame #36: 0x000000010e638de5 Python`fast_function + 117\r\n    frame #37: 0x000000010e633ab4 Python`PyEval_EvalFrameEx + 29172\r\n    frame #38: 0x000000010e62c5b2 Python`PyEval_EvalCodeEx + 1538\r\n    frame #39: 0x000000010e5b6b9c Python`function_call + 364\r\n    frame #40: 0x000000010e5907e3 Python`PyObject_Call + 99\r\n    frame #41: 0x000000010e634602 Python`PyEval_EvalFrameEx + 32066\r\n    frame #42: 0x000000010e62c5b2 Python`PyEval_EvalCodeEx + 1538\r\n    frame #43: 0x000000010e5b6b9c Python`function_call + 364\r\n    frame #44: 0x000000010e5907e3 Python`PyObject_Call + 99\r\n    frame #45: 0x000000010e59db96 Python`instancemethod_call + 182\r\n    frame #46: 0x000000010e5907e3 Python`PyObject_Call + 99\r\n    frame #47: 0x000000010e5ec325 Python`slot_tp_call + 133\r\n    frame #48: 0x000000010e5907e3 Python`PyObject_Call + 99\r\n    frame #49: 0x000000010e633b90 Python`PyEval_EvalFrameEx + 29392\r\n    frame #50: 0x000000010e62c5b2 Python`PyEval_EvalCodeEx + 1538\r\n    frame #51: 0x000000010e638de5 Python`fast_function + 117\r\n    frame #52: 0x000000010e633ab4 Python`PyEval_EvalFrameEx + 29172\r\n    frame #53: 0x000000010e638e82 Python`fast_function + 274\r\n    frame #54: 0x000000010e633ab4 Python`PyEval_EvalFrameEx + 29172\r\n    frame #55: 0x000000010e638e82 Python`fast_function + 274\r\n    frame #56: 0x000000010e633ab4 Python`PyEval_EvalFrameEx + 29172\r\n    frame #57: 0x000000010e62c5b2 Python`PyEval_EvalCodeEx + 1538\r\n    frame #58: 0x000000010e638de5 Python`fast_function + 117\r\n    frame #59: 0x000000010e633ab4 Python`PyEval_EvalFrameEx + 29172\r\n    frame #60: 0x000000010e638e82 Python`fast_function + 274\r\n    frame #61: 0x000000010e633ab4 Python`PyEval_EvalFrameEx + 29172\r\n    frame #62: 0x000000010e62c5b2 Python`PyEval_EvalCodeEx + 1538\r\n    frame #63: 0x000000010e62bfa6 Python`PyEval_EvalCode + 54\r\n    frame #64: 0x000000010e65ae24 Python`PyRun_FileExFlags + 164\r\n    frame #65: 0x000000010e65a9a1 Python`PyRun_SimpleFileExFlags + 769\r\n    frame #66: 0x000000010e6705e8 Python`Py_Main + 3096\r\n    frame #67: 0x00007fff65a1f015 libdyld.dylib`start + 1\r\n  thread #2, stop reason = signal SIGSTOP\r\n    frame #0: 0x00007fff65b6fa16 libsystem_kernel.dylib`__psynch_cvwait + 10\r\n    frame #1: 0x00007fff65d38589 libsystem_pthread.dylib`_pthread_cond_wait + 732\r\n    frame #2: 0x000000010f590cc8 cygrpc.so`gpr_cv_wait + 120\r\n    frame #3: 0x000000010f5b711b cygrpc.so`timer_thread(void*) + 763\r\n    frame #4: 0x000000010f59233d cygrpc.so`grpc_core::(anonymous namespace)::ThreadInternalsPosix::ThreadInternalsPosix(char const*, void (*)(void*), void*, bool*)::'lambda'(void*)::__invoke(void*) + 125\r\n    frame #5: 0x00007fff65d37661 libsystem_pthread.dylib`_pthread_body + 340\r\n    frame #6: 0x00007fff65d3750d libsystem_pthread.dylib`_pthread_start + 377\r\n    frame #7: 0x00007fff65d36bf9 libsystem_pthread.dylib`thread_start + 13\r\n  thread #3, stop reason = signal SIGSTOP\r\n    frame #0: 0x00007fff65b6fa16 libsystem_kernel.dylib`__psynch_cvwait + 10\r\n    frame #1: 0x00007fff65d38589 libsystem_pthread.dylib`_pthread_cond_wait + 732\r\n    frame #2: 0x000000010e66d37b Python`PyThread_acquire_lock + 139\r\n    frame #3: 0x000000010e672387 Python`lock_PyThread_acquire_lock + 71\r\n    frame #4: 0x000000010e633ebe Python`PyEval_EvalFrameEx + 30206\r\n    frame #5: 0x000000010e62c5b2 Python`PyEval_EvalCodeEx + 1538\r\n    frame #6: 0x000000010e638de5 Python`fast_function + 117\r\n    frame #7: 0x000000010e633ab4 Python`PyEval_EvalFrameEx + 29172\r\n    frame #8: 0x000000010e62c5b2 Python`PyEval_EvalCodeEx + 1538\r\n    frame #9: 0x000000010e638de5 Python`fast_function + 117\r\n    frame #10: 0x000000010e633ab4 Python`PyEval_EvalFrameEx + 29172\r\n    frame #11: 0x000000010e638e82 Python`fast_function + 274\r\n    frame #12: 0x000000010e633ab4 Python`PyEval_EvalFrameEx + 29172\r\n    frame #13: 0x000000010e62c5b2 Python`PyEval_EvalCodeEx + 1538\r\n    frame #14: 0x000000010e5b6b9c Python`function_call + 364\r\n    frame #15: 0x000000010e5907e3 Python`PyObject_Call + 99\r\n    frame #16: 0x000000010e634602 Python`PyEval_EvalFrameEx + 32066\r\n    frame #17: 0x000000010e638e82 Python`fast_function + 274\r\n    frame #18: 0x000000010e633ab4 Python`PyEval_EvalFrameEx + 29172\r\n    frame #19: 0x000000010e638e82 Python`fast_function + 274\r\n    frame #20: 0x000000010e633ab4 Python`PyEval_EvalFrameEx + 29172\r\n    frame #21: 0x000000010e62c5b2 Python`PyEval_EvalCodeEx + 1538\r\n    frame #22: 0x000000010e5b6b9c Python`function_call + 364\r\n    frame #23: 0x000000010e5907e3 Python`PyObject_Call + 99\r\n    frame #24: 0x000000010e59db96 Python`instancemethod_call + 182\r\n    frame #25: 0x000000010e5907e3 Python`PyObject_Call + 99\r\n    frame #26: 0x000000010e63855d Python`PyEval_CallObjectWithKeywords + 93\r\n    frame #27: 0x000000010e672826 Python`t_bootstrap + 70\r\n    frame #28: 0x00007fff65d37661 libsystem_pthread.dylib`_pthread_body + 340\r\n    frame #29: 0x00007fff65d3750d libsystem_pthread.dylib`_pthread_start + 377\r\n    frame #30: 0x00007fff65d36bf9 libsystem_pthread.dylib`thread_start + 13\r\n```"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/476429917",
    "html_url": "https://github.com/grpc/grpc/issues/18422#issuecomment-476429917",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18422",
    "id": 476429917,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjQyOTkxNw==",
    "user": {
      "login": "lidizheng",
      "id": 7394928,
      "node_id": "MDQ6VXNlcjczOTQ5Mjg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7394928?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lidizheng",
      "html_url": "https://github.com/lidizheng",
      "followers_url": "https://api.github.com/users/lidizheng/followers",
      "following_url": "https://api.github.com/users/lidizheng/following{/other_user}",
      "gists_url": "https://api.github.com/users/lidizheng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lidizheng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lidizheng/subscriptions",
      "organizations_url": "https://api.github.com/users/lidizheng/orgs",
      "repos_url": "https://api.github.com/users/lidizheng/repos",
      "events_url": "https://api.github.com/users/lidizheng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lidizheng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-26T00:40:51Z",
    "updated_at": "2019-03-26T00:40:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "First bad commit from https://github.com/grpc/grpc/pull/17723"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/476449165",
    "html_url": "https://github.com/grpc/grpc/issues/18422#issuecomment-476449165",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18422",
    "id": 476449165,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjQ0OTE2NQ==",
    "user": {
      "login": "lidizheng",
      "id": 7394928,
      "node_id": "MDQ6VXNlcjczOTQ5Mjg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7394928?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lidizheng",
      "html_url": "https://github.com/lidizheng",
      "followers_url": "https://api.github.com/users/lidizheng/followers",
      "following_url": "https://api.github.com/users/lidizheng/following{/other_user}",
      "gists_url": "https://api.github.com/users/lidizheng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lidizheng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lidizheng/subscriptions",
      "organizations_url": "https://api.github.com/users/lidizheng/orgs",
      "repos_url": "https://api.github.com/users/lidizheng/repos",
      "events_url": "https://api.github.com/users/lidizheng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lidizheng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-26T02:25:22Z",
    "updated_at": "2019-03-26T02:25:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "With the help from @apolcyn, we are able to identify the root cause. The C-Ares driver in C-Core depends on `g_event_engine` which will only be initialized if no custom IO manager is provided.\r\n\r\nAlso, our unit test failed to catch this error because all of our unit tests are testing against `localhost`, which means the DNS resolution will end with merely checking `/etc/hosts` instead of firing actual queries to other DNS servers.\r\n\r\nThese behaviors are tested in our interop tests. But our Python tests cases currently is not turned on `gevent` support.\r\n\r\nA single file reproduction snippet:\r\n\r\n```Python\r\nimport requests\r\nimport gevent\r\nfrom grpc.experimental.gevent import init_gevent\r\nfrom flask import Flask, request\r\n\r\nfrom opencensus.stats import aggregation, measure, stats, view\r\nfrom opencensus.stats.exporters import stackdriver_exporter\r\nfrom opencensus.tags import TagMap\r\n\r\ninit_gevent()\r\n\r\ndef project_id():\r\n  return 'foo'\r\n\r\napp = Flask(__name__)\r\n\r\nPARAM_TAG = 'param'\r\n\r\nm_requests = measure.MeasureInt(\"app/requests\", \"Number of requests\", \"1\")\r\nrequests_view = view.View(\"opencensus-example/app/requests\",\r\n                          \"The sum of requests\",\r\n                          [PARAM_TAG], m_requests, aggregation.SumAggregation())\r\n\r\nop_stats = stats.Stats()\r\nexporter = stackdriver_exporter.new_stats_exporter(stackdriver_exporter.Options(\r\n  project_id=project_id()))\r\nop_stats.view_manager.register_exporter(exporter)\r\nop_stats.view_manager.register_view(requests_view)\r\n\r\n\r\n@app.route('/')\r\ndef hello_world():\r\n  mmap = op_stats.stats_recorder.new_measurement_map()\r\n  mmap.measure_int_put(m_requests, 1)\r\n  tmap = TagMap()\r\n  param = request.args.get('param')\r\n  if param:\r\n    tmap.insert(PARAM_TAG, param)\r\n  mmap.record(tmap)\r\n\r\n  return 'Hello, World!'\r\n```\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/476732487",
    "html_url": "https://github.com/grpc/grpc/issues/18422#issuecomment-476732487",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18422",
    "id": 476732487,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjczMjQ4Nw==",
    "user": {
      "login": "lidizheng",
      "id": 7394928,
      "node_id": "MDQ6VXNlcjczOTQ5Mjg=",
      "avatar_url": "https://avatars3.githubusercontent.com/u/7394928?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lidizheng",
      "html_url": "https://github.com/lidizheng",
      "followers_url": "https://api.github.com/users/lidizheng/followers",
      "following_url": "https://api.github.com/users/lidizheng/following{/other_user}",
      "gists_url": "https://api.github.com/users/lidizheng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lidizheng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lidizheng/subscriptions",
      "organizations_url": "https://api.github.com/users/lidizheng/orgs",
      "repos_url": "https://api.github.com/users/lidizheng/repos",
      "events_url": "https://api.github.com/users/lidizheng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lidizheng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-26T16:29:43Z",
    "updated_at": "2019-03-26T16:29:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "@colincadams @willkg There is one quick workaround for this issue that setting the [environment variable](https://github.com/grpc/grpc/blob/master/doc/environment_variables.md) `GRPC_DNS_RESOLVER` to `native` will make the segfault go away. "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/476737490",
    "html_url": "https://github.com/grpc/grpc/issues/18422#issuecomment-476737490",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/18422",
    "id": 476737490,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjczNzQ5MA==",
    "user": {
      "login": "willkg",
      "id": 820826,
      "node_id": "MDQ6VXNlcjgyMDgyNg==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/820826?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/willkg",
      "html_url": "https://github.com/willkg",
      "followers_url": "https://api.github.com/users/willkg/followers",
      "following_url": "https://api.github.com/users/willkg/following{/other_user}",
      "gists_url": "https://api.github.com/users/willkg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/willkg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/willkg/subscriptions",
      "organizations_url": "https://api.github.com/users/willkg/orgs",
      "repos_url": "https://api.github.com/users/willkg/repos",
      "events_url": "https://api.github.com/users/willkg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/willkg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-26T16:40:19Z",
    "updated_at": "2019-03-26T16:40:19Z",
    "author_association": "NONE",
    "body": "@lidizheng That's helpful to know! Thank you!"
  }
]
