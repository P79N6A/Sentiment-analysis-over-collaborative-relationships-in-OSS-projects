[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/293084538",
    "html_url": "https://github.com/grpc/grpc/issues/10553#issuecomment-293084538",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10553",
    "id": 293084538,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MzA4NDUzOA==",
    "user": {
      "login": "matt-kwong",
      "id": 22083734,
      "node_id": "MDQ6VXNlcjIyMDgzNzM0",
      "avatar_url": "https://avatars1.githubusercontent.com/u/22083734?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matt-kwong",
      "html_url": "https://github.com/matt-kwong",
      "followers_url": "https://api.github.com/users/matt-kwong/followers",
      "following_url": "https://api.github.com/users/matt-kwong/following{/other_user}",
      "gists_url": "https://api.github.com/users/matt-kwong/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matt-kwong/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matt-kwong/subscriptions",
      "organizations_url": "https://api.github.com/users/matt-kwong/orgs",
      "repos_url": "https://api.github.com/users/matt-kwong/repos",
      "events_url": "https://api.github.com/users/matt-kwong/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matt-kwong/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-04-10T21:28:51Z",
    "updated_at": "2017-04-10T21:28:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "An interaction I don't quite understand:\r\n\r\nIf I try to pin Bazel to 0.4.4 via this\r\n```\r\n#========================\r\n# Bazel installation\r\nRUN apt-get install -y software-properties-common g++\r\nRUN echo \"deb [arch=amd64] http://storage.googleapis.com/bazel-apt stable jdk1.8\" > /etc/apt/sources.list.d/bazel.list\r\nRUN apt-get -y update\r\nRUN apt-get -y install openjdk-8-jdk\r\n\r\n# Pin Bazel to 0.4.4\r\nRUN curl -fSsL -O https://github.com/bazelbuild/bazel/releases/download/0.4.4/bazel-0.4.4-installer-linux-x86_64.sh\r\nRUN chmod +x ./bazel-0.4.4-installer-linux-x86_64.sh\r\nRUN ./bazel-0.4.4-installer-linux-x86_64.sh\r\n```\r\nI get the following error when trying to run `tools/jenkins/run_bazel_basic.sh`:\r\n```\r\n____[18,349 / 19,429] Compiling src/core/ext/census/base_resources.c\r\n____[18,351 / 19,429] Compiling src/core/ext/census/placeholders.c\r\n____[18,416 / 19,429] Compiling src/core/ext/filters/client_channel/subchannel_index.c\r\n____[18,428 / 19,429] Compiling src/core/lib/support/tmpfile_posix.c\r\nERROR: /var/local/git/grpc/BUILD:431:1: C++ compilation of rule '//:grpc_base' failed: gcc failed: error executing command /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -B/usr/bin -B/usr/bin -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -MD -MF ... (remaining 34 argument(s) skipped): com.google.devtools.build.lib.shell.BadExitStatusException: Process exited with status 1.\r\nsrc/core/lib/compression/message_compress.c:41:18: fatal error: zlib.h: No such file or directory\r\ncompilation terminated.\r\n____Building complete.\r\n____Elapsed time: 79.257s, Critical Path: 39.61s\r\n+ FAILED=true\r\n+ '[' '' '!=' '' ']'\r\n+ docker rm -f build_and_run_docker_d0cf6914-4d7d-4588-8a9e-fa693d931a05\r\nbuild_and_run_docker_d0cf6914-4d7d-4588-8a9e-fa693d931a05\r\n+ '[' true '!=' '' ']'\r\n+ exit 1\r\n```\r\nbut...\r\n```\r\n#========================\r\n# Bazel installation\r\nRUN apt-get install -y software-properties-common g++\r\nRUN echo \"deb [arch=amd64] http://storage.googleapis.com/bazel-apt stable jdk1.8\" > /etc/apt/sources.list.d/bazel.list\r\nRUN curl https://bazel.build/bazel-release.pub.gpg | apt-key add -\r\nRUN apt-get -y update\r\nRUN apt-get -y install bazel\r\n\r\n# Pin Bazel to 0.4.4\r\n# Installing Bazel via apt-get first is required before installing 0.4.4 to\r\n# allow gRPC to build without errors. See https://github.com/grpc/grpc/issues/10553\r\nRUN curl -fSsL -O https://github.com/bazelbuild/bazel/releases/download/0.4.4/bazel-0.4.4-installer-linux-x86_64.sh\r\nRUN chmod +x ./bazel-0.4.4-installer-linux-x86_64.sh\r\nRUN ./bazel-0.4.4-installer-linux-x86_64.sh\r\n```\r\nTrying to install Bazel to 0.4.4 after installing Bazel via apt-get allows me to run `tools/jenkins/run_bazel_basic.sh` without any issues."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/293091825",
    "html_url": "https://github.com/grpc/grpc/issues/10553#issuecomment-293091825",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/10553",
    "id": 293091825,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MzA5MTgyNQ==",
    "user": {
      "login": "nicolasnoble",
      "id": 7281574,
      "node_id": "MDQ6VXNlcjcyODE1NzQ=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/7281574?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nicolasnoble",
      "html_url": "https://github.com/nicolasnoble",
      "followers_url": "https://api.github.com/users/nicolasnoble/followers",
      "following_url": "https://api.github.com/users/nicolasnoble/following{/other_user}",
      "gists_url": "https://api.github.com/users/nicolasnoble/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nicolasnoble/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nicolasnoble/subscriptions",
      "organizations_url": "https://api.github.com/users/nicolasnoble/orgs",
      "repos_url": "https://api.github.com/users/nicolasnoble/repos",
      "events_url": "https://api.github.com/users/nicolasnoble/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nicolasnoble/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-04-10T22:00:57Z",
    "updated_at": "2017-04-10T22:02:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "` ¯\\_(ツ)_/¯`\r\n\r\nSo you should be able to pin to a certain version using apt-get. See something along the lines of `apt-get install bazel=0.4.4`. That should allow you to avoid the second part."
  }
]
