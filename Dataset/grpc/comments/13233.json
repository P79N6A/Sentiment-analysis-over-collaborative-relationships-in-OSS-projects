[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/343581721",
    "html_url": "https://github.com/grpc/grpc/pull/13233#issuecomment-343581721",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13233",
    "id": 343581721,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzU4MTcyMQ==",
    "user": {
      "login": "kpayson64",
      "id": 18316330,
      "node_id": "MDQ6VXNlcjE4MzE2MzMw",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18316330?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kpayson64",
      "html_url": "https://github.com/kpayson64",
      "followers_url": "https://api.github.com/users/kpayson64/followers",
      "following_url": "https://api.github.com/users/kpayson64/following{/other_user}",
      "gists_url": "https://api.github.com/users/kpayson64/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kpayson64/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kpayson64/subscriptions",
      "organizations_url": "https://api.github.com/users/kpayson64/orgs",
      "repos_url": "https://api.github.com/users/kpayson64/repos",
      "events_url": "https://api.github.com/users/kpayson64/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kpayson64/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-10T20:47:45Z",
    "updated_at": "2017-11-10T20:47:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think I understand the issue a little better now thanks!\r\n\r\nIt looks like the workaround is to pull out grpcio-tools from the dependencies because the protos get compiled as part of our distribution process anyway.\r\n\r\nIt feels like doing \r\n```\r\ntry:\r\n  import health_commands\r\n```\r\nis a roundabout way of detecting if we are in the artifact build.  Can we just add an environment variable instead?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/343588886",
    "html_url": "https://github.com/grpc/grpc/pull/13233#issuecomment-343588886",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13233",
    "id": 343588886,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzU4ODg4Ng==",
    "user": {
      "login": "mehrdada",
      "id": 900411,
      "node_id": "MDQ6VXNlcjkwMDQxMQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/900411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mehrdada",
      "html_url": "https://github.com/mehrdada",
      "followers_url": "https://api.github.com/users/mehrdada/followers",
      "following_url": "https://api.github.com/users/mehrdada/following{/other_user}",
      "gists_url": "https://api.github.com/users/mehrdada/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mehrdada/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mehrdada/subscriptions",
      "organizations_url": "https://api.github.com/users/mehrdada/orgs",
      "repos_url": "https://api.github.com/users/mehrdada/repos",
      "events_url": "https://api.github.com/users/mehrdada/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mehrdada/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-10T21:16:55Z",
    "updated_at": "2017-11-10T21:17:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "@kpayson64 Yes, that is essentially what we do. We could make it an environment variable, but *unless there is an **existing** environment variable we can rely on*, my sense is it just \"spreads the disease\" giving us the illusion that we actually cleaned this hack up (but we simply moved it elsewhere), and then we will have to ensure we propagate the environment correctly, making it more fragile. The import check is a pretty direct way to verify the ground truth directly, instead of relying on an external party to let us know what state we are in (and potentially lie about it)."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/344017509",
    "html_url": "https://github.com/grpc/grpc/pull/13233#issuecomment-344017509",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13233",
    "id": 344017509,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NDAxNzUwOQ==",
    "user": {
      "login": "kpayson64",
      "id": 18316330,
      "node_id": "MDQ6VXNlcjE4MzE2MzMw",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18316330?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kpayson64",
      "html_url": "https://github.com/kpayson64",
      "followers_url": "https://api.github.com/users/kpayson64/followers",
      "following_url": "https://api.github.com/users/kpayson64/following{/other_user}",
      "gists_url": "https://api.github.com/users/kpayson64/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kpayson64/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kpayson64/subscriptions",
      "organizations_url": "https://api.github.com/users/kpayson64/orgs",
      "repos_url": "https://api.github.com/users/kpayson64/repos",
      "events_url": "https://api.github.com/users/kpayson64/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kpayson64/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-13T18:45:50Z",
    "updated_at": "2017-11-13T18:45:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "@mehrdada I would argue that this PR introduces a new mechanism anyways, you are now excluding a file from our distribution as a means of detecting if we are in the github repo or in a packaged distribution.  I'd much rather use a different detection mechanism that isn't so roundabout."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/344022700",
    "html_url": "https://github.com/grpc/grpc/pull/13233#issuecomment-344022700",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13233",
    "id": 344022700,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NDAyMjcwMA==",
    "user": {
      "login": "mehrdada",
      "id": 900411,
      "node_id": "MDQ6VXNlcjkwMDQxMQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/900411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mehrdada",
      "html_url": "https://github.com/mehrdada",
      "followers_url": "https://api.github.com/users/mehrdada/followers",
      "following_url": "https://api.github.com/users/mehrdada/following{/other_user}",
      "gists_url": "https://api.github.com/users/mehrdada/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mehrdada/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mehrdada/subscriptions",
      "organizations_url": "https://api.github.com/users/mehrdada/orgs",
      "repos_url": "https://api.github.com/users/mehrdada/repos",
      "events_url": "https://api.github.com/users/mehrdada/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mehrdada/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-13T19:03:20Z",
    "updated_at": "2017-11-13T19:03:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "@kpayson64 The `*_commands` files that are excluded from the distribution should be excluded either way though, as \"building\" the distributed package is unnecessary and can potentially cause behavior drifts based on the `grpcio-tools` version installed at the time of build. It's much better to just ship `pb2`s (which we always did) and don't (potentially) overwrite them on build. Whether or not using a flag is a good idea, I am just slightly against based on the rationale above, but could be convinced otherwise. I'm interested in hearing what @nathanielmanistaatgoogle thinks about either of the two approaches. (If we end up deciding on a flag, we should also specify where it should be set too.)"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/344026634",
    "html_url": "https://github.com/grpc/grpc/pull/13233#issuecomment-344026634",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13233",
    "id": 344026634,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NDAyNjYzNA==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-13T19:16:41Z",
    "updated_at": "2017-11-13T19:16:41Z",
    "author_association": "MEMBER",
    "body": "6f424b71b35fc1322fc7aa is a great change; pull it out of here and into its own pull request.\r\n\r\nWhen you say \"nor would they contain the Python module that does the preprocessing code generation from the respective .proto files\", which module is \"the Python module that does the preprocessing code generation\"? (This may be as simple as changing the prose to read `the \"_commands\" Python module`.)\r\n\r\nI think I also agree with @kpayson64 about the trigger mechanism here. Is this code drafted in the shape it's in because you wanted to make a minimal change (usually a good thing when fixing a bug)? Could a better change be made by making a deeper cut? Something that strikes me as a decent idea: should \"build the `_pb2.py` file\" be a judgement made based on the _absence_ of the desired `_pb2.py` file, rather than the _presence_ of the `<something>_commands` module?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/344029490",
    "html_url": "https://github.com/grpc/grpc/pull/13233#issuecomment-344029490",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13233",
    "id": 344029490,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NDAyOTQ5MA==",
    "user": {
      "login": "mehrdada",
      "id": 900411,
      "node_id": "MDQ6VXNlcjkwMDQxMQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/900411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mehrdada",
      "html_url": "https://github.com/mehrdada",
      "followers_url": "https://api.github.com/users/mehrdada/followers",
      "following_url": "https://api.github.com/users/mehrdada/following{/other_user}",
      "gists_url": "https://api.github.com/users/mehrdada/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mehrdada/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mehrdada/subscriptions",
      "organizations_url": "https://api.github.com/users/mehrdada/orgs",
      "repos_url": "https://api.github.com/users/mehrdada/repos",
      "events_url": "https://api.github.com/users/mehrdada/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mehrdada/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-13T19:26:10Z",
    "updated_at": "2017-11-13T19:28:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Is this code drafted in the shape it's in because you wanted to make a minimal change (usually a good thing when fixing a bug)? \r\n\r\nThis is intentionally drafted to be minimal not just to fix a bug, but to not increase the complexity of the general build system due to a feature local to a certain package (i.e. decrease coupling), since the prior assumption seems to have been \"let each package build itself\". Otherwise, I question the existence of the `*_commands.py` files within the packages. I think if we are changing the outer build system to fix this problem in a more fundamental way, we should not see it as introducing a trigger mechanism: rather, we should have a pass in the build system to preprocess the `.proto` files, and then completely eliminate the `*_commands.py` file from the packages."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/344036372",
    "html_url": "https://github.com/grpc/grpc/pull/13233#issuecomment-344036372",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13233",
    "id": 344036372,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NDAzNjM3Mg==",
    "user": {
      "login": "nathanielmanistaatgoogle",
      "id": 10131044,
      "node_id": "MDQ6VXNlcjEwMTMxMDQ0",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10131044?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nathanielmanistaatgoogle",
      "html_url": "https://github.com/nathanielmanistaatgoogle",
      "followers_url": "https://api.github.com/users/nathanielmanistaatgoogle/followers",
      "following_url": "https://api.github.com/users/nathanielmanistaatgoogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/nathanielmanistaatgoogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nathanielmanistaatgoogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nathanielmanistaatgoogle/subscriptions",
      "organizations_url": "https://api.github.com/users/nathanielmanistaatgoogle/orgs",
      "repos_url": "https://api.github.com/users/nathanielmanistaatgoogle/repos",
      "events_url": "https://api.github.com/users/nathanielmanistaatgoogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nathanielmanistaatgoogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-13T19:48:46Z",
    "updated_at": "2017-11-13T19:48:46Z",
    "author_association": "MEMBER",
    "body": "Changing the outer build system is an option that is on the table; either in this pull request or another. Is it the right thing to do?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/344036854",
    "html_url": "https://github.com/grpc/grpc/pull/13233#issuecomment-344036854",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13233",
    "id": 344036854,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NDAzNjg1NA==",
    "user": {
      "login": "kpayson64",
      "id": 18316330,
      "node_id": "MDQ6VXNlcjE4MzE2MzMw",
      "avatar_url": "https://avatars2.githubusercontent.com/u/18316330?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kpayson64",
      "html_url": "https://github.com/kpayson64",
      "followers_url": "https://api.github.com/users/kpayson64/followers",
      "following_url": "https://api.github.com/users/kpayson64/following{/other_user}",
      "gists_url": "https://api.github.com/users/kpayson64/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kpayson64/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kpayson64/subscriptions",
      "organizations_url": "https://api.github.com/users/kpayson64/orgs",
      "repos_url": "https://api.github.com/users/kpayson64/repos",
      "events_url": "https://api.github.com/users/kpayson64/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kpayson64/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-13T19:50:33Z",
    "updated_at": "2017-11-13T19:50:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "I agree with both comments, the outer build system could use a refactor, but if we want some determinant that exists today, checking for the existence of ```pb2_grpc.py``` modules is preferable.\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/344080302",
    "html_url": "https://github.com/grpc/grpc/pull/13233#issuecomment-344080302",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13233",
    "id": 344080302,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NDA4MDMwMg==",
    "user": {
      "login": "mehrdada",
      "id": 900411,
      "node_id": "MDQ6VXNlcjkwMDQxMQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/900411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mehrdada",
      "html_url": "https://github.com/mehrdada",
      "followers_url": "https://api.github.com/users/mehrdada/followers",
      "following_url": "https://api.github.com/users/mehrdada/following{/other_user}",
      "gists_url": "https://api.github.com/users/mehrdada/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mehrdada/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mehrdada/subscriptions",
      "organizations_url": "https://api.github.com/users/mehrdada/orgs",
      "repos_url": "https://api.github.com/users/mehrdada/repos",
      "events_url": "https://api.github.com/users/mehrdada/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mehrdada/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-13T22:27:27Z",
    "updated_at": "2017-11-13T22:27:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "PTAL"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/344813878",
    "html_url": "https://github.com/grpc/grpc/pull/13233#issuecomment-344813878",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13233",
    "id": 344813878,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NDgxMzg3OA==",
    "user": {
      "login": "mehrdada",
      "id": 900411,
      "node_id": "MDQ6VXNlcjkwMDQxMQ==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/900411?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mehrdada",
      "html_url": "https://github.com/mehrdada",
      "followers_url": "https://api.github.com/users/mehrdada/followers",
      "following_url": "https://api.github.com/users/mehrdada/following{/other_user}",
      "gists_url": "https://api.github.com/users/mehrdada/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mehrdada/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mehrdada/subscriptions",
      "organizations_url": "https://api.github.com/users/mehrdada/orgs",
      "repos_url": "https://api.github.com/users/mehrdada/repos",
      "events_url": "https://api.github.com/users/mehrdada/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mehrdada/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-16T04:40:20Z",
    "updated_at": "2017-11-16T04:40:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "KI: Node interop failures"
  }
]
