[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/339643421",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-339643421",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 339643421,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzOTY0MzQyMQ==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-26T12:01:37Z",
    "updated_at": "2017-10-26T12:01:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "~10 tests failing 100% of time -> escalating to P0."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/339643506",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-339643506",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 339643506,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzOTY0MzUwNg==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-26T12:01:58Z",
    "updated_at": "2017-10-26T12:01:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "@dgquintas, who's the right person to fix?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/340491454",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-340491454",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 340491454,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MDQ5MTQ1NA==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-30T15:59:00Z",
    "updated_at": "2017-10-30T15:59:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "Any updates here? It's failing in 100% runs."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/340578546",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-340578546",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 340578546,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MDU3ODU0Ng==",
    "user": {
      "login": "dgquintas",
      "id": 120217,
      "node_id": "MDQ6VXNlcjEyMDIxNw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/120217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dgquintas",
      "html_url": "https://github.com/dgquintas",
      "followers_url": "https://api.github.com/users/dgquintas/followers",
      "following_url": "https://api.github.com/users/dgquintas/following{/other_user}",
      "gists_url": "https://api.github.com/users/dgquintas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dgquintas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dgquintas/subscriptions",
      "organizations_url": "https://api.github.com/users/dgquintas/orgs",
      "repos_url": "https://api.github.com/users/dgquintas/repos",
      "events_url": "https://api.github.com/users/dgquintas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dgquintas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-30T20:44:40Z",
    "updated_at": "2017-10-30T20:44:40Z",
    "author_association": "NONE",
    "body": "I talked to @nicolasnoble about this last week. We are lacking Windows expertise for fixing this. We talked about ways to improve this, but nothing short term enough to deal with the failing tests. \r\n\r\nOn the other hand, I don't think this is a Windows-specific issue. @yashykt and @sreecha have agreed to look into it."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/340580774",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-340580774",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 340580774,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MDU4MDc3NA==",
    "user": {
      "login": "sreecha",
      "id": 2754995,
      "node_id": "MDQ6VXNlcjI3NTQ5OTU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/2754995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sreecha",
      "html_url": "https://github.com/sreecha",
      "followers_url": "https://api.github.com/users/sreecha/followers",
      "following_url": "https://api.github.com/users/sreecha/following{/other_user}",
      "gists_url": "https://api.github.com/users/sreecha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sreecha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sreecha/subscriptions",
      "organizations_url": "https://api.github.com/users/sreecha/orgs",
      "repos_url": "https://api.github.com/users/sreecha/repos",
      "events_url": "https://api.github.com/users/sreecha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sreecha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-30T20:52:51Z",
    "updated_at": "2017-10-30T20:52:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "I won't be able to look into this in the next 2 days (since I already have a p0 on my plate). "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/340583613",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-340583613",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 340583613,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MDU4MzYxMw==",
    "user": {
      "login": "yashykt",
      "id": 4181124,
      "node_id": "MDQ6VXNlcjQxODExMjQ=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/4181124?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yashykt",
      "html_url": "https://github.com/yashykt",
      "followers_url": "https://api.github.com/users/yashykt/followers",
      "following_url": "https://api.github.com/users/yashykt/following{/other_user}",
      "gists_url": "https://api.github.com/users/yashykt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yashykt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yashykt/subscriptions",
      "organizations_url": "https://api.github.com/users/yashykt/orgs",
      "repos_url": "https://api.github.com/users/yashykt/repos",
      "events_url": "https://api.github.com/users/yashykt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yashykt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-30T21:02:59Z",
    "updated_at": "2017-10-30T21:02:59Z",
    "author_association": "MEMBER",
    "body": "I'll take this on."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/340963242",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-340963242",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 340963242,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MDk2MzI0Mg==",
    "user": {
      "login": "yashykt",
      "id": 4181124,
      "node_id": "MDQ6VXNlcjQxODExMjQ=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/4181124?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yashykt",
      "html_url": "https://github.com/yashykt",
      "followers_url": "https://api.github.com/users/yashykt/followers",
      "following_url": "https://api.github.com/users/yashykt/following{/other_user}",
      "gists_url": "https://api.github.com/users/yashykt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yashykt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yashykt/subscriptions",
      "organizations_url": "https://api.github.com/users/yashykt/orgs",
      "repos_url": "https://api.github.com/users/yashykt/repos",
      "events_url": "https://api.github.com/users/yashykt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yashykt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-01T02:48:24Z",
    "updated_at": "2017-11-01T02:48:24Z",
    "author_association": "MEMBER",
    "body": "The history from commits show that these tests have been failing for other fixtures too like h2_ssl_proxy_test and h2_http_proxy_nosec_test.\r\n\r\nI tried running these locally on a Windows VM and these pass, which makes me think that the timeout for these tests is too low for Windows."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341076264",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-341076264",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 341076264,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTA3NjI2NA==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-01T11:01:29Z",
    "updated_at": "2017-11-01T11:01:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "I did some extra analysis on the test result data:\r\n\r\nTests that are *timing out* (the timeout is 5mins, which should really be high enough), both for Release and Debug:\r\n```\r\nh2_ssl_proxy_test.exe high_initial_seqno\r\nh2_proxy_test.exe high_initial_seqno\r\n```\r\n\r\nTests that are *failing* (after ~15secs), both Release and Debug:\r\n```\r\n*_proxy_test.exe max_connection_age\r\n*_proxy_test.exe graceful_server_shutdown\r\n```\r\n\r\nUseful bigquery that shows all the recent failures and timeouts:\r\n```\r\nselect * from jenkins_test_results.aggregate_results where test_name like '%proxy_test%' and job_name like '%windows%basictests%' and timestamp > '2017-10-25 00:00' and result != 'PASSED' order by timestamp desc limit 10000 \r\n```"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341129636",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-341129636",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 341129636,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTEyOTYzNg==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-01T14:53:32Z",
    "updated_at": "2017-11-01T14:53:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "I am able to reproduce locally. From tracing logs, it looks like that the `cq_verify_empty` here: https://github.com/grpc/grpc/blob/49e2ce3b78b21909b625c61d088d0c94b04a75fc/test/core/end2end/tests/graceful_server_shutdown.c#L150 doesn't return after 1 second as it should, but instead waits for the whole 10s until the client call times out (it has timeout of 10s) - at which point the unexpected tag of \"0x1\" is delivered.\r\n\r\n```\r\n$  GRPC_VERBOSITY=debug GRPC_TRACE=api Debug/h2_http_proxy_test.exe graceful_server_shutdown\r\n...\r\nI1101 14:46:27.785000000  5588 server.cc:1260] grpc_server_shutdown_and_notify(server=0088A118, cq=0088AE20, tag=0000DEAD)\r\nI1101 14:46:27.785000000  5588 graceful_server_shutdown.c:156] gpr_now(GPR_CLOCK_REALTIME): tv_sec 1509547587 tv_nsec 785000000\r\nI1101 14:46:27.785000000  5588 graceful_server_shutdown.c:157] gpr_now(GPR_CLOCK_MONOTONIC): tv_sec 0 tv_nsec 733949400\r\nI1101 14:46:27.785000000  5588 completion_queue.cc:883] grpc_completion_queue_next(cq=0088AE20, deadline=gpr_timespec { tv_sec: 1509547588, tv_nsec: 785000000, clock_type: 1 }, reserved=00000000)\r\n^ this is the grpc_completion_queue_next called by cq_verify_empty. \r\n  It has timeout of 1 sec but doesn't wake up until 10 sec later.\r\nI1101 14:46:37.783000000  2164 completion_queue.cc:663] cq_end_op_for_next(exec_ctx=043AF950, cq=0088AE20, tag=00000001, error=\"No Error\", done=00D7DEE0, done_arg=0081125C, storage=00811260)\r\nI1101 14:46:37.783000000  5588 completion_queue.cc:984] RETURN_EVENT[0088AE20]: OP_COMPLETE: tag:00000001 OK\r\nE1101 14:46:37.783000000  5588 cq_verifier.c:298] unexpected event (expected nothing): OP_COMPLETE: tag:00000001 OK\r\nI1101 14:46:37.783000000  6120 completion_queue.cc:663] cq_end_op_for_next(exec_ctx=03FBFE1C, cq=0088AE20, tag=0000DEAD, error=\"No Error\", done=00D6ABF0, done_arg=0088A118, storage=00858820)\r\nAbort handler called.\r\n```\r\n\r\nSo it looks like we're missing a kick somewhere.Actually, in some runs, we get lucky, and cq_next wakes up sooner then in 10 seconds (I've seen instances with 9.03sec) and then the test passes.\r\n\r\n\r\n\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341234518",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-341234518",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 341234518,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTIzNDUxOA==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-01T20:37:12Z",
    "updated_at": "2017-11-01T20:37:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "My unproven theory:\r\nhttps://github.com/grpc/grpc/blob/master/src/core/lib/surface/completion_queue.cc#L949 is the place where cq_next should exit in case the deadline is hit and there's still no new event. But inside https://github.com/grpc/grpc/blob/master/src/core/lib/iomgr/exec_ctx.cc#L141,  `exec_ctx->now_is_valid` is `true` and  exec_ctx->now contains the timestamp when cq_next has started and it's not getting updated. So it looks like we are missing a call to `grpc_exec_ctx_invalidate_now` somewhere?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341254496",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-341254496",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 341254496,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTI1NDQ5Ng==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-01T21:53:05Z",
    "updated_at": "2017-11-01T21:53:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "I can confirm that an ugly hack of updating exec_ctx->now every time  grpc_exec_ctx_now() is inspected fixes at least a subset some of the issues we are seeing.\r\n@ctiller, any tips where we should add `grpc_exec_ctx_invalidate_now` for a proper fix?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341257114",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-341257114",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 341257114,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTI1NzExNA==",
    "user": {
      "login": "ctiller",
      "id": 10120821,
      "node_id": "MDQ6VXNlcjEwMTIwODIx",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10120821?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ctiller",
      "html_url": "https://github.com/ctiller",
      "followers_url": "https://api.github.com/users/ctiller/followers",
      "following_url": "https://api.github.com/users/ctiller/following{/other_user}",
      "gists_url": "https://api.github.com/users/ctiller/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ctiller/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ctiller/subscriptions",
      "organizations_url": "https://api.github.com/users/ctiller/orgs",
      "repos_url": "https://api.github.com/users/ctiller/repos",
      "events_url": "https://api.github.com/users/ctiller/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ctiller/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-01T22:04:21Z",
    "updated_at": "2017-11-01T22:04:21Z",
    "author_association": "MEMBER",
    "body": "Wherever we block for a significant amount of time.\n\nOne clever way of finding this: ctrl+c when the application is sleeping,\nand ensure that we've got an invalidate after that.\n\nOn Wed, Nov 1, 2017 at 2:53 PM Jan Tattermusch <notifications@github.com>\nwrote:\n\n> I can confirm that an ugly hack of updating exec_ctx->now every time\n> grpc_exec_ctx_now() is inspected fixes at least a subset some of the issues\n> we are seeing.\n> @ctiller <https://github.com/ctiller>, any tips where we should add\n> grpc_exec_ctx_invalidate_now for a proper fix?\n>\n> —\n> You are receiving this because you were mentioned.\n>\n>\n> Reply to this email directly, view it on GitHub\n> <https://github.com/grpc/grpc/issues/13079#issuecomment-341254496>, or mute\n> the thread\n> <https://github.com/notifications/unsubscribe-auth/AJpudUGPV8QmFCjNA9jkApPn8LJQhIHZks5syOhRgaJpZM4QALoX>\n> .\n>\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341286165",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-341286165",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 341286165,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTI4NjE2NQ==",
    "user": {
      "login": "yashykt",
      "id": 4181124,
      "node_id": "MDQ6VXNlcjQxODExMjQ=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/4181124?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yashykt",
      "html_url": "https://github.com/yashykt",
      "followers_url": "https://api.github.com/users/yashykt/followers",
      "following_url": "https://api.github.com/users/yashykt/following{/other_user}",
      "gists_url": "https://api.github.com/users/yashykt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yashykt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yashykt/subscriptions",
      "organizations_url": "https://api.github.com/users/yashykt/orgs",
      "repos_url": "https://api.github.com/users/yashykt/repos",
      "events_url": "https://api.github.com/users/yashykt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yashykt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-02T00:50:45Z",
    "updated_at": "2017-11-02T02:18:41Z",
    "author_association": "MEMBER",
    "body": "I was able to reproduce the problem with 8vcpus instead of 1. And this issue was seen with both 64 bit and 32 bit builds.\r\n\r\nIt seems that GPR_CLOCK_MONOTONIC time is being compared to GPR_CLOCK_REALTIME time. This might be the cause.\r\n\r\n@ctiller, are we following a standard as to when to use what?\r\n\r\nUPDATE:  Ignore that, it is handled in grpc_timespec_to_millis"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341286716",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-341286716",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 341286716,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTI4NjcxNg==",
    "user": {
      "login": "sreecha",
      "id": 2754995,
      "node_id": "MDQ6VXNlcjI3NTQ5OTU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/2754995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sreecha",
      "html_url": "https://github.com/sreecha",
      "followers_url": "https://api.github.com/users/sreecha/followers",
      "following_url": "https://api.github.com/users/sreecha/following{/other_user}",
      "gists_url": "https://api.github.com/users/sreecha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sreecha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sreecha/subscriptions",
      "organizations_url": "https://api.github.com/users/sreecha/orgs",
      "repos_url": "https://api.github.com/users/sreecha/repos",
      "events_url": "https://api.github.com/users/sreecha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sreecha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-02T00:54:39Z",
    "updated_at": "2017-11-02T00:54:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "We should not be doing this comparison without making both clocktypes the same.\r\nCan you point to the code that is doing this ? "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341293033",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-341293033",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 341293033,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTI5MzAzMw==",
    "user": {
      "login": "yashykt",
      "id": 4181124,
      "node_id": "MDQ6VXNlcjQxODExMjQ=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/4181124?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yashykt",
      "html_url": "https://github.com/yashykt",
      "followers_url": "https://api.github.com/users/yashykt/followers",
      "following_url": "https://api.github.com/users/yashykt/following{/other_user}",
      "gists_url": "https://api.github.com/users/yashykt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yashykt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yashykt/subscriptions",
      "organizations_url": "https://api.github.com/users/yashykt/orgs",
      "repos_url": "https://api.github.com/users/yashykt/repos",
      "events_url": "https://api.github.com/users/yashykt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yashykt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-02T01:40:07Z",
    "updated_at": "2017-11-02T02:18:44Z",
    "author_association": "MEMBER",
    "body": "https://github.com/grpc/grpc/blob/66b740a8c60df59d7c82c8f7e122369ee86d62c1/src/core/lib/surface/completion_queue.cc#L950 \r\nHere, for example, we are comparing deadline which might be in realtime to exec_ctx_now which is monotonic.\r\n\r\nUPDATE: Ignore that, it is handled in grpc_timespec_to_millis"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341294159",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-341294159",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 341294159,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTI5NDE1OQ==",
    "user": {
      "login": "yashykt",
      "id": 4181124,
      "node_id": "MDQ6VXNlcjQxODExMjQ=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/4181124?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yashykt",
      "html_url": "https://github.com/yashykt",
      "followers_url": "https://api.github.com/users/yashykt/followers",
      "following_url": "https://api.github.com/users/yashykt/following{/other_user}",
      "gists_url": "https://api.github.com/users/yashykt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yashykt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yashykt/subscriptions",
      "organizations_url": "https://api.github.com/users/yashykt/orgs",
      "repos_url": "https://api.github.com/users/yashykt/repos",
      "events_url": "https://api.github.com/users/yashykt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yashykt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-02T01:47:55Z",
    "updated_at": "2017-11-02T02:12:32Z",
    "author_association": "MEMBER",
    "body": "This code makes the assumption that grpc_pollset_work calls grpc_invalidate_now so that grpc_exec_ctx_now, but that's not always true.\r\n\r\nhttps://github.com/grpc/grpc/blob/66b740a8c60df59d7c82c8f7e122369ee86d62c1/src/core/lib/iomgr/pollset_windows.cc#L162\r\n\r\nThis path for example does not call invalidate_now. It is instead called in grpc_iocp_work which is not always called.\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341297983",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-341297983",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 341297983,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTI5Nzk4Mw==",
    "user": {
      "login": "yashykt",
      "id": 4181124,
      "node_id": "MDQ6VXNlcjQxODExMjQ=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/4181124?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yashykt",
      "html_url": "https://github.com/yashykt",
      "followers_url": "https://api.github.com/users/yashykt/followers",
      "following_url": "https://api.github.com/users/yashykt/following{/other_user}",
      "gists_url": "https://api.github.com/users/yashykt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yashykt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yashykt/subscriptions",
      "organizations_url": "https://api.github.com/users/yashykt/orgs",
      "repos_url": "https://api.github.com/users/yashykt/repos",
      "events_url": "https://api.github.com/users/yashykt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yashykt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-02T02:15:45Z",
    "updated_at": "2017-11-02T02:15:45Z",
    "author_association": "MEMBER",
    "body": "https://github.com/grpc/grpc/pull/13234\r\n\r\nThis PR for example places an invalidate_now at the end of the cq_next loop. Doing this makes all the failing tests succeed atleast locally (on a windows VM)\r\n\r\nAlso, the reason why it is happening only on proxy related tests is probably because proxy introduces another thread which causes one of the threads to take the path in grpc_pollset_work that does not hit grpc_exec_ctx_invalidate_now"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/341308409",
    "html_url": "https://github.com/grpc/grpc/issues/13079#issuecomment-341308409",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13079",
    "id": 341308409,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MTMwODQwOQ==",
    "user": {
      "login": "dgquintas",
      "id": 120217,
      "node_id": "MDQ6VXNlcjEyMDIxNw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/120217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dgquintas",
      "html_url": "https://github.com/dgquintas",
      "followers_url": "https://api.github.com/users/dgquintas/followers",
      "following_url": "https://api.github.com/users/dgquintas/following{/other_user}",
      "gists_url": "https://api.github.com/users/dgquintas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dgquintas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dgquintas/subscriptions",
      "organizations_url": "https://api.github.com/users/dgquintas/orgs",
      "repos_url": "https://api.github.com/users/dgquintas/repos",
      "events_url": "https://api.github.com/users/dgquintas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dgquintas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-02T03:32:53Z",
    "updated_at": "2017-11-02T03:32:53Z",
    "author_association": "NONE",
    "body": "Great stuff, thanks Yash for looking into this and seemingly root causing\nit so quickly.\n\nOn 1 Nov 2017 19:16, \"Yash Tibrewal\" <notifications@github.com> wrote:\n\n> #13234 <https://github.com/grpc/grpc/pull/13234>\n>\n> This PR for example places an invalidate_now at the end of the cq_next\n> loop. Doing this makes all the failing tests succeed atleast locally (on a\n> windows VM)\n>\n> Also, the reason why it is happening only on proxy related tests is\n> probably because proxy introduces another thread which causes one of the\n> threads to take the path in grpc_pollset_work that does not hit\n> grpc_exec_ctx_invalidate_now\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/grpc/grpc/issues/13079#issuecomment-341297983>, or mute\n> the thread\n> <https://github.com/notifications/unsubscribe-auth/AAHVmUwGRZxZJLkiTY4FdM2ozm-qYV9Sks5sySXrgaJpZM4QALoX>\n> .\n>\n"
  }
]
