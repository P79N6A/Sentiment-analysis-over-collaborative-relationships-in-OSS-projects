[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/403598276",
    "html_url": "https://github.com/grpc/grpc/issues/14789#issuecomment-403598276",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/14789",
    "id": 403598276,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMzU5ODI3Ng==",
    "user": {
      "login": "mmitalidis",
      "id": 23199785,
      "node_id": "MDQ6VXNlcjIzMTk5Nzg1",
      "avatar_url": "https://avatars3.githubusercontent.com/u/23199785?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mmitalidis",
      "html_url": "https://github.com/mmitalidis",
      "followers_url": "https://api.github.com/users/mmitalidis/followers",
      "following_url": "https://api.github.com/users/mmitalidis/following{/other_user}",
      "gists_url": "https://api.github.com/users/mmitalidis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mmitalidis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mmitalidis/subscriptions",
      "organizations_url": "https://api.github.com/users/mmitalidis/orgs",
      "repos_url": "https://api.github.com/users/mmitalidis/repos",
      "events_url": "https://api.github.com/users/mmitalidis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mmitalidis/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-09T19:47:36Z",
    "updated_at": "2018-07-09T19:47:36Z",
    "author_association": "NONE",
    "body": "Hi,\r\nI experience the same issue on Linux. I am working with python 2.7 and I built the release 1.13.0 from source. When I run the following test it only succeeds occasionally.\r\n\r\n\r\n\r\n```\r\n$ python -m unittest tests.unit._server_ssl_cert_config_test.ServerSSLCertReloadTestWithoutClientAuth\r\nE0709 19:25:21.845139308   30559 ssl_transport_security.cc:1228] Handshake failed with fatal error SSL_ERROR_SSL: error:14090086:SSL routines:ssl3_get_server_certificate:certificate verify failed.\r\nNo handlers could be found for logger \"grpc._cython.cygrpc\"\r\nE0709 19:25:21.892249813   30597 security_connector.cc:758]  Failed fetching new server credentials, continuing to use previously-loaded credentials.\r\nE0709 19:25:22.554869982   30559 ssl_transport_security.cc:1228] Handshake failed with fatal error SSL_ERROR_SSL: error:14090086:SSL routines:ssl3_get_server_certificate:certificate verify failed.\r\nE0709 19:25:22.879386405   30559 ssl_transport_security.cc:1228] Handshake failed with fatal error SSL_ERROR_SSL: error:14090086:SSL routines:ssl3_get_server_certificate:certificate verify failed.\r\n.\r\n----------------------------------------------------------------------\r\nRan 1 test in 10.063s\r\n\r\nOK\r\n```\r\n\r\nMoreover, it seems to fail at a different point every time I execute it, as you can see from the following logs.\r\n\r\n\r\n```\r\n$ python -m unittest tests.unit._server_ssl_cert_config_test.ServerSSLCertReloadTestWithoutClientAuth\r\nE0709 19:24:01.748955122   30169 ssl_transport_security.cc:1228] Handshake failed with fatal error SSL_ERROR_SSL: error:14090086:SSL routines:ssl3_get_server_certificate:certificate verify failed.\r\nNo handlers could be found for logger \"grpc._cython.cygrpc\"\r\nE0709 19:24:01.766522099   30209 security_connector.cc:758]  Failed fetching new server credentials, continuing to use previously-loaded credentials.\r\nE0709 19:24:02.465962608   30169 ssl_transport_security.cc:1228] Handshake failed with fatal error SSL_ERROR_SSL: error:14090086:SSL routines:ssl3_get_server_certificate:certificate verify failed.\r\nE0709 19:24:02.683784605   30169 ssl_transport_security.cc:1228] Handshake failed with fatal error SSL_ERROR_SSL: error:14090086:SSL routines:ssl3_get_server_certificate:certificate verify failed.\r\nF\r\n======================================================================\r\nFAIL: test (tests.unit._server_ssl_cert_config_test.ServerSSLCertReloadTestWithoutClientAuth)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"tests/unit/_server_ssl_cert_config_test.py\", line 359, in _test\r\n    self.assertEqual(len(actual_calls), 0)\r\nAssertionError: 1 != 0\r\n\r\n----------------------------------------------------------------------\r\nRan 1 test in 10.077s\r\n\r\nFAILED (failures=1)\r\n```\r\n\r\n\r\n```\r\n$ python -m unittest tests.unit._server_ssl_cert_config_test.ServerSSLCertReloadTestWithoutClientAuth\r\nE0709 19:26:54.068187095   31027 ssl_transport_security.cc:1228] Handshake failed with fatal error SSL_ERROR_SSL: error:14090086:SSL routines:ssl3_get_server_certificate:certificate verify failed.\r\nNo handlers could be found for logger \"grpc._cython.cygrpc\"\r\nE0709 19:26:54.085385552   31121 security_connector.cc:758]  Failed fetching new server credentials, continuing to use previously-loaded credentials.\r\nE0709 19:26:54.879662896   31027 ssl_transport_security.cc:1228] Handshake failed with fatal error SSL_ERROR_SSL: error:14090086:SSL routines:ssl3_get_server_certificate:certificate verify failed.\r\nE0709 19:26:55.046656890   31027 ssl_transport_security.cc:1228] Handshake failed with fatal error SSL_ERROR_SSL: error:14090086:SSL routines:ssl3_get_server_certificate:certificate verify failed.\r\nF\r\n======================================================================\r\nFAIL: test (tests.unit._server_ssl_cert_config_test.ServerSSLCertReloadTestWithoutClientAuth)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"tests/unit/_server_ssl_cert_config_test.py\", line 353, in _test\r\n    self.assertEqual(len(actual_calls), 0)\r\nAssertionError: 1 != 0\r\n\r\n----------------------------------------------------------------------\r\nRan 1 test in 10.078s\r\n\r\nFAILED (failures=1)\r\n```\r\n\r\n```\r\n$ python -m unittest tests.unit._server_ssl_cert_config_test.ServerSSLCertReloadTestWithoutClientAuth\r\nE0709 19:28:40.059594825   31676 ssl_transport_security.cc:1228] Handshake failed with fatal error SSL_ERROR_SSL: error:14090086:SSL routines:ssl3_get_server_certificate:certificate verify failed.\r\nNo handlers could be found for logger \"grpc._cython.cygrpc\"\r\nE0709 19:28:40.086924517   31682 security_connector.cc:758]  Failed fetching new server credentials, continuing to use previously-loaded credentials.\r\nFE0709 19:28:49.892262696   31717 ssl_transport_security.cc:1228] Handshake failed with fatal error SSL_ERROR_SSL: error:14090086:SSL routines:ssl3_get_server_certificate:certificate verify failed.\r\n\r\n======================================================================\r\nFAIL: test (tests.unit._server_ssl_cert_config_test.ServerSSLCertReloadTestWithoutClientAuth)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"tests/unit/_server_ssl_cert_config_test.py\", line 283, in _test\r\n    self.assertEqual(len(actual_calls), 1)\r\nAssertionError: 2 != 1\r\n\r\n----------------------------------------------------------------------\r\nRan 1 test in 10.129s\r\n\r\nFAILED (failures=1)\r\n```\r\n\r\n@kpayson64 do you have any ideas what is causing this? Is there anything I can do to make the tests pass deterministically? I tried to debug the tests, but I do not know enough about the inner workings of the module to get to the bottom of the issue without a significant time investment.\r\n\r\nThanks"
  }
]
