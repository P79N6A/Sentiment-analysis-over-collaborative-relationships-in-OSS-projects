[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/388527857",
    "html_url": "https://github.com/grpc/grpc/issues/15348#issuecomment-388527857",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/15348",
    "id": 388527857,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4ODUyNzg1Nw==",
    "user": {
      "login": "yang-g",
      "id": 10122250,
      "node_id": "MDQ6VXNlcjEwMTIyMjUw",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10122250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yang-g",
      "html_url": "https://github.com/yang-g",
      "followers_url": "https://api.github.com/users/yang-g/followers",
      "following_url": "https://api.github.com/users/yang-g/following{/other_user}",
      "gists_url": "https://api.github.com/users/yang-g/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yang-g/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yang-g/subscriptions",
      "organizations_url": "https://api.github.com/users/yang-g/orgs",
      "repos_url": "https://api.github.com/users/yang-g/repos",
      "events_url": "https://api.github.com/users/yang-g/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yang-g/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-12T03:57:44Z",
    "updated_at": "2018-05-12T03:57:44Z",
    "author_association": "MEMBER",
    "body": "How about setting your g_thread_num to larger than 1? You are using a\nsingle threaded server.\n\nOn Fri, May 11, 2018 at 5:21 PM gongweibao <notifications@github.com> wrote:\n\n> On 100Gb network, I create a server to listening on 4 ports and grpc can\n> reach 3GB+/s throughput.\n> However, when the server listening on one port, grpc reaches just 1GB/s\n> throughput, even I set\n>\n>     args.SetInt(GRPC_ARG_HTTP2_STREAM_LOOKAHEAD_BYTES, 1024*1024*1024);\n>     args.SetInt(GRPC_ARG_MAX_CONCURRENT_STREAMS, 10);\n>\n> It seems that grpc can use only one connection concurrently on one port\n> service. Am I right?\n>\n> What's the correct way of doing it?\n>\n> My code is here:\n>\n> client:\n> https://github.com/gongweibao/tests/blob/develop/grpc_test/client.cc\n> server:\n> https://github.com/gongweibao/tests/blob/develop/grpc_test/server.cc\n>\n> â€”\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/grpc/grpc/issues/15348>, or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AJp0Ck40ymm2MmE69Hjp33YFtOiuN_p-ks5txisMgaJpZM4T8ND_>\n> .\n>\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/388530336",
    "html_url": "https://github.com/grpc/grpc/issues/15348#issuecomment-388530336",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/15348",
    "id": 388530336,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4ODUzMDMzNg==",
    "user": {
      "login": "gongweibao",
      "id": 10721757,
      "node_id": "MDQ6VXNlcjEwNzIxNzU3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10721757?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gongweibao",
      "html_url": "https://github.com/gongweibao",
      "followers_url": "https://api.github.com/users/gongweibao/followers",
      "following_url": "https://api.github.com/users/gongweibao/following{/other_user}",
      "gists_url": "https://api.github.com/users/gongweibao/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gongweibao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gongweibao/subscriptions",
      "organizations_url": "https://api.github.com/users/gongweibao/orgs",
      "repos_url": "https://api.github.com/users/gongweibao/repos",
      "events_url": "https://api.github.com/users/gongweibao/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gongweibao/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-12T05:03:31Z",
    "updated_at": "2018-05-12T05:04:12Z",
    "author_association": "NONE",
    "body": "`g_thread_num` is set https://github.com/gongweibao/tests/blob/develop/grpc_test/server.cc#L228\r\n\r\nIt's changed by `main()` arguments."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/388532208",
    "html_url": "https://github.com/grpc/grpc/issues/15348#issuecomment-388532208",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/15348",
    "id": 388532208,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4ODUzMjIwOA==",
    "user": {
      "login": "yang-g",
      "id": 10122250,
      "node_id": "MDQ6VXNlcjEwMTIyMjUw",
      "avatar_url": "https://avatars0.githubusercontent.com/u/10122250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yang-g",
      "html_url": "https://github.com/yang-g",
      "followers_url": "https://api.github.com/users/yang-g/followers",
      "following_url": "https://api.github.com/users/yang-g/following{/other_user}",
      "gists_url": "https://api.github.com/users/yang-g/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yang-g/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yang-g/subscriptions",
      "organizations_url": "https://api.github.com/users/yang-g/orgs",
      "repos_url": "https://api.github.com/users/yang-g/repos",
      "events_url": "https://api.github.com/users/yang-g/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yang-g/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-12T05:49:57Z",
    "updated_at": "2018-05-12T05:49:57Z",
    "author_association": "MEMBER",
    "body": "It could be useful to know the client/server thread count and message size you used. As I recall, using larger message size over the same connection can result in higher throughput. Also, if you want, I think you can set distinct channel argument when creating multiple channels to create different connections to the same endpoint."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/388536014",
    "html_url": "https://github.com/grpc/grpc/issues/15348#issuecomment-388536014",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/15348",
    "id": 388536014,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4ODUzNjAxNA==",
    "user": {
      "login": "gongweibao",
      "id": 10721757,
      "node_id": "MDQ6VXNlcjEwNzIxNzU3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10721757?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gongweibao",
      "html_url": "https://github.com/gongweibao",
      "followers_url": "https://api.github.com/users/gongweibao/followers",
      "following_url": "https://api.github.com/users/gongweibao/following{/other_user}",
      "gists_url": "https://api.github.com/users/gongweibao/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gongweibao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gongweibao/subscriptions",
      "organizations_url": "https://api.github.com/users/gongweibao/orgs",
      "repos_url": "https://api.github.com/users/gongweibao/repos",
      "events_url": "https://api.github.com/users/gongweibao/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gongweibao/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-12T07:13:36Z",
    "updated_at": "2018-05-12T10:04:27Z",
    "author_association": "NONE",
    "body": "> It could be useful to know the client/server thread count and message size you used.\r\n\r\nActually, I test 1/2/4 threads in client/server.\r\nAnd the detailed result is [here](https://github.com/gongweibao/Paddle/blob/c1267a948dfb7fb8174c1f6d4802fceb04b7db06/benchmark/cluster/network/README.md#grpc) with different message size.\r\n\r\nIn the table, the `server` and `client` column show the number of process instead of threads.\r\nI test 1/2/4 threads and other and pick the max result.\r\n\r\n> Also, if you want, I think you can set distinct channel argument when creating multiple channels to create different connections to the same endpoint.\r\n\r\nI set channels arguments [here](https://github.com/gongweibao/tests/blob/develop/grpc_test/client.cc#L165) . And `args` is initialized [here](https://github.com/gongweibao/tests/blob/develop/grpc_test/client.cc#L198).\r\n\r\nWhat's the meaning of distinct channel arguments in detail?  Could you give me an example?\r\nAnd how can I get the connections that are used?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/388544615",
    "html_url": "https://github.com/grpc/grpc/issues/15348#issuecomment-388544615",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/15348",
    "id": 388544615,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4ODU0NDYxNQ==",
    "user": {
      "login": "gongweibao",
      "id": 10721757,
      "node_id": "MDQ6VXNlcjEwNzIxNzU3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10721757?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gongweibao",
      "html_url": "https://github.com/gongweibao",
      "followers_url": "https://api.github.com/users/gongweibao/followers",
      "following_url": "https://api.github.com/users/gongweibao/following{/other_user}",
      "gists_url": "https://api.github.com/users/gongweibao/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gongweibao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gongweibao/subscriptions",
      "organizations_url": "https://api.github.com/users/gongweibao/orgs",
      "repos_url": "https://api.github.com/users/gongweibao/repos",
      "events_url": "https://api.github.com/users/gongweibao/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gongweibao/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-12T10:05:32Z",
    "updated_at": "2018-05-12T10:05:32Z",
    "author_association": "NONE",
    "body": "It seems that if [ I use more `channel` to send](https://github.com/gongweibao/tests/pull/3/files), the throughput gets much worse."
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/389366499",
    "html_url": "https://github.com/grpc/grpc/issues/15348#issuecomment-389366499",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/15348",
    "id": 389366499,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4OTM2NjQ5OQ==",
    "user": {
      "login": "gongweibao",
      "id": 10721757,
      "node_id": "MDQ6VXNlcjEwNzIxNzU3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/10721757?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gongweibao",
      "html_url": "https://github.com/gongweibao",
      "followers_url": "https://api.github.com/users/gongweibao/followers",
      "following_url": "https://api.github.com/users/gongweibao/following{/other_user}",
      "gists_url": "https://api.github.com/users/gongweibao/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gongweibao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gongweibao/subscriptions",
      "organizations_url": "https://api.github.com/users/gongweibao/orgs",
      "repos_url": "https://api.github.com/users/gongweibao/repos",
      "events_url": "https://api.github.com/users/gongweibao/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gongweibao/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-16T01:34:28Z",
    "updated_at": "2018-05-16T01:34:28Z",
    "author_association": "NONE",
    "body": "https://stackoverflow.com/questions/50301690/how-to-maximize-grpc-throughput/50335737#50335737"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/415597542",
    "html_url": "https://github.com/grpc/grpc/issues/15348#issuecomment-415597542",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/15348",
    "id": 415597542,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNTU5NzU0Mg==",
    "user": {
      "login": "sreecha",
      "id": 2754995,
      "node_id": "MDQ6VXNlcjI3NTQ5OTU=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/2754995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sreecha",
      "html_url": "https://github.com/sreecha",
      "followers_url": "https://api.github.com/users/sreecha/followers",
      "following_url": "https://api.github.com/users/sreecha/following{/other_user}",
      "gists_url": "https://api.github.com/users/sreecha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sreecha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sreecha/subscriptions",
      "organizations_url": "https://api.github.com/users/sreecha/orgs",
      "repos_url": "https://api.github.com/users/sreecha/repos",
      "events_url": "https://api.github.com/users/sreecha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sreecha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-23T22:56:34Z",
    "updated_at": "2018-08-23T22:56:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "@gongweibao:\r\n\r\n>It seems that grpc client can use only one connection concurrently to one port service. Am I right?\r\n\r\nNot really. If you create multiple channels (and make sure each channel has atleast one different channel arg), then each channel will create a separate connection.\r\n\r\nHere is an example of code that creates 5 channels and forces each one to create a different connection (the code creates a dummy channel arg that is unique per channel)\r\n\r\n```C++\r\n  for (i = 0; i < 5; i++) {\r\n    ::grpc::ChannelArguments args;\r\n\r\n    // Set a dummy (but distinct) channel arg on each channel so that\r\n    // every channel gets its own connection\r\n    args.SetInt(\"test_key\", i);\r\n    std::shared_ptr<::grpc::Channel> channel =\r\n                ::grpc::CreateCustomChannel(server_address,\r\n                                            ::grpc::InsecureChannelCredentials(),\r\n                                            args);\r\n  }\r\n```\r\n\r\nCan you try creating multiple channels like the above and see if it improves the situation?"
  }
]
