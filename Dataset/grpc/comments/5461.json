[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/189523494",
    "html_url": "https://github.com/grpc/grpc/issues/5461#issuecomment-189523494",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/5461",
    "id": 189523494,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE4OTUyMzQ5NA==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-02-26T23:23:23Z",
    "updated_at": "2016-02-26T23:23:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "https://grpc-testing.appspot.com/job/gRPC_master/15406/config=opt,language=csharp,platform=macos/console\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/192394784",
    "html_url": "https://github.com/grpc/grpc/issues/5461#issuecomment-192394784",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/5461",
    "id": 192394784,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MjM5NDc4NA==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-04T18:24:03Z",
    "updated_at": "2016-03-04T18:24:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "I am able to beautifully reproduce this on Linux if I use GPR_POSIX_MULTIPOLL_WITH_POLL instead of epoll.\n\n```\nD0304 09:40:55.271543539   24283 fd_posix.c:135]             FD 13 0x7f72f8110c80 unref 2 8 -> 6 [tcp_listener_shutdown; src/core/iomgr/fd_posix.c:251]\nD0304 09:40:55.271731238   24318 fd_posix.c:135]             FD 13 0x7f72f8110c80 unref 2 6 -> 4 [poll; src/core/iomgr/fd_posix.c:440]\nD0304 09:40:55.271744947   24318 fd_posix.c:135]             FD 13 0x7f72f8110c80 unref 2 4 -> 2 [multipoller; src/core/iomgr/pollset_multipoller_with_poll_posix.c:121]\nD0304 09:40:55.272787073   24323 fd_posix.c:135]             FD 13 0x7f72f8110c80 unref 2 2 -> 0 [poll; src/core/iomgr/fd_posix.c:440]\nD0304 09:40:55.271470984   24324 fd_posix.c:120]             FD 13 0x7f72f8110c80   ref 2 7 -> 9 [poll; src/core/iomgr/fd_posix.c:346]\nE0304 09:40:55.272849015   24324 fd_posix.c:128]             assertion failed: gpr_atm_no_barrier_fetch_add(&fd->refst, n) > 0\n```\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/192468618",
    "html_url": "https://github.com/grpc/grpc/issues/5461#issuecomment-192468618",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/5461",
    "id": 192468618,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MjQ2ODYxOA==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-04T21:14:57Z",
    "updated_at": "2016-03-04T21:14:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "Here's the full log:\n[output.txt](https://github.com/grpc/grpc/files/159392/output.txt)\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/192477286",
    "html_url": "https://github.com/grpc/grpc/issues/5461#issuecomment-192477286",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/5461",
    "id": 192477286,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MjQ3NzI4Ng==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-04T21:33:05Z",
    "updated_at": "2016-03-04T21:33:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "I believe (not sure though) that the call stack at the time of unrefing the FD for the first time (unref 2 2 -> 0 [poll; src/core/iomgr/fd_posix.c:440]   is \n\n```\n/usr/local/google/home/jtattermusch/github/grpc/src/csharp/Grpc.Core.Tests/bin/Debug/nativelibs/linux_x64/libgrpc_csharp_ext.so(+0x17874d) [0x7f8cff96a74d]\n    /usr/local/google/home/jtattermusch/github/grpc/src/csharp/Grpc.Core.Tests/bin/Debug/nativelibs/linux_x64/libgrpc_csharp_ext.so(grpc_fd_unref+0x36) [0x7f8cff96ac98]\n    /usr/local/google/home/jtattermusch/github/grpc/src/csharp/Grpc.Core.Tests/bin/Debug/nativelibs/linux_x64/libgrpc_csharp_ext.so(grpc_fd_end_poll+0x1bd) [0x7f8cff96b301]\n    /usr/local/google/home/jtattermusch/github/grpc/src/csharp/Grpc.Core.Tests/bin/Debug/nativelibs/linux_x64/libgrpc_csharp_ext.so(+0x179a4f) [0x7f8cff96ba4f]\n    /usr/local/google/home/jtattermusch/github/grpc/src/csharp/Grpc.Core.Tests/bin/Debug/nativelibs/linux_x64/libgrpc_csharp_ext.so(grpc_pollset_work+0x1e5) [0x7f8cff8bfe25]\n    /usr/local/google/home/jtattermusch/github/grpc/src/csharp/Grpc.Core.Tests/bin/Debug/nativelibs/linux_x64/libgrpc_csharp_ext.so(grpc_completion_queue_next+0x2f0) [0x7f8cff8304df]\n    /usr/local/google/home/jtattermusch/github/grpc/src/csharp/Grpc.Core.Tests/bin/Debug/nativelibs/linux_x64/libgrpc_csharp_ext.so(grpcsharp_completion_queue_next+0x31) [0x7f8cff828675]\n```\n\nthat's basically the same call stack as when another thread (also performing grpc_completion_queue_next) tries to ref the fd (and crashes).\n\nSo as far as I can tell, this is a race between two or more threads performing cq_next   when a fd gets closed (in my case the channel shutdown has been requested before).\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/192479128",
    "html_url": "https://github.com/grpc/grpc/issues/5461#issuecomment-192479128",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/5461",
    "id": 192479128,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MjQ3OTEyOA==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-04T21:39:13Z",
    "updated_at": "2016-03-04T21:39:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "When I decreased the thread pool size from 4 to 1, the tests passes without any problems (300 runs). That supports the theory of a race between multiple cq_next calls.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/192504043",
    "html_url": "https://github.com/grpc/grpc/issues/5461#issuecomment-192504043",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/5461",
    "id": 192504043,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MjUwNDA0Mw==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-04T22:38:02Z",
    "updated_at": "2016-03-04T22:38:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "Reassigning to @ctiller  as he knows the root cause of this.\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/193321570",
    "html_url": "https://github.com/grpc/grpc/issues/5461#issuecomment-193321570",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/5461",
    "id": 193321570,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5MzMyMTU3MA==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-07T16:13:55Z",
    "updated_at": "2016-03-07T16:13:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "I went through ~20 last builds and havent seen any instance of this failure.\n"
  }
]
