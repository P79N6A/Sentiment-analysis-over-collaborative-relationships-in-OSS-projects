[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/309544514",
    "html_url": "https://github.com/grpc/grpc/issues/11529#issuecomment-309544514",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11529",
    "id": 309544514,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwOTU0NDUxNA==",
    "user": {
      "login": "dgquintas",
      "id": 120217,
      "node_id": "MDQ6VXNlcjEyMDIxNw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/120217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dgquintas",
      "html_url": "https://github.com/dgquintas",
      "followers_url": "https://api.github.com/users/dgquintas/followers",
      "following_url": "https://api.github.com/users/dgquintas/following{/other_user}",
      "gists_url": "https://api.github.com/users/dgquintas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dgquintas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dgquintas/subscriptions",
      "organizations_url": "https://api.github.com/users/dgquintas/orgs",
      "repos_url": "https://api.github.com/users/dgquintas/repos",
      "events_url": "https://api.github.com/users/dgquintas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dgquintas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-19T19:29:16Z",
    "updated_at": "2017-06-19T19:29:16Z",
    "author_association": "NONE",
    "body": "It seems this is happening for `bad_ping` across all fixtures:\r\n```\r\n$ ./tools/run_tests/run_tests.py -l c -c tsan -r '.*bad_ping.*' -S -t -n inf -a 20\r\n...\r\n*******************************\r\nCaught signal SIGABRT\r\n==================\r\nWARNING: ThreadSanitizer: signal-unsafe call inside of a signal (pid=57368)\r\n    #0 malloc /home/development/llvm/3.8.0/final/llvm.src/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:595:5 (h2_full+pipe_nosec_test+0x00000041f56d)\r\n    #1 _dl_map_object_deps /build/eglibc-MjiXCM/eglibc-2.19/elf/dl-deps.c:511 (ld-linux-x86-64.so.2+0x00000000de7b)\r\n    #2 crash_handler /usr/local/google/home/dgq/grpc/forks/tmp/grpc/test/core/util/test_config.c:245:13 (h2_full+pipe_nosec_test+0x00000069c598)\r\n    #3 __tsan::CallUserSignalHandler(__tsan::ThreadState*, bool, bool, bool, int, my_siginfo_t*, void*) /home/development/llvm/3.8.0/final/llvm.src/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:1951:7 (h2_full+pipe_nosec_test+0x00000042b734)\r\n    #4 test_bad_ping /usr/local/google/home/dgq/grpc/forks/tmp/grpc/test/core/end2end/tests/bad_ping.c:200:3 (h2_full+pipe_nosec_test+0x0000004adec8)\r\n    #5 bad_ping /usr/local/google/home/dgq/grpc/forks/tmp/grpc/test/core/end2end/tests/bad_ping.c:220:3 (h2_full+pipe_nosec_test+0x0000004acfad)\r\n    #6 grpc_end2end_tests /usr/local/google/home/dgq/grpc/forks/tmp/grpc/test/core/end2end/end2end_nosec_tests.c:272:7 (h2_full+pipe_nosec_test+0x0000004a8e9e)\r\n    #7 main /usr/local/google/home/dgq/grpc/forks/tmp/grpc/test/core/end2end/fixtures/h2_full+pipe.c:108:5 (h2_full+pipe_nosec_test+0x0000004a8298)\r\n\r\nSUMMARY: ThreadSanitizer: signal-unsafe call inside of a signal /build/eglibc-MjiXCM/eglibc-2.19/elf/dl-deps.c:511 in _dl_map_object_deps\r\n==================\r\nFAILED: bins/tsan/h2_full+pipe_nosec_test bad_ping GRPC_POLL_STRATEGY=poll-cv [ret=66, pid=57368]\r\n```\r\n\r\n@y-zeng you wrote the relevant section of the `bad_ping` test, do you have any insight? In particular, it seems the [`GPR_ASSERT(status == GRPC_STATUS_UNAVAILABLE);`](https://github.com/grpc/grpc/blob/master/test/core/end2end/tests/bad_ping.c#L200) isn't satisfied under load.\r\n"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/309550870",
    "html_url": "https://github.com/grpc/grpc/issues/11529#issuecomment-309550870",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11529",
    "id": 309550870,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwOTU1MDg3MA==",
    "user": {
      "login": "dgquintas",
      "id": 120217,
      "node_id": "MDQ6VXNlcjEyMDIxNw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/120217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dgquintas",
      "html_url": "https://github.com/dgquintas",
      "followers_url": "https://api.github.com/users/dgquintas/followers",
      "following_url": "https://api.github.com/users/dgquintas/following{/other_user}",
      "gists_url": "https://api.github.com/users/dgquintas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dgquintas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dgquintas/subscriptions",
      "organizations_url": "https://api.github.com/users/dgquintas/orgs",
      "repos_url": "https://api.github.com/users/dgquintas/repos",
      "events_url": "https://api.github.com/users/dgquintas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dgquintas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-19T19:44:12Z",
    "updated_at": "2017-06-19T19:44:12Z",
    "author_association": "NONE",
    "body": "In addition: when the assertion fails, all the information received by the client is that set by the server ([here](https://github.com/grpc/grpc/blob/master/test/core/end2end/tests/bad_ping.c#L174)) during normal operation. Maybe the test isn't triggering the so-called \"punishment\"?"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/309611035",
    "html_url": "https://github.com/grpc/grpc/issues/11529#issuecomment-309611035",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11529",
    "id": 309611035,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwOTYxMTAzNQ==",
    "user": {
      "login": "y-zeng",
      "id": 17460127,
      "node_id": "MDQ6VXNlcjE3NDYwMTI3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/17460127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/y-zeng",
      "html_url": "https://github.com/y-zeng",
      "followers_url": "https://api.github.com/users/y-zeng/followers",
      "following_url": "https://api.github.com/users/y-zeng/following{/other_user}",
      "gists_url": "https://api.github.com/users/y-zeng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/y-zeng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/y-zeng/subscriptions",
      "organizations_url": "https://api.github.com/users/y-zeng/orgs",
      "repos_url": "https://api.github.com/users/y-zeng/repos",
      "events_url": "https://api.github.com/users/y-zeng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/y-zeng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-20T00:36:24Z",
    "updated_at": "2017-06-20T00:36:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "There should be two `PING strike`s in the log. But in the failing test, these was only one, so the goaway \"punishment\" was not triggered. I'm digging into the cause.  "
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/311140219",
    "html_url": "https://github.com/grpc/grpc/issues/11529#issuecomment-311140219",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/11529",
    "id": 311140219,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMTE0MDIxOQ==",
    "user": {
      "login": "y-zeng",
      "id": 17460127,
      "node_id": "MDQ6VXNlcjE3NDYwMTI3",
      "avatar_url": "https://avatars3.githubusercontent.com/u/17460127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/y-zeng",
      "html_url": "https://github.com/y-zeng",
      "followers_url": "https://api.github.com/users/y-zeng/followers",
      "following_url": "https://api.github.com/users/y-zeng/following{/other_user}",
      "gists_url": "https://api.github.com/users/y-zeng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/y-zeng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/y-zeng/subscriptions",
      "organizations_url": "https://api.github.com/users/y-zeng/orgs",
      "repos_url": "https://api.github.com/users/y-zeng/repos",
      "events_url": "https://api.github.com/users/y-zeng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/y-zeng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-26T18:19:26Z",
    "updated_at": "2017-06-26T18:19:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "The issue was caused by the server-side BDP. In the failing cases, it triggered a window update frame, and reset the ping strike counter. Fixed by #11589."
  }
]
