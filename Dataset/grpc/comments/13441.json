[
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/345313062",
    "html_url": "https://github.com/grpc/grpc/issues/13441#issuecomment-345313062",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13441",
    "id": 345313062,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NTMxMzA2Mg==",
    "user": {
      "login": "dgquintas",
      "id": 120217,
      "node_id": "MDQ6VXNlcjEyMDIxNw==",
      "avatar_url": "https://avatars3.githubusercontent.com/u/120217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dgquintas",
      "html_url": "https://github.com/dgquintas",
      "followers_url": "https://api.github.com/users/dgquintas/followers",
      "following_url": "https://api.github.com/users/dgquintas/following{/other_user}",
      "gists_url": "https://api.github.com/users/dgquintas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dgquintas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dgquintas/subscriptions",
      "organizations_url": "https://api.github.com/users/dgquintas/orgs",
      "repos_url": "https://api.github.com/users/dgquintas/repos",
      "events_url": "https://api.github.com/users/dgquintas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dgquintas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-17T17:43:22Z",
    "updated_at": "2017-11-17T17:43:22Z",
    "author_association": "NONE",
    "body": "In particular:\r\n```\r\nWARNING: ThreadSanitizer: data race (pid=26170)\r\n  Read of size 8 at 0x7d500053fd90 by thread T11:\r\n    #0 testing::internal::UnitTestImpl::os_stack_trace_getter() /var/local/git/grpc/third_party/googletest/googletest/src/gtest.cc:4919:7 (client_channel_stress_test+0x000000ad32e9)\r\n    #1 testing::internal::UnitTestImpl::CurrentOsStackTraceExceptTop(int) /var/local/git/grpc/third_party/googletest/googletest/src/gtest.cc:797:10 (client_channel_stress_test+0x000000acfd1c)\r\n    #2 testing::internal::AssertHelper::operator=(testing::Message const&) const /var/local/git/grpc/third_party/googletest/googletest/src/gtest.cc:377:23 (client_channel_stress_test+0x000000acf3e3)\r\n    #3 grpc::testing::TestServiceImpl::Echo(grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*) /var/local/git/grpc/test/cpp/end2end/test_service_impl.cc:130:385 (client_channel_stress_test+0x00000053e628)\r\n    #4 grpc::Status std::_Mem_fn<grpc::Status (grpc::testing::EchoTestService::Service::*)(grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*)>::operator()<grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*, void>(grpc::testing::EchoTestService::Service*, grpc::ServerContext*&&, grpc::testing::EchoRequest const*&&, grpc::testing::EchoResponse*&&) const /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:569:11 (client_channel_stress_test+0x0000005323ba)\r\n    #5 std::_Function_handler<grpc::Status (grpc::testing::EchoTestService::Service*, grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*), std::_Mem_fn<grpc::Status (grpc::testing::EchoTestService::Service::*)(grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*)> >::_M_invoke(std::_Any_data const&, grpc::testing::EchoTestService::Service*, grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*) /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:2024:9 (client_channel_stress_test+0x000000531fe2)\r\n    #6 std::function<grpc::Status (grpc::testing::EchoTestService::Service*, grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*)>::operator()(grpc::testing::EchoTestService::Service*, grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*) const /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:2439:14 (client_channel_stress_test+0x000000533039)\r\n    #7 grpc::internal::RpcMethodHandler<grpc::testing::EchoTestService::Service, grpc::testing::EchoRequest, grpc::testing::EchoResponse>::RunHandler(grpc::internal::MethodHandler::HandlerParameter const&) /var/local/git/grpc/include/grpc++/impl/codegen/method_handler_impl.h:46:16 (client_channel_stress_test+0x00000053297c)\r\n    #8 grpc::Server::SyncRequest::CallData::Run(std::shared_ptr<grpc::Server::GlobalCallbacks>) /var/local/git/grpc/src/cpp/server/server_cc.cc:216:7 (client_channel_stress_test+0x0000005dda43)\r\n    #9 grpc::Server::SyncRequestThreadManager::DoWork(void*, bool) /var/local/git/grpc/src/cpp/server/server_cc.cc:308:7 (client_channel_stress_test+0x0000005dc5c7)\r\n    #10 grpc::ThreadManager::MainWorkLoop() /var/local/git/grpc/src/cpp/thread_manager/thread_manager.cc:152:9 (client_channel_stress_test+0x0000005eada7)\r\n    #11 grpc::ThreadManager::WorkerThread::Run() /var/local/git/grpc/src/cpp/thread_manager/thread_manager.cc:38:3 (client_channel_stress_test+0x0000005eaaee)\r\n    #12 void std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()>::operator()<, void>(grpc::ThreadManager::WorkerThread*) const /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:569:11 (client_channel_stress_test+0x0000005edc9b)\r\n    #13 void std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)>::_M_invoke<0ul>(std::_Index_tuple<0ul>) /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:1699:18 (client_channel_stress_test+0x0000005edb85)\r\n    #14 std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)>::operator()() /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:1688:16 (client_channel_stress_test+0x0000005edb08)\r\n    #15 std::thread::_Impl<std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)> >::_M_run() /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/thread:115:13 (client_channel_stress_test+0x0000005ed65c)\r\n    #16 <null> <null> (libstdc++.so.6+0x0000000b696f)\r\n\r\n  Previous write of size 8 at 0x7d500053fd90 by thread T23:\r\n    #0 testing::internal::UnitTestImpl::os_stack_trace_getter() /var/local/git/grpc/third_party/googletest/googletest/src/gtest.cc:4923:28 (client_channel_stress_test+0x000000ad333d)\r\n    #1 testing::internal::UnitTestImpl::CurrentOsStackTraceExceptTop(int) /var/local/git/grpc/third_party/googletest/googletest/src/gtest.cc:797:10 (client_channel_stress_test+0x000000acfd1c)\r\n    #2 testing::internal::AssertHelper::operator=(testing::Message const&) const /var/local/git/grpc/third_party/googletest/googletest/src/gtest.cc:377:23 (client_channel_stress_test+0x000000acf3e3)\r\n    #3 grpc::testing::TestServiceImpl::Echo(grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*) /var/local/git/grpc/test/cpp/end2end/test_service_impl.cc:130:385 (client_channel_stress_test+0x00000053e628)\r\n    #4 grpc::Status std::_Mem_fn<grpc::Status (grpc::testing::EchoTestService::Service::*)(grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*)>::operator()<grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*, void>(grpc::testing::EchoTestService::Service*, grpc::ServerContext*&&, grpc::testing::EchoRequest const*&&, grpc::testing::EchoResponse*&&) const /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:569:11 (client_channel_stress_test+0x0000005323ba)\r\n    #5 std::_Function_handler<grpc::Status (grpc::testing::EchoTestService::Service*, grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*), std::_Mem_fn<grpc::Status (grpc::testing::EchoTestService::Service::*)(grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*)> >::_M_invoke(std::_Any_data const&, grpc::testing::EchoTestService::Service*, grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*) /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:2024:9 (client_channel_stress_test+0x000000531fe2)\r\n    #6 std::function<grpc::Status (grpc::testing::EchoTestService::Service*, grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*)>::operator()(grpc::testing::EchoTestService::Service*, grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*) const /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:2439:14 (client_channel_stress_test+0x000000533039)\r\n    #7 grpc::internal::RpcMethodHandler<grpc::testing::EchoTestService::Service, grpc::testing::EchoRequest, grpc::testing::EchoResponse>::RunHandler(grpc::internal::MethodHandler::HandlerParameter const&) /var/local/git/grpc/include/grpc++/impl/codegen/method_handler_impl.h:46:16 (client_channel_stress_test+0x00000053297c)\r\n    #8 grpc::Server::SyncRequest::CallData::Run(std::shared_ptr<grpc::Server::GlobalCallbacks>) /var/local/git/grpc/src/cpp/server/server_cc.cc:216:7 (client_channel_stress_test+0x0000005dda43)\r\n    #9 grpc::Server::SyncRequestThreadManager::DoWork(void*, bool) /var/local/git/grpc/src/cpp/server/server_cc.cc:308:7 (client_channel_stress_test+0x0000005dc5c7)\r\n    #10 grpc::ThreadManager::MainWorkLoop() /var/local/git/grpc/src/cpp/thread_manager/thread_manager.cc:152:9 (client_channel_stress_test+0x0000005eada7)\r\n    #11 grpc::ThreadManager::WorkerThread::Run() /var/local/git/grpc/src/cpp/thread_manager/thread_manager.cc:38:3 (client_channel_stress_test+0x0000005eaaee)\r\n    #12 void std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()>::operator()<, void>(grpc::ThreadManager::WorkerThread*) const /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:569:11 (client_channel_stress_test+0x0000005edc9b)\r\n    #13 void std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)>::_M_invoke<0ul>(std::_Index_tuple<0ul>) /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:1699:18 (client_channel_stress_test+0x0000005edb85)\r\n    #14 std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)>::operator()() /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:1688:16 (client_channel_stress_test+0x0000005edb08)\r\n    #15 std::thread::_Impl<std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)> >::_M_run() /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/thread:115:13 (client_channel_stress_test+0x0000005ed65c)\r\n    #16 <null> <null> (libstdc++.so.6+0x0000000b696f)\r\n\r\n  Location is heap block of size 480 at 0x7d500053fc00 allocated by thread T23:\r\n    #0 operator new(unsigned long) /llvm/projects/compiler-rt/lib/tsan/rtl/tsan_new_delete.cc:45 (client_channel_stress_test+0x0000004b8de3)\r\n    #1 testing::UnitTest::UnitTest() /var/local/git/grpc/third_party/googletest/googletest/src/gtest.cc:4300:11 (client_channel_stress_test+0x000000ae9ba9)\r\n    #2 testing::UnitTest::GetInstance() /var/local/git/grpc/third_party/googletest/googletest/src/gtest.cc:3988:19 (client_channel_stress_test+0x000000acf4da)\r\n    #3 testing::internal::AssertHelper::operator=(testing::Message const&) const /var/local/git/grpc/third_party/googletest/googletest/src/gtest.cc:374:3 (client_channel_stress_test+0x000000acf2eb)\r\n    #4 grpc::testing::TestServiceImpl::Echo(grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*) /var/local/git/grpc/test/cpp/end2end/test_service_impl.cc:130:385 (client_channel_stress_test+0x00000053e628)\r\n    #5 grpc::Status std::_Mem_fn<grpc::Status (grpc::testing::EchoTestService::Service::*)(grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*)>::operator()<grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*, void>(grpc::testing::EchoTestService::Service*, grpc::ServerContext*&&, grpc::testing::EchoRequest const*&&, grpc::testing::EchoResponse*&&) const /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:569:11 (client_channel_stress_test+0x0000005323ba)\r\n    #6 std::_Function_handler<grpc::Status (grpc::testing::EchoTestService::Service*, grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*), std::_Mem_fn<grpc::Status (grpc::testing::EchoTestService::Service::*)(grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*)> >::_M_invoke(std::_Any_data const&, grpc::testing::EchoTestService::Service*, grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*) /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:2024:9 (client_channel_stress_test+0x000000531fe2)\r\n    #7 std::function<grpc::Status (grpc::testing::EchoTestService::Service*, grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*)>::operator()(grpc::testing::EchoTestService::Service*, grpc::ServerContext*, grpc::testing::EchoRequest const*, grpc::testing::EchoResponse*) const /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:2439:14 (client_channel_stress_test+0x000000533039)\r\n    #8 grpc::internal::RpcMethodHandler<grpc::testing::EchoTestService::Service, grpc::testing::EchoRequest, grpc::testing::EchoResponse>::RunHandler(grpc::internal::MethodHandler::HandlerParameter const&) /var/local/git/grpc/include/grpc++/impl/codegen/method_handler_impl.h:46:16 (client_channel_stress_test+0x00000053297c)\r\n    #9 grpc::Server::SyncRequest::CallData::Run(std::shared_ptr<grpc::Server::GlobalCallbacks>) /var/local/git/grpc/src/cpp/server/server_cc.cc:216:7 (client_channel_stress_test+0x0000005dda43)\r\n    #10 grpc::Server::SyncRequestThreadManager::DoWork(void*, bool) /var/local/git/grpc/src/cpp/server/server_cc.cc:308:7 (client_channel_stress_test+0x0000005dc5c7)\r\n    #11 grpc::ThreadManager::MainWorkLoop() /var/local/git/grpc/src/cpp/thread_manager/thread_manager.cc:152:9 (client_channel_stress_test+0x0000005eada7)\r\n    #12 grpc::ThreadManager::WorkerThread::Run() /var/local/git/grpc/src/cpp/thread_manager/thread_manager.cc:38:3 (client_channel_stress_test+0x0000005eaaee)\r\n    #13 void std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()>::operator()<, void>(grpc::ThreadManager::WorkerThread*) const /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:569:11 (client_channel_stress_test+0x0000005edc9b)\r\n    #14 void std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)>::_M_invoke<0ul>(std::_Index_tuple<0ul>) /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:1699:18 (client_channel_stress_test+0x0000005edb85)\r\n    #15 std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)>::operator()() /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:1688:16 (client_channel_stress_test+0x0000005edb08)\r\n    #16 std::thread::_Impl<std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)> >::_M_run() /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/thread:115:13 (client_channel_stress_test+0x0000005ed65c)\r\n    #17 <null> <null> (libstdc++.so.6+0x0000000b696f)\r\n\r\n  Thread T11 (tid=26230, running) created by thread T10 at:\r\n    #0 pthread_create /llvm/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:954 (client_channel_stress_test+0x000000457e53)\r\n    #1 std::thread::_M_start_thread(std::shared_ptr<std::thread::_Impl_base>) <null> (libstdc++.so.6+0x0000000b6a90)\r\n    #2 grpc::ThreadManager::WorkerThread::WorkerThread(grpc::ThreadManager*) /var/local/git/grpc/src/cpp/thread_manager/thread_manager.cc:34:10 (client_channel_stress_test+0x0000005eaa3a)\r\n    #3 grpc::ThreadManager::Initialize() /var/local/git/grpc/src/cpp/thread_manager/thread_manager.cc:114:9 (client_channel_stress_test+0x0000005eb7d3)\r\n    #4 grpc::Server::SyncRequestThreadManager::Start() /var/local/git/grpc/src/cpp/server/server_cc.cc:351:7 (client_channel_stress_test+0x0000005da3b9)\r\n    #5 grpc::Server::Start(grpc::ServerCompletionQueue**, unsigned long) /var/local/git/grpc/src/cpp/server/server_cc.cc:553:5 (client_channel_stress_test+0x0000005d6e92)\r\n    #6 grpc::ServerBuilder::BuildAndStart() /var/local/git/grpc/src/cpp/server/server_builder.cc:344:3 (client_channel_stress_test+0x0000005c3a45)\r\n    #7 grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::Start(std::string const&, std::mutex*, std::condition_variable*) /var/local/git/grpc/test/cpp/client/client_channel_stress_test.cc:192:17 (client_channel_stress_test+0x0000004f530b)\r\n    #8 void std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)>::operator()<std::string&, std::mutex*&, std::condition_variable*&, void>(grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string&, std::mutex*&, std::condition_variable*&) const /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:569:11 (client_channel_stress_test+0x0000004f7870)\r\n    #9 void std::_Bind<std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)> (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string, std::mutex*, std::condition_variable*)>::__call<void, , 0ul, 1ul, 2ul, 3ul>(std::tuple<>&&, std::_Index_tuple<0ul, 1ul, 2ul, 3ul>) /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:1263:11 (client_channel_stress_test+0x0000004f76fc)\r\n    #10 void std::_Bind<std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)> (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string, std::mutex*, std::condition_variable*)>::operator()<, void>() /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:1321:11 (client_channel_stress_test+0x0000004f75b9)\r\n    #11 void std::_Bind_simple<std::_Bind<std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)> (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string, std::mutex*, std::condition_variable*)> ()>::_M_invoke<>(std::_Index_tuple<>) /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:1699:18 (client_channel_stress_test+0x0000004f7528)\r\n    #12 std::_Bind_simple<std::_Bind<std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)> (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string, std::mutex*, std::condition_variable*)> ()>::operator()() /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:1688:16 (client_channel_stress_test+0x0000004f74d8)\r\n    #13 std::thread::_Impl<std::_Bind_simple<std::_Bind<std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)> (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string, std::mutex*, std::condition_variable*)> ()> >::_M_run() /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/thread:115:13 (client_channel_stress_test+0x0000004f701c)\r\n    #14 <null> <null> (libstdc++.so.6+0x0000000b696f)\r\n\r\n  Thread T23 (tid=26250, running) created by thread T22 at:\r\n    #0 pthread_create /llvm/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:954 (client_channel_stress_test+0x000000457e53)\r\n    #1 std::thread::_M_start_thread(std::shared_ptr<std::thread::_Impl_base>) <null> (libstdc++.so.6+0x0000000b6a90)\r\n    #2 grpc::ThreadManager::WorkerThread::WorkerThread(grpc::ThreadManager*) /var/local/git/grpc/src/cpp/thread_manager/thread_manager.cc:34:10 (client_channel_stress_test+0x0000005eaa3a)\r\n    #3 grpc::ThreadManager::Initialize() /var/local/git/grpc/src/cpp/thread_manager/thread_manager.cc:114:9 (client_channel_stress_test+0x0000005eb7d3)\r\n    #4 grpc::Server::SyncRequestThreadManager::Start() /var/local/git/grpc/src/cpp/server/server_cc.cc:351:7 (client_channel_stress_test+0x0000005da3b9)\r\n    #5 grpc::Server::Start(grpc::ServerCompletionQueue**, unsigned long) /var/local/git/grpc/src/cpp/server/server_cc.cc:553:5 (client_channel_stress_test+0x0000005d6e92)\r\n    #6 grpc::ServerBuilder::BuildAndStart() /var/local/git/grpc/src/cpp/server/server_builder.cc:344:3 (client_channel_stress_test+0x0000005c3a45)\r\n    #7 grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::Start(std::string const&, std::mutex*, std::condition_variable*) /var/local/git/grpc/test/cpp/client/client_channel_stress_test.cc:192:17 (client_channel_stress_test+0x0000004f530b)\r\n    #8 void std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)>::operator()<std::string&, std::mutex*&, std::condition_variable*&, void>(grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string&, std::mutex*&, std::condition_variable*&) const /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:569:11 (client_channel_stress_test+0x0000004f7870)\r\n    #9 void std::_Bind<std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)> (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string, std::mutex*, std::condition_variable*)>::__call<void, , 0ul, 1ul, 2ul, 3ul>(std::tuple<>&&, std::_Index_tuple<0ul, 1ul, 2ul, 3ul>) /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:1263:11 (client_channel_stress_test+0x0000004f76fc)\r\n    #10 void std::_Bind<std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)> (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string, std::mutex*, std::condition_variable*)>::operator()<, void>() /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:1321:11 (client_channel_stress_test+0x0000004f75b9)\r\n    #11 void std::_Bind_simple<std::_Bind<std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)> (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string, std::mutex*, std::condition_variable*)> ()>::_M_invoke<>(std::_Index_tuple<>) /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:1699:18 (client_channel_stress_test+0x0000004f7528)\r\n    #12 std::_Bind_simple<std::_Bind<std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)> (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string, std::mutex*, std::condition_variable*)> ()>::operator()() /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/functional:1688:16 (client_channel_stress_test+0x0000004f74d8)\r\n    #13 std::thread::_Impl<std::_Bind_simple<std::_Bind<std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)> (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string, std::mutex*, std::condition_variable*)> ()> >::_M_run() /usr/bin/../lib/gcc/x86_64-linux-gnu/4.9/../../../../include/c++/4.9/thread:115:13 (client_channel_stress_test+0x0000004f701c)\r\n    #14 <null> <null> (libstdc++.so.6+0x0000000b696f)\r\n\r\nSUMMARY: ThreadSanitizer: data race /var/local/git/grpc/third_party/googletest/googletest/src/gtest.cc:4919:7 in testing::internal::UnitTestImpl::os_stack_trace_getter()\r\n==================\r\nCommand exited with non-zero status 66\r\nreal 50.19\r\nuser 57.05\r\nsys 11.52\r\n\r\n2017-11-17 02:45:10,428 FAILED: bins/tsan/client_channel_stress_test GRPC_POLL_STRATEGY=poll-cv [ret=66, pid=26165, time=50.2sec]\r\n```"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/345412955",
    "html_url": "https://github.com/grpc/grpc/issues/13441#issuecomment-345412955",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13441",
    "id": 345412955,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NTQxMjk1NQ==",
    "user": {
      "login": "AspirinSJL",
      "id": 3314176,
      "node_id": "MDQ6VXNlcjMzMTQxNzY=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/3314176?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AspirinSJL",
      "html_url": "https://github.com/AspirinSJL",
      "followers_url": "https://api.github.com/users/AspirinSJL/followers",
      "following_url": "https://api.github.com/users/AspirinSJL/following{/other_user}",
      "gists_url": "https://api.github.com/users/AspirinSJL/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AspirinSJL/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AspirinSJL/subscriptions",
      "organizations_url": "https://api.github.com/users/AspirinSJL/orgs",
      "repos_url": "https://api.github.com/users/AspirinSJL/repos",
      "events_url": "https://api.github.com/users/AspirinSJL/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AspirinSJL/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-18T02:46:28Z",
    "updated_at": "2017-11-18T02:46:28Z",
    "author_association": "MEMBER",
    "body": "I can't reproduce this failure on my machine. Just looking at the given log, I think this tsan failure seems related to gtest itself. It should be safe for multiple `ServerThread` instances to call `UnitTestImpl::os_stack_trace_getter()`, I think. After all, `UnitTestImpl` is a global singleton.\r\n\r\nBut I do see another tsan failure.\r\n\r\n```\r\nWARNING: ThreadSanitizer: data race (pid=139375)\r\n  Write of size 1 at 0x7d5400008f78 by thread T14 (mutexes: write M101900):\r\n    #0 grpc_resource_user_alloc /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/resource_quota.cc:825:33 (client_channel_stress_test+0x00000055cc6d)\r\n    #1 grpc_resource_user_alloc_slices /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/resource_quota.cc:896:3 (client_channel_stress_test+0x00000055d6a5)\r\n    #2 tcp_continue_read(grpc_exec_ctx*, grpc_tcp*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/tcp_posix.cc:476:5 (client_channel_stress_test+0x000000566c00)\r\n    #3 tcp_handle_read(grpc_exec_ctx*, void*, grpc_error*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/tcp_posix.cc:501:5 (client_channel_stress_test+0x0000005666e5)\r\n    #4 exec_ctx_run(grpc_exec_ctx*, grpc_closure*, grpc_error*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/exec_ctx.cc:70:3 (client_channel_stress_test+0x0000005563a3)\r\n    #5 grpc_exec_ctx_flush /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/exec_ctx.cc:90:9 (client_channel_stress_test+0x0000005560e7)\r\n    #6 end_worker(grpc_exec_ctx*, grpc_pollset*, grpc_pollset_worker*, grpc_pollset_worker**) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/ev_epoll1_linux.cc:880:9 (client_channel_stress_test+0x000000589fcf)\r\n    #7 pollset_work(grpc_exec_ctx*, grpc_pollset*, grpc_pollset_worker**, long) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/ev_epoll1_linux.cc:984:3 (client_channel_stress_test+0x0000005861fc)\r\n    #8 grpc_pollset_work /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/ev_posix.cc:238:10 (client_channel_stress_test+0x0000005553a2)\r\n    #9 cq_next(grpc_completion_queue*, gpr_timespec, void*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/surface/completion_queue.cc:964:23 (client_channel_stress_test+0x000000616e81)\r\n    #10 grpc_completion_queue_next /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/surface/completion_queue.cc:1045:10 (client_channel_stress_test+0x0000006156e6)\r\n    #11 grpc::CompletionQueue::AsyncNextInternal(void**, bool*, gpr_timespec) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/common/completion_queue_cc.cc:56:15 (client_channel_stress_test+0x0000005f2bf9)\r\n    #12 grpc::CompletionQueue::NextStatus grpc::CompletionQueue::AsyncNext<gpr_timespec>(void**, bool*, gpr_timespec const&) /usr/local/google/home/juanlishen/wip/stress_test/grpc/include/grpc++/impl/codegen/completion_queue.h:157:12 (client_channel_stress_test+0x0000005d0d25)\r\n    #13 grpc::Server::SyncRequestThreadManager::PollForWork(void**, bool*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/server/server_cc.cc:276:13 (client_channel_stress_test+0x0000005d2b0d)\r\n    #14 grpc::ThreadManager::MainWorkLoop() /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/thread_manager/thread_manager.cc:122:30 (client_channel_stress_test+0x0000005e1168)\r\n    #15 grpc::ThreadManager::WorkerThread::Run() /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/thread_manager/thread_manager.cc:38:3 (client_channel_stress_test+0x0000005e10ee)\r\n    #16 void std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()>::operator()<, void>(grpc::ThreadManager::WorkerThread*) const /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:601:11 (client_channel_stress_test+0x0000005e428b)\r\n    #17 void std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)>::_M_invoke<0ul>(std::_Index_tuple<0ul>) /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:1731:18 (client_channel_stress_test+0x0000005e4175)\r\n    #18 std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)>::operator()() /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:1720:16 (client_channel_stress_test+0x0000005e40f8)\r\n    #19 std::thread::_Impl<std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)> >::_M_run() /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/thread:115:13 (client_channel_stress_test+0x0000005e3c4c)\r\n    #20 execute_native_thread_routine /build/gcc-4.8-mW1ufQ/gcc-4.8-4.8.4/build/x86_64-linux-gnu/libstdc++-v3/src/c++11/../../../../../src/libstdc++-v3/src/c++11/thread.cc:84 (libstdc++.so.6+0x0000000b1a5f)\r\n\r\n  Previous read of size 1 at 0x7d5400008f78 by thread T1:\r\n    #0 ru_shutdown(grpc_exec_ctx*, void*, grpc_error*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/resource_quota.cc:530:22 (client_channel_stress_test+0x00000055c992)\r\n    #1 closure_impl::closure_wrapper(grpc_exec_ctx*, void*, grpc_error*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/./src/core/lib/iomgr/closure.h:157:3 (client_channel_stress_test+0x00000054369e)\r\n    #2 grpc_combiner_continue_exec_ctx /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/combiner.cc:261:5 (client_channel_stress_test+0x00000054e477)\r\n    #3 grpc_exec_ctx_flush /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/exec_ctx.cc:93:17 (client_channel_stress_test+0x000000556102)\r\n    #4 run_closures(grpc_exec_ctx*, grpc_closure_list) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/executor.cc:81:5 (client_channel_stress_test+0x000000557ba9)\r\n    #5 executor_thread(void*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/executor.cc:182:22 (client_channel_stress_test+0x0000005578e5)\r\n    #6 thread_body(void*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/support/thd_posix.cc:42:3 (client_channel_stress_test+0x0000005ecc7d)\r\n\r\n  Location is heap block of size 616 at 0x7d5400008e80 allocated by thread T139:\r\n    #0 malloc /home/development/llvm/3.8.1/final/llvm.src/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:595:5 (client_channel_stress_test+0x000000429f5d)\r\n    #1 gpr_malloc /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/support/alloc.cc:56:7 (client_channel_stress_test+0x0000005e7afd)\r\n    #2 grpc_resource_user_create /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/resource_quota.cc:726:28 (client_channel_stress_test+0x00000055b61a)\r\n    #3 grpc_tcp_create /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/tcp_posix.cc:804:24 (client_channel_stress_test+0x0000005651fa)\r\n    #4 grpc_tcp_client_create_from_fd /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/tcp_client_posix.cc:126:10 (client_channel_stress_test+0x000000562df8)\r\n    #5 on_writable(grpc_exec_ctx*, void*, grpc_error*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/tcp_client_posix.cc:176:13 (client_channel_stress_test+0x00000056401e)\r\n    #6 exec_ctx_run(grpc_exec_ctx*, grpc_closure*, grpc_error*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/exec_ctx.cc:70:3 (client_channel_stress_test+0x0000005563a3)\r\n    #7 grpc_exec_ctx_flush /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/exec_ctx.cc:90:9 (client_channel_stress_test+0x0000005560e7)\r\n    #8 end_worker(grpc_exec_ctx*, grpc_pollset*, grpc_pollset_worker*, grpc_pollset_worker**) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/ev_epoll1_linux.cc:913:7 (client_channel_stress_test+0x00000058a2f8)\r\n    #9 pollset_work(grpc_exec_ctx*, grpc_pollset*, grpc_pollset_worker**, long) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/ev_epoll1_linux.cc:984:3 (client_channel_stress_test+0x0000005861fc)\r\n    #10 grpc_pollset_work /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/ev_posix.cc:238:10 (client_channel_stress_test+0x0000005553a2)\r\n    #11 cq_next(grpc_completion_queue*, gpr_timespec, void*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/surface/completion_queue.cc:964:23 (client_channel_stress_test+0x000000616e81)\r\n    #12 grpc_completion_queue_next /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/surface/completion_queue.cc:1045:10 (client_channel_stress_test+0x0000006156e6)\r\n    #13 grpc::CompletionQueue::AsyncNextInternal(void**, bool*, gpr_timespec) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/common/completion_queue_cc.cc:56:15 (client_channel_stress_test+0x0000005f2bf9)\r\n    #14 grpc::CompletionQueue::NextStatus grpc::CompletionQueue::AsyncNext<gpr_timespec>(void**, bool*, gpr_timespec const&) /usr/local/google/home/juanlishen/wip/stress_test/grpc/include/grpc++/impl/codegen/completion_queue.h:157:12 (client_channel_stress_test+0x0000005d0d25)\r\n    #15 grpc::Server::SyncRequestThreadManager::PollForWork(void**, bool*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/server/server_cc.cc:276:13 (client_channel_stress_test+0x0000005d2b0d)\r\n    #16 grpc::ThreadManager::MainWorkLoop() /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/thread_manager/thread_manager.cc:122:30 (client_channel_stress_test+0x0000005e1168)\r\n    #17 grpc::ThreadManager::WorkerThread::Run() /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/thread_manager/thread_manager.cc:38:3 (client_channel_stress_test+0x0000005e10ee)\r\n    #18 void std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()>::operator()<, void>(grpc::ThreadManager::WorkerThread*) const /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:601:11 (client_channel_stress_test+0x0000005e428b)\r\n    #19 void std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)>::_M_invoke<0ul>(std::_Index_tuple<0ul>) /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:1731:18 (client_channel_stress_test+0x0000005e4175)\r\n    #20 std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)>::operator()() /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:1720:16 (client_channel_stress_test+0x0000005e40f8)\r\n    #21 std::thread::_Impl<std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)> >::_M_run() /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/thread:115:13 (client_channel_stress_test+0x0000005e3c4c)\r\n    #22 execute_native_thread_routine /build/gcc-4.8-mW1ufQ/gcc-4.8-4.8.4/build/x86_64-linux-gnu/libstdc++-v3/src/c++11/../../../../../src/libstdc++-v3/src/c++11/thread.cc:84 (libstdc++.so.6+0x0000000b1a5f)\r\n\r\n  Mutex M101900 (0x7d5400008f38) created at:\r\n    #0 pthread_mutex_init /home/development/llvm/3.8.1/final/llvm.src/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:1169:3 (client_channel_stress_test+0x00000042e590)\r\n    #1 gpr_mu_init /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/support/sync_posix.cc:37:3 (client_channel_stress_test+0x0000005ec0bc)\r\n    #2 grpc_resource_user_create /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/resource_quota.cc:743:3 (client_channel_stress_test+0x00000055b932)\r\nI1117 15:23:56.523492706  139379 grpclb.cc:536]              Missing LB token for backend address 'ipv4:127.0.0.1:24096'. The empty token will be used instead\r\nI1117 15:23:56.523514094  139379 grpclb.cc:536]              Missing LB token for backend address 'ipv4:127.0.0.1:4775'. The empty token will be used instead\r\nI1117 15:23:56.523523840  139379 grpclb.cc:536]              Missing LB token for backend address 'ipv4:127.0.0.1:4775'. The empty token will be used instead\r\nI1117 15:23:56.523532167  139379 grpclb.cc:536]              Missing LB token for backend address 'ipv4:127.0.0.1:31528'. The empty token will be used instead\r\n    #3 grpc_tcp_create /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/tcp_posix.cc:804:24 (client_channel_stress_test+0x0000005651fa)\r\nI1117 15:23:56.523540360  139379 grpclb.cc:536]              Missing LB token for backend address 'ipv4:127.0.0.1:4775'. The empty token will be used instead\r\nI1117 15:23:56.523550607  139379 grpclb.cc:536]              Missing LB token for backend address 'ipv4:127.0.0.1:18436'. The empty token will be used instead\r\nI1117 15:23:56.523558044  139379 grpclb.cc:536]              Missing LB token for backend address 'ipv4:127.0.0.1:18436'. The empty token will be used instead\r\nI1117 15:23:56.523565301  139379 grpclb.cc:536]              Missing LB token for backend address 'ipv4:127.0.0.1:18436'. The empty token will be used instead\r\nI1117 15:23:56.523579635  139379 grpclb.cc:536]              Missing LB token for backend address 'ipv4:127.0.0.1:24096'. The empty token will be used instead\r\nI1117 15:23:56.523588518  139379 grpclb.cc:536]              Missing LB token for backend address 'ipv4:127.0.0.1:9889'. The empty token will be used instead\r\nI1117 15:23:56.523598711  139379 grpclb.cc:536]              Missing LB token for backend address 'ipv4:127.0.0.1:13907'. The empty token will be used instead\r\nI1117 15:23:56.523608780  139379 grpclb.cc:536]              Missing LB token for backend address 'ipv4:127.0.0.1:18436'. The empty token will be used instead\r\nI1117 15:23:56.523616078  139379 grpclb.cc:536]              Missing LB token for backend address 'ipv4:127.0.0.1:13907'. The empty token will be used instead\r\nI1117 15:23:56.523623237  139379 grpclb.cc:536]              Missing LB token for backend address 'ipv4:127.0.0.1:10593'. The empty token will be used instead\r\n    #4 grpc_tcp_client_create_from_fd /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/tcp_client_posix.cc:126:10 (client_channel_stress_test+0x000000562df8)\r\n    #5 on_writable(grpc_exec_ctx*, void*, grpc_error*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/tcp_client_posix.cc:176:13 (client_channel_stress_test+0x00000056401e)\r\n    #6 exec_ctx_run(grpc_exec_ctx*, grpc_closure*, grpc_error*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/exec_ctx.cc:70:3 (client_channel_stress_test+0x0000005563a3)\r\n    #7 grpc_exec_ctx_flush /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/exec_ctx.cc:90:9 (client_channel_stress_test+0x0000005560e7)\r\n    #8 end_worker(grpc_exec_ctx*, grpc_pollset*, grpc_pollset_worker*, grpc_pollset_worker**) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/ev_epoll1_linux.cc:913:7 (client_channel_stress_test+0x00000058a2f8)\r\n    #9 pollset_work(grpc_exec_ctx*, grpc_pollset*, grpc_pollset_worker**, long) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/ev_epoll1_linux.cc:984:3 (client_channel_stress_test+0x0000005861fc)\r\n    #10 grpc_pollset_work /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/ev_posix.cc:238:10 (client_channel_stress_test+0x0000005553a2)\r\n    #11 cq_next(grpc_completion_queue*, gpr_timespec, void*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/surface/completion_queue.cc:964:23 (client_channel_stress_test+0x000000616e81)\r\n    #12 grpc_completion_queue_next /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/surface/completion_queue.cc:1045:10 (client_channel_stress_test+0x0000006156e6)\r\n    #13 grpc::CompletionQueue::AsyncNextInternal(void**, bool*, gpr_timespec) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/common/completion_queue_cc.cc:56:15 (client_channel_stress_test+0x0000005f2bf9)\r\n    #14 grpc::CompletionQueue::NextStatus grpc::CompletionQueue::AsyncNext<gpr_timespec>(void**, bool*, gpr_timespec const&) /usr/local/google/home/juanlishen/wip/stress_test/grpc/include/grpc++/impl/codegen/completion_queue.h:157:12 (client_channel_stress_test+0x0000005d0d25)\r\n    #15 grpc::Server::SyncRequestThreadManager::PollForWork(void**, bool*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/server/server_cc.cc:276:13 (client_channel_stress_test+0x0000005d2b0d)\r\n    #16 grpc::ThreadManager::MainWorkLoop() /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/thread_manager/thread_manager.cc:122:30 (client_channel_stress_test+0x0000005e1168)\r\n    #17 grpc::ThreadManager::WorkerThread::Run() /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/thread_manager/thread_manager.cc:38:3 (client_channel_stress_test+0x0000005e10ee)\r\n    #18 void std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()>::operator()<, void>(grpc::ThreadManager::WorkerThread*) const /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:601:11 (client_channel_stress_test+0x0000005e428b)\r\n    #19 void std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)>::_M_invoke<0ul>(std::_Index_tuple<0ul>) /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:1731:18 (client_channel_stress_test+0x0000005e4175)\r\n    #20 std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)>::operator()() /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:1720:16 (client_channel_stress_test+0x0000005e40f8)\r\n    #21 std::thread::_Impl<std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)> >::_M_run() /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/thread:115:13 (client_channel_stress_test+0x0000005e3c4c)\r\n    #22 execute_native_thread_routine /build/gcc-4.8-mW1ufQ/gcc-4.8-4.8.4/build/x86_64-linux-gnu/libstdc++-v3/src/c++11/../../../../../src/libstdc++-v3/src/c++11/thread.cc:84 (libstdc++.so.6+0x0000000b1a5f)\r\n\r\n  Thread T14 (tid=139401, running) created by thread T13 at:\r\n    #0 pthread_create /home/development/llvm/3.8.1/final/llvm.src/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:954:3 (client_channel_stress_test+0x00000042cf31)\r\n    #1 __gthread_create /build/gcc-4.8-mW1ufQ/gcc-4.8-4.8.4/build/x86_64-linux-gnu/libstdc++-v3/include/x86_64-linux-gnu/bits/gthr-default.h:662 (libstdc++.so.6+0x0000000b1cae)\r\n    #2 std::thread::_M_start_thread(std::shared_ptr<std::thread::_Impl_base>) /build/gcc-4.8-mW1ufQ/gcc-4.8-4.8.4/build/x86_64-linux-gnu/libstdc++-v3/src/c++11/../../../../../src/libstdc++-v3/src/c++11/thread.cc:142 (libstdc++.so.6+0x0000000b1cae)\r\n    #3 grpc::ThreadManager::WorkerThread::WorkerThread(grpc::ThreadManager*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/thread_manager/thread_manager.cc:34:10 (client_channel_stress_test+0x0000005e103a)\r\n    #4 grpc::ThreadManager::Initialize() /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/thread_manager/thread_manager.cc:114:9 (client_channel_stress_test+0x0000005e1e13)\r\n    #5 grpc::Server::SyncRequestThreadManager::Start() /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/server/server_cc.cc:351:7 (client_channel_stress_test+0x0000005d0bb9)\r\n    #6 grpc::Server::Start(grpc::ServerCompletionQueue**, unsigned long) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/server/server_cc.cc:553:5 (client_channel_stress_test+0x0000005cd5f2)\r\n    #7 grpc::ServerBuilder::BuildAndStart() /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/server/server_builder.cc:344:3 (client_channel_stress_test+0x0000005ba744)\r\n    #8 grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::Start(std::string const&, std::mutex*, std::condition_variable*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/test/cpp/client/client_channel_stress_test.cc:192:17 (client_channel_stress_test+0x0000004eda7b)\r\n    #9 void std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)>::operator()<std::string&, std::mutex*&, std::condition_variable*&, void>(grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string&, std::mutex*&, std::condition_variable*&) const /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:601:11 (client_channel_stress_test+0x0000004efe10)\r\n    #10 void std::_Bind<std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)> (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string, std::mutex*, std::condition_variable*)>::__call<void, , 0ul, 1ul, 2ul, 3ul>(std::tuple<>&&, std::_Index_tuple<0ul, 1ul, 2ul, 3ul>) /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:1295:11 (client_channel_stress_test+0x0000004efc9c)\r\n    #11 void std::_Bind<std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)> (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string, std::mutex*, std::condition_variable*)>::operator()<, void>() /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:1353:11 (client_channel_stress_test+0x0000004efb59)\r\n    #12 void std::_Bind_simple<std::_Bind<std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)> (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string, std::mutex*, std::condition_variable*)> ()>::_M_invoke<>(std::_Index_tuple<>) /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:1731:18 (client_channel_stress_test+0x0000004efac8)\r\n    #13 std::_Bind_simple<std::_Bind<std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)> (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string, std::mutex*, std::condition_variable*)> ()>::operator()() /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:1720:16 (client_channel_stress_test+0x0000004efa78)\r\n    #14 std::thread::_Impl<std::_Bind_simple<std::_Bind<std::_Mem_fn<void (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>::*)(std::string const&, std::mutex*, std::condition_variable*)> (grpc::testing::(anonymous namespace)::ClientChannelStressTest::ServerThread<grpc::testing::TestServiceImpl>*, std::string, std::mutex*, std::condition_variable*)> ()> >::_M_run() /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/thread:115:13 (client_channel_stress_test+0x0000004ef5bc)\r\n    #15 execute_native_thread_routine /build/gcc-4.8-mW1ufQ/gcc-4.8-4.8.4/build/x86_64-linux-gnu/libstdc++-v3/src/c++11/../../../../../src/libstdc++-v3/src/c++11/thread.cc:84 (libstdc++.so.6+0x0000000b1a5f)\r\n\r\n  Thread T1 (tid=139379, running) created by main thread at:\r\n    #0 pthread_create /home/development/llvm/3.8.1/final/llvm.src/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:954:3 (client_channel_stress_test+0x00000042cf31)\r\n    #1 gpr_thd_new /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/support/thd_posix.cc:66:21 (client_channel_stress_test+0x0000005ecb63)\r\n    #2 grpc_executor_set_threading /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/executor.cc:108:5 (client_channel_stress_test+0x000000556f1a)\r\n    #3 grpc_executor_init /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/executor.cc:139:3 (client_channel_stress_test+0x000000557c33)\r\n    #4 grpc_iomgr_init /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/iomgr.cc:53:3 (client_channel_stress_test+0x00000055880e)\r\n    #5 grpc_init /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/surface/init.cc:154:5 (client_channel_stress_test+0x0000005fbd3a)\r\n    #6 main /usr/local/google/home/juanlishen/wip/stress_test/grpc/test/cpp/client/client_channel_stress_test.cc:323:3 (client_channel_stress_test+0x0000004e8233)\r\n\r\n  Thread T139 (tid=139586, running) created by thread T18 at:\r\n    #0 pthread_create /home/development/llvm/3.8.1/final/llvm.src/projects/compiler-rt/lib/tsan/rtl/tsan_interceptors.cc:954:3 (client_channel_stress_test+0x00000042cf31)\r\n    #1 __gthread_create /build/gcc-4.8-mW1ufQ/gcc-4.8-4.8.4/build/x86_64-linux-gnu/libstdc++-v3/include/x86_64-linux-gnu/bits/gthr-default.h:662 (libstdc++.so.6+0x0000000b1cae)\r\n    #2 std::thread::_M_start_thread(std::shared_ptr<std::thread::_Impl_base>) /build/gcc-4.8-mW1ufQ/gcc-4.8-4.8.4/build/x86_64-linux-gnu/libstdc++-v3/src/c++11/../../../../../src/libstdc++-v3/src/c++11/thread.cc:142 (libstdc++.so.6+0x0000000b1cae)\r\n    #3 grpc::ThreadManager::WorkerThread::WorkerThread(grpc::ThreadManager*) /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/thread_manager/thread_manager.cc:34:10 (client_channel_stress_test+0x0000005e103a)\r\n    #4 grpc::ThreadManager::MainWorkLoop() /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/thread_manager/thread_manager.cc:146:15 (client_channel_stress_test+0x0000005e1316)\r\n    #5 grpc::ThreadManager::WorkerThread::Run() /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/cpp/thread_manager/thread_manager.cc:38:3 (client_channel_stress_test+0x0000005e10ee)\r\n    #6 void std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()>::operator()<, void>(grpc::ThreadManager::WorkerThread*) const /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:601:11 (client_channel_stress_test+0x0000005e428b)\r\n    #7 void std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)>::_M_invoke<0ul>(std::_Index_tuple<0ul>) /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:1731:18 (client_channel_stress_test+0x0000005e4175)\r\n    #8 std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)>::operator()() /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/functional:1720:16 (client_channel_stress_test+0x0000005e40f8)\r\n    #9 std::thread::_Impl<std::_Bind_simple<std::_Mem_fn<void (grpc::ThreadManager::WorkerThread::*)()> (grpc::ThreadManager::WorkerThread*)> >::_M_run() /usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../include/c++/4.8/thread:115:13 (client_channel_stress_test+0x0000005e3c4c)\r\n    #10 execute_native_thread_routine /build/gcc-4.8-mW1ufQ/gcc-4.8-4.8.4/build/x86_64-linux-gnu/libstdc++-v3/src/c++11/../../../../../src/libstdc++-v3/src/c++11/thread.cc:84 (libstdc++.so.6+0x0000000b1a5f)\r\n\r\nSUMMARY: ThreadSanitizer: data race /usr/local/google/home/juanlishen/wip/stress_test/grpc/src/core/lib/iomgr/resource_quota.cc:825:33 in grpc_resource_user_alloc\r\n\r\n```"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/362337456",
    "html_url": "https://github.com/grpc/grpc/issues/13441#issuecomment-362337456",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13441",
    "id": 362337456,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MjMzNzQ1Ng==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-01T17:17:03Z",
    "updated_at": "2018-02-01T17:17:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "https://sponge.corp.google.com/invocation?id=cc270bcf-4878-406e-9558-dc1c17ce3852"
  },
  {
    "url": "https://api.github.com/repos/grpc/grpc/issues/comments/367342733",
    "html_url": "https://github.com/grpc/grpc/issues/13441#issuecomment-367342733",
    "issue_url": "https://api.github.com/repos/grpc/grpc/issues/13441",
    "id": 367342733,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NzM0MjczMw==",
    "user": {
      "login": "jtattermusch",
      "id": 9939684,
      "node_id": "MDQ6VXNlcjk5Mzk2ODQ=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/9939684?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtattermusch",
      "html_url": "https://github.com/jtattermusch",
      "followers_url": "https://api.github.com/users/jtattermusch/followers",
      "following_url": "https://api.github.com/users/jtattermusch/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtattermusch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtattermusch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtattermusch/subscriptions",
      "organizations_url": "https://api.github.com/users/jtattermusch/orgs",
      "repos_url": "https://api.github.com/users/jtattermusch/repos",
      "events_url": "https://api.github.com/users/jtattermusch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtattermusch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-21T14:26:36Z",
    "updated_at": "2018-02-21T14:26:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "Not seen since 2018-01-11."
  }
]
