[
  {
    "url": "https://api.github.com/repos/OpenRA/OpenRA/issues/comments/137275596",
    "html_url": "https://github.com/OpenRA/OpenRA/issues/8794#issuecomment-137275596",
    "issue_url": "https://api.github.com/repos/OpenRA/OpenRA/issues/8794",
    "id": 137275596,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzI3NTU5Ng==",
    "user": {
      "login": "RoosterDragon",
      "id": 3399086,
      "node_id": "MDQ6VXNlcjMzOTkwODY=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/3399086?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RoosterDragon",
      "html_url": "https://github.com/RoosterDragon",
      "followers_url": "https://api.github.com/users/RoosterDragon/followers",
      "following_url": "https://api.github.com/users/RoosterDragon/following{/other_user}",
      "gists_url": "https://api.github.com/users/RoosterDragon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RoosterDragon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RoosterDragon/subscriptions",
      "organizations_url": "https://api.github.com/users/RoosterDragon/orgs",
      "repos_url": "https://api.github.com/users/RoosterDragon/repos",
      "events_url": "https://api.github.com/users/RoosterDragon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RoosterDragon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-02T23:51:29Z",
    "updated_at": "2015-09-02T23:51:29Z",
    "author_association": "MEMBER",
    "body": "tl;dr: To stop this happening, disable network discovery in the game settings.\n\n---\n\nI dig some digging. If a network device sends back an invalid response about port forwarding related things then Mono.Nat will crash our process and there's not much we can do to prevent it from doing so. More details below.\n\nWhen we call `NatDevice.GetAllMappings()` in [UPnP.cs](https://github.com/OpenRA/OpenRA/blob/8114a537608a6d441390f0b90396f19897edb44e/OpenRA.Game/Network/UPnP.cs#L67), this sends some HTTP requests to devices asking for the current mappings.\n\nAs the stack trace above shows, a worker thread is used in order to process these web requests asynchronously.\n\nUnfortunately for us, Mono.Nat expects XML back from this web request, and if it doesn't get XML it doesn't bother handling the exception.\n\nHowever, since the exception occurs on a worker thread, it won't ever make it back to the try-catch we have wrapping the `NatDevice.GetAllMappings()` call (this would require Mono.Nat to catch the exception and rethrow it on the right thread for us). Instead it goes unhandled and takes down our entire process as a result.\n\nThis is pretty dumb and there's not an awful lot we can do about this since the bug is in in the Mono.Nat library.\n\nThis bug can be hit any time a device on the network returns invalid XML for any request - so basically any time we call a method on `NatDevice`.\n\nI gather from other issues we don't have a lot of options to resolve this:\n- We can't handle the error in our code.\n- Mono.Nat is dead, so we can't fix it in that.\n- We've debated switching to another library in the past to no success: #7140\n\nFun.\n"
  },
  {
    "url": "https://api.github.com/repos/OpenRA/OpenRA/issues/comments/137275882",
    "html_url": "https://github.com/OpenRA/OpenRA/issues/8794#issuecomment-137275882",
    "issue_url": "https://api.github.com/repos/OpenRA/OpenRA/issues/8794",
    "id": 137275882,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzI3NTg4Mg==",
    "user": {
      "login": "pchote",
      "id": 167819,
      "node_id": "MDQ6VXNlcjE2NzgxOQ==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/167819?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pchote",
      "html_url": "https://github.com/pchote",
      "followers_url": "https://api.github.com/users/pchote/followers",
      "following_url": "https://api.github.com/users/pchote/following{/other_user}",
      "gists_url": "https://api.github.com/users/pchote/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pchote/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pchote/subscriptions",
      "organizations_url": "https://api.github.com/users/pchote/orgs",
      "repos_url": "https://api.github.com/users/pchote/repos",
      "events_url": "https://api.github.com/users/pchote/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pchote/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-02T23:53:54Z",
    "updated_at": "2015-09-02T23:53:54Z",
    "author_association": "MEMBER",
    "body": "We could fork and fix our own copy of Mono.Nat.\n"
  },
  {
    "url": "https://api.github.com/repos/OpenRA/OpenRA/issues/comments/137403406",
    "html_url": "https://github.com/OpenRA/OpenRA/issues/8794#issuecomment-137403406",
    "issue_url": "https://api.github.com/repos/OpenRA/OpenRA/issues/8794",
    "id": 137403406,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzQwMzQwNg==",
    "user": {
      "login": "LipkeGu",
      "id": 2057932,
      "node_id": "MDQ6VXNlcjIwNTc5MzI=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/2057932?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LipkeGu",
      "html_url": "https://github.com/LipkeGu",
      "followers_url": "https://api.github.com/users/LipkeGu/followers",
      "following_url": "https://api.github.com/users/LipkeGu/following{/other_user}",
      "gists_url": "https://api.github.com/users/LipkeGu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LipkeGu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LipkeGu/subscriptions",
      "organizations_url": "https://api.github.com/users/LipkeGu/orgs",
      "repos_url": "https://api.github.com/users/LipkeGu/repos",
      "events_url": "https://api.github.com/users/LipkeGu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LipkeGu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-03T10:29:35Z",
    "updated_at": "2015-09-03T10:29:52Z",
    "author_association": "MEMBER",
    "body": "Extracting this functions and fixing them would be better than shipping an entire libary\n"
  },
  {
    "url": "https://api.github.com/repos/OpenRA/OpenRA/issues/comments/137584862",
    "html_url": "https://github.com/OpenRA/OpenRA/issues/8794#issuecomment-137584862",
    "issue_url": "https://api.github.com/repos/OpenRA/OpenRA/issues/8794",
    "id": 137584862,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzU4NDg2Mg==",
    "user": {
      "login": "LipkeGu",
      "id": 2057932,
      "node_id": "MDQ6VXNlcjIwNTc5MzI=",
      "avatar_url": "https://avatars1.githubusercontent.com/u/2057932?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LipkeGu",
      "html_url": "https://github.com/LipkeGu",
      "followers_url": "https://api.github.com/users/LipkeGu/followers",
      "following_url": "https://api.github.com/users/LipkeGu/following{/other_user}",
      "gists_url": "https://api.github.com/users/LipkeGu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LipkeGu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LipkeGu/subscriptions",
      "organizations_url": "https://api.github.com/users/LipkeGu/orgs",
      "repos_url": "https://api.github.com/users/LipkeGu/repos",
      "events_url": "https://api.github.com/users/LipkeGu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LipkeGu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-03T21:54:28Z",
    "updated_at": "2015-09-03T21:57:22Z",
    "author_association": "MEMBER",
    "body": "I did this for another project and embedd the functions for NTLM authentification directly in my c project we could also do that ... and implement that directly in OpenRA\n"
  },
  {
    "url": "https://api.github.com/repos/OpenRA/OpenRA/issues/comments/137634069",
    "html_url": "https://github.com/OpenRA/OpenRA/issues/8794#issuecomment-137634069",
    "issue_url": "https://api.github.com/repos/OpenRA/OpenRA/issues/8794",
    "id": 137634069,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzNzYzNDA2OQ==",
    "user": {
      "login": "chrisforbes",
      "id": 128877,
      "node_id": "MDQ6VXNlcjEyODg3Nw==",
      "avatar_url": "https://avatars1.githubusercontent.com/u/128877?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chrisforbes",
      "html_url": "https://github.com/chrisforbes",
      "followers_url": "https://api.github.com/users/chrisforbes/followers",
      "following_url": "https://api.github.com/users/chrisforbes/following{/other_user}",
      "gists_url": "https://api.github.com/users/chrisforbes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chrisforbes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chrisforbes/subscriptions",
      "organizations_url": "https://api.github.com/users/chrisforbes/orgs",
      "repos_url": "https://api.github.com/users/chrisforbes/repos",
      "events_url": "https://api.github.com/users/chrisforbes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chrisforbes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-09-04T02:49:27Z",
    "updated_at": "2015-09-04T02:49:27Z",
    "author_association": "MEMBER",
    "body": "+1 for fork-and-fix.\n"
  },
  {
    "url": "https://api.github.com/repos/OpenRA/OpenRA/issues/comments/147121952",
    "html_url": "https://github.com/OpenRA/OpenRA/issues/8794#issuecomment-147121952",
    "issue_url": "https://api.github.com/repos/OpenRA/OpenRA/issues/8794",
    "id": 147121952,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NzEyMTk1Mg==",
    "user": {
      "login": "Mailaender",
      "id": 756669,
      "node_id": "MDQ6VXNlcjc1NjY2OQ==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/756669?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Mailaender",
      "html_url": "https://github.com/Mailaender",
      "followers_url": "https://api.github.com/users/Mailaender/followers",
      "following_url": "https://api.github.com/users/Mailaender/following{/other_user}",
      "gists_url": "https://api.github.com/users/Mailaender/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Mailaender/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Mailaender/subscriptions",
      "organizations_url": "https://api.github.com/users/Mailaender/orgs",
      "repos_url": "https://api.github.com/users/Mailaender/repos",
      "events_url": "https://api.github.com/users/Mailaender/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Mailaender/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-10-10T20:04:43Z",
    "updated_at": "2015-10-10T20:04:43Z",
    "author_association": "MEMBER",
    "body": "We use the https://github.com/nterry/Mono.Nat fork which also provides the Nuget package so upstream collaboration is possible here.\n"
  },
  {
    "url": "https://api.github.com/repos/OpenRA/OpenRA/issues/comments/147124613",
    "html_url": "https://github.com/OpenRA/OpenRA/issues/8794#issuecomment-147124613",
    "issue_url": "https://api.github.com/repos/OpenRA/OpenRA/issues/8794",
    "id": 147124613,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE0NzEyNDYxMw==",
    "user": {
      "login": "GraionDilach",
      "id": 1136302,
      "node_id": "MDQ6VXNlcjExMzYzMDI=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/1136302?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/GraionDilach",
      "html_url": "https://github.com/GraionDilach",
      "followers_url": "https://api.github.com/users/GraionDilach/followers",
      "following_url": "https://api.github.com/users/GraionDilach/following{/other_user}",
      "gists_url": "https://api.github.com/users/GraionDilach/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/GraionDilach/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GraionDilach/subscriptions",
      "organizations_url": "https://api.github.com/users/GraionDilach/orgs",
      "repos_url": "https://api.github.com/users/GraionDilach/repos",
      "events_url": "https://api.github.com/users/GraionDilach/events{/privacy}",
      "received_events_url": "https://api.github.com/users/GraionDilach/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-10-10T20:53:26Z",
    "updated_at": "2015-10-10T20:53:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "This isn't a Windows-only crash though, I had this in Linux too.\n"
  },
  {
    "url": "https://api.github.com/repos/OpenRA/OpenRA/issues/comments/158762135",
    "html_url": "https://github.com/OpenRA/OpenRA/issues/8794#issuecomment-158762135",
    "issue_url": "https://api.github.com/repos/OpenRA/OpenRA/issues/8794",
    "id": 158762135,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1ODc2MjEzNQ==",
    "user": {
      "login": "Mailaender",
      "id": 756669,
      "node_id": "MDQ6VXNlcjc1NjY2OQ==",
      "avatar_url": "https://avatars0.githubusercontent.com/u/756669?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Mailaender",
      "html_url": "https://github.com/Mailaender",
      "followers_url": "https://api.github.com/users/Mailaender/followers",
      "following_url": "https://api.github.com/users/Mailaender/following{/other_user}",
      "gists_url": "https://api.github.com/users/Mailaender/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Mailaender/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Mailaender/subscriptions",
      "organizations_url": "https://api.github.com/users/Mailaender/orgs",
      "repos_url": "https://api.github.com/users/Mailaender/repos",
      "events_url": "https://api.github.com/users/Mailaender/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Mailaender/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-11-22T14:08:35Z",
    "updated_at": "2015-11-22T14:08:35Z",
    "author_association": "MEMBER",
    "body": "@nterry: Have you asked @Xamarin already to gain control over https://github.com/mono/Mono.Nat so we can collaborate on fixing up Mono.NAT all together? Creating yet another fork doesn't sound too sustainable in my eyes also in regard of re-using system libraries when distributing under Linux. https://github.com/OpenRA/OpenRA/issues/8264\n"
  },
  {
    "url": "https://api.github.com/repos/OpenRA/OpenRA/issues/comments/159368904",
    "html_url": "https://github.com/OpenRA/OpenRA/issues/8794#issuecomment-159368904",
    "issue_url": "https://api.github.com/repos/OpenRA/OpenRA/issues/8794",
    "id": 159368904,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE1OTM2ODkwNA==",
    "user": {
      "login": "nterry",
      "id": 815254,
      "node_id": "MDQ6VXNlcjgxNTI1NA==",
      "avatar_url": "https://avatars2.githubusercontent.com/u/815254?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nterry",
      "html_url": "https://github.com/nterry",
      "followers_url": "https://api.github.com/users/nterry/followers",
      "following_url": "https://api.github.com/users/nterry/following{/other_user}",
      "gists_url": "https://api.github.com/users/nterry/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nterry/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nterry/subscriptions",
      "organizations_url": "https://api.github.com/users/nterry/orgs",
      "repos_url": "https://api.github.com/users/nterry/repos",
      "events_url": "https://api.github.com/users/nterry/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nterry/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-11-24T18:45:20Z",
    "updated_at": "2015-11-24T18:45:20Z",
    "author_association": "NONE",
    "body": "@Mailaender Yes, but they said that they wouldn't... Im still working on that.\n"
  }
]
